"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["5968"],{3258:function(e,t,n){n.d(t,{ZP:()=>p,wg:()=>Z});var i=n(7409),r=n(99282),a=n(16584),o=n(94184),l=n.n(o),c=n(80569),s=n.n(c),d=n(85685),u=n(85095),m=n(33017),h=n(63651),g=n(51885);let p=e=>{let{id:t,type:n,name:i,url:r,photo_url:o,uuid:c,mentionText:s,isStatic:p=!1,isEditorContext:f=!1}=e;return p?(0,a.tZ)("span",{className:l()(g.Z.mention,g.Z.mentionStatic),"data-component-name":"MentionStatic",children:(0,a.tZ)("a",{href:(0,h.gpq)(n,t,i,r),children:i||"Substack user"})}):"user"===n?(0,a.tZ)(u.am,{children:(0,a.tZ)(d.ProfileHoverCard,{subject:{id:t,name:i||"Substack user",photo_url:o},utmSource:"mention",children:(0,a.tZ)("a",{className:g.Z.mention,href:f?void 0:(0,h.gpq)(n,t,i,r),target:"_blank",rel:"noopener","data-attrs":JSON.stringify({name:i,id:t,type:n,url:r,photo_url:o,uuid:c}),onClick:e=>e.stopPropagation(),"data-component-name":"MentionUser",children:null!=s?s:i})})}):"pub"===n?(0,a.tZ)(m.Sm,{publication_id:t,utmSource:"mention",children:(0,a.tZ)("a",{className:g.Z.mention,href:r,target:"_blank",rel:"noopener","data-attrs":JSON.stringify({name:i,id:t,type:n,url:f?void 0:(0,h.gpq)(n,t,i,r),uuid:c}),onClick:e=>e.stopPropagation(),"data-component-name":"MentionPub",children:null!=s?s:i})}):(0,a.tZ)("a",{className:g.Z.mention,target:"_blank",rel:"noopener",href:(0,h.gpq)(n,t,i,r),"data-attrs":JSON.stringify({name:i,id:t,type:n,url:r,photo_url:o,uuid:c}),"data-component-name":"Mention",children:null!=s?s:i})},f={},Z=async function(e){let{pathname:t="/api/v1/posts/mention"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(f[e])return f[e];let{profiles:n,publications:a}=(await s().get(t).query({query:e,include_unmentionables:!0})).body,o=new Map;return n&&n.length&&o.set("Writers",n.map(e=>(0,r._)((0,i._)({},e),{type:"user",disabledReason:e.is_mentionable?void 0:"unmentionable"}))),a&&a.length&&o.set("Publications",null==a?void 0:a.map(e=>(0,r._)((0,i._)({},e),{type:"pub",url:(0,h.HQ5)({subdomain:e.subdomain}),photo_url:e.logo_url}))),f[e]=o,o}},33451:function(e,t,n){n.d(t,{A7:()=>W,Gt:()=>T,Ii:()=>q,KV:()=>x,P9:()=>_,aE:()=>N,bO:()=>P,pc:()=>k,xj:()=>X,xk:()=>B});var i=n(7409),r=n(99282),a=n(98848),o=n(16584),l=n(94184),c=n.n(l),s=n(48403),d=n.n(s);n(39693);var u=n(56687),m=n(99869);n(93974);var h=n(39535);n(3880),n(79094);var g=n(20888);n(19548),n(95441),n(77906),n(48980),n(94874);var p=n(80026);n(44424);var f=n(38841),Z=n(63474);n(91021),n(70379),n(1669);var b=n(55533);n(16913),n(69304),n(93502),n(32223),n(97842),n(11308);var v=n(36889);n(76820),n(98012),n(60308);var y=n(63651),w=n(77859);function x(e){var t;let{user:n}=e;return(0,o.tZ)(p.xu,{paddingX:12,children:(0,o.tZ)(p.xv.B4,{as:"a",color:"secondary",decoration:"hover-underline",href:(0,y.NNq)(n,{noBase:!0}),target:"_blank",children:null!==(t=n.name)&&void 0!==t?t:"Substack user"})})}let k=(0,p.zo)({className:w.Z.messageBubbleGroup,position:"relative",gap:2},Z.sg);function N(e){let{direction:t,isLink:n,backgroundColor:i,isAuthorContributor:r}=e,a="incoming"===t&&r,l="".concat(i,"1A");return(0,o.BX)("svg",{viewBox:"0 0 16 13",className:c()(w.Z.bubbs,w.Z[t],n&&w.Z.isLink,r&&w.Z.author),style:a?{fill:l}:{},children:[(0,o.tZ)("circle",{cx:"5",cy:"5",r:"5",className:w.Z.bubb}),(0,o.tZ)("circle",{cx:"13.5",cy:"10.5",r:"2.5",className:w.Z.bubb}),a&&(0,o.BX)(o.HY,{children:[(0,o.tZ)("circle",{cx:"5",cy:"5",r:"5",fill:l}),(0,o.tZ)("circle",{cx:"13.5",cy:"10.5",r:"2.5",fill:l})]})]})}function X(e){var{messageDirection:t,isFirst:n=!1,isLast:l=!1,forceTheme:s,pubThemeAccentColor:u,isAuthorContributor:m,className:h}=e,g=(0,a._)(e,["messageDirection","isFirst","isLast","forceTheme","pubThemeAccentColor","isAuthorContributor","className"]);let f="incoming"===t&&m,Z=f&&u;return(0,o.tZ)(p.X2,(0,r._)((0,i._)({},g),{className:c()(w.Z.bubble,w.Z[t],n&&w.Z.isFirst,l&&w.Z.isLast,s&&w.Z["force".concat(d()(s),"Theme")],f&&w.Z.author,h),style:{"--color-chat-author-bg-overlay":Z?"".concat(u,"1A"):"oklch(from var(--color-bg-accent-themed) l c h / 0.1)"}}))}function B(e){let{metadata:t,publication:n,direction:i,isFirst:r,isLast:a}=e,l=_(t.url);return l?(0,o.tZ)(X,{messageDirection:i,isFirst:r,isLast:a,maxWidth:400,forceTheme:"incoming",outline:"detail",children:(0,o.tZ)(S,{videoId:l})}):(0,o.tZ)(X,{as:"a",href:t.url,target:"_blank",rel:"nofollow noopener ugc",messageDirection:i,isFirst:r,isLast:a,maxWidth:400,forceTheme:"incoming",outline:"detail",children:!function(e){let{metadata:t}=e;if(!t.image)return!1;let n=(0,y.zJH)(t.image);return!!n&&(n.width<401||n.height<401)}({metadata:t})?(0,o.tZ)(C,{publication:n,metadata:t}):(0,o.tZ)(P,{metadata:t})})}function _(e){try{let t=new URL(e);if("youtube.com"===t.hostname||"www.youtube.com"===t.hostname){let e=t.searchParams.get("v");if("/watch"===t.pathname&&e)return e}else if("youtu.be"===t.hostname){let e=t.pathname.slice(1);if(e)return e}}catch(e){console.error("Error parsing URL:",e)}return null}function W(e){try{var t,n;let i=new URL(e);if(i.pathname.startsWith("/player/v1/"))return null!==(t=i.pathname.split("/").pop())&&void 0!==t?t:null;if(i.pathname.includes("/video/")){let e=i.pathname.split("/"),t=e.indexOf("video")+1;if(t<e.length)return null!==(n=e[t])&&void 0!==n?n:null}}catch(e){console.error("Error parsing TikTok URL:",e)}return null}function S(e){let{videoId:t}=e;return(0,o.tZ)(I,{src:"https://www.youtube.com/embed/".concat(t),frameBorder:0})}let I=(0,p.zo)({className:w.Z.youtubeIframe,border:"unset",bg:"black",flex:"grow"},"iframe");function P(e){let{metadata:t}=e;return(0,o.BX)(p.X2,{flex:"grow",gap:12,padding:12,minWidth:0,children:[(0,o.tZ)(L,{metadata:t}),t.image?(0,o.tZ)(p.sg,{radius:"md",overflow:"hidden",bg:"tertiary",minWidth:0,children:(0,o.tZ)(g.e,{className:c()(w.Z.linkImage,w.Z.small),src:t.image,maxWidth:64,useRetinaSizing:!0,imageIsFixedWidth:!0,imageProps:{smartCrop:!0,aspect:"1:1"}})}):(0,o.tZ)(p.sg,{alignItems:"center",justifyContent:"center",radius:"md",height:64,width:64,bg:"tertiary",children:(0,o.tZ)(u.Z,{stroke:"var(--color-fg-secondary)"})})]})}function C(e){let{metadata:t,publication:n}=e;return(0,o.BX)(p.sg,{flex:"grow",maxWidth:400,minWidth:400,children:[t.image&&(0,o.tZ)(g.e,{className:w.Z.linkImage,src:t.image,maxWidth:400,useRetinaSizing:!0,imageIsFixedWidth:!0,imageProps:{aspect:"1.91:1",gravity:"auto",crop:"fill"}}),(0,o.tZ)(p.X2,{flex:"grow",padding:12,borderTop:t.image?"detail":void 0,children:(0,o.tZ)(L,{metadata:t,publication:n})})]})}function L(e){let{metadata:t,publication:n}=e;return(0,o.BX)(p.X2,{flex:"grow",gap:12,minWidth:0,children:[(0,o.BX)(p.sg,{minWidth:0,flex:"grow",gap:2,children:[t.host&&(0,o.BX)(p.X2,{alignItems:"center",gap:8,minWidth:0,paddingBottom:n?4:void 0,children:[n&&(0,o.tZ)(f.wk,{pub:n,size:18,radius:"xs"}),(0,o.tZ)(p.xv.B4,{color:"secondary",ellipsis:!0,children:t.host})]}),t.title&&(0,o.tZ)(p.xv.B3,{color:"primary",weight:"medium",clamp:2,children:t.title})]}),!t.image&&(0,o.tZ)(p.X2,{width:64,height:64,bg:"tertiary",radius:"md",alignItems:"center",justifyContent:"center",children:"twitter.com"===t.host||"x.com"===t.host?(0,o.tZ)(h.Z,{fill:"var(--color-fg-secondary)"}):(0,o.tZ)(m.Z,{stroke:"var(--color-fg-secondary)"})})]})}function T(){return(0,o.BX)(p.X2,{gap:12,padding:12,alignItems:"center",bg:"secondary",flex:"grow",children:[(0,o.BX)(p.sg,{minWidth:0,flex:"grow",gap:8,children:[(0,o.tZ)(v.V,{height:16,width:"".concat(30*Math.random()+60,"%")}),(0,o.tZ)(v.V,{height:16,width:"".concat(20*Math.random()+20,"%")})]}),(0,o.tZ)(v.V,{size:64,radius:"md"})]})}function q(){return(0,o.tZ)(p.X2,{gap:12,alignItems:"start",bg:"secondary",flex:"grow",children:(0,o.tZ)(b.vJ,{title:"Error loading link",body:"Please try again"})})}}}]);