"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["4615"],{5772:function(e,t,n){n.d(t,{R:()=>u});var o=n(30396),r=n(23279),a=n.n(r);function u(e){let{items:t,getKeys:n,sort:r=!0,sortFunc:u,deps:c}=e,i=(e,t)=>{let o=n(e),r=n(t);for(let e=0;e<Math.min(o.length,r.length);e++){let t=o[e].localeCompare(r[e]);if(0!==t)return t}return o.length-r.length},[l,s]=(0,o.eJ)(""),d=(0,o.Ye)(()=>a()(s,100),[s]),f=l.trim();return{setQuery:d,filteredItems:(0,o.Ye)(()=>{if(!f)return t;let e=t.filter(e=>n(e).some(e=>e.toLowerCase().includes(f.toLowerCase())));return(r||u)&&(e=e.sort(u||i)),e},c?[f,...c]:[f,t]),hasFiltered:""!==f,query:f}}},12706:function(e,t,n){n.d(t,{Z:()=>i});var o=n(7409),r=n(99282),a=n(98848),u=n(16584),c=n(64515);let i=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,i=(0,a._)(e,["size","fill"]);return(0,u.tZ)(c.l,(0,r._)((0,o._)({},i),{name:"CommentBadgeFoundingIcon",svgParams:{viewBox:"0 0 26 26"},width:t,height:t,stroke:"none",fill:n,children:(0,u.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.82184 6.14159C7.56025 6.78804 7.4162 7.49464 7.4162 8.23489C7.4162 9.09949 7.61271 9.91819 7.9635 10.6488C8.60389 10.4676 9.27965 10.3706 9.97806 10.3706C10.1536 10.3706 10.3278 10.3767 10.5003 10.3888C10.6996 9.28561 11.1441 8.26769 11.7752 7.39342C10.8114 6.60183 9.57792 6.12665 8.23342 6.12665C8.09499 6.12665 7.95774 6.13168 7.82184 6.14159ZM5.77711 6.69453C5.67168 7.19136 5.6162 7.70664 5.6162 8.23489C5.6162 9.34746 5.86227 10.4026 6.30295 11.3487C5.04556 12.0717 4.02116 13.1542 3.37011 14.456C2.91142 13.6453 2.64961 12.7084 2.64961 11.7105C2.64961 9.50798 3.92478 7.60333 5.77711 6.69453ZM6.62812 4.50164C3.32204 5.23459 0.849609 8.18379 0.849609 11.7105C0.849609 13.5781 1.54303 15.2838 2.68647 16.5842C2.62578 16.9653 2.59425 17.3562 2.59425 17.7544C2.59425 21.8324 5.9001 25.1382 9.97806 25.1382C11.0364 25.1382 12.0427 24.9156 12.9527 24.5146C13.8703 24.9237 14.8868 25.1511 15.9565 25.1511C20.0344 25.1511 23.3403 21.8453 23.3403 17.7673C23.3403 17.3869 23.3115 17.0133 23.256 16.6484C24.4334 15.3402 25.15 13.609 25.15 11.7105C25.15 8.18398 22.6778 5.23491 19.372 4.50176C18.0895 2.31749 15.716 0.851074 13 0.851074C10.2841 0.851074 7.91059 2.31743 6.62812 4.50164ZM8.97613 4.36354C10.502 4.51594 11.8911 5.13289 12.9998 6.07089C14.1086 5.1328 15.4978 4.51583 17.0239 4.36349C16.008 3.30789 14.5807 2.65107 13 2.65107C11.4193 2.65107 9.99198 3.30791 8.97613 4.36354ZM18.1782 6.14162C18.0422 6.1317 17.9047 6.12665 17.7661 6.12665C16.4217 6.12665 15.1881 6.60183 14.2244 7.39342C14.8571 8.26995 15.3022 9.29088 15.5008 10.3974C15.6515 10.3882 15.8034 10.3835 15.9565 10.3835C16.6738 10.3835 17.3673 10.4858 18.0231 10.6766C18.3823 9.93902 18.5838 9.11049 18.5838 8.23489C18.5838 7.49466 18.4398 6.78807 18.1782 6.14162ZM16.872 12.2582C16.5741 12.2091 16.2683 12.1835 15.9565 12.1835C15.8373 12.1835 15.7189 12.1873 15.6016 12.1946C15.5866 12.4264 15.5609 12.6552 15.525 12.8807C15.5917 12.9565 15.6569 13.0338 15.7205 13.1123C16.1408 12.8774 16.5276 12.5897 16.872 12.2582ZM16.6751 14.6406C17.456 14.1916 18.147 13.6039 18.7146 12.9112C19.918 13.5961 20.8419 14.7155 21.2731 16.0559C20.3145 16.8304 19.0945 17.2943 17.7661 17.2943C17.6251 17.2943 17.4852 17.289 17.3468 17.2788C17.2872 16.341 17.0525 15.4508 16.6751 14.6406ZM14.6053 15.4437C14.7432 15.4131 14.8797 15.3787 15.0146 15.3405C15.2344 15.7983 15.3936 16.2906 15.4819 16.8072C15.0272 16.6031 14.6048 16.3399 14.2244 16.0275C14.3602 15.8394 14.4874 15.6446 14.6053 15.4437ZM13.5397 13.4538C13.5008 13.5722 13.4581 13.689 13.4116 13.8038C13.2757 13.8137 13.1384 13.8187 13 13.8187C12.8614 13.8187 12.724 13.8136 12.588 13.8037C12.5373 13.6787 12.4911 13.5513 12.4495 13.4219C12.6177 13.286 12.794 13.1597 12.9774 13.0437C13.1735 13.1688 13.3613 13.3059 13.5397 13.4538ZM12.9818 11.0072C13.2248 10.9001 13.4747 10.8057 13.7305 10.725C13.6069 10.0305 13.3548 9.3804 12.9998 8.80019C12.6435 9.3825 12.3909 10.0352 12.2677 10.7325C12.5116 10.8119 12.7499 10.9038 12.9818 11.0072ZM10.3974 12.1861C10.259 12.1758 10.1191 12.1706 9.97806 12.1706C9.68186 12.1706 9.39103 12.1937 9.1073 12.2381C9.44659 12.5681 9.82768 12.8553 10.2419 13.0911C10.3148 13.0021 10.3897 12.9149 10.4666 12.8294C10.4344 12.6178 10.4112 12.4032 10.3974 12.1861ZM9.27818 14.6135C8.50368 14.1606 7.81907 13.5707 7.25761 12.877C6.04543 13.5545 5.11183 14.6709 4.67178 16.0111C5.63842 16.8125 6.87966 17.2943 8.23342 17.2943C8.35261 17.2943 8.47093 17.2905 8.58827 17.2832C8.64976 16.3331 8.89095 15.432 9.27818 14.6135ZM10.4498 16.8371C10.5392 16.3038 10.7042 15.7962 10.9334 15.3256C11.085 15.3697 11.2387 15.4091 11.3942 15.4436C11.5121 15.6445 11.6393 15.8393 11.7752 16.0275C11.3759 16.3554 10.9304 16.6291 10.4498 16.8371ZM8.68906 19.0804C8.53836 19.0896 8.38643 19.0943 8.23342 19.0943C6.82992 19.0943 5.51788 18.7027 4.40059 18.0228C4.54064 20.982 6.98419 23.3382 9.97806 23.3382C10.3286 23.3382 10.6715 23.3059 11.0041 23.2442C9.81887 22.1718 8.98334 20.72 8.68906 19.0804ZM12.9571 22.478C11.6671 21.6549 10.7378 20.3165 10.4593 18.7528C11.4019 18.4552 12.2628 17.9735 12.9998 17.35C13.7201 17.9595 14.5588 18.4334 15.4765 18.7324C15.1983 20.3075 14.2597 21.6548 12.9571 22.478ZM14.9067 23.2526C15.2467 23.3173 15.5976 23.3511 15.9565 23.3511C18.9412 23.3511 21.379 21.0093 21.5326 18.0627C20.4299 18.718 19.1419 19.0943 17.7661 19.0943C17.5906 19.0943 17.4164 19.0881 17.2439 19.0761C16.9463 20.7231 16.1024 22.18 14.9067 23.2526ZM22.5911 14.5228C21.9495 13.2133 20.9316 12.1216 19.6783 11.3888C20.1308 10.4323 20.3838 9.36317 20.3838 8.23489C20.3838 7.70673 20.3284 7.19153 20.223 6.69479C22.075 7.60369 23.35 9.50818 23.35 11.7105C23.35 12.736 23.0735 13.6969 22.5911 14.5228Z"})}))}},53957:function(e,t,n){n.d(t,{Z:()=>i});var o=n(7409),r=n(99282),a=n(98848),u=n(16584),c=n(64515);let i=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,i=(0,a._)(e,["size","fill"]);return(0,u.tZ)(c.l,(0,r._)((0,o._)({},i),{name:"CommentBadgeFoundingIcon",svgParams:{viewBox:"0 0 24 24"},width:t,height:t,stroke:"none",fill:n,children:(0,u.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.0436 3.51174C14.4213 1.66968 17.8438 1.81108 20.0161 3.98341C22.1882 6.15552 22.3297 9.5776 20.4883 11.9552C22.308 14.3248 22.1043 17.7443 19.9244 19.9242C17.7446 22.104 14.3255 22.3079 11.956 20.4885C9.57839 22.3299 6.1564 22.1883 3.98435 20.0162C1.8125 17.8443 1.67073 14.4227 3.51158 12.0451C1.69209 9.67557 1.89593 6.25627 4.07573 4.07643C6.25532 1.8968 9.67415 1.69278 12.0436 3.51174ZM10.7862 4.82251C9.14237 3.68439 6.84468 3.85303 5.34853 5.34921C3.8523 6.84546 3.68371 9.14337 4.822 10.7873C6.30674 9.7329 8.15567 9.41636 9.84859 9.84842C9.41641 8.15584 9.73255 6.30722 10.7862 4.82251ZM6.19444 12.0422C7.5081 11.2786 9.12685 11.2691 10.425 12.0048C9.11132 12.7684 7.49256 12.7779 6.19444 12.0422ZM4.82075 13.3014C3.6397 14.9746 3.79215 17.2784 5.25715 18.7435C6.72233 20.2087 9.02649 20.361 10.6997 19.1794C9.66398 17.7076 9.37248 15.8727 9.81462 14.1861C8.12786 14.6285 6.29279 14.3372 4.82075 13.3014ZM11.9587 17.8054C11.2232 16.5075 11.2326 14.8891 11.9957 13.5756C12.7312 14.8735 12.7218 16.4919 11.9587 17.8054ZM13.2136 19.178C14.8575 20.3162 17.1553 20.1477 18.6516 18.6514C20.1479 17.155 20.3164 14.8568 19.1778 13.2128C17.6931 14.2668 15.8445 14.5832 14.1519 14.1512C14.5841 15.8441 14.2678 17.6931 13.2136 19.178ZM17.805 11.958C16.4917 12.7209 14.8738 12.7303 13.5761 11.9952C14.8894 11.2324 16.5073 11.2229 17.805 11.958ZM19.1791 10.6991C20.3608 9.02581 20.2085 6.72146 18.7433 5.25619C17.2779 3.79079 14.9733 3.63863 13.3 4.82071C14.3361 6.29264 14.6277 8.1277 14.1855 9.81454C15.8722 9.37211 17.7071 9.66343 19.1791 10.6991ZM12.0413 6.19502C12.7767 7.49269 12.7676 9.1108 12.0048 10.4243C11.2694 9.12658 11.2786 7.50848 12.0413 6.19502Z"})}))}},20144:function(e,t,n){n.d(t,{Z:()=>i});var o=n(7409),r=n(99282),a=n(98848),u=n(16584),c=n(64515);let i=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,i=(0,a._)(e,["size","fill"]);return(0,u.tZ)(c.l,(0,r._)((0,o._)({},i),{name:"CommentBadgeStarIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,children:(0,u.tZ)("path",{stroke:"none",d:"M5.29389 16.7794C5.1238 16.6496 5.02086 16.4773 4.98505 16.2625C4.94924 16.0521 4.97834 15.8081 5.07233 15.5306L6.43525 11.4822L2.95746 8.99133C2.71576 8.81677 2.54568 8.6355 2.44721 8.44751C2.35322 8.25505 2.34203 8.05587 2.41364 7.84998C2.48078 7.64856 2.60834 7.49862 2.79633 7.40015C2.98432 7.30168 3.22602 7.25468 3.52143 7.25916L7.79145 7.28601L9.08722 3.21069C9.17674 2.92871 9.29759 2.71387 9.44977 2.56616C9.60195 2.41398 9.78323 2.33789 9.9936 2.33789C10.2084 2.33789 10.392 2.41398 10.5441 2.56616C10.6963 2.71387 10.8172 2.92871 10.9067 3.21069L12.2025 7.28601L16.4658 7.25916C16.7656 7.25468 17.0096 7.30168 17.1976 7.40015C17.3856 7.49862 17.5131 7.64856 17.5803 7.84998C17.6519 8.05587 17.6385 8.25505 17.54 8.44751C17.446 8.6355 17.2781 8.81677 17.0364 8.99133L13.5587 11.4822L14.9216 15.5306C15.0156 15.8081 15.0447 16.0521 15.0089 16.2625C14.973 16.4773 14.8701 16.6496 14.7 16.7794C14.5255 16.9092 14.3308 16.9562 14.1159 16.9204C13.9055 16.8846 13.6817 16.7794 13.4445 16.6049L9.9936 14.0737L6.54938 16.6049C6.31216 16.7794 6.08613 16.8846 5.87128 16.9204C5.66091 16.9562 5.46845 16.9092 5.29389 16.7794Z"})}))}},43148:function(e,t,n){n.d(t,{H:()=>d,o:()=>s});var o=n(16584),r=n(98661),a=n(30396),u=n(15771),c=n(19081),i=n(58175),l=n(12811);let s=(0,r.forwardRef)((e,t)=>{let{onClick:n,children:r,disabled:a=!1,size:c="md"}=e;return(0,o.tZ)(u.GI,{ref:t,rounded:!0,onClick:n,disabled:a,size:c,children:r})}),d=e=>{let{label:t,children:n}=e,[r,u]=(0,a.eJ)(!1);return(0,o.BX)(c.gq,{gap:8,justifyContent:"center",alignItems:"center",children:[t&&(0,o.tZ)(c.gq,{bg:"glass-inverted-medium",justifyContent:"center",alignItems:"center",radius:"sm",paddingY:6,paddingX:8,className:l.Z.verticalMenuLabel,style:{opacity:+!!r},children:(0,o.tZ)(i.xv.B4,{color:"white",children:t})}),(0,o.tZ)("div",{onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:n})]})}},77338:function(e,t,n){n.d(t,{h:()=>p,x:()=>m});var o=n(7409),r=n(99282),a=n(16584),u=n(74691),c=n.n(u),i=n(39693),l=n.n(i),s=n(67348),d=n(93252),f=n(58175),C=n(23398),h=n(5749);function p(e){let{content:t,isHidden:n,hiddenText:o,attachedLinks:r}=e;return t?(0,a.BX)(f.xv.B4,{className:h.Z.feedCommentBodyInner,children:[n&&o,t&&(0,a.tZ)(m,{content:t,attachedLinks:r})]}):null}function m(e){var t,n,u,i,f,h,p;let{content:b,onLinkClicked:g,attachedLinks:v,isFirstElement:_=!0,isLastElement:y=!1}=e;if("text"===b.type){let e=null===(t=b.marks)||void 0===t?void 0:t.find(e=>"link"===e.type),c=null==e?void 0:null===(n=e.attrs)||void 0===n?void 0:n.href,i=b.text;if(c){let e=(0,C.u)(c),t=_||y?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t.length)return e;for(let n of t){let t=(0,C.u)(n);if(e.includes(t))return null}return e}(e,v):e;i=null!=t?t:void 0}if(!i)return null;let l=(0,a.tZ)(a.HY,{children:i});if(b.marks)for(let e of b.marks)"link"===e.type?l=(0,a.tZ)("a",(0,r._)((0,o._)({className:"note-link"},e.attrs),{target:(0,d.P)()?"_blank":null===(u=e.attrs)||void 0===u?void 0:u.target,onClick:()=>g&&g(),children:l})):"bold"===e.type?l=(0,a.tZ)("strong",{children:l}):"italic"===e.type?l=(0,a.tZ)("em",{children:l}):"strike"===e.type?l=(0,a.tZ)("s",{children:l}):"code"===e.type?l=(0,a.tZ)("code",{children:l}):"mark"===e.type&&(l=(0,a.tZ)("mark",{className:"note-highlight",children:l}));return l}if("substack_mention"===b.type){let{id:e,label:t,mentionType:n,url:o}=null!==(i=b.attrs)&&void 0!==i?i:{};return e&&t?(0,a.tZ)(s.p,{id:e,label:t,type:n,url:o}):null}let Z=l()(null!==(f=b.content)&&void 0!==f?f:[]).map((e,t,n)=>(0,a.tZ)(m,{content:e,onLinkClicked:g,attachedLinks:v,isFirstElement:0===t,isLastElement:t===n.length-1}));if("doc"===b.type)return(0,a.tZ)("div",{className:"ProseMirror FeedProseMirror",children:Z});if("paragraph"===b.type)return(0,a.tZ)("p",{children:Z});if("heading"===b.type){let e="h".concat(c()((null!==(p=null===(h=b.attrs)||void 0===h?void 0:h.level)&&void 0!==p?p:1)+1,2,6));return(0,a.tZ)(e,{children:Z})}return"blockquote"===b.type?(0,a.tZ)("blockquote",{children:Z}):"codeBlock"===b.type?(0,a.tZ)("pre",{children:(0,a.tZ)("code",{children:Z})}):"orderedList"===b.type?(0,a.tZ)("ol",{children:Z}):"bulletList"===b.type?(0,a.tZ)("ul",{children:Z}):"listItem"===b.type?(0,a.tZ)("li",{children:Z}):null}},46914:function(e,t,n){n.d(t,{z:()=>r});var o=n(30396);function r(e){let t=(0,o.sO)(e);return t.current=e,(0,o.Ye)(()=>function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.current(...n)},[])}},70717:function(e,t,n){n.d(t,{w:()=>c});var o=n(16584),r=n(19081),a=n(58175),u=n(84864);let c=e=>{let{duration:t,icon:n,position:c="bottom-left",previewDuration:i}=e;return(0,o.BX)(r.gq,{alignItems:"center",bg:"glass-inverted-medium",gap:6,paddingX:8,paddingY:2,position:"absolute",radius:"sm",style:"bottom-left"===c?{left:8,bottom:8}:{right:8,bottom:8},children:[n,(0,o.tZ)(a.xv.Meta,{color:"white",lineHeight:20,children:i?"".concat((0,u.secondsToHHMMSS)(i)," / ").concat((0,u.secondsToHHMMSS)(null!=t?t:0)):(0,u.secondsToHHMMSS)(null!=t?t:0)})]})}},19834:function(e,t,n){n.d(t,{Z:()=>a});var o=n(86492),r=n.n(o);function a(e){let{only_non_ascii:t=!1,useNamedReferences:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?r().encode(e||"",{useNamedReferences:n,decimal:!0,allowUnsafeSymbols:t}):e}},86551:function(e,t,n){n.d(t,{BN:()=>k,F2:()=>S,Fp:()=>R,HQ:()=>Z,Lb:()=>y,S_:()=>L,T6:()=>U,U0:()=>_,Ui:()=>N,aZ:()=>x,op:()=>B,pw:()=>w,sj:()=>M,tX:()=>I});var o=n(58865),r=n(60826),a=n(68833),u=n(60308),c=n(63651),i=n(84864),l=n(47929),s=n(68303),d=n(39947);function f(){let e=(0,o._)(["Start writing today. Use the button below to create a Substack of your own"]);return f=function(){return e},e}function C(){let e=(0,o._)(["Share ",""]);return C=function(){return e},e}function h(){let e=(0,o._)(["Get ","% off a group subscription"]);return h=function(){return e},e}function p(){let e=(0,o._)(["Get a group subscription"]);return p=function(){return e},e}function m(){let e=(0,o._)(["Give a gift subscription"]);return m=function(){return e},e}function b(){let e=(0,o._)(["","! Subscribe for free to receive new posts and support my work."]);return b=function(){return e},e}function g(){let e=(0,o._)(["",". To receive new posts and support my work, consider becoming a free or paid subscriber."]);return g=function(){return e},e}function v(){let e=(0,o._)(["","! This post is public so feel free to share it."]);return v=function(){return e},e}let _=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let a={url:"".concat(r.W.CHECKOUT_URL,"&donate=true"),text:o("Donate Subscriptions")};return n&&n((0,s.o4)(t,t.schema.nodes.button.create(a))),!0},y=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let a={url:"".concat(r.W.LEADERBOARD_URL,"&utm_source=").concat(l.b3.post),text:o("Refer a friend")};return n&&n((0,s.o4)(t,t.schema.nodes.button.create(a))),!0},Z=e=>{let{writerReferralCode:t,publication:n,postId:o}=e;return(e,r)=>{let{iString:a,iTemplate:c}=I18N.i({pub:n});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!e.schema.nodes.captionedWriterReferralButton)return console.error("captionedWriterReferralButton node type not found in schema"),!1;if(!e.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let i=c(f()),C={url:"".concat((0,u.Fnz)(t||""),"?utm_source=").concat(l.b3.substack,"&utm_context=").concat(l.gD.post,"&utm_content=").concat(o,"&utm_campaign=").concat(l.VX.writerReferralButton),text:a("Start a Substack")},h=e.schema.nodes.captionedWriterReferralButton.create(C,e.schema.nodes.ctaCaption.create(null,[e.schema.text(i)]));return r&&r((0,s.o4)(e,h)),!0}},M=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let a={url:r.W.HALF_MAGIC_COMMENTS_URL,text:o("Leave a comment")};return n&&n((0,s.o4)(t,t.schema.nodes.button.create(a))),!0},S=(e,t,n)=>(o,r)=>{if((0,a.j)(a.FP.READER_SURVEY_LINKED_IN_POST,{editorVersion:"1",surveyId:t.id}),!o.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(o,o.schema.nodes.button))return!1;let u={url:"".concat((0,c.h8g)(e,t.id)),text:n};return r&&r((0,s.o4)(o,o.schema.nodes.button.create(u))),!0},k=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let a={url:r.W.SHARE_URL,text:o("Share")};return n&&n((0,s.o4)(t,t.schema.nodes.button.create(a))),!0},L=e=>(t,n)=>{let{iTemplate:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let a={url:r.W.SHARE_PUB_URL,text:o(C(),e.name)};return n&&n((0,s.o4)(t,t.schema.nodes.button.create(a))),!0},w=e=>{let{couponPub:t,scrollParent:n,parentClass:o,get_coupons:r,insert_coupon:a,SelectField:c,openPrompt:i,closePrompt:l,getNetworkErrorMessage:s}=e;return(e,f,C)=>{let{iString:h}=I18N.i({pub:t});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let p={parentClass:o,root:n?document.querySelector(".".concat(n)):C.dom.parentNode,scrollParent:n,offsetTop:10},m=Object.assign({title:h("Loading..."),no_buttons:!0,language:t.language},p);return i(m),r().then(n=>{l(m);let o=n.map(e=>{var t;return{label:null!==(t=e.name)&&void 0!==t?t:"",value:e}}).concat([{label:h("Create new offer"),value:{create_new:!0}}]),r={coupon:new c({label:h("Select offer..."),required:!0,options:o,onChange:n=>{if(n&&"create_new"in n&&n.create_new){l(s);let n=window.open("".concat((0,u.SVA)(t),"/publish/offers/new?popup=true"),"_blank");n&&n.addEventListener&&n.addEventListener("message",t=>{let{data:n}=t;n&&n.coupon&&a({coupon:n.coupon,state:e,dispatch:f,schema:e.schema})},!1)}}})},s=Object.assign({title:h("Special Offer"),fields:r,language:null==t?void 0:t.language,onSubmit:t=>{let{coupon:n}=t;a({coupon:n,state:e,dispatch:C.dispatch,schema:e.schema})},onClose:()=>{C.focus()}},p);i(s)}).catch(e=>{l(m),alert(s(e))}),!1}},B=e=>{let{scrollParent:t,parentClass:n,TextField:o,openPrompt:r,publication:a}=e;return(e,u,c)=>{let{iString:i}=I18N.i({pub:a});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let l={parentClass:n,title:i("Create a button"),root:t?document.querySelector(".".concat(t)):c.dom.parentNode,scrollParent:t,offsetTop:10,language:null==a?void 0:a.language,fields:{text:new o({label:i("Enter text..."),required:!0,clean:e=>(e||"").trim(),validate:e=>{if(e.length>40)return i("Too long")}}),href:new o({label:i("Enter URL..."),required:!0,clean:e=>(e||"").trim(),validate:e=>{if(!/^%%.*%%$/.test(e)){try{let t=new URL(e);if(["http:","https:","mailto:"].includes(t.protocol))return}catch(e){}return i("Invalid URL")}}})}};return l.onSubmit=t=>{let n={url:t.href,text:t.text};if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;u&&c.dispatch((0,s.o4)(e,e.schema.nodes.button.create(n)))},l.onClose=()=>{c.focus()},r(l),!0}},R=e=>{let{publication:t}=e;return(e,n)=>{let{iTemplate:o}=I18N.i({pub:t});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let a=t.default_group_coupon,u={url:"".concat(r.W.CHECKOUT_URL,"group=true").concat(a?"&coupon=".concat(a):""),text:(0,i.getSubscriptionSentenceWithCustomWords)(t,()=>{var e;return a&&t.default_group_coupon_percent_off?o(h(),null!==(e=t.default_group_coupon_percent_off.split(".")[0])&&void 0!==e?e:""):o(p())},e=>a&&t.default_group_coupon_percent_off?"Get ".concat(t.default_group_coupon_percent_off.split(".")[0],"% off a group ").concat(e.subscription):"Get a group ".concat(e.subscription))};return n&&n((0,s.o4)(e,e.schema.nodes.button.create(u))),!0}},x=e=>(t,n)=>{let{iTemplate:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let a={url:"".concat(r.W.CHECKOUT_URL,"&gift=true"),text:(0,i.getSubscriptionSentenceWithCustomWords)(e,()=>o(m()),e=>"Give a gift ".concat(e.subscription))};return n&&n((0,s.o4)(t,t.schema.nodes.button.create(a))),!0},I=e=>(t,n)=>{if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let o={url:r.W.CHECKOUT_URL,text:(0,i.getSubscribeText)(e,{now:!0}),language:e.language};return n&&n((0,s.o4)(t,t.schema.nodes.button.create(o))),!0},N=e=>(t,n)=>{let{iTemplate:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!t.schema.nodes.subscribeWidget)return console.error("subscribeWidget node type not found in schema"),!1;if(!t.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let a="enabled"!==e.payments_state?o(b(),e.author_name===e.name?"Thanks for reading":"Thanks for reading ".concat(e.name)):o(g(),e.author_name===e.name?"This Substack is reader-supported":"".concat(e.name," is a reader-supported publication")),u={url:r.W.CHECKOUT_URL,text:(0,i.getSubscribeText)(e),language:e.language},c=t.schema.nodes.subscribeWidget.create(u,[t.schema.nodes.ctaCaption.create(null,[t.schema.text(a)])]);return n&&n((0,s.o4)(t,c)),!0},U=e=>(t,n)=>{let{iString:o,iTemplate:a}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!t.schema.nodes.captionedShareButton)return console.error("captionedShareButton node type not found in schema"),!1;if(!t.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let u=a(v(),e.author_name===e.name?"Thanks for reading":"Thanks for reading ".concat(e.name)),c={url:r.W.SHARE_URL,text:o("Share")},i=t.schema.nodes.captionedShareButton.create(c,t.schema.nodes.ctaCaption.create(null,[t.schema.text(u)]));return n&&n((0,s.o4)(t,i)),!0}},57208:function(e,t,n){n.d(t,{f2:()=>a});var o=n(68303);let r=e=>!(0,o.DY)(e.doc.toJSON(),e=>"paywall"===e.type),a=e=>(t,n)=>{if(!r(t))return!1;let{schema:o,tr:a}=t,c=o.nodes.paywall.create();return 1===a.selection.anchor?u(e)(t,n):(a.insert(a.selection.anchor,c),n&&(n(a),e()),!0)},u=e=>(t,n)=>{if(!r(t))return!1;let{schema:o,tr:a}=t,u=o.nodes.paywall.create(),c=0,i=0;for(;c<10&&i<3;){let e=t.doc.resolve(c).nodeAfter;if(!e)break;c+=e.nodeSize,i++}return a.insert(c,u),n&&(n(a),e()),!0}}}]);