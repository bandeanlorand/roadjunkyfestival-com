"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["9578"],{1148:function(t,e,i){i.d(e,{H:()=>n,O:()=>a});var r=i(16584);let n=t=>(0,r.tZ)("div",{className:"file-embed-wrapper-editor",children:(0,r.tZ)("div",{className:"file-embed-aligner",children:(0,r.tZ)("div",{className:"file-embed-container placeholder",children:(0,r.tZ)(a,{})})})}),a=()=>(0,r.BX)("div",{className:"embed-loader-container",children:[(0,r.tZ)("div",{className:"embed-loader"}),(0,r.tZ)("div",{className:"embed-loader-text",children:"Loading..."})]})},19908:function(t,e,i){if(i.d(e,{M:()=>u,T:()=>c}),/^(1612|4716|5288)$/.test(i.j))var r=i(21834);if(/^(1612|4716|5288)$/.test(i.j))var n=i(141);if(/^(1612|4716|5288)$/.test(i.j))var a=i(88204);if(/^(1612|4716|5288)$/.test(i.j))var l=i(18923);var o=i(83857);let s="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),d=(t,e)=>{let{$anchor:i}=t.selection,{parent:r}=i;if(!r||!["preformatted_text_block","code_block","codeBlock","latex_block"].includes(r.type.name))return!1;if(!r.textContent.length&&e){let{tr:i}=t;return e(i.delete(i.selection.from-1,i.selection.to+1)),!0}return!1};function c(t){let e;let i={};function o(t,e){let r=i[t];r?i[t]=function(t,i){return r(t,i)||e(t,i)}:i[t]=e}if(o("Mod-z",n.Yw),o("Shift-Mod-z",n.KX),o("Backspace",a.dU),o("Backspace",d),s||o("Mod-y",n.KX),o("Alt-ArrowUp",r.MI),o("Alt-ArrowDown",r.Ig),o("Mod-BracketLeft",r.xb),o("Mod-k",u(t)),(e=t.marks.strong||t.marks.bold)&&(o("Mod-b",(0,r.w9)(e)),o("Mod-B",(0,r.w9)(e))),(e=t.marks.em||t.marks.italic)&&(o("Mod-i",(0,r.w9)(e)),o("Mod-I",(0,r.w9)(e))),(e=t.marks.strikethrough||t.marks.strike)&&(o("Shift-Mod-x",(0,r.w9)(e)),o("Shift-Mod-X",(0,r.w9)(e))),(e=t.marks.code)&&o("Mod-`",(0,r.w9)(e)),(e=t.nodes.blockquote)&&o("Ctrl->",(0,r.ym)(e)),(e=t.marks.superscript)&&o("Mod-.",(0,r.w9)(e)),(e=t.marks.subscript)&&o("Mod->",(0,r.w9)(e)),e=t.nodes.hard_break||t.nodes.hardBreak){let t=e,i=(0,r.QF)(r.uo,(e,i)=>(i&&i(e.tr.replaceSelectionWith(t.create()).scrollIntoView()),!0));o("Mod-Enter",i),o("Shift-Enter",i),s&&o("Ctrl-Enter",i)}if((e=t.nodes.list_item||t.nodes.listItem)&&(o("Enter",(0,l.s6)(e)),o("Shift-Tab",(0,r.QF)((0,l.IB)(e),()=>!0)),o("Tab",(0,r.QF)((0,l.bw)(e),()=>!0))),e=t.nodes.heading)for(let t=1;t<=6;t++)o("Shift-Ctrl-".concat(t),(0,r.uJ)(e,{level:t}));return i}let u=t=>(e,i,r)=>{if(i){var n,a,l;(0,o.d)(t.marks.link,{scrollParent:".editor-scroll",language:"undefined"!=typeof window?null===(l=window)||void 0===l?void 0:null===(a=l._preloads)||void 0===a?void 0:null===(n=a.publication)||void 0===n?void 0:n.language:null}).spec.run(e,i,r)}return!0}},22747:function(t,e,i){i.d(e,{j_:()=>tQ,oj:()=>tU});var r=i(7409),n=i(99282),a=i(98848);if(/^(1612|4716|5288)$/.test(i.j))var l=i(58865);var o=i(16584),s=i(98661),d=i(30396),c=i(94184),u=i.n(c);if(/^(1612|4716|5288)$/.test(i.j))var g=i(52113);if(/^(1612|4716|5288)$/.test(i.j))var h=i(36307);if(/^(1612|4716|5288)$/.test(i.j))var f=i(53074);if(/^(1612|4716|5288)$/.test(i.j))var m=i(92973);if(/^(1612|4716|5288)$/.test(i.j))var p=i(93180);if(/^(1612|4716|5288)$/.test(i.j))var b=i(62577);if(/^(1612|4716|5288)$/.test(i.j))var v=i(8693);if(/^(1612|4716|5288)$/.test(i.j))var k=i(25380);if(/^(1612|4716|5288)$/.test(i.j))var Z=i(69548);if(/^(1612|4716|5288)$/.test(i.j))var y=i(50630);if(/^(1612|4716|5288)$/.test(i.j))var w=i(5463);if(/^(1612|4716|5288)$/.test(i.j))var C=i(49488);if(/^(1612|4716|5288)$/.test(i.j))var _=i(98056);if(/^(1612|4716|5288)$/.test(i.j))var A=i(59591);if(/^(1612|4716|5288)$/.test(i.j))var N=i(45510);if(/^(1612|4716|5288)$/.test(i.j))var S=i(23709);if(/^(1612|4716|5288)$/.test(i.j))var I=i(1685);if(/^(1612|4716|5288)$/.test(i.j))var O=i(67659);if(/^(1612|4716|5288)$/.test(i.j))var z=i(52990);if(/^(1612|4716|5288)$/.test(i.j))var B=i(65445);if(/^(1612|4716|5288)$/.test(i.j))var x=i(19237);if(/^(1612|4716|5288)$/.test(i.j))var M=i(84423);if(/^(1612|4716|5288)$/.test(i.j))var j=i(24840);if(/^(1612|4716|5288)$/.test(i.j))var P=i(51110);if(/^(1612|4716|5288)$/.test(i.j))var E=i(74846);if(/^(1612|4716|5288)$/.test(i.j))var $=i(38464);if(/^(1612|4716|5288)$/.test(i.j))var L=i(59253);if(/^(1612|4716|5288)$/.test(i.j))var D=i(68843);if(/^(1612|4716|5288)$/.test(i.j))var T=i(72519);if(/^(1612|4716|5288)$/.test(i.j))var X=i(85158);if(/^(1612|4716|5288)$/.test(i.j))var F=i(74386);if(/^(1612|4716|5288)$/.test(i.j))var W=i(74032);if(/^(1612|4716|5288)$/.test(i.j))var R=i(79692);if(/^(1612|4716|5288)$/.test(i.j))var H=i(77600);if(/^(1612|4716|5288)$/.test(i.j))var q=i(99869);if(/^(1612|4716|5288)$/.test(i.j))var J=i(28549);if(/^(1612|4716|5288)$/.test(i.j))var G=i(96592);if(/^(1612|4716|5288)$/.test(i.j))var U=i(14987);var Y=i(80569),K=i.n(Y),V=i(8131),Q=i(86374),tt=i(74679),te=i(81924),ti=i(347),tr=i(95441),tn=i(14952),ta=i(56629),tl=i(60807),to=i(78592),ts=i(39769),td=i(60310),tc=i(20479),tu=i(44369),tg=i(66586),th=i(67560),tf=i(68833),tm=i(49762),tp=i(7882),tb=i(98914),tv=i(15771),tk=i(61254),tZ=i(19081),ty=i(44424),tw=i(73943),tC=i(6070),t_=i(84864);function tA(){let t=(0,l._)(["Heading ",""]);return tA=function(){return t},t}function tN(){let t=(0,l._)(["Give a gift subscription"]);return tN=function(){return t},t}function tS(){let t=(0,l._)(["Get a group subscription"]);return tS=function(){return t},t}function tI(){let t=(0,l._)(["Undo ","Z"]);return tI=function(){return t},t}function tO(){let t=(0,l._)(["Redo ","⇧Z"]);return tO=function(){return t},t}function tz(){let t=(0,l._)(["Bold ","B"]);return tz=function(){return t},t}function tB(){let t=(0,l._)(["Italic ","I"]);return tB=function(){return t},t}function tx(){let t=(0,l._)(["Strikethrough ","⇧X"]);return tx=function(){return t},t}function tM(){let t=(0,l._)(["Link ","K"]);return tM=function(){return t},t}let tj=(t,e,i)=>{(0,tf.j)(tf.FP.EDITOR_MENU_ICON_CLICKED,{button:i}),e(t)};function tP(t,e){return(0,d.I4)(i=>{t&&(e?tj(i,t,e):t(i))},[t,e])}let tE=(0,s.forwardRef)((t,e)=>{var{trackedName:i,testId:l,priority:s="tertiary",onClick:d}=t,c=(0,a._)(t,["trackedName","testId","priority","onClick"]);let u=tP(d,i);return(0,o.tZ)(tv.hU,(0,n._)((0,r._)({},c),{size:"sm","data-testId":l,onClick:u,ref:e,priority:s}))}),t$=(0,s.forwardRef)((t,e)=>{var{trackedName:i,testId:l,priority:s="tertiary",onClick:d}=t,c=(0,a._)(t,["trackedName","testId","priority","onClick"]);let u=tP(d,i);return(0,o.tZ)(tv.zx,(0,n._)((0,r._)({},c),{size:"sm","data-testId":l,onClick:u,ref:e,priority:s}))}),tL=(0,s.forwardRef)((t,e)=>{var{trackedName:i,testId:l,onClick:s}=t,d=(0,a._)(t,["trackedName","testId","onClick"]);let c=tP(s,i);return(0,o.tZ)(ty.sN,(0,n._)((0,r._)({},d),{"data-testId":l,onClick:c,ref:e}))}),tD=()=>(0,o.tZ)(tZ.tu,{height:32,paddingY:4,sizing:"border-box",children:(0,o.tZ)(tk.xt,{})}),tT=t=>{let{level:e}=t;switch(e){case 1:return(0,o.tZ)(g.Z,{size:20});case 2:return(0,o.tZ)(h.Z,{size:20});case 3:return(0,o.tZ)(f.Z,{size:20});case 4:return(0,o.tZ)(m.Z,{size:20});case 5:return(0,o.tZ)(p.Z,{size:20});case 6:return(0,o.tZ)(b.Z,{size:20});default:return(0,o.tZ)(v.Z,{size:20})}},tX=t=>{let{editor:e}=t,{iString:i,iTemplate:r}=(0,tr.M1)();return(0,o.BX)(o.HY,{children:[(0,o.tZ)(tL,{onClick:()=>null==e?void 0:e.chain().focus().setParagraph().run(),trailing:(null==e?void 0:e.isActive("paragraph"))&&(0,o.tZ)(k.Z,{}),leading:(0,o.tZ)(Z.Z,{}),trackedName:"paragraph",children:i("Normal text")}),[1,2,3,4,5,6].map(t=>(0,o.tZ)(tL,{onClick:()=>null==e?void 0:e.chain().focus().toggleHeading({level:t}).run(),trailing:(null==e?void 0:e.isActive("heading",{level:t}))&&(0,o.tZ)(k.Z,{}),leading:(0,o.tZ)(tT,{level:t}),children:r(tA(),t)}))]})},tF=t=>{let{editor:e}=t,{iString:i}=(0,tr.M1)();return(0,o.tZ)(ty.v2,{trigger:(0,o.tZ)(t$,{trailing:(0,o.tZ)(Q.Z,{}),testId:"style-picker",children:i("Style")}),layerOptions:{triggerOffset:4,placement:"bottom-start"},children:(0,o.tZ)(tX,{editor:e})})},tW=t=>{var e;let{editor:i,publication:r,postId:n,get_coupons:a,insert_coupon:l,hideSharePostAndComment:s=!1,writerReferralCode:d,customSpecialOfferCommand:c=null,customCustomButtonCommand:u=null,user:g,setIsSurveyModalOpen:h}=t,{userSettings:f}=(0,tl.SE)(),{result:m}=(0,tp.ib)({pathname:"/api/v1/meetings/config",initialResult:{meetings:{enabled:!1}},auto:(0,tm.default)("meetings_v1")&&(null==r?void 0:r.payments_state)==="enabled",deps:[]}),p=f.messageRequestLevel||"nobody",{iString:b,iTemplate:v,language:k}=(0,tr.M1)(),Z=(0,t_.isPaidPub)(r),{getSettingFor:y}=(0,ta.So)();return(0,o.BX)(o.HY,{children:[(0,o.tZ)(tL,{onClick:()=>{i.chain().focus().insertSubscribeButton(r).run()},trackedName:"button_subscribe",testId:"insert-subscribe-button",children:(0,t_.getSubscribeText)(r,{now:!1,language:k})}),(0,o.tZ)(tL,{onClick:()=>i.chain().focus().insertSubscribeButtonWithPreamble(r).run(),trackedName:"button_subscribe_with_preamble",children:b("Subscribe with caption")}),!s&&(0,o.BX)(ty.xw,{children:[(0,o.tZ)(tL,{onClick:()=>i.chain().focus().insertSharePostButton(r).run(),trackedName:"button_share_post",children:b("Share post")}),(0,o.tZ)(tL,{onClick:()=>i.chain().focus().insertCaptionedShareButton(r).run(),trackedName:"button_share_with_preamble",children:b("Share post with caption")}),(0,o.tZ)(tL,{onClick:()=>i.chain().focus().insertSharePubButton(r).run(),trackedName:"button_share_publication",children:b("Share publication")})]}),(0,o.BX)(ty.xw,{children:[!s&&(0,o.tZ)(tL,{onClick:()=>i.chain().focus().insertCommentsButton(r).run(),trackedName:"button_insert_comment",children:b("Leave a comment")}),"nobody"!==p&&g&&(0,o.tZ)(tL,{onClick:()=>{i.chain().focus().insertDirectMessage({user:g}).run()},trackedName:"button_dm_author",children:b("Send a message")}),!!(null==r?void 0:r.threads_v2_enabled)&&(0,o.tZ)(tL,{testId:"visit-thread-btn",onClick:()=>i.chain().focus().insertVisitThreadButton(r).run(),trackedName:"button_visit_thread",children:b("Join the chat")}),(0,o.tZ)(tL,{testId:"get-app-btn",onClick:()=>i.chain().focus().insertInstallSubstackAppEmbed(r).run(),trackedName:"install_substack_app",children:b("Get the app")})]}),(0,o.BX)(ty.xw,{children:[(0,o.tZ)(tL,{onClick:u||(()=>i.chain().focus().insertCustomButton({scrollParent:"editor",parentClass:"more-dropdown",TextField:tu.nv,openPrompt:tu.cS,publication:r}).run()),trackedName:"button_custom",children:b("Custom...")}),(0,o.BX)(ty.LY,{content:b("More..."),children:[y("reader_referrals_enabled")&&(0,o.tZ)(tL,{onClick:()=>i.chain().focus().insertReferralButton(r).run(),trackedName:"button_referral",children:b("Refer a friend")}),d&&(0,o.tZ)(tL,{onClick:()=>i.chain().focus().insertCaptionedWriterReferralButton({writerReferralCode:d,publication:r,postId:n}).run(),trackedName:"button_writer_referral",children:b("Refer a writer")}),Z&&(0,o.BX)(o.HY,{children:[(0,o.tZ)(tL,{onClick:c||(()=>i.chain().focus().insertSpecialOfferButton({couponPub:r,scrollParent:"editor",parentClass:"more-dropdown",get_coupons:a,insert_coupon:l,SelectField:tu.mg,openPrompt:tu.cS,closePrompt:tu.pA,getNetworkErrorMessage:tb.zx}).run()),trackedName:"button_special_offer",children:b("Special offer")}),(0,o.tZ)(tL,{onClick:()=>i.chain().focus().insertGiftButton(r).run(),trackedName:"button_gift",children:(0,t_.getSubscriptionSentenceWithCustomWords)(r,()=>v(tN()),t=>"Give a gift ".concat(t.subscription))}),(0,o.tZ)(tL,{onClick:()=>{i.chain().focus().insertGroupSubscriptionButton({publication:r}).run()},trackedName:"button_group_subscription",children:(0,t_.getSubscriptionSentenceWithCustomWords)(r,()=>v(tS()),t=>"Get a group ".concat(t.subscription))})]}),(0,o.tZ)(tL,{testId:"survey-prompt-btn",onClick:()=>h(!0),trackedName:"survey_button",children:b("Link to survey")}),(0,tm.default)("meetings_v1")&&(null==r?void 0:r.payments_state)==="enabled"&&(null==m?void 0:null===(e=m.meetings)||void 0===e?void 0:e.enabled)&&(0,o.tZ)(tL,{onClick:()=>{var t;return i.chain().focus().insertMeeting({publication:r,meetingsConfig:null==m?void 0:m.meetings,usePublicationName:null!==(t=(0,tm.default)("meetings_embed_publication_name"))&&void 0!==t&&t}).run()},trackedName:"button_book_meeting",children:b("Book a meeting")})]})]})]})},tR=t=>{let{editor:e,setPostPaidForPaywall:i,setPostId:r,isAdhocEmail:n,customInsertRuleCommand:a,canAddPaywall:l=!0,setFinancialChartModalOpen:s,setSponsorshipCampaignModalOpen:d}=t,{iString:c}=(0,tr.M1)(),u=(0,tm.default)("recipes_enabled"),g=(0,tm.default)("enable_sponsorship_campaigns");return(0,o.BX)(o.HY,{children:[(0,o.tZ)(tL,{disabled:!(null==e?void 0:e.can().toggleCodeBlock()),onClick:()=>{e.chain().focus().toggleCodeBlock().run()},leading:(0,o.tZ)(y.Z,{}),trackedName:"code_block",children:c("Code block")}),(0,o.tZ)(tL,{onClick:a||(()=>e.chain().focus().setHorizontalRule().run()),leading:(0,o.tZ)(w.Z,{}),trackedName:"horizontal_rule",children:c("Divider")}),(0,o.tZ)(tL,{onClick:()=>{s(!0)},leading:(0,o.tZ)(C.Z,{}),trackedName:"financial_chart",children:c("Financial chart")}),(0,o.tZ)(tL,{disabled:!(null==e?void 0:e.can().insertFootnote()),onClick:()=>{e.chain().focus().insertFootnote().run()},leading:(0,o.tZ)(_.Z,{}),trackedName:"footnote",children:c("Footnote")}),(0,o.tZ)(tL,{disabled:!(null==e?void 0:e.can().insertLatex({expression:""})),onClick:()=>e.chain().focus().insertLatex({expression:""}).run(),leading:(0,o.tZ)(A.Z,{}),trackedName:"latex_block",children:c("LaTeX")}),u&&(0,o.tZ)(tL,{disabled:!1,onClick:async()=>{let t=await r();if(!t)return;let i=await K().post("/api/v1/recipe").send({post_id:t});e.chain().focus().insertRecipe({id:i.body.id}).run()},leading:(0,o.tZ)(N.Z,{}),trackedName:"recipe",testId:"add-recipe-button",children:c("Recipe")}),l&&!n&&(0,o.tZ)(tL,{disabled:!(null==e?void 0:e.can().addPaywall(i)),onClick:()=>e.chain().focus().addPaywall(i).run(),leading:(0,o.tZ)(S.Z,{}),testId:"add-paywall-button",trackedName:"paywall",children:c("Paywall")}),(0,o.tZ)(tL,{disabled:!(null==e?void 0:e.can().toggleNode("preformatted_text_block","paragraph")),onClick:()=>e.chain().focus().toggleNode("preformatted_text_block","paragraph").run(),leading:(0,o.tZ)(I.Z,{}),trackedName:"preformatted_text_block",children:c("Poetry")}),(0,o.tZ)(tL,{onClick:async()=>{let t=await r();if(!t)return;let i=await K().post("/api/v1/poll").send({post_id:t});e.chain().focus().insertPoll({id:i.body.id}).run()},leading:(0,o.tZ)(O.Z,{}),trackedName:"poll",children:c("Poll")}),g&&(0,o.tZ)(tL,{onClick:async()=>{await r()&&d(!0)},leading:(0,o.tZ)(z.Z,{}),trackedName:"sponsorship_campaign",children:c("Sponsorship campaign")})]})},tH=t=>{let{editor:e,publication:i,get_coupons:r,insert_coupon:n,hideSharePostAndComment:a=!1,writerReferralCode:l,postId:s,customSpecialOfferCommand:d=null,customCustomButtonCommand:c=null,user:u,setIsSurveyModalOpen:g}=t,{iString:h}=(0,tr.M1)();return(0,o.tZ)(ty.v2,{trigger:(0,o.tZ)(t$,{trailing:(0,o.tZ)(Q.Z,{}),testId:"button-picker",children:h("Button")}),layerOptions:{triggerOffset:4,placement:"bottom-start"},children:(0,o.tZ)(tW,{user:u,editor:e,publication:i,get_coupons:r,insert_coupon:n,hideSharePostAndComment:a,writerReferralCode:l,postId:s,setIsSurveyModalOpen:g,customSpecialOfferCommand:d,customCustomButtonCommand:c})})},tq=t=>{let{editor:e,setPostPaidForPaywall:i,setPostId:r,isAdhocEmail:n,customInsertRuleCommand:a,canAddPaywall:l=!0,setFinancialChartModalOpen:s}=t,{iString:c}=(0,tr.M1)(),[u,g]=(0,d.eJ)(!1);return(0,o.BX)(o.HY,{children:[(0,o.tZ)(ty.v2,{trigger:(0,o.tZ)(t$,{trailing:(0,o.tZ)(Q.Z,{}),testId:"more-submenu",className:"more-dropdown",children:c("More")}),layerOptions:{triggerOffset:4,placement:"bottom-start"},children:(0,o.tZ)(tR,{isAdhocEmail:n,editor:e,setPostPaidForPaywall:i,setPostId:r,customInsertRuleCommand:a,canAddPaywall:l,setFinancialChartModalOpen:s,setSponsorshipCampaignModalOpen:g})}),(0,o.tZ)(tc.x,{isOpen:u,setOpen:g,onInsert:t=>{e.chain().focus().insertSponsorshipCampaign({id:t.id}).run()}})]})},tJ=t=>{let{editor:e,insertImageFile:i,publication:r,postId:n}=t,[a,l]=(0,d.eJ)(!1),[s,c]=(0,d.eJ)(!1),[u,g]=(0,d.eJ)(!1),[h,f]=(0,d.eJ)(!1),{iString:m}=(0,tr.M1)(),p=t=>{t.preventDefault(),f(!0),c(!0)};return(0,d.d4)(()=>(document.addEventListener("editSelectedImageGallery",p),()=>{document.removeEventListener("editSelectedImageGallery",p)}),[]),(0,o.BX)(o.HY,{children:[(0,o.BX)(ty.v2,{trigger:(0,o.tZ)(tE,{title:"Insert image",children:(0,o.tZ)(B.Z,{size:20})}),layerOptions:{triggerOffset:4,placement:"bottom-start"},children:[(0,o.tZ)(tL,{onClick:()=>e.chain().focus().insertImage(i).run(),leading:(0,o.tZ)(x.Z,{}),trackedName:"image_upload",children:m("Add image")}),(0,o.tZ)(tL,{onClick:()=>c(!0),leading:(0,o.tZ)(M.Z,{}),trackedName:"image_gallery",children:m("Add gallery")}),(0,o.tZ)(tL,{onClick:()=>{l(!0)},leading:(0,o.tZ)(j.Z,{}),testId:"image-unsplash",trackedName:"image_unsplash",children:m("Add stock photo")}),(0,tm.default)("ai_image_generation_enabled")&&(0,o.tZ)(tL,{onClick:()=>{g(!0)},leading:(0,o.tZ)(P.Z,{}),trackedName:"image_generate",children:m("Generate")})]}),(0,o.tZ)(td.Z,{open:a,onAfterClose:()=>{l(!1)},onSelectStockImage:t=>{e.chain().focus().insertUnsplashImage(t).run()}}),(0,o.tZ)(ts.F,{pub:r,postId:n,editor:e,editingCurrentSelection:h,isOpen:s,onInsertGallery:t=>{e.chain().focus().insertImageGallery({gallery:t}).run()},onUpdateGallery:t=>{e.chain().focus().updateImageGallery({gallery:t}).run()},onClose:()=>{f(!1),c(!1)}}),(0,o.tZ)(V.Z,{open:u,onAfterClose:()=>g(!1),onImageSelected:null,insertionPointSelector:".editor",onUrlSelected:async t=>{let{url:i,prompt:r}=t,a=await K().post("/api/v1/image").send({image:i,postId:null!=n?n:void 0});e.chain().focus().insertImageFromUrl({url:a.body.url,caption:r||"",width:tw._s,height:tw.WX}).run(),g(!1)}})]})},tG=t=>{let{editor:e}=t,{iString:i}=(0,tr.M1)(),r=(0,tn.Ij)(),n=(0,tC.HD)({pub:r});return(0,o.BX)(ty.v2,{trigger:(0,o.tZ)(tE,{title:"Insert quote",disabled:!(null==e?void 0:e.can().togglePullquote())&&!(null==e?void 0:e.can().toggleBlockquote())&&(!n||!(null==e?void 0:e.can().toggleCalloutBlock())),children:(0,o.tZ)(E.Z,{size:20})}),layerOptions:{triggerOffset:4,placement:"bottom-start"},children:[(0,o.tZ)(tL,{disabled:!(null==e?void 0:e.can().toggleBlockquote()),onClick:()=>null==e?void 0:e.chain().focus().toggleBlockquote().run(),trailing:(null==e?void 0:e.isActive("blockquote"))&&(0,o.tZ)(k.Z,{}),trackedName:"blockquote",children:i("Block quote")}),(0,o.tZ)(tL,{disabled:!(null==e?void 0:e.can().togglePullquote()),onClick:()=>{null==e||e.chain().focus().togglePullquote().run()},trailing:(null==e?void 0:e.isActive("pullquote"))&&(0,o.tZ)(k.Z,{}),trackedName:"pullquote",children:i("Pull quote")}),n&&(0,o.tZ)(tL,{disabled:!(null==e?void 0:e.can().toggleCalloutBlock()),onClick:()=>null==e?void 0:e.chain().focus().toggleCalloutBlock().run(),trailing:(null==e?void 0:e.isActive("calloutBlock"))&&(0,o.tZ)(k.Z,{}),trackedName:"calloutBlock",children:i("Callout block")})]})},tU=()=>{if(window)return window.LatexModalEvent||(window.LatexModalEvent=new EventTarget),window.LatexModalEvent},tY=t=>{var e;let{isOpen:i,setIsOpen:a}=t,[l,s]=(0,d.eJ)(null);return(0,d.d4)(()=>{let t=t=>{let{detail:e}=t;s(e.node),a(!0)};return tU().addEventListener("open",t),()=>{tU().removeEventListener("open",t)}},[i,l]),(0,d.d4)(()=>{let t=t=>{let{detail:e}=t;e.node.attrs=(0,n._)((0,r._)({},e.node.attrs),{persistentExpression:e.persistentExpression}),e.node.attrs.dirty=!0,s(e.node)};return tU().addEventListener("close",t),()=>{tU().removeEventListener("close",t)}},[i,l]),(0,o.tZ)(te.i,{isOpen:i,onClose:()=>{a(!1)},node:l,persistentExpression:(null==l?void 0:null===(e=l.attrs)||void 0===e?void 0:e.persistentExpression)||""})},tK=t=>{let{editor:e,publication:i,postId:r,setPostId:n,voiceoverEnabled:a,audioEmbedsEnabled:l,showingDrawerName:s,setShowDrawer:d}=t,{iString:c}=(0,tr.M1)();return(0,o.BX)(o.HY,{children:[(0,o.BX)(ty.v2,{trigger:(0,o.tZ)(tE,{title:"Insert audio",children:(0,o.tZ)($.Z,{size:20})}),layerOptions:{triggerOffset:4,placement:"bottom-start"},children:[a&&(0,o.tZ)(tL,{onClick:()=>{d("voiceover")},trackedName:"voiceover",leading:(0,o.tZ)(L.Z,{}),children:c("Voiceover")}),l&&(0,o.tZ)(tL,{trackedName:"audio_embed",onClick:()=>{d("audioEmbed")},leading:(0,o.tZ)(D.Z,{}),children:c("Audio embed")})]}),(0,o.tZ)(tg.k,{id:"audioEmbed",open:"audioEmbed"===s,pub:i,postId:r,onClose:()=>d(null),onSave:t=>{let{mediaUploadId:i,duration:r}=t;e.chain().focus().insertAudio({mediaUploadId:i,duration:r}).run()},setPostId:n})]})},tV=t=>{let{editor:e,publication:i,postId:r,isAdhocEmail:n,insertImageFile:a,get_coupons:l,insert_coupon:s,setPostPaidForPaywall:c,voiceoverEnabled:g,audioEmbedsEnabled:h,setPostId:f,hideSharePostAndComment:m=!1,showingDrawerName:p,setShowDrawer:b,writerReferralCode:v,canAddPaywall:k,user:Z}=t,{iString:y,iTemplate:w}=(0,tr.M1)(),[C,_]=(0,d.eJ)(!1),[A,N]=(0,d.eJ)(!1),[S,I]=(0,d.eJ)(!1);if(!e)return;let O=(0,tb.Mi)(),z=(null==e?void 0:e.isActive("orderedList"))||(null==e?void 0:e.isActive("bulletList"));return(0,o.BX)(ti.h,{children:[(0,o.tZ)(tZ.hs,{paddingX:16,justifyContent:"center",bg:"primary",className:u()("tiptap-menu"),children:(0,o.BX)(tZ.hs,{wrap:"wrap",gap:12,paddingY:8,alignItems:"center",children:[(0,o.BX)(tZ.hs,{gap:4,children:[(0,o.tZ)(tE,{onClick:()=>e.chain().focus().undo().run(),disabled:!e.can().undo(),title:w(tI(),O),trackedName:"undo",children:(0,o.tZ)(T.Z,{size:20})}),(0,o.tZ)(tE,{onClick:()=>e.chain().focus().redo().run(),disabled:!e.can().redo(),title:w(tO(),O),trackedName:"redo",children:(0,o.tZ)(X.Z,{size:20})})]}),(0,o.tZ)(tD,{}),(0,o.tZ)(tZ.hs,{gap:4,children:(0,o.tZ)(tF,{editor:e})}),(0,o.tZ)(tD,{}),(0,o.BX)(tZ.hs,{gap:4,children:[(0,o.tZ)(tE,{priority:e.isActive("bold")?"secondary":"tertiary",onClick:()=>e.chain().focus().toggleBold().run(),disabled:!e.can().toggleBold(),title:w(tz(),O),trackedName:"toggle_bold",children:(0,o.tZ)(F.Z,{size:20})}),(0,o.tZ)(tE,{priority:e.isActive("italic")?"secondary":"tertiary",onClick:()=>e.chain().focus().toggleItalic().run(),disabled:!e.can().toggleItalic(),title:w(tB(),O),trackedName:"toggle_italic",children:(0,o.tZ)(W.Z,{size:20})}),(0,o.tZ)(tE,{onClick:()=>e.chain().focus().toggleStrike().run(),disabled:!e.can().toggleStrike(),priority:e.isActive("strike")?"secondary":"tertiary",title:w(tx(),O),trackedName:"toggle_strikethrough",children:(0,o.tZ)(R.Z,{size:20})}),(0,o.tZ)(tE,{priority:e.isActive("code")?"secondary":"tertiary",onClick:()=>e.chain().focus().toggleCode().run(),disabled:!e.can().toggleCode(),title:y("Code"),trackedName:"toggle_code_mark",children:(0,o.tZ)(H.Z,{size:20})})]}),(0,o.tZ)(tD,{}),(0,o.BX)(tZ.hs,{gap:4,children:[(0,o.tZ)(tE,{onClick:()=>e.chain().addLink().run(),title:w(tM(),O),trackedName:"link",children:(0,o.tZ)(q.Z,{size:20})}),(0,o.tZ)(tJ,{editor:e,insertImageFile:a,publication:i,postId:r}),!n&&(g||h)&&(0,o.tZ)(tK,{editor:e,publication:i,postId:r,setPostId:f,voiceoverEnabled:g,audioEmbedsEnabled:h,showingDrawerName:p,setShowDrawer:b}),!n&&(0,o.tZ)(tt.p,{editor:e,pub:i,postId:null!=r?r:null,setPostId:f}),(0,o.tZ)(tG,{editor:e})]}),(0,o.tZ)(tD,{}),(0,o.BX)(tZ.hs,{gap:4,children:[(0,o.tZ)(tE,{priority:(null==e?void 0:e.isActive("bulletList"))?"secondary":"tertiary",disabled:!(null==e?void 0:e.can().toggleBulletList()),onClick:()=>e.chain().focus().toggleBulletList().run(),title:y("Bulleted list"),trackedName:"bullet_list",children:(0,o.tZ)(J.Z,{size:20})}),(0,o.tZ)(tE,{priority:(null==e?void 0:e.isActive("orderedList"))?"secondary":"tertiary",disabled:!(null==e?void 0:e.can().toggleOrderedList()),onClick:()=>e.chain().focus().toggleOrderedList().run(),title:y("Numbered list"),trackedName:"ordered_list",children:(0,o.tZ)(G.Z,{size:20})}),z&&(0,o.BX)(o.HY,{children:[(0,o.tZ)(tD,{}),(0,o.tZ)(tE,{disabled:!(null==e?void 0:e.can().sinkListItem("listItem")),onClick:()=>e.chain().focus().sinkListItem("listItem").run(),title:y("Indent"),trackedName:"indent_list",children:(0,o.tZ)(U.Z,{size:20})}),(0,o.tZ)(tE,{disabled:!(null==e?void 0:e.can().liftListItem("listItem")),onClick:()=>e.chain().focus().liftListItem("listItem").run(),title:y("Deindent"),trackedName:"deindent_list",children:(0,o.tZ)(U.Z,{size:20,style:{transform:"scaleX(-1)"}})})]})]}),(0,o.tZ)(tD,{}),(0,o.tZ)(tZ.hs,{gap:4,children:(0,o.tZ)(tH,{user:Z,editor:e,publication:i,get_coupons:l,insert_coupon:s,hideSharePostAndComment:m,writerReferralCode:v,postId:r,setIsSurveyModalOpen:_})}),(0,o.tZ)(tD,{}),(0,o.tZ)(tZ.hs,{gap:4,children:(0,o.tZ)(tq,{isAdhocEmail:n,canAddPaywall:k,editor:e,setPostPaidForPaywall:c,setPostId:f,setFinancialChartModalOpen:N})})]})}),i&&(0,o.tZ)(th.b,{isOpen:C,pub:i,onClose:()=>{_(!1)},onInsert:(t,r)=>{e.chain().focus().insertSurveyButton(i,t,r).run(),_(!1)}}),(0,o.tZ)(to.G,{isOpen:A,onClose:()=>{N(!1)},onInsert:t=>{let{url:i,width:r,height:n}=t;e.chain().focus().insertTradingViewImageFromUrl({url:i,height:n,width:r}).run()}}),(0,o.tZ)(tY,{isOpen:S,setIsOpen:I})]})},tQ=t=>{try{return tV(t)}catch(t){return window.Sentry&&window.Sentry.captureException(t),(0,o.tZ)(o.HY,{})}}},70232:function(t,e,i){i.d(e,{HF:()=>o,n3:()=>a,zF:()=>l});var r=i(98914);let n=/^(1612|4716|5288)$/.test(i.j)?{Enter:13,Backspace:8,Tab:9,Shift:16,Ctrl:17,Alt:18,Pause:19,CapsLock:20,Esc:27,Space:32,PageUp:63276,PageDown:63277,End:63275,Home:63273,Left:63234,Up:63232,Right:63235,Down:63233,PrintScrn:44,Insert:63302,Delete:63272,";":186,"=":187,Mod:93,"*":106,"-":189,".":190,"/":191,",":188,"`":192,"[":219,"\\":220,"]":221,"'":222}:null;function a(t,e){let i=e.split(/-(?!'?$)/),a=-1!==i.indexOf("Mod"),l=-1!==i.indexOf("Cmd"),o=-1!==i.indexOf("Ctrl"),s=-1!==i.indexOf("Shift"),d=-1!==i.indexOf("Alt"),c=i[i.length-1],u=n[c]?n[c]:c.toUpperCase().charCodeAt(0).toString(),g=(0,r.V5)(),h=new CustomEvent("keydown",{bubbles:!0,cancelable:!0});h.key=c.replace(/Space/g," "),h.shiftKey=s,h.altKey=d,h.ctrlKey=o||!g&&a,h.metaKey=l||g&&a,h.keyCode=u,h.which=u,h.view=window,t.dispatchEvent(h)}let l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAY4AAAB0BAMAAABgVMiEAAAAMFBMVEX////7+/vt7e3o6Ojm5ubn5+fu7u709PTs7Oz39/f19fX29vby8vLx8fHz8/Pw8PCxY+A8AAAAoklEQVR4AWJgVHYZ+sBIgEE0vXzog7JAhrZZq4Y+WJnB4A5o5w5oAAYBGAi6mcKpQgIaClhCBklz7+AM/Gjo5+Dg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODgeO7g4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4OD4Zse3dmVXfIST0/B1vh0UtMKbNF7rAAAAAElFTkSuQmCC";function o(t,e){let i=null,r=[],n=[];return function(){for(var a=arguments.length,l=Array(a),o=0;o<a;o++)l[o]=arguments[o];return new Promise((a,o)=>{null!==i&&window.clearTimeout(i),i=window.setTimeout(()=>{t(...l).then(t=>{r.forEach(e=>e(t)),r=[]}).catch(t=>{n.forEach(e=>e(t)),n=[]})},e),r.push(a),n.push(o)})}}},54809:function(t,e,i){i.d(e,{$B:()=>u,ER:()=>a,Lz:()=>s,Nf:()=>f,Xb:()=>c,Z$:()=>o,jP:()=>d,uM:()=>l});var r=i(80983),n=i(84864);let a={"application/x-cbr":[[82,97,114,33,26,7,0],[82,97,114,33,26,7,1,0],[127,69,76,70]],"application/x-cbz":[[80,75,3,4],[80,75,5,6],[80,75,7,8]]},l={"application/vnd.amazon.kfx":[[75,70,88,32]],"application/vnd.amazon.kpf":[[80,75,3,4]],"application/epub+zip":[[80,75,3,4]],"application/x-mobipocket-ebook":[[77,79,66,73]]},o={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[[80,75,3,4],[80,75,5,6],[80,75,7,8]]},s={"application/pdf":[[37,80,68,70]]};function d(){return[...Object.keys(a),...Object.keys(l),...Object.keys(o),...Object.keys(s)]}function c(t){let{mimeTypesToSignature:e,substackType:i,actionButtonAttr:r}=t;return[{tag:"div.file-embed-wrapper",getAttrs:t=>{let a={};try{var l,o,s;let[d,c,u]=t.children[0].children;if(!d)return!1;let[g,h]=d.children;if(!h||!g)return!1;let[f,m]=h.children;if(!m)return!1;a.title=null==f?void 0:f.textContent;let[p,b]=(null===(l=m.textContent)||void 0===l?void 0:l.split("∙"))||[];if(!p||!b)return!1;a.filesize=(0,n.formattedBytesToNumber)(p);let v=null===(s=b.split("File"))||void 0===s?void 0:null===(o=s[0])||void 0===o?void 0:o.trim().toLowerCase();if(!v)return!1;if(e[v]||i===v)a.filetype=v;else{if("file"!==i)return!1;a.filetype=v}return(null==g?void 0:g.classList.contains("file-embed-thumbnail-default"))||(a.thumbnail=g.getAttribute("src")||""),a.description=null==c?void 0:c.innerText,a[r]=null==u?void 0:u.getAttribute("href"),a}catch(t){return!1}}}]}async function u(t){let{file:e}=t,i=await h({file:e});return!function(t){let{file:e,bytes:i}=t,r=e.name.split(".").pop();return r&&["cbr","cbz"].indexOf(r.toLowerCase())>=0&&(e.assignedType="application/x-".concat(r)),g({bytes:i,file:e,mimeTypeToSignature:a})}({file:e,bytes:i})?!function(t){let{file:e,bytes:i}=t,r=e.name.split(".").pop();return r&&["kpf","kfx"].indexOf(r.toLowerCase())>=0&&(e.assignedType="application/vnd.amazon.".concat(r)),g({bytes:i,file:e,mimeTypeToSignature:l})}({file:e,bytes:i})?g({bytes:i,file:e,mimeTypeToSignature:o})?"xlsx":g({bytes:i,file:e,mimeTypeToSignature:s})?"pdf":null:"ebook":"comic"}function g(t){let{bytes:e,mimeTypeToSignature:i,file:r}=t,n=i[r.assignedType||r.type];return!!n&&n.some(t=>t.every((t,i)=>t===e[i]))}async function h(t){let{file:e}=t;return new Uint8Array(await e.arrayBuffer())}function f(t){var e;let{attrs:i}=t;return"".concat((0,n.numberToHumanFileSize)(null!==(e=Number(i.filesize))&&void 0!==e?e:void 0)," ∙ ").concat(function(t){var e,i,n,a;let{filetype:l}=t;return l?["application/vnd.amazon.kfx","application/vnd.amazon.kpf","application/vnd.amazon.ebook"].includes(l)?"Kindle":null!==(a=null===(i=r.extension(l)||(null===(n=l.split("/").pop())||void 0===n?void 0:n.split("-").pop()))||void 0===i?void 0:null===(e=i.toUpperCase)||void 0===e?void 0:e.call(i))&&void 0!==a?a:"":""}({filetype:i.filetype})," file")}},57639:function(t,e,i){i.d(e,{$y:()=>f,MQ:()=>Z,N9:()=>v,Nh:()=>p,RK:()=>m,kC:()=>b});var r=i(7409),n=i(94184),a=i.n(n),l=i(98661),o=i(26445),s=i(98914),d=i(60308),c=i(63651),u=i(19520),g=i(30548);let h=t=>t.attrs.fullscreen?"full":t.attrs.imageSize||"normal",f={attrs:{src:{default:""},srcNoWatermark:{default:null},fullscreen:{default:null},imageSize:{default:null},height:{default:null},width:{default:null},resizeWidth:{default:null},bytes:{default:null},alt:{default:null},title:{default:null},type:{default:null},href:{default:null},belowTheFold:{default:!1},topImage:{default:!1},internalRedirect:{default:null},isProcessing:{default:!1},align:{default:null},offset:{default:!1}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"p",priority:100,getAttrs:t=>{if(t.textContent.trim())return!1;let[e]=t.getElementsByTagName("img");return!!e&&p(e)}},{tag:"img[src]",getAttrs:t=>!(t.getAttribute("height")&&1>=Number(t.getAttribute("height"))||t.getAttribute("width")&&1>=Number(t.getAttribute("width")))&&p(t)}],toDOM:t=>{let{ImageActions:e}=i(55918);try{let i,r,n;let s=b(t),u=h(t),g=d.s2v.map(e=>({width:e,imageSrc:b(t,{maxWidth:e})})),f=d.s2v.map(e=>({width:e,imageSrc:b(t,{maxWidth:e,imageProps:{format:"webp"}})})),{isProcessing:m}=t.attrs;t.attrs.height&&t.attrs.width&&(i=t.attrs.height,r=t.attrs.width,t.attrs.resizeWidth?(i=t.attrs.resizeWidth*i/r,r=t.attrs.resizeWidth):w(t.attrs)&&r<d.kPM&&(i*=d.kPM/r,r=d.kPM),"full"===u&&(r=Math.min(r,d.qN9)));let p=t.attrs.width/t.attrs.height,v=t.attrs.resizeWidth?t.attrs.resizeWidth/p:t.attrs.height,k=t.attrs.resizeWidth?t.attrs.resizeWidth/v:p,Z=!(t.attrs.href&&t.attrs.href!=t.attrs.src);Z=(Z=Z&&t.attrs.height>240&&v>240)&&p<4&&k<4;let y="undefined"==typeof window;n=t.attrs.href?(0,c.chL)(t.attrs.href)?(0,d.zF4)(t.attrs.href):t.attrs.href:(0,d.zF4)(t.attrs.src);let C=document.createElement("div");if(Z&&y){C.className="image-link-expand";try{C.innerHTML=(0,o.Dq)((0,l.createElement)(e,{size:20}))}catch(t){console.error("Error rendering ImageActions",t)}}return["a",{class:a()("image-link image2","left"===t.attrs.align&&"image2-align-left","right"===t.attrs.align&&"image2-align-right",t.attrs.offset&&"left"===t.attrs.align&&"image2-offset-left",t.attrs.offset&&"right"===t.attrs.align&&"image2-offset-right",Z&&"is-viewable-img",m&&"processing"),target:"_blank",href:n,"data-component-name":"Image2ToDOM"},["div",{class:"image2-inset".concat("full"===u?" image2-full-screen":"")},["picture",{},["source",{type:"image/webp",srcset:f.map(t=>"".concat(t.imageSrc," ").concat(t.width,"w")).join(", "),sizes:"100vw"}],["img",{src:s,width:"full"===u?void 0:r,height:"full"===u?void 0:i,"data-attrs":JSON.stringify(t.attrs),class:"full"===u?"sizing-fullscreen":"large"===u?"sizing-large":"sizing-normal",alt:t.attrs.alt||"",title:t.attrs.title||t.attrs.alt,srcset:g.map(t=>"".concat(t.imageSrc," ").concat(t.width,"w")).join(", "),sizes:"100vw",loading:t.attrs.belowTheFold?"lazy":null,fetchpriority:t.attrs.topImage?"high":null}]],C]]}catch(e){return console.error("Error rendering Maximize2",e),(0,u.s)({msg:null,node:t,err:e,group:"block"})}},toDOMStatic:t=>{var e,i;let r=h(t),n=t.attrs.href||t.attrs.internalRedirect||(0,d.zF4)(t.attrs.src,void 0,{quality:"normal"===r?"auto:good":"auto:best"});if(t.attrs.height&&t.attrs.width&&"full"!==r){let{width:e,height:i}=t.attrs,r=e;t.attrs.resizeWidth?r=t.attrs.resizeWidth:w(t.attrs)&&(r=Math.min(Math.max(e,d.kPM),d.JWy));let a=Math.min(r,d.bxL),l=i*a/e,o=r>d.bxL,s={"data-attrs":JSON.stringify(t.attrs),alt:t.attrs.alt||"",title:t.attrs.title||t.attrs.alt,width:a,height:l,class:o?"wide-image":"",src:(0,d.zF4)(t.attrs.src,Math.min(!w(t.attrs)&&o?2*r:r,2*d.bxL),{lossy:y(t.attrs)})};return["table",{class:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"Image2ToDOMStatic"},["tr",{},["td"],["td",{align:"left",class:"content",width:r},["a",{class:"image-link",target:"_blank",href:n},["img",s]]],["td"]]]}return"full"===r?["a",{class:"image-link",target:"_blank",href:n},["img",{src:(0,d.zF4)(t.attrs.src,2*d.bxL,{lossy:y(t.attrs),crop:"limit",aspect:"full"===r?"1":void 0}),"data-attrs":JSON.stringify(t.attrs),alt:t.attrs.alt||"",title:t.attrs.title||t.attrs.alt,height:t.attrs.height,width:t.attrs.width}]]:["a",{class:"image-link",target:"_blank",href:n},["img",{src:(0,d.zF4)(t.attrs.src,2*d.bxL,{lossy:y(t.attrs)}),"data-attrs":JSON.stringify(t.attrs),alt:t.attrs.alt||"",title:t.attrs.title||t.attrs.alt,width:t.attrs.resizeWidth||t.attrs.width,height:t.attrs.resizeWidth?(e=t.attrs.width,i=t.attrs.height,i*t.attrs.resizeWidth/e):t.attrs.height}]]}},m=(0,g.S)({name:"image2",nodeSpec:f}),p=function(t,e){let i,r,n,{bytes:a,internalRedirect:l}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.getAttribute("data-attrs");if(o)try{return JSON.parse(o)}catch(t){}t.getAttribute("imageSize")&&(i=t.getAttribute("imageSize"));let s=t.getAttribute("style");if(s){let t=/max-height:\s*(\d+)px/.exec(s);t&&(r=Number(t[1]));let e=/max-width:\s*(\d+)px/.exec(s);e&&(n=Number(e[1]))}else t.getAttribute("width")&&t.getAttribute("height")&&(r=Number(t.getAttribute("height")),n=Number(t.getAttribute("width")));return t.complete&&t.naturalHeight&&t.naturalWidth&&(r=t.naturalHeight,n=t.naturalWidth),{src:(0,d.UH4)(t.getAttribute("data-medium-file")||t.getAttribute("src")),type:e,title:t.getAttribute("title"),alt:t.getAttribute("alt"),height:r,width:n,bytes:a,internalRedirect:l,imageSize:i,href:t.getAttribute("href"),align:t.getAttribute("align"),offset:"true"===t.getAttribute("offset")}},b=function(t){let{maxWidth:e=null,imageProps:i={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=h(t),a="full"===n?2*d.hI6:"large"===n?2*d.urw:2*d.qN9;return e&&(a=Math.min(e,a)),(0,d.zF4)(t.attrs.src,a,(0,r._)({lossy:y(t.attrs)},i))},v=function(t){var e;let{customSchema:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i&&!i.nodes.image2)return null;let r=/(https?:\/\/(giphy\.com\/gifs|gph.is\/g|media\d*\.giphy\.com\/media)\/[^\s]+)/.exec(t);return null!==(e=r&&r[1])&&void 0!==e?e:null},k=async t=>{let e=(await Promise.resolve().then(i.t.bind(i,80569,23))).default,r="image/gif",n=await e.get("/api/v1/giphy").query({url:t});return p(await new Promise(t=>(0,s.pt)(b({attrs:{type:r,src:n.body.url}}),t)),r,{bytes:n.body.bytes})},Z=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(i.bind(i,37175))).schema.nodes.image2.create(await k(t))};function y(t){return w(t)&&(!t.bytes||t.bytes>5e6)}function w(t){return!!(t.type&&"image/gif"===t.type||t.src&&t.src.split("?")[0].split("#")[0].endsWith(".gif"))}},80870:function(t,e,i){function r(t,e){let i={},r={};t.doc.descendants((t,n)=>{t.type===e.nodes.footnote?i[t.attrs.number]=[n,t.nodeSize]:t.type===e.nodes.footnoteAnchor&&(r[t.attrs.number]=n)});let n=new Set(Object.keys(i).map(Number)),a=new Set(Object.keys(r).map(Number)),l=Array.from(n).filter(t=>!a.has(t)).sort((t,e)=>e-t),o=Array.from(a).filter(t=>!n.has(t)).sort((t,e)=>e-t);for(let e of l){let[r,n]=i[e];t.delete(r,r+n)}for(let e of o){let i=r[e];t.delete(i,i+1)}}function n(t,e){let i=1,r=1;t.doc.descendants((n,a)=>{if(n.type===e.nodes.footnote){if(n.attrs.number!==i){let r=e.nodes.footnote.create({number:i},n.content);t.replaceWith(a,a+n.nodeSize,r)}i+=1}else if(n.type===e.nodes.footnoteAnchor){if(n.attrs.number!==r){let i=e.nodes.footnoteAnchor.create({number:r});t.replaceWith(a,a+n.nodeSize,i)}r+=1}})}function a(t,e){let i=[],r=!1;t.doc.forEach((t,n)=>{t.type===e.nodes.footnote&&(r=!0),r&&t.type!==e.nodes.footnote&&i.push([n,t.nodeSize])}),i.reverse().forEach(e=>{let[i,r]=e;t.delete(i,i+r)})}function l(t,e){let i=0;t.doc.nodesBetween(0,t.selection.from,t=>{t.type===e.nodes.footnoteAnchor&&(i+=1)});let r=[];return(t.doc.forEach((t,i)=>{t.type===e.nodes.footnote&&r.push(i)}),i<r.length)?r[i]:t.doc.resolve(0).end()}i.d(e,{$w:()=>a,A0:()=>n,dG:()=>l,zb:()=>r})}}]);