"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["9116"],{35047:function(e,t,n){n.d(t,{Eh:()=>X,ZP:()=>j,sv:()=>q});var r=n(7409),o=n(99282),i=n(58865),l=n(16584),a=n(98661),s=n(30396),u=n(94184),c=n.n(u),d=n(36808),p=n(2564),m=n(71375),h=n(91925),f=n(12620),g=n(64343),v=n(21312),b=n(20888),y=n(75744),_=n(57391),w=n(95441),x=n(56629),Z=n(40647),k=n(35702),N=n(68833),S=n(98914),C=n(71068),B=n(15771),I=n(19081),L=n(38841),E=n(58175),T=n(64528),A=n(55722),F=n(74312),P=n(31377),O=n(60308),R=n(26111),M=n(6911),H=n(70408),W=n(84864),z=n(47929),$=n(31190);function U(){let e=(0,i._)(["By ",""]);return U=function(){return e},e}let D="intro_popup_last_hidden_at";function q(e){let{includePrice:t=!0,includeRankingDetail:r=!0,includeByline:o=!0,includeBadge:i=!1,rankingDetailOverrideText:a=null,language:s="en"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=s||e.language,{iTemplate:c}=I18N.i(s||e.language),d=(0,W.getByLine)(e),p=null;return r&&(p=a||(e.rankingDetailByLanguage&&"en"!==u&&e.rankingDetailByLanguage[u]?e.rankingDetailByLanguage[u].rankingDetail:e.rankingDetail)),(0,l.BX)(T.N,{separator:" \xb7 ",children:[o&&d?(0,l.BX)(I.hs,{inline:!0,gap:4,children:[c(U(),d),i&&(0,l.tZ)(F.cr,{module:"../pencraft/unstable/UserBadge",resolve:e=>e.UserBadge,onRequest:()=>Promise.all([n.e("565"),n.e("6384")]).then(n.bind(n,87989)),size:"sm",tier:e.author_bestseller_tier,userId:e.author_id,whileLoading:e.author_bestseller_tier?(0,l.tZ)(I.hs,{alignItems:"center",children:(0,l.tZ)(A.o,{size:"sm",tier:e.author_bestseller_tier})}):(0,l.tZ)(l.HY,{})})]}):null,p,t&&function(e,t){let{language:n}=t,r=!e.disable_monthly_subscriptions&&e.plans&&e.plans.filter(e=>"month"===e.interval).sort((e,t)=>e.amount-t.amount)[0],o=!e.disable_annual_subscriptions&&e.plans&&e.plans.filter(e=>"year"===e.interval).sort((e,t)=>e.amount-t.amount)[0],i=r||o;if(i)return(0,W.planBasePricing)(i,{language:n})}(e,{language:s})]})}let j=(0,a.memo)(e=>{var t,n,i;let{publication:a,user:u,post:c,onHide:p,freeSignup:m,hidden:f,alwaysShow:g,showOnMount:v,freeSignupEmail:b,email:y,referralCode:w,blurbs:C,launchWelcomePage:B,topThreePosts:I,topThreeSubscribers:L}=e,{getConfigFor:E}=(0,Z.xR)(),T=E("welcome_page_query_params"),[A,F]=(0,s.eJ)(!1),[M,H]=(0,s.eJ)(!!(B||g)),$=(e,t)=>{var n;return T&&null!==(n=(0,R.x)(e))&&void 0!==n?n:t},[U]=(0,s.eJ)($("no_skip",void 0)),[q]=(0,s.eJ)($("no_blurbs",!1)),[j]=(0,s.eJ)(()=>{let e=$("hero_text",void 0);return e?decodeURIComponent(e):void 0}),{getExperimentVariant:X,exposeExperiment:G}=(0,_.jc)(),{getSettingFor:K}=(0,x.So)(),Q=null!==(t=(0,R.x)("force"))&&void 0!==t?t:void 0;(0,s.d4)(()=>{let e=e=>{"Escape"===e.key&&er(!0)};if(M)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[M]),(0,s.d4)(()=>{if(B&&!eo()||et()){if("undefined"!=typeof window&&(0,S.cn)(document.documentElement,"has-intro-popup"),(0,R.x)("r")){let e=(0,R.x)("r");u&&(0,W.userReferralKey)(u)===e||(0,N.j)(N.FP.COVER_PAGE_REFERRAL_VISIT,{referral_key:e,referring_user:(0,W.userFromReferralKey)(e)})}ee()}else p&&p(),(0,k.a)({hide_intro_popup:!0}),"undefined"!=typeof window&&(0,S.IV)(document.documentElement,"has-intro-popup"),!g&&"undefined"!=typeof window&&(0,S.pv)(document.documentElement,"show-intro-popup")&&(0,S.IV)(document.documentElement,"show-intro-popup");return["no_skip","no_blurbs","hero_text","hide_intro_popup"].forEach(e=>(0,S.iO)(e)),()=>{"undefined"!=typeof window&&(0,S.IV)(document.documentElement,"has-intro-popup"),er(!0)}},[]);let ee=()=>{"undefined"==typeof window||((0,S.cn)(document.documentElement,"show-intro-popup"),(0,N.j)(N.FP.COVER_PAGE_SHOWN,{has_cover_photo:!!a.cover_photo_url,has_free_signup_email:!!b,has_free_signup:!!m,functional_version:!0,launch_welcome_page:B,always_show:g,hidden:f,screen_height:"undefined"!=typeof window?window.innerHeight:null,screen_width:"undefined"!=typeof window?window.innerWidth:null,test_experiment_variant_v5:X("test_experiment_v5")}),G("test_experiment_v5"),g||(0,N.XY)("pageview",{dl:"".concat(document.location.origin,"/welcome").concat(document.location.search)})),H(!0)},et=(0,s.I4)(()=>!!g||!f&&(!!v||!!A||!eo()&&!!(null==c||c&&!(0,P.isPaidAudience)(c.audience))&&!m&&(!u||!u.is_free_subscribed&&!u.is_subscribed)),[g,m,f,c,v,A,u]),en=K("display_welcome_page_details")&&a.freeSubscriberCount&&!(0,S.K1)()&&!Q&&!a.invite_only&&!w&&!a.custom_domain&&(null==I?void 0:I.length)&&(null==L?void 0:L.length)&&!U&&!j;(0,s.d4)(()=>{M&&et()&&en&&G("welcome_page_update_desktop_visuals_limited")},[G,K,en,et,M]);let er=e=>{e||(ei(),setTimeout(()=>{(0,k.a)({hide_intro_popup:!0})},500)),p&&p(),!g&&"undefined"!=typeof window&&(0,S.pv)(document.documentElement,"show-intro-popup")&&(0,S.IV)(document.documentElement,"show-intro-popup")},eo=()=>{let e=d.get(D);return!!(e&&new Date(e)>new Date(Date.now()-864e5))},ei=()=>{d.set(D,new Date().toJSON(),{expires:3650})},el=async e=>{(0,N.j)(N.FP.COVER_PAGE_EMAIL_SUBMITTED,{is_paying_sub:!!e.body.prompt_to_login,has_plans:!!a.plans,functional_version:!0,homepage_type:a.homepage_type}),ei(),F(!0),(0,k.a)({freeSignup:!0,freeSignupEmail:e.body.email});let t=g?"/":document.location.href;e.body.prompt_to_login?setTimeout(()=>{document.location.href=(0,O.n1t)("/account/login",{redirect:t,email:e.body.email})},30):document.location.href=(0,O.n1t)("/subscribe",(0,o._)((0,r._)({next:t,later:!0,just_signed_up:!0},e.body.subscription_id&&{subscription_id:e.body.subscription_id},e.body.referral_token&&{referral_token:e.body.referral_token}),{requires_confirmation:e.body.requires_confirmation?"true":"",utm_source:z.b3.coverPage,email:e.body.email,skip_redirect_check:!0}))},ea=()=>{(0,N.j)(N.FP.COVER_PAGE_MAYBE_LATER_CLICKED,{functional_version:!0}),er()};if(!M||!et())return null;let es=(0,l.tZ)(Y,{source:"cover_page",email:y,pub:a,user:null!=u?u:null,freeSignup:m,freeSignupEmail:b,referralCode:w,forceSignup:null!==(i=null!==(n=(0,R.x)("force"))&&void 0!==n?n:U)&&void 0!==i?i:void 0,onMaybeLater:U?void 0:ea,onFreeSignup:el,blurbs:C,hideBlurbs:q,overrideSubtitle:j});if(en)switch(X("welcome_page_update_desktop_visuals_limited")){case"treatment_social_proof":es=(0,l.tZ)(J,{email:y,pub:a,user:null!=u?u:null,freeSignup:m,freeSignupEmail:b,onMaybeLater:ea,onFreeSignup:el,blurbs:C,topThreeSubscribers:L});break;case"treatment_large_fonts":es=(0,l.tZ)(V,{email:y,pub:a,user:null!=u?u:null,freeSignup:m,freeSignupEmail:b,onMaybeLater:ea,onFreeSignup:el,blurbs:C})}return(0,l.tZ)(h.s,{children:(0,l.tZ)("div",{className:"intro-popup",children:(0,l.tZ)("div",{className:"intro-popup-page",children:es})})})}),X=e=>(0,l.tZ)("div",{className:"intro-inline",children:(0,l.tZ)(Y,(0,r._)({},e))}),J=e=>{var t,o,i,a,u;let{pub:d,user:p,email:m,freeSignup:h,freeSignupEmail:_,onMaybeLater:Z,onFreeSignup:k,blurbs:S,topThreeSubscribers:B}=e,T="cover_page",A=(0,s.qp)(x.vz),{iString:P,language:R}=(0,w.M1)(),{title:M,subtitle:W,logoUrl:z,coverPhotoUrl:U,hideTitle:D,hideSubtitle:j}=G(d),X=U&&(0,O.zJH)(U),J=X&&X.width/X.height,V=!!(J&&J<2),Y=!D||U&&V,K=!j||U&&V;(0,s.d4)(()=>{(0,N.j)(N.FP.FULL_EMAIL_FORM_SHOWN,{source:T,functional_version:!0,version:"social-proof"})},[T]);let ee=S?S.filter(e=>""!=e.description):[],et=q(d,{includePrice:!1,includeBadge:!0,includeRankingDetail:!1,language:R});return(0,l.BX)("div",{className:"full-email-form",children:[(0,l.BX)("div",{className:"vertically-centered",children:[(0,l.tZ)(Q,{onClick:Z}),U?V?null:(0,l.tZ)(C.xu,{paddingBottom:48,children:(0,l.tZ)(b.e,{className:$.Z.publicationCoverPhotoCenter,src:U,imageProps:{quality:"auto:best"},maxWidth:840,loading:"eager",style:(0,r._)({},X&&X.width&&{height:"min(168px, ".concat(840*X.height/X.width,"px)")}),imageIsFixedWidth:!0})}):z&&(0,l.tZ)(C.xu,{paddingBottom:32,children:(0,l.tZ)(L.wk,{logoUrl:z,size:88})}),(0,l.BX)(I.hs,{gap:48,children:[(0,l.BX)(I.tu,{className:V?$.Z.column:$.Z.centeredColumn,gap:32,children:[(0,l.BX)(I.tu,{gap:16,children:[Y?(0,l.tZ)(E.xv.H1,{textAlign:V?"left":"center",font:"pub-headings",className:$.Z.coverPrimary,textWrap:"balance",children:M}):null,K?(0,l.tZ)(E.xv.B3,{textAlign:V?"left":"center",font:"display",size:15,lineHeight:20,className:$.Z.coverSecondary,textWrap:"balance",children:W}):null,et&&(null===(a=et.props)||void 0===a?void 0:null===(i=a.children)||void 0===i?void 0:null===(o=i.filter)||void 0===o?void 0:null===(t=o.call(i,Boolean))||void 0===t?void 0:t.length)?(0,l.tZ)(E.xv.B2,{textAlign:V?"left":"center",weight:"semibold",font:"display",size:17,lineHeight:24,className:$.Z.coverSecondary,children:et}):null]}),(0,l.BX)(I.tu,{gap:16,children:[(0,l.BX)(I.hs,{alignItems:"center",alignSelf:V?"start":"center",gap:8,children:[(0,l.tZ)(I.hs,{alignItems:"center",className:c()($.Z.faces),children:B.map((e,t)=>{let{id:r,photo_url:o}=e,i=(0,l.tZ)(b.e,{className:c()($.Z.face,0===t&&$.Z.first,t===B.length-1&&$.Z.last),style:{zIndex:B.length-t},maxWidth:80,src:(0,O.zF4)(o||(0,H.I4)(r),64),imageIsFixedWidth:!0});return(0,l.tZ)(F.cr,{module:"@/frontend/components/ProfileHoverCard",resolve:e=>e.ProfileHoverCard,onRequest:()=>Promise.all([n.e("6304"),n.e("1426"),n.e("565"),n.e("5924"),n.e("7337"),n.e("8522"),n.e("1262"),n.e("4870"),n.e("8695"),n.e("1556"),n.e("56")]).then(n.bind(n,85685)),whileLoading:i,subject:e,dontStopPropagation:!1,disabled:!1,placement:"top-start",children:i})})}),d.freeSubscriberCount?(0,l.BX)(E.xv.H3,{font:"display",weight:"semibold",size:20,lineHeight:24,className:$.Z.coverPrimary,translated:!0,children:["Join over ",I18N.p(d.freeSubscriberCount)," subscribers"]}):null]}),(0,l.tZ)(f.Z,{email:m,isWelcomePageColor:!0,freeSignup:h,freeSignupEmail:_,pub:d,source:T,user:p,onConfirmationRequired:"enabled"===d.payments_state?()=>null:void 0,onSuccess:k||(()=>document.location.href="/"),autoFocus:!0,className:$.Z.containerClassName,promptClassName:$.Z.promptClassName,inputClassName:$.Z.inputClassName,subscribeButtonClassName:$.Z.subscribeButtonClassName}),(0,l.BX)(I.hs,{gap:4,cursor:"pointer",alignItems:"center",alignSelf:V?"start":"center",inline:!0,onClick:Z,children:[(0,l.tZ)(E.xv.B3,{style:{color:"var(--cover_print_secondary)"},children:"No thanks"===A.getSettingFor("welcome_page_opt_out_text")?P("No thanks"):null!==(u=A.getSettingFor("welcome_page_opt_out_text"))&&void 0!==u?u:P("No thanks")}),(0,l.tZ)(g.Z,{height:18,stroke:"var(--cover_print_secondary)",strokeWidth:2})]})]})]}),U&&V?(0,l.tZ)(I.tu,{className:c()($.Z.column,$.Z.hideColumnSmallScreens),gap:32,children:(0,l.tZ)(b.e,{className:$.Z.publicationCoverPhotoRight,src:U,imageProps:{quality:"auto:best"},maxWidth:476,loading:"eager",imageIsFixedWidth:!0})}):null]}),!!(null==ee?void 0:ee.length)&&(0,l.tZ)("div",{className:"blurb-buffer"}),!!(null==ee?void 0:ee.length)&&(0,l.tZ)(I.gq,{className:"blurbs",gap:20,children:ee.map(e=>(0,l.BX)(I.tu,{gap:8,className:"blurb",children:[(0,l.tZ)(E.xv.B4,{className:"blurb-text",children:(0,l.tZ)(v.Z,{maxLines:4,ellipsesText:"...”",text:"“".concat(e.description,"”")})}),(0,l.BX)(E.xv.B4,{weight:"semibold",className:"blurb-text",children:[e.author_name||e.recommendingPublication.email_from_name||e.recommendingPublication.copyright,", ",(0,l.tZ)("a",{href:(0,O.SVA)(e.recommendingPublication),children:e.recommendingPublication.name})]})]}))})]}),(0,l.tZ)(y.fJ,{publication:d})]})},V=e=>{var t;let{pub:n,user:o,email:i,freeSignup:a,freeSignupEmail:u,onMaybeLater:d,onFreeSignup:p,blurbs:m}=e,h="cover_page",_=(0,s.qp)(x.vz),{getSettingFor:Z}=(0,x.So)(),{iString:k,language:S}=(0,w.M1)(),{title:B,subtitle:T,logoUrl:A,coverPhotoUrl:F,hideTitle:P,hideSubtitle:R}=G(n),M=F&&(0,O.zJH)(F),H=M&&M.width/M.height,W=!!(H&&H<2),z=!P||F&&W,U=!R||F&&W;(0,s.d4)(()=>{(0,N.j)(N.FP.FULL_EMAIL_FORM_SHOWN,{source:h,functional_version:!0,version:"large-fonts"})},[h]);let D=m?m.filter(e=>""!=e.description):[],j=Z("display_welcome_page_details");return(0,l.BX)("div",{className:"full-email-form",children:[(0,l.BX)("div",{className:"vertically-centered",children:[(0,l.tZ)(Q,{onClick:d}),F?W?null:(0,l.tZ)(C.xu,{paddingBottom:48,children:(0,l.tZ)(b.e,{className:$.Z.publicationCoverPhotoCenter,src:F,imageProps:{quality:"auto:best"},maxWidth:840,loading:"eager",style:(0,r._)({},M&&M.width&&{height:"min(168px, ".concat(840*M.height/M.width,"px)")}),imageIsFixedWidth:!0})}):A&&(0,l.tZ)(C.xu,{paddingBottom:32,children:(0,l.tZ)(L.wk,{logoUrl:A,size:88})}),(0,l.BX)(I.hs,{gap:48,children:[(0,l.BX)(I.tu,{className:W?$.Z.largeColumn:$.Z.largeCenteredColumn,gap:32,children:[(0,l.BX)(I.tu,{gap:16,children:[z?(0,l.tZ)(E.xv.H1,{textAlign:W?"left":"center",font:"pub-headings",className:c()($.Z.coverPrimary,$.Z.largeHeading),textWrap:"balance",children:B}):null,U?(0,l.tZ)(E.xv.B3,{textAlign:W?"left":"center",font:"display",size:15,lineHeight:20,className:c()($.Z.coverSecondary,$.Z.largeSubHeading),textWrap:"balance",children:T}):null,(0,l.tZ)(E.xv.B2,{textAlign:"left",weight:"semibold",font:"display",size:17,lineHeight:24,className:$.Z.coverSecondary,alignSelf:W?"start":"center",children:q(n,{includePrice:!1,includeBadge:!0,rankingDetailOverrideText:n.rankingDetailFreeSubscriberCount,includeRankingDetail:!!j,language:S})})]}),(0,l.BX)(I.tu,{gap:16,children:[(0,l.tZ)(f.Z,{email:i,isWelcomePageColor:!0,freeSignup:a,freeSignupEmail:u,pub:n,source:h,user:o,onConfirmationRequired:"enabled"===n.payments_state?()=>null:void 0,onSuccess:p||(()=>document.location.href="/"),autoFocus:!0,className:$.Z.containerClassName,promptClassName:$.Z.largePromptClassName,inputClassName:$.Z.largeInputClassName,inputWrapperClassName:$.Z.largeInputWrapperClassName,subscribeButtonClassName:$.Z.largeSubscribeButtonClassName}),(0,l.BX)(I.hs,{gap:4,cursor:"pointer",alignItems:"center",alignSelf:"center",inline:!0,onClick:d,children:[(0,l.tZ)(E.xv.B1,{size:20,lineHeight:30,weight:"semibold",style:{color:"var(--cover_print_secondary)"},children:"No thanks"===_.getSettingFor("welcome_page_opt_out_text")?k("No thanks"):null!==(t=_.getSettingFor("welcome_page_opt_out_text"))&&void 0!==t?t:k("No thanks")}),(0,l.tZ)(g.Z,{height:18,stroke:"var(--cover_print_secondary)",strokeWidth:2})]})]})]}),F&&W?(0,l.tZ)(I.tu,{className:c()($.Z.largeColumn,$.Z.hideLargeColumnSmallScreens),gap:32,children:(0,l.tZ)(b.e,{className:$.Z.largePublicationCoverPhotoRight,src:F,imageProps:{quality:"auto:best"},maxWidth:568,loading:"eager",imageIsFixedWidth:!0})}):null]}),!!(null==D?void 0:D.length)&&(0,l.tZ)("div",{className:"blurb-buffer"}),!!(null==D?void 0:D.length)&&(0,l.tZ)(I.gq,{className:"blurbs",gap:20,children:D.map(e=>(0,l.BX)(I.tu,{gap:8,className:"blurb",children:[(0,l.tZ)(E.xv.B4,{className:"blurb-text",children:(0,l.tZ)(v.Z,{maxLines:4,ellipsesText:"...”",text:"“".concat(e.description,"”")})}),(0,l.BX)(E.xv.B4,{weight:"semibold",className:"blurb-text",children:[e.author_name||e.recommendingPublication.email_from_name||e.recommendingPublication.copyright,", ",(0,l.tZ)("a",{href:(0,O.SVA)(e.recommendingPublication),children:e.recommendingPublication.name})]})]}))})]}),(0,l.tZ)(y.fJ,{publication:n})]})},Y=e=>{var t;let{autoFocus:o=!0,pub:i,user:a,email:u,freeSignup:d,freeSignupEmail:m,referralCode:h,source:g,forceSignup:b,submitButtonText:y,onMaybeLater:_,onFreeSignup:Z,blurbs:k,hideBlurbs:S,overrideSubtitle:C}=e,L=(0,s.qp)(x.vz),{iString:T}=(0,w.M1)(),A=(0,R.x)("referralCode"),P=(0,R.x)("refSource"),H=T("Learn More"),W=(0,O.d6h)(i,{params:(0,r._)({utm_source:z.b3.subscribeEmail,utm_content:z.fZ.learnMore},A&&{referralCode:A},P&&{refSource:P})});(0,s.d4)(()=>{"subscribe_page"===g&&(0,N.j)(N.FP.SUBSCRIBE_EMAIL_FULL_SCREEN_SHOWN,{functional_version:!0}),(0,N.j)(N.FP.FULL_EMAIL_FORM_SHOWN,{source:g,functional_version:!0})},[g]);let U=k&&!S?k.filter(e=>""!=e.description):[];return(0,l.tZ)("div",{className:"full-email-form",children:(0,l.BX)("div",{className:"vertically-centered",children:[_&&!i.invite_only&&(0,l.tZ)(Q,{onClick:_}),(0,l.tZ)(K,{pub:i,overrideSubtitle:C}),!i.invite_only||a&&a.is_free_subscribed?(0,l.BX)(l.HY,{children:[(0,l.tZ)(I.gq,{justifyContent:"center",style:{width:"100%"},children:(0,l.BX)(I.tu,{gap:4,style:{width:"100%",maxWidth:"380px"},children:[(0,l.tZ)(f.Z,{email:u,isWelcomePageColor:!0,freeSignup:d,freeSignupEmail:m,pub:i,referralCode:h,source:g,submitButtonText:y,user:a,onConfirmationRequired:"enabled"===i.payments_state?()=>null:void 0,onSuccess:Z||(()=>document.location.href="/"),autoFocus:o}),(0,l.BX)(E.xv.B4,{paddingX:{mobile:16,desktop:0},paddingTop:16,className:$.Z.tosText,translated:!0,children:["By subscribing, I agree to Substack’s"," ",(0,l.tZ)("a",{className:$.Z.tosLink,href:(0,M._Q)(),target:"_blank",rel:"noopener noreferrer",children:"Terms of Use"})," ","and acknowledge its"," ",(0,l.tZ)("a",{className:$.Z.tosLink,href:(0,M.WF)(),target:"_blank",rel:"noopener noreferrer",children:"Information Collection Notice"})," ","and"," ",(0,l.tZ)("a",{className:$.Z.tosLink,href:(0,M.Zz)(),target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"})]})]})}),!b&&(_?(0,l.tZ)("a",{onClick:e=>e.preventDefault(),className:"no-styles",children:(0,l.BX)(B.zx,{priority:"quaternary",className:$.Z.maybeLater,onClick:_,"data-testid":"maybeLater",children:["No thanks"===L.getSettingFor("welcome_page_opt_out_text")?T("No thanks"):null!==(t=L.getSettingFor("welcome_page_opt_out_text"))&&void 0!==t?t:T("No thanks"),(0,l.tZ)(p.Z,{size:20})]})}):(0,l.BX)(B.zx,{priority:"quaternary",className:$.Z.maybeLater,href:W,localNavigation:!1,children:[H,(0,l.tZ)(p.Z,{size:20})]}))]}):(0,l.tZ)(F.cr,{onRequest:()=>n.e("2457").then(n.bind(n,51323)),resolve:e=>e.InviteActions,module:"./InviteActions",pub:i,user:a,freeSignupEmail:m}),!!(null==U?void 0:U.length)&&(0,l.tZ)("div",{className:"blurb-buffer"}),!!(null==U?void 0:U.length)&&(0,l.tZ)(I.gq,{className:"blurbs",gap:20,children:U.map(e=>(0,l.BX)(I.tu,{gap:8,className:"blurb",children:[(0,l.tZ)(E.xv.B4,{className:c()("blurb-text",$.Z.blurbText),children:(0,l.tZ)(v.Z,{maxLines:4,ellipsesText:"...”",text:"“".concat(e.description,"”")})}),(0,l.BX)(E.xv.B4,{weight:"semibold",className:c()("blurb-text",$.Z.blurbText),children:[e.author_name||e.recommendingPublication.email_from_name||e.recommendingPublication.copyright,", ",(0,l.tZ)("a",{href:(0,O.SVA)(e.recommendingPublication),children:e.recommendingPublication.name})]})]}))})]})})},G=(e,t)=>{let n,r,o,i,l,a;let{getConfigFor:s}=(0,Z.xR)();if(s("section_specific_welcome_pages")&&e.section){var u;n=e.section.name,r=e.section.description,o=null!==(u=e.section.logo_url)&&void 0!==u?u:e.logo_url,l=!!((i=e.section.cover_photo_url)&&e.section.hide_intro_title),a=!!(i&&e.section.hide_intro_subtitle)}else n=e.name,r=e.hero_text,o=e.logo_url,l=!!((i=e.cover_photo_url)&&e.hide_intro_title),a=!!(i&&e.hide_intro_subtitle);return t&&(r=t),{title:n,subtitle:r,logoUrl:o,coverPhotoUrl:i,hideTitle:l,hideSubtitle:a}},K=e=>{let{pub:t,overrideSubtitle:n}=e,{getSettingFor:o}=(0,x.So)(),{language:i}=(0,w.M1)(),{title:a,subtitle:s,logoUrl:u,coverPhotoUrl:d,hideTitle:p,hideSubtitle:m}=G(t,n),h=o("display_welcome_page_details"),f=d&&(0,O.zJH)(d);return(0,l.BX)(l.HY,{children:[d?(0,l.tZ)(b.e,{className:"publication-cover-photo",src:d,imageProps:{quality:"auto:best"},maxWidth:1360,loading:"eager",style:(0,r._)({},f&&f.width&&{height:"min(35vh, ".concat(680*f.height/f.width,"px)")})}):u&&(0,l.tZ)(C.xu,{paddingBottom:32,children:(0,l.tZ)(L.wk,{logoUrl:u,size:88})}),!p&&(0,l.tZ)("h1",{className:c()("publication-name",{"no-logo":!u,"with-cover":d},$.Z.balancedText),children:a}),!m&&s&&(0,l.tZ)("p",{className:c()("publication-tagline with-cover",{verbose:!0,"with-cover":d},$.Z.balancedText),children:s}),(0,l.tZ)("div",{className:"publication-meta",children:q(t,{includePrice:!1,includeBadge:!0,rankingDetailOverrideText:t.rankingDetailFreeSubscriberCount,includeRankingDetail:!!h,language:i})})]})},Q=e=>{let{onClick:t}=e;return(0,l.tZ)(B.hU,{onClick:t,"aria-label":"Close","data-testid":"close-welcome-modal",priority:"tertiary",className:$.Z.closeWelcomeModal,children:(0,l.tZ)(m.Z,{size:20})})}},72392:function(e,t,n){n.d(t,{o:()=>_});var r=n(16584),o=n(30396),i=n(94184),l=n.n(i),a=n(95441),s=n(98914),u=n(15771),c=n(19081),d=n(44424),p=n(63474),m=n(58175),h=n(81821),f=n(98550);let g=e=>{let[t,n]=(0,o.eJ)(null);return(0,o.d4)(()=>{let t=[];return e.forEach(e=>{let r=(0,s.VA)(e.text.toLowerCase(),!0),o=document.getElementById("\xa7".concat(r));if(o){let e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.intersectionRatio>=.8&&n(r)})},{threshold:.5,rootMargin:"0px 0px -90% 0px"});e.observe(o),t.push(e)}}),()=>t.forEach(e=>e.disconnect())},[e]),t},v=e=>e?/^H[1-5]$/i.test(e.tagName)?e:v(e.parentElement):null,b=e=>{let{toc:t,minLevel:n,activeItem:o}=e;return(0,r.tZ)(c.tu,{gap:12,paddingY:12,paddingX:8,alignItems:"end",children:t.map((e,t)=>{let i=e.level-n,a="indent-".concat(Math.min(i,3)),u=(0,s.VA)(e.text.toLowerCase(),!0);return(0,r.tZ)("div",{className:l()(f.Z.line,f.Z[a],o===u&&f.Z.active)},t)})})},y=e=>{let{toc:t,minLevel:n,activeItem:o,onItemClick:i}=e,{iString:u}=(0,a.M1)();return(0,r.BX)(c.tu,{gap:4,flex:"grow",children:[(0,r.tZ)(m.xv.Meta,{padding:4,color:"primary",children:u("Contents")}),t.map((e,t)=>{let a=(0,s.VA)(e.text.toLowerCase(),!0),u=e.level-n,d="indent-".concat(Math.min(u,3));return(0,r.tZ)(p.A0,{href:"#\xa7".concat(a),onClick:e=>{e.preventDefault(),i(a)},children:(0,r.tZ)(c.gq,{padding:4,className:l()(f.Z.row),children:(0,r.tZ)(m.xv.B3,{className:l()(f.Z.label,f.Z[d],o===a&&f.Z.active),ellipsis:!0,children:e.text})})},t)})]})},_=e=>{let{toc:t,position:n="fixed"}=e,{iString:i}=(0,a.M1)(),s=Math.min(...t.map(e=>e.level)),[c,p]=(0,o.eJ)(null),m=g(t);return t.length<2||(0,h.tq)()?null:(0,r.tZ)(d.v2,{trigger:e=>{let{ref:o,onClick:a}=e;return(0,r.tZ)(u.kG,{ref:o,onClick:a,className:l()(f.Z.trigger,f.Z[n]),"aria-label":i("Table of Contents"),position:n,children:(0,r.tZ)(b,{toc:t,minLevel:s,activeItem:m})})},customShowClass:f.Z.show,customHideClass:f.Z.hide,layerClassName:f.Z.menu,layerOptions:{placement:"right-center",triggerOffset:8},children:(0,r.tZ)(y,{toc:t,minLevel:s,activeItem:m,onItemClick:e=>{let t=document.getElementById("\xa7".concat(e));if(t){let n=v(t);if(n){if(c){let e=document.getElementById("\xa7".concat(c)),t=e?v(e):null;null==t||t.classList.remove("highlight")}n.classList.add("highlight"),p(e),t.scrollIntoView({behavior:"smooth",block:"start"})}}}})})}},59708:function(e,t,n){let r;n.d(t,{Kd:()=>J,N1:()=>V});var o,i=n(7409),l=n(99282),a=n(16584),s=n(6400),u=n(70109),c=n(94184),d=n.n(c),p=n(60826),m=n(4373),h=n(62049),f=n(16564),g=n(17117),v=n(36441),b=n(78435),y=n(80836),_=n(3258),w=n(33665),x=n(95441),Z=n(57796),k=n(26989),N=n(98914),S=n(55706),C=n(19081),B=n(32700),I=n(93903),L=n(60308),E=n(26111),T=n(81821),A=n(64314);let F=(e,t)=>{var n,r,o,l;return(0,a.tZ)("div",{className:"subscription-widget-wrap",children:(0,a.BX)("div",{className:"subscription-widget show-subscribe",children:[(0,a.tZ)("div",{className:"preamble",children:(0,a.tZ)("p",{dangerouslySetInnerHTML:{__html:null!==(l=null===(o=e.children[0])||void 0===o?void 0:null===(r=o.children[0])||void 0===r?void 0:null===(n=r.children[0])||void 0===n?void 0:n.innerHTML)&&void 0!==l?l:""}})}),(0,a.tZ)(w.Z,(0,i._)({pub:t.pub,subscribeButtonAttrs:null,source:"subscribe-widget-preamble"},t.props))]})})},P=(e,t)=>{try{let n=JSON.parse((0,I.Z)(e.getAttribute("data-attrs")));if(["".concat(t.pub.base_url,"/subscribe?"),"".concat(t.pub.base_url,"/subscribe?plan=founding"),p.W.CHECKOUT_URL,p.W.FOUNDING_CHECKOUT_URL].includes(n.url)){let n=JSON.parse((0,I.Z)(e.getAttribute("data-attrs")));return(0,a.tZ)(w.Z,(0,i._)({pub:t.pub,subscribeButtonAttrs:n},t.props))}}catch(e){console.error("Failed to parse button:",e)}return null},O=(e,t)=>{let{pub:n,props:{isStatic:r,post:o}}=t;try{let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse((0,I.Z)(t));return r?(0,a.tZ)(f.nO,{label:e.label,pub:n,post:o,duration:e.duration}):(0,a.tZ)(f.cM,{label:e.label,pub:n,post:o,src:"/api/v1/audio/upload/".concat(e.mediaUploadId,"/src"),duration:e.duration,autoPlay:!1,mediaUpload:{id:e.mediaUploadId}})}}catch(e){console.error("Failed to parse audio:",e)}return null},R=(e,t)=>{let{pub:n,props:{isStatic:r,post:o}}=t;try{let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse((0,I.Z)(t));return r?(0,a.tZ)(f.nO,{label:e.label,pub:n,post:o,duration:e.duration}):(0,a.tZ)(f.cM,{label:e.label,pub:n,post:o,src:e.url,duration:e.duration,autoPlay:!1})}}catch(e){console.error("Failed to parse audio:",e)}return null},M=(e,t)=>{let{props:{isStatic:n}}=t;try{let t=e.getAttribute("data-attrs");if(t){let{name:e,avatarUrl:r,url:o}=JSON.parse((0,I.Z)(t));return n?(0,a.tZ)(S.W,{name:e,avatarUrl:r,url:o}):(0,a.tZ)(S.R,{name:e,avatarUrl:r,url:o})}}catch(e){console.error("Failed to parse audio:",e)}return null},H=e=>{try{let t=JSON.parse(e.dataset.attrs).symbol;if(t)return(0,a.tZ)(g.Z,{symbol:t,prependSymbol:JSON.parse(e.dataset.attrs).prependSymbol,isStatic:JSON.parse(e.dataset.attrs).isStatic});return(0,a.tZ)(a.HY,{})}catch(e){return console.error("failed to parse cashtag"),(0,a.tZ)(a.HY,{})}},W=(e,t)=>{let{pub:n,props:{isStatic:r}}=t,{iString:o}=I18N.i({pub:n});try{if(r){let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse((0,I.Z)(t)),n=null==e?void 0:e.persistentExpression;return n?(0,a.tZ)("img",{src:(0,L.iJV)(n),style:{transform:"scale(0.5)"},"data-component-name":"LatexImg"}):(0,a.tZ)("p",{children:o("Failed to render LaTeX expression — no expression found in email")})}return(0,a.tZ)("p",{children:o("Failed to render LaTeX expression — data attributes not found")})}let t=e.getAttribute("data-attrs"),n=JSON.parse((0,I.Z)(t)),i=null==n?void 0:n.persistentExpression;return i?(0,a.tZ)(C.gq,{className:"latex-rendered",justifyContent:"center",flex:"grow",paddingBottom:"4px",paddingTop:"4px","data-component-name":"Latex",children:(0,a.tZ)(C.tu,{justifyContent:"center",children:(0,a.tZ)(u.Z,{inline:!1,children:"\\(".concat(i,"\\)")})})}):(0,a.tZ)("p",{children:o("Failed to render LaTeX expression — no expression found")})}catch(e){return console.error("failed to render mathjax",e),(0,a.tZ)("p",{children:o("Failed to render LaTeX expression — error")})}},z=e=>{try{let{name:t,id:n,type:r,url:o,photo_url:i,uuid:l,isStatic:s}=JSON.parse(e.dataset.attrs);if(t)return(0,a.tZ)(_.ZP,{name:t,id:n,type:r,url:o,photo_url:i,uuid:l,isStatic:s});return(0,a.tZ)(a.HY,{})}catch(e){return(0,a.tZ)(a.HY,{})}},$=(e,t)=>{try{let o=JSON.parse((0,I.Z)(e.getAttribute("data-attrs")));if(null==o?void 0:o.isEmail){var n,r;return(0,a.tZ)("table",{className:"poll-embed poll-email",cellSpacing:"16px",width:"100%",children:(0,a.tZ)("tbody",{children:(0,a.tZ)("tr",{children:(0,a.tZ)("td",{align:"center",children:(0,a.tZ)(b.kq,{id:o.id,embeddedPolls:null!==(r=null===(n=t.props.dataForEmailRender)||void 0===n?void 0:n.embeddedPolls)&&void 0!==r?r:[],pub:t.pub})})})})})}return(0,a.tZ)("div",{className:"poll-embed",dataAttrs:e.getAttribute("data-attrs"),children:(0,a.tZ)(b.n_,{id:o.id,isEditor:!1,post:t.props.post,isVersionView:!!t.props.isVersionView})})}catch(e){return console.error("Failed to parse poll:",e),(0,a.tZ)(a.HY,{})}},U=(e,t,n)=>{var r;let[o,,i]=e.id.split("-"),l=null===(r=n.wrapper.querySelector("#".concat(o,"-").concat(i)))||void 0===r?void 0:r.nextElementSibling;return l?((0,T.tq)()&&(e.href="#_"),(0,a.tZ)(B.z,{content:(0,a.tZ)("div",{className:"markup",children:X(l,t,n)}),className:"footnote-hovercard-target",dontStopPropagation:!0,layerClassName:"typography footnote-hovercard",as:"span",children:X(e,t,n)})):X(e,t,n)},D=(e,t)=>(0,a.tZ)(x._7,{language:t,children:e}),q=function(e,t){var n,r,o;let{shallow:l}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("A"!==e.nodeName||e.getAttribute("rel")||e.setAttribute("rel","pub"in t&&(null===(o=t.pub)||void 0===o?void 0:o.no_follow)?"nofollow ugc noopener":""),(0,N.pv)(e,"image2")&&(null===(n=t.props)||void 0===n?void 0:n.canRestackImage)&&e.classList.add("can-restack"),"pub"in t&&t.pub&&"P"===e.nodeName&&(0,N.pv)(e,"button-wrapper")){let n=P(e,t);if(n)return n;let r=(0,v.TW)(e,t);if(r)return r}let u="pub"in t&&(null===(r=t.pub)||void 0===r?void 0:r.language)||"en";return(0,N.pv)(e,"subscription-widget-wrap-editor")||(0,N.pv)(e,"subscription-widget-wrap")?D(F(e,t),u):(0,N.pv)(e,"cashtag-wrap")?D(H(e),u):(0,N.pv)(e,"mention-wrap")?D(z(e),u):"pub"in t&&t.pub&&(0,N.pv)(e,"native-audio-url-embed")?D(R(e,t),u):"pub"in t&&t.pub&&(0,N.pv)(e,"native-audio-embed")?D(O(e,t),u):"pub"in t&&t.pub&&(0,N.pv)(e,"native-video-embed")?D((0,v.tj)(e,t),u):"pub"in t&&t.pub&&(0,N.pv)(e,"meeting-embed")?D(M(e,t),u):(0,N.pv)(e,"poll-embed")?D($(e,t),u):(0,N.pv)(e,"recipe-embed")?D((0,v.G3)(e,t),u):(0,N.pv)(e,"pinterest-embed")?D((0,v.EK)(e),u):(0,N.pv)(e,"sponsorship-campaign-embed")?D((0,v.b3)(e,t),u):(0,N.pv)(e,"image-gallery-embed")?D((0,v.W5)(e,t),u):(0,N.pv)(e,"image3")?D((0,v.L0)(e,t),u):(0,N.pv)(e,"directMessage")?D((0,v.Gz)(e,t),u):(0,N.pv)(e,"latex-rendered")?D(W(e,t),u):(0,N.pv)(e,"community-chat")?D(function(e,t){let{props:{isStatic:n}}=t;try{let t=e.getAttribute("data-attrs"),r=JSON.parse((0,I.Z)(t));if(!r.pub||!r.subdomain)return console.error("could not deepPrepare communityChat, subdomain or pub missing from node"),(0,a.tZ)(s.Fragment,{});return(0,a.tZ)("div",{className:"community-chat",dataAttrs:t,children:n?(0,a.tZ)(m.C,(0,i._)({},r)):(0,a.tZ)(m.a,{pub:r.pub,subdomain:r.subdomain})})}catch(e){return console.error("Failed to parse chat embed:",e),(0,a.tZ)(s.Fragment,{})}}(e,t),u):(0,N.pv)(e,"community-post")?D(function(e,t){let{props:{isStatic:n,is_freemail:r}}=t;try{let t=e.getAttribute("data-attrs"),o=JSON.parse((0,I.Z)(t));return n?(0,a.tZ)(h.s,(0,i._)({is_freemail:r},o)):(0,a.tZ)(h.V,(0,i._)({},o))}catch(e){return console.error("Failed to parse chat post embed:",e),(0,a.tZ)(s.Fragment,{})}}(e,t),u):(0,N.pv)(e,"digest-post-embed")?D((0,v.Do)(e,t),u):(0,N.pv)(e,"comment")&&!(0,N.pv)(e,"template-comment")?D(function(e,t){let{props:{isStatic:n}}=t;try{let t=e.getAttribute("data-attrs"),r=JSON.parse((0,I.Z)(t));return n?(0,a.tZ)(k.Eo,(0,i._)({},r)):(0,a.tZ)(Z.d,(0,i._)({},r))}catch(e){return console.error("Failed to parse chat post embed:",e),(0,a.tZ)(s.Fragment,{})}}(e,t),u):(0,N.pv)(e,"referrals-tier-card")?D((0,v.mx)(e,t),u):("undefined"!=typeof window&&(0,N.pv)(e,"file-embed-button")&&"href"in e&&e.href&&!(0,E.x)(e.href,"token")&&(e.href=(0,L.n1t)(e.href,{token:(0,E.x)(window._preloads.original_url,"token")})),"props"in t&&t.props&&"post"in t.props&&t.props.post&&"object"==typeof t.props.post&&"id"in t.props.post&&t.props.post.id&&(0,N.pv)(e,"footnote")&&(e.id&&(e.id+="-".concat(t.props.post.id)),"href"in e&&e.href&&(e.href+="-".concat(t.props.post.id))),(0,N.pv)(e,"footnote-anchor"))?D(U(e,q,t),u):l?null:X(e,q,t)},j=function(e){let t={};for(let{name:n,value:r}of Array.prototype.slice.call(e))t[n]=r;return t},X=(o=(e,t,n,r)=>{var o;if(!e)throw Error("Empty node, cannot preactify!");let u=3===e.nodeType?"span":8===e.nodeType?"x_preact_compatible_html_comment_x":e.tagName.toLowerCase(),c=1!==e.nodeType?{}:j(e.attributes),p=e.children&&e.children.length>0?null:e.textContent;if(r||"script"===u&&e.innerHTML===A.N)return(0,s.h)(u,(0,l._)((0,i._)({},c),{dangerouslySetInnerHTML:{__html:e.innerHTML}}));let m=!!(null===(o=e.parentElement)||void 0===o?void 0:o.getAttribute("data-prose-mirror-wrapper"));if(n&&"pub"in n&&m&&["h1","h2","h3","h4"].includes(u)&&!e.className)return function(e,t,n,r){var o,u,c,p;let m=d()("header-anchor-post",t.className),h=n.children.length?Array.prototype.map.call(n.childNodes,e=>q(e,r)):[n.textContent];return(0,s.h)(e,(0,l._)((0,i._)({},t),{className:m}),...h,(0,a.tZ)(y.Z,{text:null!==(c=n.textContent)&&void 0!==c?c:"",pub:null==r?void 0:r.pub,post:null==r?void 0:null===(o=r.props)||void 0===o?void 0:o.post,offsetTop:!0,isAboutPage:null!==(p=null==r?void 0:null===(u=r.props)||void 0===u?void 0:u.isAboutPage)&&void 0!==p&&p}))}(u,c,e,n);if(p)return(0,s.h)(u,c,p);let h=t(e,n,{shallow:!0});return h||(0,s.h)(u,c,...Array.prototype.map.call(e.childNodes,e=>t(e,n)))},r=0,function(){let e=[].slice.call(arguments,0),t=++r>2500;if(t){var n,i,l;console.error("Too many post nodes to recurse",{postId:null===(l=e[2])||void 0===l?void 0:null===(i=l.props)||void 0===i?void 0:null===(n=i.post)||void 0===n?void 0:n.id,depth:r})}let a=o.apply(null,[...e,...t?[!0]:[]]);return r--,a});function J(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=document.createElement("div");return r.setAttribute("data-prose-mirror-wrapper","1"),r.innerHTML=e,Array.prototype.map.call(r.childNodes,e=>X(e,q,{wrapper:r,pub:t,props:n}))}function V(e){if("undefined"==typeof window)return[];let t=document.createElement("div");t.innerHTML=e;let n=[];for(let e of t.querySelectorAll("h1, h2, h3, h4")){var r,o;let t=e.tagName[1],i=t?parseInt(t):NaN;n.push({level:null!=i?i:0,text:null!==(r=e.textContent)&&void 0!==r?r:"",id:null!==(o=e.id)&&void 0!==o?o:""})}return n}},43148:function(e,t,n){n.d(t,{H:()=>d,o:()=>c});var r=n(16584),o=n(98661),i=n(30396),l=n(15771),a=n(19081),s=n(58175),u=n(12811);let c=(0,o.forwardRef)((e,t)=>{let{onClick:n,children:o,disabled:i=!1,size:a="md"}=e;return(0,r.tZ)(l.GI,{ref:t,rounded:!0,onClick:n,disabled:i,size:a,children:o})}),d=e=>{let{label:t,children:n}=e,[o,l]=(0,i.eJ)(!1);return(0,r.BX)(a.gq,{gap:8,justifyContent:"center",alignItems:"center",children:[t&&(0,r.tZ)(a.gq,{bg:"glass-inverted-medium",justifyContent:"center",alignItems:"center",radius:"sm",paddingY:6,paddingX:8,className:u.Z.verticalMenuLabel,style:{opacity:+!!o},children:(0,r.tZ)(s.xv.B4,{color:"white",children:t})}),(0,r.tZ)("div",{onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:n})]})}},2748:function(e,t,n){n.d(t,{F:()=>i});var r=n(1835),o=n(84864);function i(e,t){var n,i,l,a;let s,u;let c=null===(n=e.name)||void 0===n?void 0:n.trim(),d=c;(0,o.endsWithPunctuation)(c)&&(d='"'.concat(c,'"'));let p=(0,r.Im)(e.contributors);return e.invite_only?(s=null,u=null):(s=(null===(l=e.rankingDetailFreeIncluded)||void 0===l?void 0:l.toLowerCase().includes("subscribers"))?e.rankingDetailFreeIncluded.toLowerCase():null,u=e.rankingDetailFreeIncluded||e.rankingDetail),(0,r.ab)(null!==(a=null!=t?t:null===(i=e.hero_text)||void 0===i?void 0:i.trim())&&void 0!==a?a:"",p,s,d,u)}},70717:function(e,t,n){n.d(t,{w:()=>a});var r=n(16584),o=n(19081),i=n(58175),l=n(84864);let a=e=>{let{duration:t,icon:n,position:a="bottom-left",previewDuration:s}=e;return(0,r.BX)(o.gq,{alignItems:"center",bg:"glass-inverted-medium",gap:6,paddingX:8,paddingY:2,position:"absolute",radius:"sm",style:"bottom-left"===a?{left:8,bottom:8}:{right:8,bottom:8},children:[n,(0,r.tZ)(i.xv.Meta,{color:"white",lineHeight:20,children:s?"".concat((0,l.secondsToHHMMSS)(s)," / ").concat((0,l.secondsToHHMMSS)(null!=t?t:0)):(0,l.secondsToHHMMSS)(null!=t?t:0)})]})}},91246:function(e,t,n){if(n.d(t,{V:()=>f,u:()=>v}),2787!=n.j)var r=n(7409);if(2787!=n.j)var o=n(99282);var i=n(16584);if(2787!=n.j)var l=n(78493);if(2787!=n.j)var a=n(28518);if(2787!=n.j)var s=n(93920);if(2787!=n.j)var u=n(55585);var c=n(98661),d=n(19081),p=n(44424),m=n(42450);let h=2787!=n.j?{padding:0,elementContext:"floating",altBoundary:!1,rootBoundary:"viewport"}:null;function f(e){let{trigger:t,children:n,onOpen:r,onClose:o,disabled:l,stopPropagation:a,placement:s="bottom",matchReferenceWidth:c=!1}=e;return(0,i.tZ)(u.v,{children:e=>{let{open:u}=e;return(0,i.tZ)(g,{trigger:t,children:n,open:u,onOpen:r,onClose:o,disabled:l,stopPropagation:a,placement:s,matchReferenceWidth:c})}})}function g(e){let{trigger:t,children:n,open:f,disabled:g,onOpen:v,onClose:b,stopPropagation:y,placement:_,matchReferenceWidth:w}=e,x=[(0,l.cv)(4),(0,l.RR)()];w&&x.push((0,l.dp)((0,o._)((0,r._)({},h),{apply(e){let{rects:t,elements:n}=e;Object.assign(n.floating.style,{minWidth:"".concat(t.reference.width,"px")})}})));let{refs:Z,floatingStyles:k,context:N}=(0,a.YF)({placement:_,strategy:"fixed",open:f,whileElementsMounted:s.Me,middleware:x}),{getReferenceProps:S,getFloatingProps:C}=(0,a.NI)([(0,a.bQ)(N,{ancestorScroll:!0})]),{isMounted:B,styles:I}=(0,a.Y_)(N,{duration:250,initial:e=>{let{side:t}=e;return{opacity:0,transform:"translate".concat("bottom"===t||"top"===t?"Y":"X","(calc(").concat("bottom"===t||"right"===t?-1:1," * ").concat("var(--size-8)","))")}},open:{opacity:1,transform:"translate(0, 0)"},common:{transition:"var(--animate-hover)"}});return(0,c.useEffect)(()=>{f?null==v||v():null==b||b()},[f]),(0,i.BX)(d.sg,{onClick:e=>{y&&e.stopPropagation()},children:[(0,i.tZ)(u.v.Button,(0,o._)((0,r._)({as:c.Fragment,ref:Z.setReference},S()),{disabled:g,children:t})),(0,i.tZ)(a.ll,{children:B&&(0,i.tZ)(u.v.Items,(0,o._)((0,r._)({className:m.Z.floatingContainer,ref:Z.setFloating,style:k,static:!0},C()),{children:(0,i.tZ)(p.ep,{style:I,children:n})}))})]})}function v(e){return(0,i.tZ)(u.v.Item,{children:(0,i.tZ)(p.sN,(0,r._)({},e))})}},15186:function(e,t,n){if(n.d(t,{Z:()=>h,j:()=>b}),2787!=n.j)var r=n(7409);if(2787!=n.j)var o=n(99282);var i=n(16584);if(2787!=n.j)var l=n(49550);var a=n(98661),s=n(95441),u=n(15771),c=n(80026),d=n(17172),p=n(45783),m=n(20346);function h(e){let{tabs:t,value:n,onChange:u,ariaLabel:h}=e,{iString:b}=(0,s.M1)(),y=(0,a.useRef)(null),_=(0,a.useRef)(null),{props:w,hasOverflow:x}=(0,d.aZ)(y),{state:Z}=(0,p.eK)(y),k=e=>{let t=_.current,n=y.current;if(!n||!t||e<0)return;let r=n.getElementsByClassName(m.Z.segment)[e];if(!r)return;let o=r.getBoundingClientRect(),i=n.getBoundingClientRect(),l=parseInt(window.getComputedStyle(n).paddingLeft),a=o.left-i.left-l+n.scrollLeft;requestAnimationFrame(()=>{t.style.setProperty("--highlight-width","".concat(o.width,"px")),t.style.setProperty("--highlight-x","".concat(a,"px"))})},N=t.findIndex(e=>e.value===n);return(0,a.useLayoutEffect)(()=>{k(N)},[t,n,N]),(0,a.useEffect)(()=>{k(N)},[t,n,N]),(0,i.BX)(g,{children:[(0,i.tZ)(l.O.Group,{manual:!0,selectedIndex:-1===N?0:N,onChange:e=>{var n;let r=null===(n=t[e])||void 0===n?void 0:n.value;void 0!==r&&u(r)},children:(0,i.tZ)(l.O.List,(0,o._)((0,r._)({as:c.X2},w),{ref:y,className:m.Z.container,position:"relative",cursor:x()?"grab":"default",gap:4,padding:4,radius:"sm",overflow:"auto",scrollBar:"hidden",outline:"detail","aria-label":null!=h?h:"".concat(b("Tabs")),children:()=>(0,i.BX)(i.HY,{children:[t.map((e,t)=>(0,i.tZ)(f,{tab:e,index:t,children:e.label},e.value)),(0,i.tZ)(v,{ref:_})]})}))}),(0,i.tZ)(p.R3,{direction:"left",isVisible:Z.showLeft}),(0,i.tZ)(p.R3,{direction:"right",isVisible:Z.showRight})]})}function f(e){let{tab:t,index:n,children:r}=e;return(0,i.tZ)(l.O,{as:a.Fragment,children:e=>{let{selected:o}=e;return(0,i.tZ)(u.zx,{className:m.Z.segment,leading:t.leadingIcon,trailing:t.trailingIcon,priority:o?"tertiary":"quaternary",size:"sm",children:r},n)}})}let g=(0,c.zo)({display:"flex",direction:"column",position:"relative",bg:"primary",radius:"sm",minWidth:0,overflow:"hidden"}),v=(0,c.zo)({position:"absolute",height:32,radius:"xs",bg:"secondary",sizing:"border-box",className:m.Z.highlight}),b=(0,c.zo)({display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24})},18967:function(e,t,n){n.d(t,{E4:()=>o,ML:()=>i});var r,o=2787!=n.j?((r={}).CompOneMonth="comp_one_month",r.CompThreeMonths="comp_three_months",r.CompSixMonths="comp_six_months",r.CompNineMonths="comp_nine_months",r.CompTwelveMonths="comp_twelve_months",r.Custom="custom",r):null;let i={comp_one_month:"1 month comp",comp_three_months:"3 month comp",comp_six_months:"6 month comp",comp_nine_months:"9 month comp",comp_twelve_months:"12 month comp",custom:"Custom"}},86551:function(e,t,n){n.d(t,{BN:()=>C,F2:()=>S,Fp:()=>E,HQ:()=>k,Lb:()=>Z,R_:()=>O,S_:()=>B,T6:()=>P,U0:()=>x,Ui:()=>F,aZ:()=>T,op:()=>L,pw:()=>I,sj:()=>N,tX:()=>A});var r=n(58865),o=n(60826),i=n(68833),l=n(60308),a=n(63651),s=n(84864),u=n(47929),c=n(68303),d=n(39947);function p(){let e=(0,r._)(["Start writing today. Use the button below to create a Substack of your own"]);return p=function(){return e},e}function m(){let e=(0,r._)(["Share ",""]);return m=function(){return e},e}function h(){let e=(0,r._)(["Get ","% off a group subscription"]);return h=function(){return e},e}function f(){let e=(0,r._)(["Get a group subscription"]);return f=function(){return e},e}function g(){let e=(0,r._)(["Give a gift subscription"]);return g=function(){return e},e}function v(){let e=(0,r._)(["","! Subscribe for free to receive new posts and support my work."]);return v=function(){return e},e}function b(){let e=(0,r._)(["",". To receive new posts and support my work, consider becoming a free or paid subscriber."]);return b=function(){return e},e}function y(){let e=(0,r._)(["","! This post is public so feel free to share it."]);return y=function(){return e},e}function _(){let e=(0,r._)(["Thanks for reading ","! Subscribe for free to receive new posts and support my work."]);return _=function(){return e},e}function w(){let e=(0,r._)([""," is a reader-supported publication. To receive new posts and support my work, consider becoming a free or paid subscriber."]);return w=function(){return e},e}let x=e=>(t,n)=>{let{iString:r}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let i={url:"".concat(o.W.CHECKOUT_URL,"&donate=true"),text:r("Donate Subscriptions")};return n&&n((0,c.o4)(t,t.schema.nodes.button.create(i))),!0},Z=e=>(t,n)=>{let{iString:r}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let i={url:"".concat(o.W.LEADERBOARD_URL,"&utm_source=").concat(u.b3.post),text:r("Refer a friend")};return n&&n((0,c.o4)(t,t.schema.nodes.button.create(i))),!0},k=e=>{let{writerReferralCode:t,publication:n,postId:r}=e;return(e,o)=>{let{iString:i,iTemplate:a}=I18N.i({pub:n});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!e.schema.nodes.captionedWriterReferralButton)return console.error("captionedWriterReferralButton node type not found in schema"),!1;if(!e.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let s=a(p()),m={url:"".concat((0,l.Fnz)(t||""),"?utm_source=").concat(u.b3.substack,"&utm_context=").concat(u.gD.post,"&utm_content=").concat(r,"&utm_campaign=").concat(u.VX.writerReferralButton),text:i("Start a Substack")},h=e.schema.nodes.captionedWriterReferralButton.create(m,e.schema.nodes.ctaCaption.create(null,[e.schema.text(s)]));return o&&o((0,c.o4)(e,h)),!0}},N=e=>(t,n)=>{let{iString:r}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let i={url:o.W.HALF_MAGIC_COMMENTS_URL,text:r("Leave a comment")};return n&&n((0,c.o4)(t,t.schema.nodes.button.create(i))),!0},S=(e,t,n)=>(r,o)=>{if((0,i.j)(i.FP.READER_SURVEY_LINKED_IN_POST,{editorVersion:"1",surveyId:t.id}),!r.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(r,r.schema.nodes.button))return!1;let l={url:"".concat((0,a.h8g)(e,t.id)),text:n};return o&&o((0,c.o4)(r,r.schema.nodes.button.create(l))),!0},C=e=>(t,n)=>{let{iString:r}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let i={url:o.W.SHARE_URL,text:r("Share")};return n&&n((0,c.o4)(t,t.schema.nodes.button.create(i))),!0},B=e=>(t,n)=>{let{iTemplate:r}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let i={url:o.W.SHARE_PUB_URL,text:r(m(),e.name)};return n&&n((0,c.o4)(t,t.schema.nodes.button.create(i))),!0},I=e=>{let{couponPub:t,scrollParent:n,parentClass:r,get_coupons:o,insert_coupon:i,SelectField:a,openPrompt:s,closePrompt:u,getNetworkErrorMessage:c}=e;return(e,p,m)=>{let{iString:h}=I18N.i({pub:t});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let f={parentClass:r,root:n?document.querySelector(".".concat(n)):m.dom.parentNode,scrollParent:n,offsetTop:10},g=Object.assign({title:h("Loading..."),no_buttons:!0,language:t.language},f);return s(g),o().then(n=>{u(g);let r=n.map(e=>{var t;return{label:null!==(t=e.name)&&void 0!==t?t:"",value:e}}).concat([{label:h("Create new offer"),value:{create_new:!0}}]),o={coupon:new a({label:h("Select offer..."),required:!0,options:r,onChange:n=>{if(n&&"create_new"in n&&n.create_new){u(c);let n=window.open("".concat((0,l.SVA)(t),"/publish/offers/new?popup=true"),"_blank");n&&n.addEventListener&&n.addEventListener("message",t=>{let{data:n}=t;n&&n.coupon&&i({coupon:n.coupon,state:e,dispatch:p,schema:e.schema})},!1)}}})},c=Object.assign({title:h("Special Offer"),fields:o,language:null==t?void 0:t.language,onSubmit:t=>{let{coupon:n}=t;i({coupon:n,state:e,dispatch:m.dispatch,schema:e.schema})},onClose:()=>{m.focus()}},f);s(c)}).catch(e=>{u(g),alert(c(e))}),!1}},L=e=>{let{scrollParent:t,parentClass:n,TextField:r,openPrompt:o,publication:i}=e;return(e,l,a)=>{let{iString:s}=I18N.i({pub:i});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let u={parentClass:n,title:s("Create a button"),root:t?document.querySelector(".".concat(t)):a.dom.parentNode,scrollParent:t,offsetTop:10,language:null==i?void 0:i.language,fields:{text:new r({label:s("Enter text..."),required:!0,clean:e=>(e||"").trim(),validate:e=>{if(e.length>40)return s("Too long")}}),href:new r({label:s("Enter URL..."),required:!0,clean:e=>(e||"").trim(),validate:e=>{if(!/^%%.*%%$/.test(e)){try{let t=new URL(e);if(["http:","https:","mailto:"].includes(t.protocol))return}catch(e){}return s("Invalid URL")}}})}};return u.onSubmit=t=>{let n={url:t.href,text:t.text};if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;l&&a.dispatch((0,c.o4)(e,e.schema.nodes.button.create(n)))},u.onClose=()=>{a.focus()},o(u),!0}},E=e=>{let{publication:t}=e;return(e,n)=>{let{iTemplate:r}=I18N.i({pub:t});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let i=t.default_group_coupon,l={url:"".concat(o.W.CHECKOUT_URL,"group=true").concat(i?"&coupon=".concat(i):""),text:(0,s.getSubscriptionSentenceWithCustomWords)(t,()=>{var e;return i&&t.default_group_coupon_percent_off?r(h(),null!==(e=t.default_group_coupon_percent_off.split(".")[0])&&void 0!==e?e:""):r(f())},e=>i&&t.default_group_coupon_percent_off?"Get ".concat(t.default_group_coupon_percent_off.split(".")[0],"% off a group ").concat(e.subscription):"Get a group ".concat(e.subscription))};return n&&n((0,c.o4)(e,e.schema.nodes.button.create(l))),!0}},T=e=>(t,n)=>{let{iTemplate:r}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let i={url:"".concat(o.W.CHECKOUT_URL,"&gift=true"),text:(0,s.getSubscriptionSentenceWithCustomWords)(e,()=>r(g()),e=>"Give a gift ".concat(e.subscription))};return n&&n((0,c.o4)(t,t.schema.nodes.button.create(i))),!0},A=e=>(t,n)=>{if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let r={url:o.W.CHECKOUT_URL,text:(0,s.getSubscribeText)(e,{now:!0}),language:e.language};return n&&n((0,c.o4)(t,t.schema.nodes.button.create(r))),!0},F=e=>(t,n)=>{let{iTemplate:r}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!t.schema.nodes.subscribeWidget)return console.error("subscribeWidget node type not found in schema"),!1;if(!t.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let i="enabled"!==e.payments_state?r(v(),e.author_name===e.name?"Thanks for reading":"Thanks for reading ".concat(e.name)):r(b(),e.author_name===e.name?"This Substack is reader-supported":"".concat(e.name," is a reader-supported publication")),l={url:o.W.CHECKOUT_URL,text:(0,s.getSubscribeText)(e),language:e.language},a=t.schema.nodes.subscribeWidget.create(l,[t.schema.nodes.ctaCaption.create(null,[t.schema.text(i)])]);return n&&n((0,c.o4)(t,a)),!0},P=e=>(t,n)=>{let{iString:r,iTemplate:i}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!t.schema.nodes.captionedShareButton)return console.error("captionedShareButton node type not found in schema"),!1;if(!t.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let l=i(y(),e.author_name===e.name?"Thanks for reading":"Thanks for reading ".concat(e.name)),a={url:o.W.SHARE_URL,text:r("Share")},s=t.schema.nodes.captionedShareButton.create(a,t.schema.nodes.ctaCaption.create(null,[t.schema.text(l)]));return n&&n((0,c.o4)(t,s)),!0},O=e=>(t,n)=>{let{tr:r}=t,{iTemplate:i,iString:l}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!t.schema.nodes.subscribeWidget)return console.error("captionedShareButton node type not found in schema"),!1;if(!t.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let a=e.author_name===e.name?l("enabled"!==e.payments_state?"Thanks for reading! Subscribe for free to receive new posts and support my work.":"This Substack is reader-supported. To receive new posts and support my work, consider becoming a free or paid subscriber."):i("enabled"!==e.payments_state?_():w(),e.name),u={url:o.W.CHECKOUT_URL,text:(0,s.getSubscribeText)(e),language:e.language},c=0,p=null;return t.doc.descendants((e,t)=>{var n;return(null===(n=e.type)||void 0===n?void 0:n.name)==="paragraph"&&2==++c&&(p=t+e.nodeSize),!1}),c>=5&&null!==p&&r.insert(p,t.schema.nodes.subscribeWidget.create(u,[t.schema.nodes.ctaCaption.create(null,[t.schema.text(a)])])),r.insert(r.doc.content.size,t.schema.nodes.subscribeWidget.create(u,[t.schema.nodes.ctaCaption.create(null,[t.schema.text(a)])])),n&&n(r),!0}},57208:function(e,t,n){n.d(t,{Er:()=>o,LC:()=>l,f2:()=>i});var r=n(68303);let o=e=>!(0,r.DY)(e.doc.toJSON(),e=>"paywall"===e.type),i=e=>(t,n)=>{if(!o(t))return!1;let{schema:r,tr:i}=t,a=r.nodes.paywall.create();return 1===i.selection.anchor?l(e)(t,n):(i.insert(i.selection.anchor,a),n&&(n(i),e()),!0)},l=e=>(t,n)=>{if(!o(t))return!1;let{schema:r,tr:i}=t,l=r.nodes.paywall.create(),a=0,s=0;for(;a<10&&s<3;){let e=t.doc.resolve(a).nodeAfter;if(!e)break;a+=e.nodeSize,s++}return i.insert(a,l),n&&(n(i),e()),!0}},37175:function(e,t,n){n.r(t),n.d(t,{EMPTY_DOC:()=>tm,HEADER_IMAGE_ATTRS_FROM_NODE_TYPE:()=>th,addIdsToHeaders:()=>tM,checkForUnpublishableComments:()=>t4,checkForUnsafeLinks:()=>t2,createStringDoc:()=>t7,customMediaNodes:()=>tg,extractTags:()=>t$,fromHtml:()=>tU,getCoverImage:()=>tJ,getCoverImages:()=>tQ,getDefaultPodcastDescriptionWithoutFeedCTAs:()=>t9,getDescription:()=>tX,getDimensionsFromImageUrl:()=>tp,getFirstImageFromBody:()=>tY,getHeaderImageFromBody:()=>tG,getImageUrlsFromPostBody:()=>tK,getImagesFromBody:()=>tV,getLinks:()=>t8,getPreviewImageUrl:()=>t0,hasExplicitPaywall:()=>ne,migrateMarkdown:()=>tD,migratePost:()=>tq,migrateProsemirrorToTiptap:()=>tE,migratePublication:()=>tj,migrateTiptapToProsemirror:()=>tT,nodeToHtml:()=>tR,normalizeDbPodcastDescriptionToHtmlString:()=>t5,purgeUnsafeLinks:()=>t3,schema:()=>t_,schemaStatic:()=>tw,serializeDoc:()=>tO,serializedToPodcastDescription:()=>tz,setBelowTheFoldAttribute:()=>t6,setButtonActions:()=>t1,tipTapNodes:()=>tC,tipTapSchema:()=>tB,toHtml:()=>tH,toText:()=>tW,trackedCustomNodes:()=>tb,unserializeDoc:()=>tF,unserializeDocAsync:()=>tP,unserializeJson:()=>tA});var r=n(7409),o=n(99282),i=n(88897),l=n(19512),a=n(56070),s=n(18490),u=n(24717),c=n(56782),d=n(43557),p=n(99961),m=n(18e3),h=n(51127),f=n(67338),g=n(75481),v=n(55786),b=n(32018),y=n(91077),_=n(87597),w=n(94886),x=n(99218),Z=n(55963),k=n(21803),N=n(76405),S=n(39693),C=n.n(S),B=n(14293),I=n.n(B),L=n(44908),E=n.n(L),T=n(60826),A=n(24791),F=n(40121),P=n(5889),O=n(60308),R=n(84864),M=n(5835),H=n(26603),W=n(57937),z=n(55633),$=n(1451),U=n(44262),D=n(41676),q=n(82032),j=n(95068),X=n(99605),J=n(12568),V=n(65626),Y=n(37622),G=n(36621),K=n(31188),Q=n(71993),ee=n(88954),et=n(13991),en=n(36122),er=n(72270),eo=n(82167),ei=n(47456),el=n(32978),ea=n(40924),es=n(86725),eu=n(59383),ec=n(5660),ed=n(1415),ep=n(98616),em=n(82708),eh=n(73984),ef=n(11105),eg=n(10218),ev=n(98738),eb=n(81519),ey=n(59662),e_=n(60511),ew=n(75837),ex=n(29961),eZ=n(24653),ek=n(80334),eN=n(94413),eS=n(75970),eC=n(715),eB=n(87113),eI=n(98450),eL=n(87413),eE=n(69323),eT=n(61601),eA=n(57639),eF=n(54793),eP=n(29511),eO=n(49640),eR=n(99975),eM=n(41128),eH=n(23431),eW=n(73078),ez=n(85197),e$=n(53797),eU=n(99741),eD=n(3185),eq=n(8220),ej=n(18119),eX=n(44288),eJ=n(13938),eV=n(54757),eY=n(11006),eG=n(11470),eK=n(66928),eQ=n(19805),e0=n(46393),e1=n(2107),e8=n(99149),e4=n(79592),e2=n(62645),e3=n(39111),e6=n(42034),e5=n(41505),e9=n(57950),e7=n(78483),te=n(57881),tt=n(84766),tn=n(62092),tr=n(68303),to=n(88956),ti=n(22498),tl=n(22365),ta=n(60802),ts=n(45913),tu=n(12076),tc=n(34612),td=n(32751);let tp=e=>{var t,n,r,o;let[i,l]=((null===(o=e.split("_"))||void 0===o?void 0:null===(r=o[1])||void 0===r?void 0:null===(n=r.split("."))||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.split("x"))||[0,0]).map(Number);return{width:i||0,height:l||0}},tm={type:"doc",content:[{type:"paragraph"}]},th={captionedImage:e=>{var t,n,r,o;let i=null===(t=e.content)||void 0===t?void 0:t.find(e=>{var t,n;return"image2"===e.type&&(null===(t=e.attrs)||void 0===t?void 0:t.width)>=300&&(null==e?void 0:null===(n=e.attrs)||void 0===n?void 0:n.height)>=300});if(!i)return{url:null,caption:void 0,alt:void 0};let l=null==e?void 0:null===(n=e.content)||void 0===n?void 0:n.find(e=>"caption"===e.type);return{url:null==i?void 0:null===(r=i.attrs)||void 0===r?void 0:r.src,caption:l,alt:null==i?void 0:null===(o=i.attrs)||void 0===o?void 0:o.alt}},image2:e=>{var t,n,r,o;return"number"!=typeof(null===(t=e.attrs)||void 0===t?void 0:t.width)&&"number"!=typeof(null===(n=e.attrs)||void 0===n?void 0:n.height)||e.attrs.width>=300&&e.attrs.height>=300?{url:null==e?void 0:null===(r=e.attrs)||void 0===r?void 0:r.src,alt:null==e?void 0:null===(o=e.attrs)||void 0===o?void 0:o.alt}:{url:null,caption:void 0,alt:void 0}},image3:e=>{var t,n,r,o,i;let l=tp(null===(t=e.attrs)||void 0===t?void 0:t.src);return"number"!=typeof(null===(n=e.attrs)||void 0===n?void 0:n.width)&&"number"!=typeof(null===(r=e.attrs)||void 0===r?void 0:r.height)||e.attrs.width>=300&&e.attrs.height>=300||l.width>=300&&l.height>=300?{url:null===(o=e.attrs)||void 0===o?void 0:o.src,caption:e.content,alt:null===(i=e.attrs)||void 0===i?void 0:i.alt}:{url:null,caption:void 0,alt:void 0}}},tf={image:e=>{var t;return t0(null===(t=e.attrs)||void 0===t?void 0:t.src)},image2:e=>{var t,n,r;return"number"!=typeof(null===(t=e.attrs)||void 0===t?void 0:t.width)&&"number"!=typeof(null===(n=e.attrs)||void 0===n?void 0:n.height)||e.attrs.width>=300&&e.attrs.height>=300?t0(null===(r=e.attrs)||void 0===r?void 0:r.src):null},image3:e=>{var t,n,r,o;let i=tp(null===(t=e.attrs)||void 0===t?void 0:t.src);return"number"!=typeof(null===(n=e.attrs)||void 0===n?void 0:n.width)&&"number"!=typeof(null===(r=e.attrs)||void 0===r?void 0:r.height)||e.attrs.width>=300&&e.attrs.height>=300||i.width>=300&&i.height>=300?t0(null===(o=e.attrs)||void 0===o?void 0:o.src):null},imageGallery:e=>{var t,n,r;return t0(null===(r=e.attrs)||void 0===r?void 0:null===(n=r.gallery.images)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.src)},spotify:e=>{var t;return t0(null===(t=e.attrs)||void 0===t?void 0:t.image)},spotify2:e=>{var t;return t0(null===(t=e.attrs)||void 0===t?void 0:t.image)},opensea:e=>{var t;return t0(null===(t=e.attrs)||void 0===t?void 0:t.image)},twitter2:e=>{var t,n;if(null===(t=e.attrs)||void 0===t?void 0:t.photos){for(let t of e.attrs.photos)if(t.img_url)return t0(t.img_url)}return(null===(n=e.attrs)||void 0===n?void 0:n.expanded_url)&&e.attrs.expanded_url.image?e.attrs.expanded_url.image.url?t0(e.attrs.expanded_url.image.url):t0(e.attrs.expanded_url.image):null},vimeo:e=>{var t;return ts.Jn(null===(t=e.attrs)||void 0===t?void 0:t.videoId,{playButton:!1})},youtube:e=>{var t;return td.Jn(null===(t=e.attrs)||void 0===t?void 0:t.videoId,{playButton:!1})},youtube2:e=>{var t;return td.Jn(null===(t=e.attrs)||void 0===t?void 0:t.videoId,{playButton:!1})},kindle:e=>{var t;return(0,O.zF4)(null===(t=e.attrs)||void 0===t?void 0:t.imageUrl)},applePodcast:e=>{var t;return(0,O.zF4)(null===(t=e.attrs)||void 0===t?void 0:t.imageUrl)},tiktok:e=>{var t;return(0,O.zF4)(null===(t=e.attrs)||void 0===t?void 0:t.thumbnail_url)},prediction_market:e=>{var t;return(0,O.zF4)(null===(t=e.attrs)||void 0===t?void 0:t.thumbnail_url)},manifold:e=>{var t;return(0,O.zF4)(null===(t=e.attrs)||void 0===t?void 0:t.thumbnail_url)},lichess:e=>{var t;return(0,O.zF4)(null===(t=e.attrs)||void 0===t?void 0:t.thumbnail_url)},datawrapper:e=>{var t;return(0,O.zF4)(null===(t=e.attrs)||void 0===t?void 0:t.thumbnail_url)},pinterest:e=>{var t;return t0(null===(t=e.attrs)||void 0===t?void 0:t.image)}},tg={augmentation_placeholder:$.$,youtube2:td.$y,youtube:tc.$,vimeo:ts.$y,install_substack_app:eO.$,preview_in_substack_app:eV.$,opensea:e$.$y,twitter2:tt.$y,twitter:te.$,communityChat:ee.$y,communityPost:et.$y,comment:Q.$y,spotify2:e4.$y,spotify:e8.$,soundcloud:e0.$y,instagram:eP.$y,image2:eA.$y,image:eE.$,button:j.$y,comic:K.Z.nodeSpec,file:K.Z.nodeSpec,pdf:eD.Z.nodeSpec,xlsx:tu.Z.nodeSpec,ebook:el.Z.nodeSpec,referral_link:eK.$,bandcamp:U.$y,kindle:eR.$y,gitgist:eL.$y,embeddedPost:ea.$y,embeddedPublication:es.$y,applePodcast:M.$y,audio:W.$y,video:ta.$,audioUrl:z.$y,tiktok:e7.$y,bluesky:q.$y,poll:ej.$,sponsorshipCampaign:e1.$,imageGallery:eT.$y,image3:eF.$y,cashtag:G.$,substack_mentions:ez.$,prediction_market:eX.$y,manifold:eX.$y,lichess:eH.$y,datawrapper:er.$y,digestPostEmbed:eo.$y,assetError:H.$,directMessage:ei.$y,recipe:eG.$,pinterest:eq.$y},tv=(0,o._)((0,r._)({},tg),{blockquote:D.$,calloutBlock:X.$,fragmentNode:eI.$,captionedImage:Y.$,caption:J.$,ctaCaption:en.$,footnote:eC.$,footnoteAnchor:eB.$,latex_block:eM.$y,paywall:eU.$,preformatted_text_block:eJ.$,pullquote:eY.$,subscribeWidget:e3.$,captionedShareButton:(0,V.$y)({url:T.W.SHARE_URL}),captionedWriterReferralButton:(0,V.$y)({hasDynamicSubstitutions:!1}),templateComment:e9.$,meeting:eW.$,referralTier:eQ.$y}),tb=(0,o._)((0,r._)({},tg),{subscribeWidget:e3.$,paywall:eU.$,templateComment:e9.$}),ty={strikethrough:e2.J,superscript:e5.O,subscript:e6.l},t_=new N.V_({nodes:tI(),marks:tL()}),tw=new N.V_({nodes:tI({isStatic:!0}),marks:tL({isStatic:!0})}),tx=Object.keys(tv).filter(e=>!["blockquote","pullquote","calloutBlock"].includes(e)).map(e=>{let t=(0,tr.Co)(e,tv[e]),n=(0,r._)({},tv[e],t);return"youtube2"===e?n.addNodeView=()=>e=>{let{node:t}=e;return new td.dQ(t)}:"tiktok"===e?n.addNodeView=()=>e=>{let{node:t}=e;return new e7.QZ(t)}:"lichess"===e?n.addNodeView=()=>e=>{let{node:t}=e;return new eH.$1(t)}:"datawrapper"===e?n.addNodeView=()=>e=>{let{node:t}=e;return new er.s3(t)}:"prediction_market"===e||"manifold"===e?n.addNodeView=()=>e=>{let{node:t}=e;return new eX.eC(t)}:"paywall"===e?n.addNodeView=()=>e=>new eU.b:"latex_block"===e?n.addNodeView=()=>e=>{let{node:t}=e;return new eM.Jd(t)}:"comic"===e?n.addNodeView=()=>e=>{let{node:t,editor:n,getPos:r}=e;return K.Z.getNodeView({node:t,editor:n,getPos:r})}:"pdf"===e?n.addNodeView=()=>e=>{let{node:t,editor:n,getPos:r}=e;return eD.Z.getNodeView({node:t,editor:n,getPos:r})}:"xlsx"===e?n.addNodeView=()=>e=>{let{node:t,editor:n,getPos:r}=e;return tu.Z.getNodeView({node:t,editor:n,getPos:r})}:"ebook"===e&&(n.addNodeView=()=>e=>{let{node:t,editor:n,getPos:r}=e;return el.Z.getNodeView({node:t,editor:n,getPos:r})}),i.NB.create(n)}),tZ=l.V6.extend({addCommands(){return{toggleBlockquote:()=>e=>{let{state:t,commands:n}=e;return!(!(0,i.Ig)(t,"paragraph")||(0,i.Ig)(t,"pullquote")||(0,i.Ig)(t,"calloutBlock"))&&n.toggleWrap(this.name)}}},parseHTML:()=>D.$.parseDOM}),tk=l.V6.extend({name:"calloutBlock",addCommands(){return{toggleCalloutBlock:()=>e=>{let{state:t,commands:n}=e;if((0,i.Ig)(t,"calloutBlock"))return n.lift("calloutBlock");if((0,i.Ig)(t,"paragraph")||(0,i.Ig)(t,"button"))return!((0,i.Ig)(t,"pullquote")||(0,i.Ig)(t,"blockquote"))&&n.toggleWrap(this.name);let r=[t.schema.nodes.paragraph,t.schema.nodes.button].filter(e=>!!e),o=!0;return t.doc.nodesBetween(t.selection.from,t.selection.to,(e,n,i,l)=>{if(i===t.doc&&(e.type===t.schema.nodes.blockquote||e.type===t.schema.nodes.pullquote||!r.includes(e.type)))return o=!1,!1}),!(!o||(0,i.Ig)(t,"pullquote")||(0,i.Ig)(t,"blockquote"))&&n.toggleWrap(this.name)}}},parseHTML:()=>[{tag:"div[data-callout]",priority:100},{tag:"div.callout-block",priority:99}],renderHTML:()=>["div",{class:"callout-block","data-callout":"true"},0]}),tN=f.b.extend({addCommands:()=>({insertHorizontalRule:()=>e=>{let{state:t,dispatch:n}=e;return n&&t.schema.nodes.horizontalRule&&n((0,tr.o4)(t,t.schema.nodes.horizontalRule.create())),!0},setHorizontalRule:()=>e=>{let{state:t,dispatch:n}=e;if(n){if(!t.schema.nodes.horizontalRule)return console.error("horizontalRule is missing"),!1;n((0,tr.o4)(t,t.schema.nodes.horizontalRule.create()))}return!0}})}),tS=c.dn.extend({marks:"_"}),tC=[tZ,a.d8,s.DY,ec.z,tk,u.EK,tS,ep.l,d.B,eh.w,p.U,m.X,h.A,tN,eu.M,eS.f,eg._,eb.r,ew.q,ek.a,ex.R,e_.q,ef.y,g.Tx,ev.d,v.H,b.GS,y.n,ey.f,eY.z,_.Re,w.a,x.$,Z.x,ed.n,eN.T,em.k,ei.e1,...tx],tB=(0,i.J1)(tC);function tI(){let{isStatic:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=k.fK.spec.nodes;for(let n of Object.keys(tv)){let r=Object.assign({},tv[n]);e&&r.toDOMStatic&&(r.toDOM=r.toDOMStatic),delete r.toDOMStatic,t=t.get(n)?t.update(n,r):t.addToEnd(n,r)}return t}function tL(){let{isStatic:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=k.fK.spec.marks;for(let n of Object.keys(ty)){let r=Object.assign({},ty[n]);e&&r.toDOMStatic&&(r.toDOM=r.toDOMStatic),delete r.toDOMStatic,t=t.get(n)?t.update(n,r):t.addToEnd(n,r)}return t}function tE(e){let{postId:t,pubId:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e;return"string"==typeof r&&(r=tA(r,{postId:t,pubId:n})),(0,tr.cb)(r,e=>{let t=tr.qj.find(t=>t[0]===e.type);return t&&(e.type=t[1],e.attrs&&"orderedList"===t[1]&&(e.attrs.start=e.attrs.order)),e.marks&&e.marks.forEach(e=>{let t=tr.PH.find(t=>t[0]===e.type);t&&(e.type=t[1])}),e}),r}function tT(e){let{postId:t,pubId:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e;return"string"==typeof r&&(r=tA(r,{postId:t,pubId:n})),(0,tr.cb)(r,e=>{let t=tr.qj.find(t=>t[1]===e.type);return t&&(e.type=t[0],e.attrs&&"ordered_list"===t[0]&&(e.attrs.order=e.attrs.start)),e.marks&&e.marks.forEach(e=>{let t=tr.PH.find(t=>t[1]===e.type);t&&(e.type=t[0])}),e}),r}function tA(e){let t,{postId:n,pubId:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&(e=(e=e.replace("http://substack-post-media","https://substack-post-media")).replace("http://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984","https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984")),e=tD(e))try{t=JSON.parse(e)}catch(t){console.error("unserializeJson for post [".concat(n,"], pubId [").concat(r,"], could not parse serialized:"),e,t)}return null!=t?t:void 0}function tF(e){let{customSchema:t,useTiptap:n,mutateJson:r,shouldSetBelowTheFoldAttribute:o=!1,shouldThrowOnInvalid:i,postId:l,pubId:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let i=tA(e,{postId:l,pubId:a})||tm;r&&r(i);let s=t3(i);if(!s)throw Error("could not purgeUnsafeLinks");let u=s;return o&&(u=t6(u)),u=n?tE(u,{postId:l,pubId:a}):tT(u,{postId:l,pubId:a}),(t||t_).nodeFromJSON(u)}catch(n){if(console.error("Failed to parse JSON for post [".concat(l,"], serialized:"),e,n),i)throw Error("Failed to parse JSON:  ".concat(n.message));return(t||t_).nodeFromJSON(tm)}}async function tP(e){let{customSchema:t,useTiptap:n,mutateJson:r,shouldSetBelowTheFoldAttribute:o=!1,shouldThrowOnInvalid:i,postId:l,pubId:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let i=tA(e,{postId:l,pubId:a})||tm;r&&await r(i);let s=t3(i);if(!s)throw Error("could not purgeUnsafeLinks");let u=s;return o&&(u=t6(u)),u=n?tE(u,{postId:l,pubId:a}):tT(u,{postId:l,pubId:a}),(t||t_).nodeFromJSON(u)}catch(n){if(console.error("Failed to parse JSON for post [".concat(l,"], serialized:"),e,n),i)throw Error("Failed to parse JSON:  ".concat(n.message));return(t||t_).nodeFromJSON(tm)}}function tO(e){let{runMigrations:t=!1,postId:n,pubId:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.toJSON();return t&&(o=tT(o=t3(o=function(e){let{postId:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="string"==typeof e?tA(e,{postId:t}):e;return(0,tr.cb)(n,e=>{e.text&&(e.text=(0,R.stripInvalidBytes)(e.text))},{nodeTypes:["text"]}),n}(o)),{postId:n,pubId:r})),JSON.stringify(o)}function tR(e,t){let n=document.createElement("div");return n.appendChild(N.PW.fromSchema(t?tw:t_).serializeFragment(N.HY.fromArray([e]),{document})),n}function tM(e){Array.from(e.querySelectorAll("h2, h3, h4, h5, h6")).forEach(e=>{if(!e.getAttribute("id")){var t,n;let r=(n=e.textContent||"",(0,F.Hm)((0,R.truncateText)(n,500,{ellipsis:""}),{allowUnicode:!0})),o=document.createElement("div");o.setAttribute("id",r),o.setAttribute("class","anchor-target"),null===(t=e.parentNode)||void 0===t||t.insertBefore(o,e);let i=document.createElement("a");for(i.setAttribute("href","#".concat(r));e.firstChild;)i.appendChild(e.firstChild);e.appendChild(i)}})}function tH(e,t){let{isAmp:n,transform:r,useTipTap:o,pubId:i,postId:l}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(o){let n=tE(tA(e,{postId:l,pubId:i}),{postId:l,pubId:i});if(!n)throw Error("could not serialize json doc");return(0,tl.e)({doc:n,extensions:(0,eZ.p)({isStatic:null!=t&&t}),customDocument:document})}let a=tF(e,{shouldSetBelowTheFoldAttribute:!0,postId:l,pubId:i}),s=N.PW.fromSchema(t?tw:t_),u=document.createElement("div");try{s.serializeFragment(a.content,{document},u)}catch(e){return console.error("could not serialize fragment, for pubId [".concat(i,"], postId [").concat(l,"]"),e),u.innerHTML}return r&&r(u),n&&function(e){Array.from(e.querySelectorAll("img")).forEach(e=>{let t=document.createElement("amp-img");t.setAttribute("layout","intrinsic"),e.getAttributeNames().forEach(n=>{var r;"srcset"!==n&&t.setAttribute(n,null!==(r=e.getAttribute(n))&&void 0!==r?r:"null")}),e.replaceWith(t)})}(u),u.innerHTML}function tW(e,t){let{postId:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,tr.lr)(tF(e,{postId:n}),t)}function tz(e){let{postId:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,tr.fX)(tF(e,{postId:t}))}function t$(e){let{postId:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,tr.E5)(tF(e,{postId:t}))}function tU(e){let{stripEmptyParagraphs:t,postId:n,pubId:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=N.aw.fromSchema(t_).parse(new DOMParser().parseFromString(e,"text/html"));return(t&&(o=(0,to.Y)(o,e=>!e.type||"paragraph"!==e.type.name||!!(0,tr.lr)(e))),o)?tO(o,{postId:n,pubId:r}):null}function tD(e){return e&&"{"!==e[0]&&"null"!==e?tO(k.EU.parse(e)):e}function tq(e){var t,n;return e.body=null!==(t=tD(e.body))&&void 0!==t?t:null,e.draft_body=null!==(n=tD(e.draft_body))&&void 0!==n?n:null,e}function tj(e){var t,n,r,o,i;return e.subscribe_content=null!==(t=tD(e.subscribe_content))&&void 0!==t?t:null,e.welcome_email_content=null!==(n=tD(e.welcome_email_content))&&void 0!==n?n:null,e.tos_content=null!==(r=tD(e.tos_content))&&void 0!==r?r:null,e.privacy_content=null!==(o=tD(e.privacy_content))&&void 0!==o?o:null,e.disclosures_content=null!==(i=tD(e.disclosures_content))&&void 0!==i?i:null,e}function tX(e,t){let{post:n=null,pubId:r,minCharacters:o=6,maxStopAfter:i=null,singleSentence:l=!0,language:a="en",excludeMediaPrefix:s=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{iString:u}=I18N.i(a),c=(null==n?void 0:n.type)==="thread"?145:250;(i||0===i)&&(c=Math.min(i,c));let d=(null==n?void 0:n.type)==="thread",p="";if(t)p+=t;else if(0!==c){var m;let t={paragraph:!0,blockquote:!0,list_item:!0,listItem:!0,heading:!0,code_block:!0,codeBlock:!0,hardbreak:!0,hard_break:!0,hardBreak:!0},i={caption:!0,footnote:!0};(0,tr.cb)("string"==typeof e?tA(e,{postId:null!==(m=null==n?void 0:n.id)&&void 0!==m?m:null,pubId:r}):e,e=>{if(c&&p.length>=c||e.type&&i[e.type])return!1;if("text"===e.type){let{text:t}=e;if(t){let e=t.match(/[.?!] /);if(l&&(null==e?void 0:e.index))return p+=t.slice(0,e.index+1),ti.aT;p+=t}}else if(e.type&&t[e.type]&&p){if(p.length>o)return ti.aT;" "!==p[p.length-1]&&(p+=" ")}else if("substack_mentions"===e.type){var n,r;p+=null!==(r=null===(n=e.attrs)||void 0===n?void 0:n.name)&&void 0!==r?r:""}})}if(p=p.replace(/\s+/g," ").trim(),d&&c&&p.length>=c&&(p=(0,R.truncateText)(p,c)),((null==n?void 0:n.type)==="podcast"||(null==n?void 0:n.type)==="video")&&!s){let e=(0,A.XV)(n);p="".concat(u((null==n?void 0:n.type)==="video"||(null==n?void 0:n.videoUpload)?"Watch now":"Listen now")," ").concat(e?"(".concat((0,R.secondsToLargestUnit)(e,{minutesCutoff:10800,language:a}),") "):"","| ").concat(p)}return p}function tJ(e,t){var n;return null!==(n=tQ(e,t)[0])&&void 0!==n?n:null}function tV(e){let{postId:t,pubId:n,width:r,height:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=tA(e,{postId:t,pubId:n});return i?E()(C()((0,tr.fp)(i,e=>{var t;return!!tf[null!==(t=e.type)&&void 0!==t?t:""]}).map(e=>{var t,n;let i=null===(t=tf[null!==(n=e.type)&&void 0!==n?n:""])||void 0===t?void 0:t.call(tf,e);return i?(0,O.zF4)(i,r,{height:o}):null}))):[]}function tY(e){let{postId:t,pubId:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=tV(e,{postId:t,pubId:n});return r.length>0&&!I()(r[0])?r[0]:null}function tG(e){let{body:t}=e,n=tA(t);if(n)return(0,tr.fp)(n,e=>{var t;return!!th[null!==(t=e.type)&&void 0!==t?t:""]}).map(e=>{var t,n;return null===(t=th[null!==(n=e.type)&&void 0!==n?n:""])||void 0===t?void 0:t.call(th,e)})[0]}async function tK(e){let{body:t,postId:n}=e,r=tF(t,{postId:n}),o=[];return(0,tr.je)(r,e=>{switch(e.type.name){case"image":case"image2":e.attrs.src&&o.push(e.attrs.src);break;case"imageGallery":var t;null===(t=e.attrs.gallery.images)||void 0===t||t.map(e=>{e.src&&o.push(e.src)})}}),o}function tQ(e,t){var n;let r=[];"podcast_episode_image_info"in t&&t.podcast_episode_image_info&&!t.podcast_episode_image_info.isDefaultArt&&r.unshift(t.podcast_episode_image_info.url),r.unshift(...tV(e,{postId:t.id}));let o="podcastUpload"in t&&t.podcastUpload||"draftPodcastUpload"in t&&t.draftPodcastUpload||void 0;if((null==o?void 0:o.state)==="transcoded"&&(null!==(n=null==o?void 0:o.thumbnail_id)&&void 0!==n?n:1)>1){let e=(0,O.ow1)(o);e&&r.unshift(e)}let i="videoUpload"in t&&t.videoUpload||"draftVideoUpload"in t&&t.draftVideoUpload||void 0;if((null==i?void 0:i.state)==="transcoded"){let e=(0,O.ow1)(i);e&&r.unshift(e)}return"podcast_art_url"in t&&t.podcast_art_url&&r.unshift(t.podcast_art_url),r}function t0(e){return"string"!=typeof e?null:(e=e.replace(/\/l_twitter_play_button_rvaygk[^/]+/g,""),(0,O.zF4)(e,void 0,{height:600}))}function t1(e){(0,tr.cb)(e,e=>{var t;return"button"===e.type&&((null===(t=e.attrs)||void 0===t?void 0:t.url)&&"string"==typeof e.attrs.url&&e.attrs.url.startsWith("%%")&&(e.attrs.action=e.attrs.url.replace(/%%/g,"")),!0)},{nodeTypes:"button"})}function t8(e){let{postId:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("string"==typeof n){let e=tA(n,{postId:t});if(!e)return[];n=e}t1(n);let r=[];return(0,tr.cb)(n,e=>{var t,n,o;if("button"===e.type&&(null===(t=e.attrs)||void 0===t?void 0:t.url)&&!e.attrs.action)r.push({text:e.attrs.text,url:e.attrs.url});else if("image2"===e.type&&(null===(n=e.attrs)||void 0===n?void 0:n.href))r.push({text:e.attrs.href,url:e.attrs.href});else if(e.marks){for(let t of e.marks)if("link"===t.type&&(null===(o=t.attrs)||void 0===o?void 0:o.href)){r.push({text:e.text,url:t.attrs.href});break}}}),r}function t4(e){let{postId:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return!1;let n=e;if("string"==typeof n){let e=tA(n,{postId:t});if(!e)return!1;n=e}return!!(0,tr.DY)(n,e=>"templateComment"===e.type)}function t2(e){let{postId:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return!1;let n=e;if("string"==typeof n){let e=tA(n,{postId:t});if(!e)return!1;n=e}return!!(0,tr.DY)(n,e=>{for(let a of["href","src","url"]){var t,n,r,o,i,l;if((null==e?void 0:null===(o=e.attrs)||void 0===o?void 0:null===(r=o[a])||void 0===r?void 0:null===(n=r.trim)||void 0===n?void 0:null===(t=(i=n.call(r)).toLowerCase)||void 0===t?void 0:t.call(i).startsWith("javascript:"))||(null==e?void 0:null===(l=e.marks)||void 0===l?void 0:l.find(e=>{var t,n,r,o,i;return null===(o=e.attrs)||void 0===o?void 0:null===(r=o[a])||void 0===r?void 0:null===(n=r.trim)||void 0===n?void 0:null===(t=(i=n.call(r)).toLowerCase)||void 0===t?void 0:t.call(i).startsWith("javascript:")})))return!0}return!1})}function t3(e){let t,{postId:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){let r=tA(e,{postId:n});if(!r)return null;t=r}else t=e;return(0,tn.f5)(t)?(0,to.Y)(t,e=>{for(let a of["href","src","url"]){var t,n,r,o,i,l;if((null==e?void 0:null===(o=e.attrs)||void 0===o?void 0:null===(r=o[a])||void 0===r?void 0:null===(n=r.trim)||void 0===n?void 0:null===(t=(i=n.call(r)).toLowerCase)||void 0===t?void 0:t.call(i).startsWith("javascript:"))||(null==e?void 0:null===(l=e.marks)||void 0===l?void 0:l.find(e=>{var t,n,r,o,i;return null===(o=e.attrs)||void 0===o?void 0:null===(r=o[a])||void 0===r?void 0:null===(n=r.trim)||void 0===n?void 0:null===(t=(i=n.call(r)).toLowerCase)||void 0===t?void 0:t.call(i).startsWith("javascript:")})))return!1}return!0}):(0,to.Y)(t,e=>{for(let a of["href","src","url"]){var t,n,r,o,i,l;if((null==e?void 0:null===(o=e.attrs)||void 0===o?void 0:null===(r=o[a])||void 0===r?void 0:null===(n=r.trim)||void 0===n?void 0:null===(t=(i=n.call(r)).toLowerCase)||void 0===t?void 0:t.call(i).startsWith("javascript:"))||(null==e?void 0:null===(l=e.marks)||void 0===l?void 0:l.find(e=>{var t,n,r,o,i;return null===(o=e.attrs)||void 0===o?void 0:null===(r=o[a])||void 0===r?void 0:null===(n=r.trim)||void 0===n?void 0:null===(t=(i=n.call(r)).toLowerCase)||void 0===t?void 0:t.call(i).startsWith("javascript:")})))return!1}return!0})}function t6(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,{postId:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="string"==typeof e?tA(e,{postId:n}):e;if(!r)return;let o=!1;return"doc"===r.type&&r.content&&r.content.map((e,n)=>{n>t?(0,tr.cb)(e,e=>{!e.content&&e.attrs&&(e.attrs.belowTheFold=!0)}):o||(0,tr.cb)(e,e=>{!e.content&&(null==e?void 0:e.type)=="image2"&&e.attrs&&(e.attrs.topImage=!0,o=!0)})}),r}function t5(e){let{postId:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return JSON.parse(e),tz(e,{postId:t})}catch(t){return e}}function t9(e,t){let{body:n,hasPodcastPreview:r}=t;if(!e||!n)return null;let o=n;return r&&(o=JSON.stringify((0,tr.N5)(tA(n,{postId:e.id}),{maxLength:"post_preview_limit"in e&&e.post_preview_limit&&"number"==typeof e.post_preview_limit?e.post_preview_limit:356}))),tz(o,{postId:e.id})}function t7(e){return tO(t_.node("doc",null,e.split("\n").map(e=>e.trim()).filter(e=>e.length>0).map(e=>{let t=[],n=(0,P.m)(e);if(n.length>0){let r=e;for(;;){let e=n.map(e=>[r.indexOf(e.value),e.value]).sort().find(e=>{let[t]=e;return t>=0});if(!e)break;let[o,i]=e;if(o>0&&t.push(t_.text(r.substring(0,o))),!t_.marks.link){console.error("link is missing from schema");continue}t.push(t_.text(i,[t_.marks.link.create({title:i,href:i,target:"_blank"})])),r=r.substring(o+i.length)}r&&t.push(t_.text(r))}else t.push(t_.text(e));return t_.node("paragraph",null,t)})))}function ne(e){let{postId:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return!1;let n=e;if("string"==typeof e){let r=tA(e,{postId:t});if(!r)return!1;n=r}else n=e;return(0,tr.C4)(n)}Object.entries(tB.nodes).forEach(e=>{let[t,n]=e;void 0!==tv[t]&&(n.spec=(0,r._)({},tv[t],n.spec))})},68303:function(e,t,n){n.d(t,{$9:()=>et,$_:()=>q,$y:()=>D,C4:()=>eo,Co:()=>A,DY:()=>Z,Dc:()=>K,Dg:()=>F,E5:()=>k,Hs:()=>er,I_:()=>V,N5:()=>w,PH:()=>y,S7:()=>O,Wi:()=>$,cb:()=>v.cb,do:()=>W,fX:()=>L,fp:()=>x,gR:()=>M,hL:()=>X,je:()=>v.je,k:()=>P,lr:()=>E,o4:()=>en,qe:()=>R,qj:()=>b});var r=n(7409),o=n(99282);if(/^(4716|5288)$/.test(n.j))var i=n(76405);var l=n(92007),a=n(39693),s=n.n(a),u=n(14293),c=n.n(u),d=n(10691),p=n.n(d),m=n(19834),h=n(36186),f=n(84864),g=n(88956),v=n(22498);let b=[["list_item","listItem"],["bullet_list","bulletList"],["ordered_list","orderedList"],["hard_break","hardBreak"],["horizontal_rule","horizontalRule"],["code_block","codeBlock"]],y=[["em","italic"],["strong","bold"],["strikethrough","strike"]],_={image2:1,image:0,horizontal_rule:0,audio:0,video:0,youtube:0,youtube2:0,vimeo:0,opensea:0,twitter:0,twitter2:0,spotify:0,spotify2:0,soundcloud:0,bandcamp:0,kindle:0,tiktok:0,prediction_market:0,lichess:0,datawrapper:0,recipe:0,pinterest:0},w=function(e){let{maxLength:t=356,getAfterCutoff:n=!1,withEllipsis:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o="",i=!1,l={},a=eo(e),s=!1,u=(0,g.Y)(e,e=>{var r;if(i)return n;if("paywall"===e.type)return i=!0,!1;if(a)return!0;let u=null!==(r=e.type)&&void 0!==r?r:"undefined";if(l[u]=(l[u]||0)+1,e.type&&e.type in _&&l[u]>_[e.type])return i=!0,n;let c=t-o.length;if(c<=0&&!a||!(c>0))return n;if(n){if("text"===e.type&&e.text){if(!(t-(o+=e.text).length<=0))return!1;e.text=e.text.substring(e.text.length+t-o.length-1,e.text.length)}}else if("text"===e.type&&e.text){o+=e.text;let t=e.text;e.text=(0,f.truncateText)(t,c),s=t!==e.text}return!0});if(u&&r&&!s){let e=function(e){let t=[],n=[e];for(;n.length;){var r;let e=n.pop();if(!e)break;if(e.content&&(null===(r=e.content)||void 0===r?void 0:r.length)>0)for(let t=e.content.length-1;t>=0;t--){let r=e.content[t];r&&n.push(r)}else t.push(e)}return t}(u),t=null,n=null;for(let r=e.length-1;r>=0&&(!t||!n);r--){let o=e[r];null===t&&(null==o?void 0:o.type)==="text"&&(t=r),null===n&&(null==o?void 0:o.type)!=="text"&&(null==o?void 0:o.type)!=="paragraph"&&(n=r)}let r=null!==t?e[t]:null,o=r&&null!==n&&null!==t&&n>t;r&&!o&&(r.text=T(r.text))}return u},x=(e,t)=>{let n=[];if(e&&(t(e)&&n.push(e),e.content))for(let r of e.content)n=n.concat(x(r,t));return n},Z=(e,t)=>{if(e){if(t(e))return e;if(e.content)for(let n of e.content){let e=Z(n,t);if(e)return e}}return null},k=e=>{let t=[];return e.nodesBetween(0,e.content.size,e=>{var n;(null===(n=e.type)||void 0===n?void 0:n.name)==="cashtag"&&t.push(e.attrs.symbol)},0),t},N=new Set(["caption","footnote","captionedImage","image","image2"]),S=new Set(["bullet_list","bulletList","ordered_list","orderedList","blockquote"]),C="x_li_start_placeholder_x",B=(e,t)=>{var n,r,o,i;if((null===(n=e.type)||void 0===n?void 0:n.name)==="list_item"||(null===(r=e.type)||void 0===r?void 0:r.name)==="listItem")return{open:C,close:""};if((null===(o=e.type)||void 0===o?void 0:o.name)==="paragraph"||e.isBlock&&e.textContent.length>0&&!S.has(null===(i=e.type)||void 0===i?void 0:i.name)){let e="<p>";return(t.length>0?t[t.length-1]:null)===C&&(t.pop(),e+="* "),{open:e,close:"</p>"}}return null},I=e=>{var t,n,r;let{node:o,recursiveDepth:i,tokens:l}=e;if(i>100)return console.warn("Reached max recursive depth while converting document to HTML for podcast"),!1;let a=!0;if(N.has(null===(t=o.type)||void 0===t?void 0:t.name))a=!1;else if(o.isText){if(o.text&&o.text.length>0){let e=o.marks.find(e=>"link"===e.type.name&&e.attrs.href),t=o.marks.find(e=>"em"===e.type.name),n=o.marks.find(e=>"strong"===e.type.name),r=o.text;t&&(r="<em>".concat(r,"</em>")),n&&(r="<strong>".concat(r,"</strong>")),e&&(r='<a target="_blank" href="'.concat((0,m.Z)(e.attrs.href),'">').concat(r,"</a>")),l.push(r)}}else if(B(o,[])){let e=B(o,l);e&&l.push(e.open),o.descendants(e=>I({node:e,recursiveDepth:i+1,tokens:l})),e&&l.push(e.close),a=!1}else if((null===(n=o.type)||void 0===n?void 0:n.name)==="cashtag")l.push("".concat(o.attrs.symbol," "));else if((null===(r=o.type)||void 0===r?void 0:r.name)==="substack_mentions"){let e=o.marks.find(e=>"em"===e.type.name),t=o.marks.find(e=>"strong"===e.type.name),n=o.attrs.name;if(e&&(n="<em>".concat(n,"</em>")),t&&(n="<strong>".concat(n,"</strong>")),"user"===o.attrs.type){let e=(0,h.GR)(o.attrs.id,o.attrs.name);l.push('<a target="_blank" href="'.concat(e,'">').concat(n,"</a>"))}else if("pub"===o.attrs.type){let e=o.attrs.url;l.push('<a target="_blank" href="'.concat(e,'">').concat(n,"</a>"))}}return a},L=e=>{let t=[];return e.descendants(e=>I({node:e,recursiveDepth:1,tokens:t})),t.filter(e=>e!==C).join("").trim()},E=function(e){let{withLinks:t=!0,withCaptionsAndFootnotes:n=!1,forPodcast:r=!1,truncateAt:o=null,truncateTo:i=o,truncateEllipsis:l="…",truncateExtension:a=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="",u="",d="",p=!0;return e.nodesBetween(0,e.content.size,e=>{var o,h,g,v;if(!n&&["caption","footnote"].includes(null===(o=e.type)||void 0===o?void 0:o.name))return!1;if(e.isText){if(e.text&&e.text.length>0){let n;p=!1,!c()(i)&&s.length<i&&s.length+e.text.length>=i&&(n=(0,f.truncateText)(e.text,i-s.length,{ellipsis:l,extension:a}));let o=e.marks.filter(e=>"link"===e.type.name&&e.attrs.href)[0],h=e.marks.filter(e=>"em"===e.type.name)[0],g=e.marks.filter(e=>"strong"===e.type.name)[0],v=e.text;s+=v,h&&r&&(n&&(n="<em>".concat(n,"</em>")),v="<em>".concat(v,"</em>")),g&&r&&(n&&(n="<strong>".concat(n,"</strong>")),v="<strong>".concat(v,"</strong>")),o&&t?r?(n&&(d="".concat(u,'<a target="_blank" href="').concat((0,m.Z)(o.attrs.href),'">').concat(n,"</a>")),u+='<a target="_blank" href="'.concat((0,m.Z)(o.attrs.href),'">').concat(v,"</a>")):(n&&(d="".concat(u).concat(n," [ ").concat(o.attrs.href," ]")),u+="".concat(v," [ ").concat(o.attrs.href," ]")):(n&&(d=u+n),u+=v)}}else!p&&["hard_break","hardBreak"].includes(null===(h=e.type)||void 0===h?void 0:h.name)?(p=!0,s+="\n",r?u+="<br/>":u+="\n"):!p&&e.isBlock?(p=!0,s+="\n",r?u+="<br/><br/>":u+="\n"):(null===(g=e.type)||void 0===g?void 0:g.name)==="cashtag"?u+="".concat(e.attrs.symbol," "):(null===(v=e.type)||void 0===v?void 0:v.name)==="substack_mentions"&&(u+="".concat(e.attrs.name," "))},0),!c()(o)&&s.length>o&&d&&(u=d),u=u.trim(),r&&(u=u.replace(/\s*(<br\/>)+$/,"").trim()),u},T=e=>"".concat(p()(e,"."),"..."),A=(e,t)=>(0,o._)((0,r._)({name:e},t),{addAttributes:()=>t.attrs||{},parseHTML:()=>t.parseDOM,renderHTML(n){let{node:r}=n;return t.toDOM?t.toDOM(r):(console.warn("trying to create TipTapNode, no toDOM found for node",e),["span"])}}),F=(e,t)=>{let n,r,o;if(e.doc.nodesBetween(e.selection.from,e.selection.to,(e,i)=>{if(n||r)return!1;let l=e.marks.find(e=>e.type===t);l&&(n=e,r=l,o={from:i,to:i+e.nodeSize})}),n)return{node:n,mark:r,pos:o}},P=(e,t)=>{let n,r,o;if(e.doc.nodesBetween(e.selection.from,e.selection.to,(i,l)=>{if(n||r||!(l<=e.selection.from)||!(e.selection.to<=l+i.nodeSize))return!1;{let e=i.marks.find(e=>e.type===t);e&&(n=i,r=e,o={from:l,to:l+i.nodeSize})}}),!n){if(e.selection.empty){let a=e.doc.resolve(e.selection.from),s=a.nodeBefore&&a.nodeBefore.marks.find(e=>e.type===t),u=a.nodeAfter&&a.nodeAfter.marks.find(e=>e.type===t);if(s||u){var i,l;n=u?a.nodeAfter:a.nodeBefore,r=u||s,o=u?{from:a.pos,to:a.pos+a.nodeAfter.nodeSize}:{from:a.pos-(null!==(l=null===(i=a.nodeBefore)||void 0===i?void 0:i.nodeSize)&&void 0!==l?l:0),to:a.pos}}}if(!n)return}return{node:n,mark:r,pos:o}},O=function(e){let{allowedMarks:t=[]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!!e.selection.empty||R(e,e.selection.from,e.selection.to,{allowedMarks:t})},R=function(e,t,n){let{allowedMarks:r=[]}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=!0,i=!1;return e.doc.nodesBetween(t,n,t=>{if(!o)return!1;t.type!==e.schema.nodes.text?i?o=!1:i=!0:t.marks.find(e=>!r.includes(e.type))&&(o=!1)}),o},M=(e,t)=>{if(e.selection.empty)return!1;let n=Array.isArray(t)?t:[t];if("node"in e.selection){var r;let t=e.selection;return n.includes(null===(r=t.node)||void 0===r?void 0:r.type)}return H(e,e.selection.from,e.selection.to,n)},H=(e,t,n,r)=>{let o=null;return e.doc.nodesBetween(t,n,e=>{if(!(!1!==o&&r.includes(e.type)))return o=!1,!1;o=!0}),o||!1},W=e=>e.selection.empty?null:z(e,e.selection.from,e.selection.to),z=(e,t,n)=>{let r=null;return e.doc.nodesBetween(t,n,t=>!r&&(t.type===e.schema.nodes.image2?(r=t.attrs.href,!1):void(t.type===e.schema.nodes.image3&&(r=t.attrs.href)))),r||null},$=(e,t,n)=>{e.selection.empty||U(e,t,e.selection.from,e.selection.to,n)},U=(e,t,n,r,o)=>{e.doc.nodesBetween(n,r,(n,r)=>{(n.type===e.schema.nodes.image2||n.type===e.schema.nodes.image3)&&t.setNodeMarkup(r,n.type,Object.assign({},n.attrs,{href:o}),n.marks)})},D=e=>({top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}),q=(e,t,n,r)=>{let o=document.body,i=window.innerWidth<=481,l=j(e,t.from,t.to,t=>[e.state.schema.nodes.image,e.state.schema.nodes.image2].includes(t.type))?-44:8,a=D(e.coordsAtPos(t.from)),s=D(e.coordsAtPos(t.to));n.style.position="fixed";let u=s.bottom+(i?o.scrollTop:0),c=o.clientHeight-n.clientHeight-96-l;a.top<s.top?(r&&(r.style.left="10px"),n.style.right="",n.style.left="".concat(Math.min(a.left,s.left),"px")):o.clientWidth-a.left>n.clientWidth?(r&&(r.style.left="10px"),n.style.right="",n.style.left="".concat(a.left,"px")):(r&&(r.style.left="".concat(a.left-o.clientWidth+n.clientWidth,"px")),n.style.right="10px",n.style.left=""),i||u<c?(r&&(r.style.top="-9px",r.style.bottom="auto",r.style.transform=""),n.style.top="".concat(u+l,"px")):(r&&(r.style.top="auto",r.style.bottom="-9px",r.style.transform="rotate(180deg)"),n.style.top="".concat(c+l,"px"))},j=(e,t,n,r)=>{let o=!1;return e.state.doc.nodesBetween(t,n,e=>{if(o)return!1;o=r(e)}),o},X=async(e,t)=>i.p2.maxOpen(await J(e.content,t)),J=async(e,t,n)=>{let r=[];for(let o=0;o<e.childCount;o++){let i=e.child(o);i.content.childCount&&(i=i.copy(await J(i.content,t,i))),Array.isArray(i=await t(i,o,n))||(i=[i]),r=r.concat(s()(i))}return r=(r=(r=await Promise.all(r)).map(e=>{if(!(null==e?void 0:e.content.childCount))return[e];let t=[],n=[];for(let r=0;r<e.content.childCount;r++){let o=e.content.child(r);Q(e,o)?n.push(o):(t.push(e.copy(i.HY.fromArray(n))),n=[],t.push(o))}return n.length&&t.push(e.copy(i.HY.fromArray(n))),t}).reduce((e,t)=>e.concat(t),[])).filter(e=>e&&!("text"===e.type.name&&!e.text)&&!("paragraph"===e.type.name&&!e.content.childCount)),i.HY.fromArray(r)},V=(e,t,n)=>i.p2.maxOpen(Y(e.content,t,n)),Y=(e,t,n)=>{let r;n=n||(e=>e);let o=[];for(let i=0;i<e.childCount;i++){let l=e.child(i);if(t(l))(r=r||[]).push(l);else{if(r){let[e,...t]=n(r);o.push(G(e,...t)),r=null}l.content.childCount&&(l=l.copy(Y(l.content,t,n))),o.push(l)}}if(r){let[e,...t]=n(r);o.push(G(e,...t)),r=null}return i.HY.fromArray(o)},G=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let o=e.content;for(let e of n)o=o.append(e.content);return e.copy(o)},K=e=>{let t;if(!e)return!0;if("string"==typeof e)try{t=JSON.parse(e)}catch(t){return console.error("Could not parse doc",e),!1}else t=e;if(!t||"doc"!==t.type||!Array.isArray(t.content))return console.error("Could not parse doc",t),!1;for(let e of t.content){if(!e||"object"!=typeof e)return console.error("Could not parse doc",t),!1;if("paragraph"!==e.type)return!1;if(e.content){if(!Array.isArray(e.content))return console.error("Could not parse doc",t),!1;if("text"!==e.type||e.text&&e.text.trim())return!1}}return!0},Q=(e,t)=>{let n=["list_item","listItem"].includes(e.type.name),r=["bullet_list","bulletList","ordered_list","orderedList"].includes(t.type.name);return!!n&&!!r||!!e.type.contentMatch&&!!e.type.contentMatch.matchType(t.type)},ee=e=>e.doc.resolve(e.selection.from).node(1),et=(e,t)=>{var n;return t.includes(null===(n=ee(e))||void 0===n?void 0:n.type)},en=(e,t)=>{var n,r,o;let i=e.tr,a=i.selection instanceof l.Bs,s=a&&(null===(o=i.selection.$from)||void 0===o?void 0:null===(r=o.parent)||void 0===r?void 0:null===(n=r.content)||void 0===n?void 0:n.size)===0?e.selection.to-1:e.selection.to;if(Array.isArray(t))for(let e of t.slice().reverse())i.insert(s,e);else i.insert(s,t);return a||i.setSelection(l.qv.near(i.doc.resolve(s))),i},er=(e,t)=>{let n=e.tr;return n.replaceSelectionWith(t),n},eo=e=>!!Z(e,e=>"paywall"===e.type)}}]);