"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8543"],{60648:function(e,t,n){n.d(t,{Z:()=>r});let r={input:"input-qHk4bN",form:"form-CkZ7Kt"}},50137:function(e,t,n){n.d(t,{Z:()=>a});var r=n(7409),i=n(99282),o=n(16584),l=n(64515);let a=e=>(0,o.tZ)(l.l,(0,i._)((0,r._)({},e),{name:"NoteForwardIcon",svgParams:{height:24,width:24,stroke:e.stroke,strokeWidth:e.strokeWidth},children:(0,o.tZ)("path",{d:"M21 3V8M21 8H16M21 8L18 5.29962C16.7056 4.14183 15.1038 3.38328 13.3879 3.11547C11.6719 2.84766 9.9152 3.08203 8.32951 3.79031C6.74382 4.49858 5.39691 5.65051 4.45125 7.10715C3.5056 8.5638 3.00158 10.2629 3 11.9996M3 21V16M3 16H8M3 16L6 18.7C7.29445 19.8578 8.89623 20.6163 10.6121 20.8841C12.3281 21.152 14.0848 20.9176 15.6705 20.2093C17.2562 19.501 18.6031 18.3491 19.5487 16.8925C20.4944 15.4358 20.9984 13.7367 21 12",strokeLinecap:"round","stroke-linejoin":"round"})}))},6498:function(e,t,n){n.d(t,{R:()=>c});var r=n(16584),i=n(347),o=n(7523),l=n(95441),a=n(83225),d=n(80026);let c=e=>{let{comments:t,post:n,commentId:a,notAllowedToFetchComments:c,handleSort:u,publication:m,sort:h,sortMenuUseMobileBottomSheet:p}=e,{iString:Z}=(0,l.M1)();return(0,r.BX)(i.h,{children:[(0,r.BX)(d.gq,{alignItems:"baseline",flex:"grow",gap:8,position:"relative",children:[(0,r.tZ)(o.Z,{preset:"st4",children:Z("Comments")}),(0,r.tZ)("div",{className:"mediumRule-B78a2B"}),(null==t?void 0:t.length)&&(null==t?void 0:t.length)>0?(0,r.tZ)(o.Z,{color:"accent",preset:"st4",children:n.comment_count}):null]}),(0,r.BX)(d.xu,{className:"sortOptionsContainer-bIIUcJ",children:[!c&&(0,r.tZ)(o.Z,{align:"left",as:"a",color:"tertiary",href:"/p/community-guidelines",preset:"detail-small",style:{textDecoration:"underline"},children:Z("Community Guidelines")}),t&&(null==t?void 0:t.length)>1&&!c&&!a&&(0,r.tZ)(s,{comments:t,handleSort:u,publication:m,sort:h,useMobileBottomSheet:p})]})]})},s=e=>{let{publication:t,handleSort:n,sort:i,comments:o,useMobileBottomSheet:l}=e;return t&&n&&i?(0,r.tZ)(a.$,{currentSort:i,handleSort:n,isLoading:!o,pub:t,useMobileBottomSheet:l}):null}},57626:function(e,t,n){n.d(t,{C:()=>h});var r=n(16584),i=n(18787),o=n(74626),l=n(6498),a=n(7523),d=n(95441),c=n(71068),s=n(19081),u=n(60308),m=n(47929);let h=e=>{let{post:t,publication:n,user:h,freeSignupEmail:p=null,showHeader:Z=!1}=e,{iString:f}=(0,d.M1)(),v=h&&h.email||p||null,b=(0,u.Zs0)(n,{simple:!0,next:document.location.href,utm_source:m.b3.paywall,utm_medium:m.lP.web,utm_content:t?t.id:null,just_signed_up:!1}),g=async()=>{window.location.href=b};return(0,r.BX)(s.tu,{className:"container-u0f9W_",children:[Z&&(0,r.tZ)(l.R,{notAllowedToFetchComments:!0,post:t,publication:n}),(0,r.tZ)(c.xu,{className:"commentsPaywall-ASd8iy",children:(0,r.BX)(s.tu,{alignItems:"center",gap:24,paddingX:24,paddingY:40,children:[(0,r.tZ)(a.Z,{color:"white",preset:"h4-sans-condensed",children:f("Join the conversation")}),(0,r.tZ)(a.Z,{color:"white",preset:"d3-serif",children:f("Share your thoughts and connect with other readers by becoming a paid subscriber!")}),(0,r.tZ)(o._,{variant:"inverse",onClick:g,children:f("Upgrade today")}),(0,r.BX)(a.Z,{as:"a",color:"white",href:(0,u.W1P)(n,{isSignInAttempt:!0}),native:!0,preset:"caption",children:[(0,i.qV)({post:t,publication:n})," ",(0,r.tZ)("u",{children:f(v?"Switch accounts":"Sign in")})]})]})})]})}},48479:function(e,t,n){n.d(t,{H:()=>M,U:()=>X});var r=n(27412),i=n(58865),o=n(16584),l=n(6400),a=n(80569),d=n.n(a),c=n(60826),s=n(56219),u=n(94442),m=n(11712),h=n(89276),p=n(74648),Z=n(58319),f=n(95441),v=n(75905),b=n(90099),g=n(68833),y=n(98914),_=n(6070),C=n(31377),w=n(60308),k=n(84864),B=n(47929);function x(){let e=(0,i._)(["This thread is only visible to "," subscribers of ",""]);return x=function(){return e},e}class N extends l.Component{onTopReached(){this.state.topReached||(this.setState({topReached:!0}),(0,g.j)(g.FP.POST_SEEN,{post_id:this.props.post.id,post_audience:this.props.post.audience,post_type:this.props.post.type}))}onBottomReached(){this.state.bottomReached||(this.setState({bottomReached:!0}),(0,g.j)(g.FP.POST_BOTTOM_SEEN,{post_id:this.props.post.id,post_audience:this.props.post.audience,post_type:this.props.post.type}))}async enableEmailNotifications(){try{await d().post("/api/v1/post/".concat(this.props.post.id,"/subscribe")),window.location.reload()}catch(e){console.error("Failed to subscribe to email notifications:",e),alert((0,y.zx)(e))}}render(e){let t,n,{className:r,pub:i,post:a,user:d,freeSignup:f,freeSignupEmail:v,isStatic:g,hidden:y,truncated:N,invisible:M,post_reaction_token:X,onChange:S,showCta:E=N,showUnsubscribeNotice:I,dataForEmailRender:L={},showReactions:T=!0,gap:P=16,iString:R,iTemplate:D,iPlural:z,language:H,showShare:F}=e;"boolean"!=typeof y&&(y=a.hidden),y?(t=R("Subscribe to view"),n=(0,w.n1t)("/subscribe",{simple:!0,next:document.location.href,utm_source:B.b3.thread,utm_medium:B.lP.web,utm_content:a.id})):(n=(0,w.uRy)(i,a,{noBase:!0}),t="thread"!==a.type||N?(0,k.getPostCtaText)(a,H):a.comment_count?z("View 1 comment","View %1 comments",a.comment_count):R("Reply"));let A=g&&!this.context.isAmp,V=(0,_.HD)({pub:i}),U=V?h.j:l.Fragment;return(0,o.tZ)(b.YF,{className:"thread-head typography ".concat(r||""),children:(0,o.tZ)("tr",{children:(0,o.tZ)("td",{children:(0,o.BX)(b.i$,{width:"100%",children:[!M&&!y&&(0,o.tZ)(Z.Z,{onVisible:()=>this.onTopReached()}),(0,o.BX)(b.i$,{gap:P,width:"100%",children:[E&&V&&(0,o.tZ)(p.Q,{post:a,ctaUrl:n,ctaText:t,hidden:y}),(0,o.tZ)(s.mV,{pub:i,post:a,user:d,isStatic:g,reaction_token:X,allowEdit:!0,allowTruncate:N,showReactions:!!E||T,showShare:F,showComments:!!a.comment_count,inThreadHead:!0,onChange:S,showLabel:!0}),(0,o.tZ)(U,{inThreadHead:!0,children:(0,o.tZ)(m.Z,{user:d,freeSignup:f,freeSignupEmail:v,pub:i,post:a,html:y||N||!a.body_html?null:a.body_html,isStatic:g,dataForEmailRender:L,children:y?(0,o.tZ)("p",{children:(0,o.tZ)("i",{children:D(x(),(0,C.isFoundingAudience)(a.audience)?"founding":"paid",i.name)})}):N?(0,o.tZ)("p",{children:a.description}):null})}),E?!V&&(0,o.BX)("a",{className:"thread-head-cta",href:n,native:!0,children:[t," â†’"]}):y&&(0,o.BX)("p",{className:"thread-head-cta",children:[(0,o.tZ)("a",{href:(0,w.W1P)(i,{simple:!0,next:document.location.href,utm_source:B.b3.thread,utm_medium:B.lP.web,utm_content:a.id}),className:"button primary subscribe-btn",native:!g,children:(0,k.getSubscribeText)(i)}),(0,o.tZ)("a",{href:(0,w.uXE)({for_pub:i.subdomain}),className:"button",native:!0,children:R("Sign in")})]})]}),A&&(0,o.BX)(b.i$,{gap:P,style:{width:"100%"},children:[(0,o.tZ)(b.i$,{style:{width:"100%",textAlign:"center"},children:(0,o.tZ)("a",{role:"button",className:"button primary",style:{margin:"0 auto"},href:c.W.HALF_MAGIC_COMMENTS_URL,children:R("See the discussion")})}),(0,o.tZ)(u.yT,{isFooter:!0,customization:{showShare:!0,showComments:!0,showReactions:{showReactions:T},showRestack:!1,showLabels:!0,showCommentRestack:!i.hide_post_restacks}})]}),I&&a.unsubscribed&&(0,o.BX)("div",{className:"notifications-alert",children:[R("Email notifications are disabled for this thread.")," ",(0,o.tZ)("a",{href:"javascript:void(0)",onClick:()=>this.enableEmailNotifications(),children:R("Re-enable")})]}),!M&&!y&&(0,o.tZ)(Z.Z,{onVisible:()=>this.onBottomReached()})]})})})})}}(0,r._)(N,"contextType",v.E);let M=(0,f.fz)(N);class X extends l.Component{render(){return(0,o.BX)("div",{className:"thread-head-silhouette",children:[(0,o.tZ)("div",{className:"thread-head-silhouette-head"}),(0,o.BX)("div",{className:"thread-head-silhouette-content",children:[(0,o.tZ)("div",{className:"thread-head-silhouette-title"}),(0,o.tZ)("div",{className:"thread-head-silhouette-meta"}),(0,o.BX)("div",{className:"thread-head-silhouette-body",children:[(0,o.tZ)("div",{className:"thread-head-silhouette-body-line"}),(0,o.tZ)("div",{className:"thread-head-silhouette-body-line"}),(0,o.tZ)("div",{className:"thread-head-silhouette-body-line"})]})]})]})}}},9682:function(e,t,n){n.d(t,{js:()=>o,tv:()=>l});var r=n(30396),i=n(20042);function o(e,t){(0,r.d4)(()=>{let t=t=>{e(t)};return i.subscribers.push(t),()=>{i.subscribers.splice(i.subscribers.indexOf(t)>>>0,1)}},t)}function l(){let{path:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,n]=(0,r.eJ)({}),l=(0,r.sO)(null);o(e=>{l.current=e,n({})},[]);let a=l.current||(0,i.getCurrentUrl)(),d=a.replace(/\?.+$/,""),c=document.location.hash;return l.current=null,[{url:a,path:d,matches:e&&(0,i.exec)(d,e,{})||null,hash:c},i.route]}n(73410)},95434:function(e,t,n){n.d(t,{Gg:()=>I});var r=n(58865),i=n(16584),o=n(30396),l=n(24830),a=n(17048),d=n(80569),c=n.n(d),s=n(95441),u=n(80449),m=n(94874),h=n(71068),p=n(15771),Z=n(19081),f=n(1844),v=n(6490),b=n(65523),g=n(98248),y=n(17688),_=n(43570),C=n(58175),w=n(65252),k=n(98012);function B(){let e=(0,r._)(["Ban or suspend ",""]);return B=function(){return e},e}function x(){let e=(0,r._)(["Prevent this person from commenting on your publication in the future."]);return x=function(){return e},e}function N(){let e=(0,r._)(["Ban ",""]);return N=function(){return e},e}function M(){let e=(0,r._)(["Previously banned "," time(s), last on ",""]);return M=function(){return e},e}function X(){let e=(0,r._)([""," is permanently banned."]);return X=function(){return e},e}function S(){let e=(0,r._)([""," is banned until ","."]);return S=function(){return e},e}function E(){let e=(0,r._)(["Leave a reply"]);return E=function(){return e},e}let I=e=>{var t,n,r,l;let{comment:a,onReply:d,onBan:c,onClose:s}=e,{sub:u,loading:m,bans:h,bansHistory:p,error:Z,submitBan:f}=D(a,c),b=(0,w.mr)(),g=null===(t=b[1])||void 0===t?void 0:t[0],[y,_]=(0,o.eJ)(g),[C,B]=(0,o.eJ)(w.ol.VISIBLE),x=!!a||m,N=null!==(l=null===(r=b.find(e=>{let[t]=e;return t===y}))||void 0===r?void 0:null===(n=r[1])||void 0===n?void 0:n.toLowerCase())&&void 0!==l?l:"",M=h.filter(e=>(0,k.Z)(e.expiry).isAfter((0,k.Z)()));return(0,i.BX)(v.u_,{isOpen:x,onClose:s,children:[0===M.length&&(0,i.tZ)(L,{comment:a,sub:u,bans:h,bansHistory:p,loading:m,error:Z,selectedExpiry:y,setSelectedExpiry:_,selectedCommentVisibility:C,setSelectedCommentVisibility:B,expiryText:N,onClose:s,submitBan:f}),M.length>0&&(0,i.tZ)(R,{comment:a,bans:h,onClose:s,onReply:()=>{d&&a&&(d(a.id),s())}})]})},L=e=>{var t,n;let{comment:r,sub:o,bans:l,bansHistory:a,loading:d,error:c,selectedExpiry:u,setSelectedExpiry:h,selectedCommentVisibility:b,setSelectedCommentVisibility:k,expiryText:M,onClose:X,submitBan:S}=e,{iString:E,iTemplate:I}=(0,s.M1)(),L=(0,w.mr)(),R=(0,w.FG)();return(0,i.BX)(i.HY,{children:[(0,i.tZ)(v.xB,{showClose:!0,onClose:X,title:I(B(),null!==(t=null==r?void 0:r.name)&&void 0!==t?t:"user"),showDivider:!0,alignItems:"center",icon:(0,i.tZ)(m.qE,{photoUrl:null!==(n=null==r?void 0:r.photo_url)&&void 0!==n?n:void 0,size:56}),description:(0,i.BX)(Z.sg,{alignItems:"center",gap:8,children:[(null==o?void 0:o.is_subscribed)&&(0,i.tZ)(_.Vp,{priority:"secondary",children:E("Paid subscriber")}),(0,i.tZ)(C.xv,{children:I(x())})]})}),(0,i.tZ)(v.fe,{children:(0,i.BX)(Z.sg,{gap:20,children:[(0,i.tZ)(P,{bans:l,bansHistory:a}),c&&(0,i.tZ)(f.y,{children:E("An error occurred. Please try again.")}),d&&(0,i.tZ)(g.$j,{padding:32,alignItems:"center",justifyContent:"center"}),!d&&(0,i.BX)(i.HY,{children:[(0,i.BX)(T,{children:[(0,i.tZ)(C.xv.B3,{weight:"semibold",children:E("Ban duration")}),(0,i.BX)(y.i,{name:"expiry",value:u,onChange:e=>{h(e.target.value)},children:[(0,i.tZ)(y.d,{children:E("Select a duration")}),L.map(e=>{let[t,n]=e;return(0,i.tZ)("option",{value:t,children:null==n?void 0:n.replace(/^For /,"")})})]})]}),(0,i.BX)(T,{children:[(0,i.tZ)(C.xv.B3,{weight:"semibold",children:E("Delete comments")}),(0,i.BX)(y.i,{name:"comment_visibility",value:b,onChange:e=>{k(e.target.value)},children:[(0,i.tZ)(y.d,{children:E("Select whether to delete comments")}),R.map(e=>{let[t,n]=e;return(0,i.tZ)("option",{value:t,children:n})})]})]})]})]})}),(0,i.tZ)(v.mz,{direction:"column",showDivider:!0,primaryButton:(0,i.tZ)(p.zx,{priority:"destructive",onClick:()=>S(u,b),children:I(N(),M)})})]})},T=(0,h.zo)({display:"flex",justifyContent:"space-between",alignItems:"center"}),P=e=>{let{bans:t,bansHistory:n}=e,{iTemplate:r}=(0,s.M1)();if(!t[0])return null;let o=n.length?n.length:t.filter(e=>e.user_id).length;return(0,i.tZ)(u.b,{title:r(M(),o,(0,k.Z)(t[0].start).standardDatetimeWithYear()),theme:"default",priority:"secondary",Icon:l.Z,showClose:!1})},R=e=>{var t,n;let{comment:r,bans:o,onClose:l,onReply:d}=e,{iString:c,iTemplate:u}=(0,s.M1)(),m=o.find(e=>e.user_id),h=m&&(0,k.Z)(m.expiry).isAfter((0,k.Z)().add(100,"years"))?u(X(),null!==(t=null==r?void 0:r.name)&&void 0!==t?t:"This user"):u(S(),null!==(n=null==r?void 0:r.name)&&void 0!==n?n:"This user",(0,k.Z)(null==m?void 0:m.expiry).standardDatetimeWithYear());return m?(0,i.BX)(i.HY,{children:[(0,i.tZ)(v.xB,{title:h,alignItems:"center",icon:(0,i.tZ)(b.AM,{icon:(0,i.tZ)(a.Z,{})}),showClose:!0,onClose:l,description:c("We recommend leaving a reply to tell them why they are banned, and to let other readers know what kinds of comments are not acceptable.")}),(0,i.tZ)(v.ex,{}),(0,i.tZ)(v.mz,{direction:"column",primaryButton:(0,i.tZ)(p.zx,{priority:"primary-mono",onClick:d,children:u(E())})})]}):null},D=(e,t)=>{let[n,r]=(0,o.eJ)(null),[i,l]=(0,o.eJ)(!1),[a,d]=(0,o.eJ)([]),[s,u]=(0,o.eJ)([]),[m,h]=(0,o.eJ)(null),p=e=>{e.forEach(t=>{-1==e.findIndex(e=>e.id===t.id)&&e.push(t)}),d(e)},Z=async(n,r)=>{l(!0);try{if(!e)throw Error("comment undefined, cannot submitBan");let i=await c().post("/api/v1/comment_ban/".concat(e.id)).send({user_id:e.user_id,expiry:n,commentVisibility:r});r!==w.ol.VISIBLE&&document.location.reload();let o=i.body;p(o.bans),l(!1),t&&t(e,a)}catch(e){console.error("Failed to submit ban",e),h(!0)}l(!1)};return(0,o.d4)(()=>{(async()=>{if(e){l(!0),d([]),u([]),h(null),r(null);try{var t;let[n,i]=await Promise.all([c().get("/api/v1/user/".concat(e.user_id,"/bans")),c().get("/api/v1/moderation/publications/".concat(e.publication_id,"/users/").concat(e.user_id,"/bans")).query({type:"comment",limit:20})]),o=n.body;d(o.bans),r(o.sub),u(null!==(t=i.body.data)&&void 0!==t?t:[])}catch(e){console.error("Failed to get bans:",e),h(!0)}l(!1)}})()},[e]),{sub:n,loading:i,bans:a,bansHistory:s,error:m,submitBan:Z,setLoading:l,setError:h}}},82011:function(e,t,n){n.d(t,{a:()=>s});var r=n(16584),i=n(88812),o=n(46638),l=n(94874),a=n(17540),d=n(63474),c=n(63651);function s(e){let{comment:t,onClick:n,utm_content:s,noHover:h}=e,p=(0,o.gz)(t),Z=(0,c.NNq)(p,{utm_source:"comment",utm_content:s}),f=null!=n?n:()=>{};if(t.user_banned)return(0,r.tZ)(d.A0,{href:Z,onClick:f,children:(0,r.tZ)(l.ky,{size:32,icon:(0,r.tZ)(i.Z,{color:"var(--color-fg-tertiary)"})})});let v=m(p,h,Z,f),b=u(t);return b?(0,r.tZ)(a.zY,{tier:b,children:v}):v}let u=e=>{let{metadata:t}=e;return(null==t?void 0:t.is_author)?"author":(null==t?void 0:t.founding)?"founding":(null==t?void 0:t.membership_state)==="subscribed"?"paid":null},m=(e,t,n,i)=>t?(0,r.tZ)(l.On,{user:e,size:32,linkProps:{href:n,onClick:i}}):(0,r.tZ)(l.xV,{user:e,size:32,linkProps:{href:n,onClick:i}})},83225:function(e,t,n){n.d(t,{$:()=>u});var r=n(16584),i=n(37619),o=n(25380),l=n(95441),a=n(49762),d=n(15771),c=n(44424),s=n(50364);let u=e=>{let{currentSort:t,isLoading:n,pub:o,handleSort:a,useMobileBottomSheet:u}=e,{iString:h}=(0,l.M1)();return(0,r.tZ)(c.v2,{trigger:(0,r.tZ)(d.zx,{size:"sm",priority:"secondary",disabled:n,leading:(0,r.tZ)(i.Z,{size:18}),children:(0,s.Sh)(t,o.language)}),ariaLabel:h("Sort comments"),useMobileBottomSheet:u,children:(0,r.tZ)(m,{currentSort:t,pub:o,handleSort:a})})},m=e=>{let{currentSort:t,pub:n,handleSort:i}=e,l=!!(0,a.default)("like_comments_enabled");return(0,r.tZ)(r.HY,{children:(0,s.Hz)({likesEnabled:l,language:n.language}).map(e=>{let{key:n,text:l}=e;return(0,r.tZ)(c.sN,{onClick:()=>i(n),trailing:n===t?(0,r.tZ)(o.Z,{}):void 0,children:l},n)})})}},68072:function(e,t,n){n.d(t,{S:()=>l});var r=n(16584),i=n(71068),o=n(19081);function l(e){let{onCollapse:t}=e;return(0,r.tZ)(o.sg,{className:"collapser-Xs0O6C",onClick:t,children:(0,r.tZ)(i.xu,{className:"threadLine-BvF1wF",animate:!0})})}},63648:function(e,t,n){n.d(t,{Z:()=>g});var r=n(16584),i=n(94184),o=n.n(i),l=n(7617),a=n(31131),d=n(50137),c=n(30329),s=n(95441),u=n(53678),m=n(49762),h=n(19081),p=n(44424),Z=n(58175),f=n(39493);let v={link:"link-_X6et2",withShareButton:"withShareButton-hQzuEn"};function b(e){let{pub:t,post:n,comment:i,onChange:l}=e,{iString:a}=(0,s.M1)(),{canRestack:c,isRestacked:u,restacks:m,menuItems:h,nuxModal:Z}=(0,f.K)({pub:t,post:n,comment:i,onRestack:e=>{l({restacked:e,restacks:m+(e?1:-1)})}});return c?(0,r.BX)("span",{children:[Z,(0,r.tZ)(p.v2,{layerClassName:"comment-restack-menu",title:"Restack",trigger:(0,r.BX)("a",{className:o()("restack-button",u&&"restacked"),href:"javascript:void(0)",children:[(0,r.tZ)(d.Z,{}),a("Restack"),m>0&&" (".concat(m,")")]}),children:h})]}):null}let g=e=>{var t,n;let{comment:i,pub:d,user:p,post:f,reaction_token:g,commentsEnabledForPost:y,noRestack:_,onChange:C,startReply:w,shareComment:k,updateCommentReacted:B,hideShare:x}=e,{iString:N}=(0,s.M1)(),M=(0,m.default)("like_comments_enabled");return(0,r.tZ)(h.hs,{gap:16,alignItems:"center",justifyContent:"start",paddingTop:8,className:o()("comment-actions",{[null!==(n=v.withShareButton)&&void 0!==n?n:"undefined"]:!!k}),children:!i.deleted&&[M&&(0,r.tZ)(c.dJ,{user:p,pub:d,post:f,comment:i,height:16,countInParenthesesStyle:!0,token:g,onChange:e=>{let{comment:t}=e;return C(t)},onReactedChange:e=>{B&&B(i.id,e)},noSelfUpdate:!!B}),y&&(0,r.tZ)(u.hh,{onClick:()=>w(),className:v.link,children:(0,r.BX)(h.hs,{gap:6,alignItems:"center",children:[(0,r.tZ)(l.Z,{stroke:"var(--color-fg-secondary-themed)",size:16}),(0,r.BX)(Z.xv.Meta,{color:"pub-secondary-text",children:[N("Reply"),(null===(t=i.children)||void 0===t?void 0:t.length)>0&&" (".concat(i.children.length,")")]})]})}),!x&&!!k&&(0,r.tZ)(u.hh,{onClick:()=>k(i.id),className:v.link,children:(0,r.BX)(h.hs,{gap:6,alignItems:"center",children:[(0,r.tZ)(a.Z,{stroke:"var(--color-fg-secondary-themed)",size:16}),(0,r.tZ)(Z.xv.Meta,{color:"pub-secondary-text",children:N("Share")})]})}),!_&&(0,r.tZ)(b,{pub:d,post:f,comment:i,onChange:C})]})}},65892:function(e,t,n){n.d(t,{Z:()=>p});var r=n(16584),i=n(30396),o=n(95441),l=n(46638),a=n(50364),d=n(98012),c=n(60308),s=n(84864),u=n(47929);let m=e=>{var t;let{comment:n,showHiddenComment:i,setShowHiddenComment:l}=e,{iString:c}=(0,o.M1)(),s=null===(t=n.bans)||void 0===t?void 0:t.find(e=>e.publication_id===n.publication_id),u=s&&(0,d.Z)(s.expiry).diff((0,d.Z)(),"years")>=1,m=(0,a.Ng)(n)&&(n.user_banned_for_comment||n.reported_by_user),h=c(u?"User was indefinitely suspended for this comment. ":"User was temporarily suspended for this comment. "),p=n.user_banned_for_comment?h:c("You reported this comment. ");return m&&(0,r.tZ)("div",{className:"comment_notice",children:(0,r.BX)("i",{children:[p,(0,r.tZ)("a",{href:"javascript:void(0)",onClick:()=>l(!i),children:i?"Hide":"Show"})]})})},h=e=>{let{comment:t}=e,{title:n,truncated_body_text:i,date:o,bylines:l,like_count:a,comment_count:d,url:m}=t.reply;return(0,r.BX)("a",{className:"reply-comment",href:(0,c.n1t)(m,{utm_source:u.b3.substack,utm_campaign:u.VX.postReplyComment,utm_medium:u.lP.web}),native:!0,children:[(0,r.tZ)("div",{className:"reply-comment-title",children:n}),i&&(0,r.tZ)("div",{className:"reply-comment-body",children:(0,s.formatEllipsis)(i)}),(0,r.tZ)("button",{className:"reply-comment-read-more",children:"Read more"}),(0,r.tZ)("div",{className:"reply-comment-meta",children:(0,s.getPostEmbedMeta)({date:o,bylines:l,like_count:a,comment_count:d})})]})},p=e=>{let{comment:t,bodyRef:n,expandToggleClicked:o}=e,[a,d]=(0,i.eJ)(!1),c=(t.user_banned_for_comment||t.reported_by_user)&&!a;return(0,r.BX)("div",{className:"comment-body",ref:n,children:[(0,r.tZ)(m,{comment:t,showHiddenComment:a,setShowHiddenComment:d}),t.hidden?(0,r.tZ)("i",{children:"Comment hidden"}):t.deleted?(0,r.tZ)("i",{children:"Comment deleted"}):c?(0,r.tZ)("i",{}):t.suppressed&&!a?(0,r.tZ)("i",{children:"Comment removed"}):"reply"===t.type?(0,r.tZ)(h,{comment:t}):(0,l.Fs)(t.body),(0,r.tZ)("div",{role:"button",className:"show-all-toggle",onClick:()=>o(),children:(0,r.tZ)("div",{className:"show-all-toggle-label",children:"Expand full comment"})})]})}},56187:function(e,t,n){n.d(t,{J:()=>ez});var r=n(58865),i=n(16584),o=n(30396),l=n(14293),a=n.n(l),d=n(95441),c=n(60807),s=n(25991),u=n(53678),m=n(16451),h=n(7409),p=n(99282),Z=n(85200),f=n(7760),v=n(85598),b=n(99869),g=n(59543),y=n(78526),_=n(16293),C=n(76924),w=n(66440),k=n(17876),B=n(7073),x=n(17048),N=n(74655),M=n(98848),X=n(64515);let S=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,r=(0,M._)(e,["size","fill"]);return(0,i.tZ)(X.l,(0,p._)((0,h._)({},r),{name:"LinearIcon",svgParams:{viewBox:"0 0 24 24"},width:t,height:t,fill:n,children:(0,i.tZ)("path",{stroke:"none",fillRule:"evenodd",clipRule:"evenodd",d:"M19.0619 4.92341C15.1689 1.03032 8.8663 1.01517 4.95447 4.87797L19.1074 19.0309C22.9702 15.119 22.955 8.81651 19.0619 4.92341ZM2.95746 7.67367L16.3108 21.027C17.0035 20.6951 17.6661 20.2789 18.2829 19.7783L4.2062 5.70169C3.70565 6.31846 3.2894 6.98092 2.95746 7.67367ZM12.5482 21.9918L1.99316 11.4369C2.04331 10.5412 2.21326 9.65092 2.50301 8.79221L15.1928 21.4819C14.334 21.7717 13.4439 21.9416 12.5482 21.9918ZM4.90872 19.077C3.22167 17.3899 2.26284 15.2503 2.03226 13.049L10.9367 21.9534C8.73529 21.7228 6.59577 20.7639 4.90872 19.077Z"})}))},E=(0,n(6400).createContext)(null);function I(e){let{children:t,value:n}=e;return(0,i.tZ)(E.Provider,{value:n,children:t})}var L=n(27484),T=n.n(L),P=n(80569),R=n.n(P),D=n(8923),z=n(98914),H=n(46638),F=n(50364);function A(){let e=(0,r._)(["Are you sure you want to unpin this comment?"]);return A=function(){return e},e}function V(){let e=(0,r._)(["Are you sure you want to pin this comment?"]);return V=function(){return e},e}function U(){let e=(0,o.qp)(E);if(!e)throw Error("useCommentMenu must be used within a CommentMenuProvider");return e}let J=e=>{var t;let{iString:n}=(0,d.M1)(),r=null===(t=e.bans)||void 0===t?void 0:t.find(t=>t.publication_id===e.publication_id),i=r&&T()(r.expiry).diff(T()(),"years")>=1,o=["moderator_removed","deleted"].includes(e.status),l=e.user_banned_for_comment;return{banText:i?n("Banned"):o?"":n("Suspended"),shouldShowBanText:l}};function O(e){let{iString:t}=(0,d.M1)();return()=>window.confirm("".concat(t("Are you sure you want to ".concat(e," this comment? This action cannot be reversed."))))}var Y=n(15771),j=n(19081),q=n(44424),W=n(40949),G=n(75419),K=n(40121),$=n(60308),Q=n(84864);function ee(e){let{comment:t,pub:n,post:r,user:o,onChange:l,startEdit:a,startReport:d,openBan:c,isCollapsed:s,toggleCollapse:u,useMobileBottomSheet:m}=e;return!function(e){let{menuEnabled:t}=ef(e);return t}({comment:t,user:o})?null:(0,i.tZ)(q.v2,{trigger:(0,i.tZ)(j.X2,{className:"triggerContainer-eX588u",children:(0,i.tZ)(et,{})}),useMobileBottomSheet:m,children:(0,i.tZ)(er,{comment:t,pub:n,post:r,user:o,onChange:l,startEdit:a,startReport:d,openBan:c,isCollapsed:s,toggleCollapse:u})})}function et(){return(0,i.tZ)(Y.hU,{priority:"quaternary",size:"sm",className:"trigger-j08Uop",children:(0,i.tZ)(Z.Z,{size:16})})}function en(e){let{sections:t}=e,n=t.map(e=>(0,p._)((0,h._)({},e),{items:e.items.filter(e=>{var t;return null!==e&&(null===(t=e.props)||void 0===t?void 0:t.enabled)!==!1})})).filter(e=>e.items.length>0);return(0,i.tZ)(i.HY,{children:n.map((e,t)=>(0,i.tZ)(q.xw,{isFirst:0===t,children:e.items},e.key))})}function er(e){var t;let{comment:n,pub:r,post:l,user:a,onChange:d,startEdit:c,startReport:s,openBan:u,isCollapsed:m,toggleCollapse:h}=e,p=(0,o.sO)(),Z=ef({comment:n,user:a}),f=[{key:"editing",items:[(0,i.tZ)(el,{enabled:Z.editCommentEnabled,onClick:c})]},{key:"sharing",items:[(0,i.tZ)(eo,{enabled:!0}),(0,i.tZ)(ep,{enabled:Z.restackCommentEnabled})]},{key:"actions",items:[(0,i.tZ)(ea,{enabled:Z.pinCommentEnabled}),(0,i.tZ)(ei,{enabled:!0,isCollapsed:m,toggleCollapse:h}),(0,i.tZ)(ed,{enabled:Z.giftSubscriptionEnabled}),(0,i.tZ)(eZ,{enabled:null!==(t=null==a?void 0:a.is_global_admin)&&void 0!==t&&t}),(0,i.tZ)(ec,{enabled:Z.subscriberDetailsEnabled})]},{key:"admin",items:[(0,i.tZ)(es,{enabled:Z.deleteCommentEnabled}),(0,i.tZ)(eu,{enabled:Z.removeCommentEnabled}),(0,i.tZ)(em,{enabled:Z.reportCommentEnabled,onClick:s}),(0,i.tZ)(eh,{enabled:Z.banUserEnabled,onClick:u})]}];return(0,i.tZ)(I,{value:{comment:n,pub:r,post:l,onChange:d,onMenuClose:()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.close()},toggleCollapse:h},children:(0,i.tZ)(en,{sections:f})})}function ei(e){let{enabled:t,isCollapsed:n,toggleCollapse:r}=e,{iString:o}=(0,d.M1)();return t?(0,i.tZ)(q.sN,{leading:n?(0,i.tZ)(f.Z,{}):(0,i.tZ)(v.Z,{}),onClick:r,children:o(n?"Expand":"Collapse")}):null}function eo(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:r,post:o,pub:l}=U(),a=(0,W.y)();return t?(0,i.tZ)(q.sN,{leading:(0,i.tZ)(b.Z,{}),onClick:()=>{a((0,H.aE)(o,r,l))},children:n("Copy link")}):null}function el(e){let{enabled:t,onClick:n}=e,{iString:r}=(0,d.M1)();return t?(0,i.tZ)(q.sN,{leading:(0,i.tZ)(g.Z,{}),onClick:n,children:r("Edit")}):null}function ea(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:r,onChange:l}=U(),{pinned:a,togglingPin:c,togglePinned:s}=function(e){let{comment:t,onChange:n}=e,{iTemplate:r}=(0,d.M1)(),[i,l]=(0,o.eJ)(!1),a=!!t.pinned_by_user_id,c=async()=>{if(!i&&window.confirm(a?r(A()):r(V()))&&!i){l(!0);try{await R().patch("/api/v1/comment/".concat(t.id,"/pin")).send({pinned:!a}),n({pinned:!a}),document.location.reload()}catch(e){alert((0,z.zx)(e)),l(!1)}}};return{pinned:a,togglingPin:i,togglePinned:c}}({comment:r,onChange:l});return t?(0,i.tZ)(q.sN,{leading:(0,i.tZ)(y.Z,{}),onClick:s,children:n(c?a?"Unpinning...":"Pinning...":a?"Unpin":"Pin")}):null}function ed(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:r,pub:o}=U();if(!t)return null;let l="".concat(o.base_url,"/subscribe?gift=true&recipient=").concat(r.user_id,"-").concat((0,K.Hm)(r.name,{hashIfEmpty:!0}),"&comment_id=").concat(r.id,"}");return(0,i.tZ)(q.sN,{leading:(0,i.tZ)(_.Z,{}),href:l,children:n("Gift a subscription")})}function ec(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:r,pub:o}=U();return t?(0,i.tZ)(q.sN,{leading:(0,i.tZ)(C.Z,{}),onClick:()=>{if(r.email)return window.open((0,$.pN7)(o,r.email),"_blank")},children:n("Subscriber details")}):null}function es(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:r,onChange:l,onMenuClose:a}=U(),{isDeleting:c,deleteComment:s}=function(e){let{comment:t,onChange:n,onMenuClose:r}=e,[i,l]=(0,o.eJ)(!1),a=O("delete"),d=(0,D.Sn)(),c=async()=>{if(!i&&a()){l(!0);try{await d.delete("/api/v1/comment/".concat(t.id)).send(),n({status:F.ql.deleted,deleted:!0,user_id:null,name:null,body:null}),r()}catch(e){alert((0,z.zx)(e))}l(!1)}};return{isDeleting:i,deleteComment:c}}({comment:r,onChange:l,onMenuClose:a});return t?(0,i.tZ)(q.sN,{leading:(0,i.tZ)(w.Z,{}),onClick:s,priority:"destructive",children:n(c?"Deleting...":"Delete")}):null}function eu(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:r,onChange:l,onMenuClose:a}=U(),{isRemoving:c,removeComment:s}=function(e){let{comment:t,onChange:n,onMenuClose:r}=e,[i,l]=(0,o.eJ)(!1),a=O("remove"),d=async()=>{if(!i&&a()){l(!0);try{await R().patch("/api/v1/comment/".concat(t.id,"/status")).send({status:F.ql.moderator_removed}),n({suppressed:!0,status:F.ql.moderator_removed,body:null}),r()}catch(e){alert((0,z.zx)(e))}l(!1)}};return{isRemoving:i,removeComment:d}}({comment:r,onChange:l,onMenuClose:a});return t?(0,i.tZ)(q.sN,{leading:(0,i.tZ)(k.Z,{}),onClick:s,priority:"destructive",children:n(c?"Removing...":"Remove")}):null}function em(e){let{enabled:t,onClick:n}=e,{iString:r}=(0,d.M1)();return t?(0,i.tZ)(q.sN,{leading:(0,i.tZ)(B.Z,{}),onClick:n,priority:"destructive",children:r("Report")}):null}function eh(e){let{enabled:t,onClick:n}=e,{iString:r}=(0,d.M1)();return t?(0,i.tZ)(q.sN,{leading:(0,i.tZ)(x.Z,{}),onClick:n,priority:"destructive",children:r("Ban or suspend user")}):null}function ep(e){let{enabled:t}=e,n=(0,G.i3)(),{comment:r,pub:o,post:l}=U(),{iString:a}=(0,d.M1)();return t?(0,i.tZ)(q.sN,{leading:(0,i.tZ)(N.Z,{}),onClick:()=>{n.open({restackUrl:(0,H.aE)(l,r,o)})},children:a("Restack")}):null}function eZ(e){let{enabled:t}=e,{iString:n}=(0,d.M1)(),{comment:r,post:o,pub:l}=U(),{addCommentToLinear:a}=function(e){let{comment:t,post:n,pub:r}=e,i=()=>{let e=(0,H.aE)(n,t,r),i=encodeURIComponent("".concat(t.body,"\n\nComment author: [").concat(t.name,"](https://admin.substack.com/users/").concat(t.user_id,")\n\nLink: ").concat(e));return"https://linear.app/substackinc/team/TPT/new?description=".concat(i,"&status=Triage")};return{addCommentToLinear:()=>{window.open(i(),"_blank")}}}({comment:r,post:o,pub:l});return t?(0,i.tZ)(q.sN,{leading:(0,i.tZ)(S,{}),onClick:a,children:n("Add to Linear")}):null}function ef(e){let{comment:t,user:n}=e,r=!!(n&&n.id===t.user_id),i=!!(null==n?void 0:n.is_contributor)&&(0,F.Ng)(t),o=(0,Q.canEditComment)(n,t),l=!!(null==n?void 0:n.is_contributor)&&(0,F.Ng)(t)&&""===t.ancestor_path,a=!r&&!!t.metadata.eligibleForGift&&!t.metadata.is_author,d=!r&&!t.reported_by_user&&!t.hidden&&!t.suppressed,c=i&&!r,s=i&&!t.user_banned&&!r,u=!!i&&!!t.email&&!r,m=(0,F.Ng)(t)&&!(null==n?void 0:n.is_oauth),h=o||l||a||d||c||s||u||m;return{editCommentEnabled:o,pinCommentEnabled:l,giftSubscriptionEnabled:a,reportCommentEnabled:d,deleteCommentEnabled:r,removeCommentEnabled:c,banUserEnabled:s,subscriberDetailsEnabled:u,restackCommentEnabled:m,menuEnabled:h}}var ev=n(67749);let eb=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,r=(0,M._)(e,["size","fill"]);return(0,i.tZ)(X.l,(0,p._)((0,h._)({},r),{name:"CommentBadgeHeartIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,children:(0,i.tZ)("path",{stroke:"none",d:"M9.99915 16.7256C9.90515 16.7256 9.79102 16.692 9.65674 16.6249C9.52246 16.5622 9.3949 16.4906 9.27405 16.41C8.02974 15.6044 6.94657 14.7584 6.02454 13.8722C5.10697 12.9815 4.3953 12.0662 3.88953 11.1262C3.38375 10.1818 3.13086 9.23067 3.13086 8.27283C3.13086 7.63725 3.23157 7.05762 3.43298 6.53394C3.63888 6.01025 3.92086 5.55819 4.27893 5.17773C4.64148 4.79728 5.05774 4.50635 5.52771 4.30493C6.00216 4.09904 6.51241 3.99609 7.05847 3.99609C7.73433 3.99609 8.31844 4.16618 8.81079 4.50635C9.30762 4.84652 9.70374 5.28963 9.99915 5.83569C10.299 5.28516 10.6951 4.84204 11.1875 4.50635C11.6843 4.16618 12.2707 3.99609 12.9465 3.99609C13.4836 3.99609 13.9894 4.09904 14.4639 4.30493C14.9428 4.50635 15.3613 4.79728 15.7194 5.17773C16.0774 5.55819 16.3572 6.01025 16.5586 6.53394C16.7645 7.05762 16.8674 7.63725 16.8674 8.27283C16.8674 9.23067 16.6145 10.1818 16.1088 11.1262C15.603 12.0662 14.8891 12.9815 13.967 13.8722C13.0495 14.7584 11.9708 15.6044 10.731 16.41C10.6056 16.4906 10.4758 16.5622 10.3416 16.6249C10.2118 16.692 10.0976 16.7256 9.99915 16.7256Z"})}))};var eg=n(42970),ey=n(63474),e_=n(43570),eC=n(87077);function ew(){let e=(0,r._)(["Pinned by ",""]);return ew=function(){return e},e}function ek(){let e=(0,r._)(["Liked by ",""]);return ek=function(){return e},e}let eB=e=>{let{comment:t}=e;return t.pinned_by_user_id?(0,i.tZ)(ex,{name:t.pinned_by_name}):t.metadata.is_author?(0,i.tZ)(eN,{}):t.reactor_names.length>0?(0,i.tZ)(eM,{names:t.reactor_names}):null},ex=e=>{let{name:t}=e,{iString:n,iTemplate:r}=(0,d.M1)();return t?(0,i.tZ)(eC.u,{text:r(ew(),t),layerOptions:{placement:"top-center",triggerOffset:8},children:(0,i.tZ)(e_.Vp,{priority:"secondary",cursor:"pointer",fillIcon:!0,leading:(0,i.tZ)(eg.Z,(0,h._)({},e_.NH)),children:n("Pinned")})}):(0,i.tZ)(e_.Vp,{priority:"secondary-outline",fillIcon:!0,leading:(0,i.tZ)(eg.Z,(0,h._)({},e_.NH)),children:n("Pinned")})},eN=()=>{let{iString:e}=(0,d.M1)();return(0,i.tZ)(e_.Vp,{priority:"secondary-outline",theme:"accent",children:e("Author")})},eM=e=>{let{names:t}=e,{iTemplate:n}=(0,d.M1)();return(0,i.tZ)(e_.Vp,{theme:"accent",priority:"secondary-outline",fillIcon:!0,leading:(0,i.tZ)(eb,(0,h._)({},e_.NH)),children:n(ek(),t.join(", "))})},eX=e=>{let{comment:t,userBanned:n}=e,{banText:r,shouldShowBanText:o}=J(t);return!o||n?null:(0,i.tZ)(e_.Vp,{priority:"secondary",children:r})},eS=e=>{let{comment:t,userPendingApproval:n}=e,{iString:r}=(0,d.M1)();return n?(0,i.tZ)(ey.A0,{href:"/publish/moderation/new-commenters?user=".concat(t.user_id),target:"_blank",rel:"noopener",children:(0,i.tZ)(e_.Vp,{priority:"secondary",cursor:"pointer",trailing:(0,i.tZ)(ev.Z,(0,h._)({},e_.NH)),children:r("Awaiting approval")})}):null},eE=e=>{let{children:t}=e;return(0,i.tZ)(j.X2,{gap:4,children:t})};var eI=n(71068),eL=n(58175),eT=n(33017),eP=n(98012),eR=n(47929);function eD(){let e=(0,r._)(["Edited"]);return eD=function(){return e},e}function ez(e){let{post:t,pub:n,comment:r,isCollapsed:o,onProfileClick:l,userBanned:a,toggleCollapse:d,userPendingApproval:u,disableHoverCard:m,onChange:h,startEdit:p,startReport:Z,openBan:f,hideContextMenu:v,useMobileBottomSheet:b}=e,g=(0,c.aF)();return(0,i.BX)(j.gq,{children:[(0,i.BX)(eY,{children:[(0,i.tZ)(s.KF,{children:(0,i.BX)(s.Gf,{children:[(0,i.tZ)(eH,{comment:r,onClick:l,disableHoverCard:m}),(0,i.tZ)(eF,{comment:r}),(0,i.tZ)(eV,{comment:r,post:t,pub:n}),(0,i.tZ)(eU,{comment:r})]})}),!o&&(0,i.tZ)(eO,{comment:r,userBanned:a,userPendingApproval:u}),(0,i.tZ)(eJ,{comment:r,isCollapsed:o,toggleCollapse:d})]}),(0,i.tZ)(ej,{onClick:d}),!v&&(0,i.tZ)(ee,{comment:r,pub:n,post:t,user:g,onChange:h,startEdit:p,startReport:Z,openBan:f,isCollapsed:o,toggleCollapse:d,useMobileBottomSheet:b})]})}function eH(e){let{comment:t,onClick:n,disableHoverCard:r}=e,{iString:o}=(0,d.M1)();if(t.name&&!a()(t.user_id))return(0,i.tZ)(eL.xv.B4,{display:"flex",gap:6,children:(0,i.tZ)(s.Lg,{user:(0,H.gz)(t),onClick:n?()=>n(t):void 0,disableHoverCard:r})});let l=o(t.hidden?"Comment hidden":t.deleted?"Comment deleted":(0,F.Ng)(t)?"Anonymous":"Comment removed");return(0,i.tZ)(eL.xv.B4,{color:"secondary",children:l})}function eF(e){var t,n,r,o,l;let{comment:a}=e,d=(null===(t=a.metadata)||void 0===t?void 0:t.author_on_other_pub)&&!a.metadata.is_author,c=(null===(r=a.metadata)||void 0===r?void 0:null===(n=r.author_on_other_pub)||void 0===n?void 0:n.id)&&!a.hidden;return d?c?(0,i.tZ)(eT.Sm,{publication_id:null!==(l=null===(o=a.metadata.author_on_other_pub)||void 0===o?void 0:o.id)&&void 0!==l?l:0,children:(0,i.tZ)(eA,{comment:a})}):(0,i.tZ)(eA,{comment:a}):null}function eA(e){var t;let{comment:n,disableHoverCard:r}=e,o=(0,c.aF)();return n.metadata.author_on_other_pub&&o?(0,i.tZ)(eL.xv.B4,{as:"span",color:"secondary",weight:"regular",children:(0,i.tZ)(u.G6,{publication:n.metadata.author_on_other_pub,utm_source:eR.b3.substackFeedItem,utm_content:eR.fZ.commentMetadata,disableHoverCard:r,user:o,children:(0,i.BX)("span",{children:[(0,Q.truncateText)(null===(t=n.metadata.author_on_other_pub)||void 0===t?void 0:t.name,32)," "]})})}):null}function eV(e){let{comment:t,post:n,pub:r}=e;return(0,i.tZ)(eL.hh,{href:(0,H.aE)(n,t,r),onClick:e=>null===this||void 0===this?void 0:this.onDateClick(e),rel:"nofollow",native:!0,color:"secondary",title:s.c9.format((0,eP.Z)(t.date).toDate()),children:(0,i.tZ)(m.Ku,{timestamp:t.date})})}function eU(e){let{comment:t}=e,{iTemplate:n}=(0,d.M1)();return t.edited_at?(0,i.tZ)(eL.xv.B4,{as:"span",fontStyle:"italic",decoration:"hover-underline",cursor:"pointer",color:"tertiary",title:s.c9.format((0,eP.Z)(t.edited_at).toDate()),children:n(eD())}):null}function eJ(e){let{comment:t,toggleCollapse:n,isCollapsed:r}=e,{iString:l}=(0,d.M1)(),[a,c]=(0,o.eJ)(!1);if(!r||!n)return null;let s=e=>{var t,n;return(null!==(t=e.children)&&void 0!==t?t:[]).length+(null!==(n=e.children)&&void 0!==n?n:[]).reduce((e,t)=>e+s(t),0)},u=s(t),m=l(a?"Loading":u>0?"Show replies":"Show comment");return(0,i.tZ)(j.X2,{children:(0,i.tZ)(Y.zx,{size:"sm",flex:"auto",priority:"secondary-outline",maxHeight:28,onClick:()=>{c(!0),setTimeout(()=>{n(),c(!1)},0)},children:m})})}function eO(e){let{comment:t,userBanned:n,userPendingApproval:r}=e,o=eB({comment:t}),l=eX({comment:t,userBanned:n}),a=eS({comment:t,userPendingApproval:r});return o||l||a?(0,i.BX)(eE,{children:[o,l,a]}):null}let eY=(0,eI.zo)({display:"flex",direction:"column",gap:4}),ej=(0,eI.zo)({display:"flex",direction:"column",flex:"grow"})},75496:function(e,t,n){n.d(t,{v:()=>function e(t,n){let o=[],l=!1,a=new Map(t.map(e=>[e.id,e]));for(let t of n){let n=a.get(t.id);if(n){var d,c;(n.children&&t.children?e(n.children,t.children):t.children)!==n.children||i.some(e=>n[e]!==t[e])||!(0,r.wU)(null!==(d=n.reactions)&&void 0!==d?d:{},null!==(c=t.reactions)&&void 0!==c?c:{})?(o.push(t),l=!0):o.push(n)}else o.push(t),l=!0}return l?o:t}});var r=n(75561);let i=["edited_at","deleted","status"]},21266:function(e,t,n){n.d(t,{H:()=>o});var r=n(7409),i=n(99282);function o(e,t){var n,o;return function e(t,n,o){let l=n[0];if(!l){let e=t.findIndex(e=>e.id===o.id);return e>=0?t.with(e,o):[...t,o]}let a=t.findIndex(e=>e.id===l);if(a>=0){let l=t[a];if(l.id===o.id)return t.with(a,o);if(l.children)return t.with(a,(0,i._)((0,r._)({},l),{children:e(l.children,n.slice(1),o)}))}return t}(e,null!==(o=null===(n=t.ancestor_path)||void 0===n?void 0:n.split(".").map(Number))&&void 0!==o?o:[],t)}},17172:function(e,t,n){n.d(t,{aZ:()=>o});var r=n(98661),i=n(41302);function o(e){let t=(0,r.useRef)({isDragging:!1,didDrag:!1,startX:0,startY:0,startTime:0,scrollLeft:0,velX:0,pointerId:0,momentumId:null,overscrollX:0}),{handleOverscroll:n,resetOverscroll:o}=function(e){let t=()=>(e.current&&i.Z.overscrollTransition&&(e.current.classList.add(i.Z.overscrollTransition),e.current.style.transform="",setTimeout(()=>{e.current&&i.Z.overscrollTransition&&e.current.classList.remove(i.Z.overscrollTransition)},200)),0);return{handleOverscroll:(e,n,r)=>{let o=e.scrollWidth-e.clientWidth,l=r;i.Z.overscrollTransition&&e.classList.remove(i.Z.overscrollTransition);let a=t=>{let n=-t/5;return e.style.transform="translateX(".concat(n,"px)"),n};return n<0?(e.scrollLeft=0,l=a(n)):n>o?(e.scrollLeft=o,l=a(n-o)):(l=0,t(),e.scrollLeft=n),l},resetOverscroll:t}}(e),l=()=>{null!==t.current.momentumId&&(cancelAnimationFrame(t.current.momentumId),t.current.momentumId=null)},a=()=>{l(),t.current.momentumId=requestAnimationFrame(d)},d=()=>{if(!e.current)return;let n=t.current;e.current.scrollLeft+=n.velX,n.velX*=.9,Math.abs(n.velX)>.5&&(n.momentumId=requestAnimationFrame(d))},c=()=>{let t=e.current;return!!t&&t.scrollWidth>t.clientWidth},s=n=>{let r=t.current;if(!r.isDragging||n.pointerId!==r.pointerId)return;window.removeEventListener("pointerup",s),window.removeEventListener("pointercancel",s),r.didDrag&&n.preventDefault(),r.isDragging=!1,r.overscrollX=o();let i=e.current;if(i&&(i.releasePointerCapture(n.pointerId),r.didDrag)){let e=e=>{e.preventDefault(),e.stopImmediatePropagation()};i.addEventListener("click",e,{capture:!0,once:!0}),setTimeout(()=>{i.removeEventListener("click",e,{capture:!0})},100),r.didDrag=!1}a()};return{props:{onPointerDown:n=>{if("mouse"!==n.pointerType||0!==n.button||n.ctrlKey||n.metaKey||n.shiftKey||n.altKey||!c()||!e.current)return;n.preventDefault();let r=t.current;r.isDragging=!0,r.didDrag=!1,r.startX=n.pageX,r.startY=n.pageY,r.startTime=Date.now(),r.scrollLeft=e.current.scrollLeft,r.pointerId=n.pointerId,l(),window.addEventListener("pointerup",s),window.addEventListener("pointercancel",s)},onPointerMove:r=>{let i=t.current;if(!i.isDragging||!e.current||r.pointerId!==i.pointerId||!c())return;r.preventDefault(),!i.didDrag&&function(e,t,n,r,i){let o=Math.abs(e-n),l=Math.abs(t-r),a=Date.now()-i;return o>2||l>2||a>50}(r.pageX,r.pageY,i.startX,i.startY,i.startTime)&&(e.current.setPointerCapture(r.pointerId),i.didDrag=!0);let o=r.pageX-i.startX,l=e.current.scrollLeft,a=i.scrollLeft-o;i.overscrollX=n(e.current,a,i.overscrollX),i.velX=e.current.scrollLeft-l},onLostPointerCapture:s},didDrag:()=>t.current.didDrag,hasOverflow:c}}},37155:function(e,t,n){n.d(t,{g:()=>r});function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(t=>{setTimeout(t,e)})}}}]);