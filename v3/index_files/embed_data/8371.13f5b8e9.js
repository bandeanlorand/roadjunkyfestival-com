"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8371"],{44854:function(t,e,n){n.d(e,{Z:()=>r});let r={root:"root-MjHNqP",isOnInbox:"isOnInbox-pP0vQF",paywallStack:"paywallStack-RdkSad",pubChatColumn:"pubChatColumn-Zck7MX",pubChatFull:"pubChatFull-tEPJ4X",submit:"submit-T76OjY",inactive:"inactive-RF_jH9",chatPublicationContainer:"chatPublicationContainer-y1FRFU",invitesRow:"invitesRow-QZEeej",show:"show-vL_rsU",unfurl:"unfurl-n5q4dW",sticky:"sticky-ykmBOy",unreadDot:"unreadDot-fNgNDl",unreadTabDot:"unreadTabDot-aqz7wG",selected:"selected-oDAfJA",currentVisibilityBox:"currentVisibilityBox-VAGH9Q",headerPubLink:"headerPubLink-uygNA1",sidebarRowTitle:"sidebarRowTitle-wepYF4",headerPubAvatar:"headerPubAvatar-jFmd9c",inputBox:"inputBox-UuLYvf",modalContext:"modalContext-nC14Y0",textInputInset:"textInputInset-jnSii9",invisible:"invisible-AW4ANv",textInput:"textInput-zlmYim",dropzone:"dropzone-W750JH",submitButton:"submitButton-_zJ5fy",newThreadButton:"newThreadButton-POT_Ph",roundedFooterPlaceholder:"roundedFooterPlaceholder-k7TSWJ",chatContainer:"chatContainer-fnFgIy",fade:"fade-HKCqnN",composerLinkPreview:"composerLinkPreview-cBU00h",composer:"composer-rYAaNa",imageBox:"imageBox-NAFgde",image:"image-PfNhry",deleteFile:"deleteFile-gv_fWj",modalColumn:"modalColumn-fVvKpE",visibilityDropdown:"visibilityDropdown-mnqCEz",visibilityDropdownText:"visibilityDropdownText-uW5qxU",messageSquareIcon:"messageSquareIcon-_NUoeX",paywall:"paywall-hfm67h",modalChatEditor:"modalChatEditor-bbcasD",newText:"newText-IkD33N",newBorder:"newBorder-fycRk_",jumpButton:"jumpButton-yc047J",jumpBadge:"jumpBadge-IO2hJP"}},4473:function(t,e,n){n.d(e,{Z:()=>c});var r=n(7409),o=n(99282),i=n(98848),a=n(16584),l=n(64515);let c=t=>{var{size:e=24,fill:n="var(--color-fg-primary)",className:c}=t,s=(0,i._)(t,["size","fill","className"]);return(0,a.BX)(l.l,(0,o._)((0,r._)({},s),{name:"SubstackIcon",svgParams:{viewBox:"0 0 20 20"},width:e,height:e,fill:n,stroke:"none",className:c,children:[(0,a.tZ)("path",{d:"M1.96484 0.624512H18.0354V2.70052H1.96484V0.624512Z",stroke:"none"}),(0,a.tZ)("path",{d:"M1.96484 4.77655H18.0354V6.85254H1.96484V4.77655Z",stroke:"none"}),(0,a.tZ)("path",{d:"M1.96484 8.92857V19.9505L10.0001 14.6347L18.0354 19.9505V8.92857H1.96484Z",stroke:"none"})]}))}},77906:function(t,e,n){n.d(e,{UK:()=>C});var r=n(7409),o=n(99282),i=n(58865),a=n(16584),l=n(20160),c=n(95441),s=n(92291),u=n(77338),d=n(5952),m=n(79251),h=n(25991),p=n(53678),v=n(76721),f=n(93252),g=n(94874),b=n(19081),y=n(58175),_=n(87989),k=n(2009),w=n(50312),B=n(63651),Z=n(47929),x=n(5749);function P(){let t=(0,i._)(["This content is only visible to paid subscribers of ",""]);return P=function(){return t},t}function C(t){let{parent:e,comment:n,publication:r,readOnly:o,onAttachmentClick:i,utm_content:c,isDm:s,isPermalink:u}=t,d=(0,w.F)({onClick:()=>null==i?void 0:i({commentId:String(n.id)}),href:o?void 0:(0,B.Sgq)(n,{noBase:k.L}),state:{showBack:!0}});return(0,a.tZ)(l.W,{children:(0,a.tZ)(S,{readOnly:o,linkProps:d,isEmbed:f.P,children:(0,a.tZ)(F,{parent:e,comment:n,publication:r,readOnly:o,onAttachmentClick:i,utm_content:c,isDm:s,isPermalink:u})})})}function S(t){let{children:e,readOnly:n,linkProps:i,isEmbed:l}=t;return(0,a.tZ)(b.tu,(0,o._)((0,r._)({as:n?"div":"a",bg:"primary",border:"detail",radius:"md",padding:12,gap:8,target:l()?"_blank":void 0,draggable:!1},i),{showFocus:!0,animate:!0,className:x.Z.commentContainer,children:e}))}function F(t){var e,n,r;let{parent:o,comment:i,publication:l,readOnly:c,onAttachmentClick:s,utm_content:u,isDm:d,isPermalink:m}=t,{truncatedBodyJson:h}=(0,v.Z)(i,{truncationProfile:"small"}),p=null!==(r=i.user)&&void 0!==r?r:i.user_id?{id:i.user_id,name:null!==(e=i.name)&&void 0!==e?e:"",photo_url:i.photo_url,bestseller_tier:null!==(n=i.user_bestseller_tier)&&void 0!==n?n:void 0}:null;return(0,a.BX)(a.HY,{children:[p&&(0,a.tZ)(I,{commentUser:p,comment:i,readOnly:c,utm_content:u}),(0,a.tZ)(T,{parent:o,comment:i,publication:l,truncatedBodyJson:h,isDm:d,onAttachmentClick:s,utm_content:u,readOnly:c,isPermalink:m})]})}function I(t){let{commentUser:e,comment:n,readOnly:r,utm_content:o}=t;return e?(0,a.BX)(b.hs,{gap:6,alignItems:"center",justifyContent:"start",children:[(0,a.tZ)(w.r,{href:(0,B.NNq)(e,{noBase:k.L,utm_content:Z.fZ.substackFeedItem,utm_source:null!=o?o:void 0}),target:(0,f.P)()?"_blank":void 0,showBack:!0,radius:"full",showFocus:!0,animate:!0,children:(0,a.tZ)(g.qE,{size:20,user:e})}),(0,a.tZ)(y.xv.B4,{weight:"medium",color:"primary",children:r?e.name:(0,a.BX)(b.hs,{gap:8,direction:"row",justifyContent:"space-between",children:[(0,a.tZ)(p.xG,{user:e,utm_source:Z.b3.substackFeedItem,utm_content:o,children:e.name}),(null==e?void 0:e.bestseller_tier)!=null&&(0,a.tZ)(_.UserBadge,{tier:e.bestseller_tier,userId:e.id,tooltipOnHover:!0,size:"sm"})]})}),(0,a.tZ)(y.xv.B4,{as:"span",color:"secondary",children:(0,a.tZ)(h.mn,{timestamp:n.date,comment:n})})]}):null}function T(t){var e,n,r,o,i;let{parent:l,comment:s,publication:u,truncatedBodyJson:d,isDm:m,isPermalink:h,readOnly:p,onAttachmentClick:v,utm_content:f}=t,{iString:g,iTemplate:b}=(0,c.M1)(),y=null!==(i=null==u?void 0:u.name)&&void 0!==i?i:g("this publication"),_=b(P(),y),k=null==l?void 0:null===(e=l.attachments)||void 0===e?void 0:e.some(t=>"image"===t.type||"video"===t.type),w=null===(n=s.attachments)||void 0===n?void 0:n.some(t=>"image"===t.type||"video"===t.type),B=null===(r=s.attachments)||void 0===r?void 0:r.some(t=>"image"!==t.type&&"video"!==t.type&&"live_stream"!==t.type),Z=null===(o=s.attachments)||void 0===o?void 0:o.some(t=>"post"===t.type&&t.postSelection),x=!1;return k||w&&B||B&&!Z?(0,a.tZ)(D,{comment:s,truncatedBodyJson:d,hiddenText:_,onAttachmentClick:v,utm_content:f}):(0,a.tZ)(H,{comment:s,truncatedBodyJson:d,hiddenText:_,onAttachmentClick:v,utm_content:f,readOnly:p,isDm:m,isPermalink:h})}function D(t){var e,n;let{comment:r,truncatedBodyJson:o,hiddenText:i,onAttachmentClick:l,utm_content:c}=t;return(0,a.tZ)(a.HY,{children:(0,a.BX)(b.hs,{gap:8,direction:"row",flex:"grow",justifyContent:"space-between",children:[(0,a.BX)(b.tu,{gap:4,children:[(0,a.tZ)(u.h,{content:o,isHidden:r.hidden,hiddenText:i,attachedLinks:(0,d.Bk)(r)}),(0,a.tZ)(m.Mi,{attachments:null!==(e=r.attachments)&&void 0!==e?e:[],onAttachmentClick:l,utm_content:c})]}),(0,a.tZ)(s.Gn,{attachments:null!==(n=r.attachments)&&void 0!==n?n:[]})]})})}function H(t){var e;let{comment:n,truncatedBodyJson:r,hiddenText:o,onAttachmentClick:i,utm_content:l,readOnly:c,isDm:m,isPermalink:h}=t;return(0,a.BX)(a.HY,{children:[(0,a.tZ)(u.h,{content:r,isHidden:n.hidden,hiddenText:o,attachedLinks:(0,d.Bk)(n)}),(0,a.tZ)(s.yd,{attachments:null!==(e=n.attachments)&&void 0!==e?e:[],onAttachmentClick:i,utm_content:l,isRestack:!0,readOnly:c,isDm:m,isPermalink:h})]})}},1669:function(t,e,n){n.d(e,{o:()=>a});var r=n(16584),o=n(98914),i=n(58175);let a=t=>{let{error:e}=t,n=(0,o.HM)(e);return(null==n?void 0:n.html)?(0,r.tZ)(i.xv.B4,{weight:"medium",color:"error",dangerouslySetInnerHTML:{__html:n.html}}):(0,r.tZ)(i.xv.B4,{weight:"medium",color:"error",children:(null==n?void 0:n.msg)||"Something went wrong"})}},76566:function(t,e,n){n.d(e,{S:()=>d});var r=n(27412),o=n(16584),i=n(20042),a=n(98661),l=n(20888),c=n(9682),s=n(19081),u=n(58175);class d extends a.Component{static getDerivedStateFromError(t){return{error:t}}componentDidMount(){Promise.all([n.e("7152"),n.e("6993")]).then(n.bind(n,91985)).then(t=>{this.Sentry=t.Sentry})}componentDidCatch(t){console.error(t),this.Sentry&&this.Sentry.captureException(t)}render(){let{error:t}=this.state;return(0,o.tZ)(m,{onReset:()=>this.setState({error:null}),error:t,children:t?(0,o.tZ)(h,{}):this.props.children})}constructor(t){super(t),(0,r._)(this,"Sentry",null),this.state={error:null}}}function m(t){let{onReset:e,error:n,children:r}=t,l=(0,a.useRef)((0,i.getCurrentUrl)());return(0,c.js)(t=>{n&&l.current!==t&&e(),l.current=t},[]),n?(0,o.tZ)(h,{}):r}function h(){return(0,o.BX)(s.tu,{flex:"grow",justifyContent:"center",alignItems:"center",gap:32,padding:20,children:[(0,o.tZ)(l.e,{src:"/img/reader/toad.png",maxWidth:200}),(0,o.BX)(s.tu,{gap:8,children:[(0,o.tZ)(u.xv.H3,{weight:"semibold",align:"center",children:"Oh noâ€”this page croaked."}),(0,o.tZ)(u.xv.B3,{color:"secondary",align:"center",children:"Try again, or hop to another page."})]})]})}},50312:function(t,e,n){n.d(e,{F:()=>h,r:()=>m});var r=n(7409),o=n(99282),i=n(98848),a=n(16584),l=n(98661),c=n(20042),s=n(21811),u=n(93252),d=n(71068);let m=(0,l.forwardRef)((t,e)=>{var{href:n,onClick:l,campaign:c,replace:s,state:u,showBack:m}=t,p=(0,i._)(t,["href","onClick","campaign","replace","state","showBack"]);let v=h({href:n,onClick:l,campaign:c,replace:s,state:u=m?(0,o._)((0,r._)({},u),{showBack:!0}):u});return(0,a.tZ)(d.xu,(0,r._)((0,o._)((0,r._)({as:"a"},p),{ref:e}),v))});function h(t){let{onClick:e,href:n,campaign:o,replace:i,state:a}=t;if(n&&!(0,u.P)()){let t;try{t=new URL(n)}catch(e){try{t=new URL("".concat(document.location.origin).concat(n))}catch(t){}}if(t){if(t.origin!==document.location.origin||o){if(t.origin!==document.location.origin&&o){for(let[e,n]of Object.entries(o)){let r="name"===e?"campaign":e;t.searchParams.set("utm_".concat(r),n)}n=t.toString()}}else{let e=new URLSearchParams,r={};for(let[n,o]of t.searchParams)n.startsWith("utm_")?"utm_campaign"===n?r.name=o:r[n.replace(/^utm_/,"")]=o:e.append(n,o);o=r,n="".concat(t.pathname,"?").concat(e)}}}return{href:n,onClick:t=>{if(null==e||e(t),!t.ctrlKey&&!t.shiftKey&&!t.metaKey&&n&&!(0,u.P)()){if(t.defaultPrevented){t.stopPropagation();return}(0,s.j)((0,r._)({},o)),t.preventDefault(),t.stopPropagation(),(0,c.route)(n,i),a&&history.replaceState(a,"")}}}}},69304:function(t,e,n){n(16584),n(19081),n(58175),n(44854)},93502:function(t,e,n){n(48980)},65958:function(t,e,n){n.d(e,{s:()=>p});var r=n(7409),o=n(99282),i=n(16584),a=n(48980),l=n(80878),c=n(7882),s=n(70379),u=n(97842),d=n(95551),m=n(62515),h=n(36186);function p(t){let{source:e}=t,n=function(t){let{source:e}=t,n=(0,u.I0)(),i=(0,c.ib)({pathname:"/api/v1/messages/dm/start",method:"POST"}),a=async t=>{let r=await i.refetch({json:{user_ids:t,source:e}});return r instanceof Error||n({type:"conversation-load_more",payload:{edge:"before",cursor:null,page:r}}),r};return(0,o._)((0,r._)({},i),{handleStart:a})}({source:e}),p=(0,d.d)(),v=(0,s.pm)(),f=async t=>{var e;let c=await n.handleStart(t);return c instanceof Error?(c instanceof a.kp&&(null===(e=c.body)||void 0===e?void 0:e.type)==="profile_not_set_up"?v.popToast(t=>(0,i.tZ)(s.FN,(0,o._)((0,r._)({},t),{text:"Please set up your profile before sending a message.",cta:"Set up profile",href:(0,h.Nh)({utm_source:"substack",utm_campaign:"chat_dm_button",redirect:window.location}),localNavigation:!1}))):p(c,"Could not start conversation."),!1):((0,l._)((0,m.Rm)(c.thread.id)),!0)};return(0,o._)((0,r._)({},n),{handleStart:f})}},32189:function(t,e,n){n.d(e,{x:()=>l});var r=n(30396),o=n(60807),i=n(68833),a=n(88817);function l(t){let{surface:e,zIndex:n=null}=t,l=(0,o.aF)(),{onboardingModalRef:c}=(0,a.SJ)();return(0,r.d4)(()=>{c.current&&null!==n&&(c.current.props.zIndex=n)},[c,n]),(t,n)=>r=>{if(!t){console.warn("No publication provided to usePubOnboardingHandler handler");return}if(!l){var o,a;if(!c.current)return;r.preventDefault(),n?null===(o=c.current)||void 0===o||o.openForPub(t,n):null===(a=c.current)||void 0===a||a.openToPubSignup(t);return}(0,i.x6)(t,e)}}}}]);