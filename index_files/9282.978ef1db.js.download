"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["9282"],{51885:function(e,t,n){n.d(t,{Z:()=>o});let o={mention:"mention-pnpTE1",mentionStatic:"mentionStatic-liMklk"}},5772:function(e,t,n){n.d(t,{R:()=>a});var o=n(30396),r=n(23279),u=n.n(r);function a(e){let{items:t,getKeys:n,sort:r=!0,sortFunc:a,deps:c}=e,s=(e,t)=>{let o=n(e),r=n(t);for(let e=0;e<Math.min(o.length,r.length);e++){let t=o[e].localeCompare(r[e]);if(0!==t)return t}return o.length-r.length},[i,l]=(0,o.eJ)(""),d=(0,o.Ye)(()=>u()(l,100),[l]),f=i.trim();return{setQuery:d,filteredItems:(0,o.Ye)(()=>{if(!f)return t;let e=t.filter(e=>n(e).some(e=>e.toLowerCase().includes(f.toLowerCase())));return(r||a)&&(e=e.sort(a||s)),e},c?[f,...c]:[f,t]),hasFiltered:""!==f,query:f}}},46914:function(e,t,n){n.d(t,{z:()=>r});var o=n(30396);function r(e){let t=(0,o.sO)(e);return t.current=e,(0,o.Ye)(()=>function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.current(...n)},[])}},90406:function(e,t,n){n.d(t,{Hu:()=>o,yK:()=>r});let o="#ff6719",r=48},19834:function(e,t,n){n.d(t,{Z:()=>u});var o=n(86492),r=n.n(o);function u(e){let{only_non_ascii:t=!1,useNamedReferences:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?r().encode(e||"",{useNamedReferences:n,decimal:!0,allowUnsafeSymbols:t}):e}},86551:function(e,t,n){n.d(t,{BN:()=>B,F2:()=>v,Fp:()=>T,HQ:()=>w,Lb:()=>C,S_:()=>U,T6:()=>N,U0:()=>S,Ui:()=>W,aZ:()=>k,op:()=>x,pw:()=>L,sj:()=>R,tX:()=>E});var o=n(58865),r=n(60826),u=n(68833),a=n(60308),c=n(63651),s=n(84864),i=n(47929),l=n(68303),d=n(39947);function f(){let e=(0,o._)(["Start writing today. Use the button below to create a Substack of your own"]);return f=function(){return e},e}function p(){let e=(0,o._)(["Share ",""]);return p=function(){return e},e}function m(){let e=(0,o._)(["Get ","% off a group subscription"]);return m=function(){return e},e}function h(){let e=(0,o._)(["Get a group subscription"]);return h=function(){return e},e}function b(){let e=(0,o._)(["Give a gift subscription"]);return b=function(){return e},e}function g(){let e=(0,o._)(["","! Subscribe for free to receive new posts and support my work."]);return g=function(){return e},e}function _(){let e=(0,o._)(["",". To receive new posts and support my work, consider becoming a free or paid subscriber."]);return _=function(){return e},e}function y(){let e=(0,o._)(["","! This post is public so feel free to share it."]);return y=function(){return e},e}let S=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let u={url:"".concat(r.W.CHECKOUT_URL,"&donate=true"),text:o("Donate Subscriptions")};return n&&n((0,l.o4)(t,t.schema.nodes.button.create(u))),!0},C=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let u={url:"".concat(r.W.LEADERBOARD_URL,"&utm_source=").concat(i.b3.post),text:o("Refer a friend")};return n&&n((0,l.o4)(t,t.schema.nodes.button.create(u))),!0},w=e=>{let{writerReferralCode:t,publication:n,postId:o}=e;return(e,r)=>{let{iString:u,iTemplate:c}=I18N.i({pub:n});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!e.schema.nodes.captionedWriterReferralButton)return console.error("captionedWriterReferralButton node type not found in schema"),!1;if(!e.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let s=c(f()),p={url:"".concat((0,a.Fnz)(t||""),"?utm_source=").concat(i.b3.substack,"&utm_context=").concat(i.gD.post,"&utm_content=").concat(o,"&utm_campaign=").concat(i.VX.writerReferralButton),text:u("Start a Substack")},m=e.schema.nodes.captionedWriterReferralButton.create(p,e.schema.nodes.ctaCaption.create(null,[e.schema.text(s)]));return r&&r((0,l.o4)(e,m)),!0}},R=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let u={url:r.W.HALF_MAGIC_COMMENTS_URL,text:o("Leave a comment")};return n&&n((0,l.o4)(t,t.schema.nodes.button.create(u))),!0},v=(e,t,n)=>(o,r)=>{if((0,u.j)(u.FP.READER_SURVEY_LINKED_IN_POST,{editorVersion:"1",surveyId:t.id}),!o.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(o,o.schema.nodes.button))return!1;let a={url:"".concat((0,c.h8g)(e,t.id)),text:n};return r&&r((0,l.o4)(o,o.schema.nodes.button.create(a))),!0},B=e=>(t,n)=>{let{iString:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let u={url:r.W.SHARE_URL,text:o("Share")};return n&&n((0,l.o4)(t,t.schema.nodes.button.create(u))),!0},U=e=>(t,n)=>{let{iTemplate:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let u={url:r.W.SHARE_PUB_URL,text:o(p(),e.name)};return n&&n((0,l.o4)(t,t.schema.nodes.button.create(u))),!0},L=e=>{let{couponPub:t,scrollParent:n,parentClass:o,get_coupons:r,insert_coupon:u,SelectField:c,openPrompt:s,closePrompt:i,getNetworkErrorMessage:l}=e;return(e,f,p)=>{let{iString:m}=I18N.i({pub:t});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let h={parentClass:o,root:n?document.querySelector(".".concat(n)):p.dom.parentNode,scrollParent:n,offsetTop:10},b=Object.assign({title:m("Loading..."),no_buttons:!0,language:t.language},h);return s(b),r().then(n=>{i(b);let o=n.map(e=>{var t;return{label:null!==(t=e.name)&&void 0!==t?t:"",value:e}}).concat([{label:m("Create new offer"),value:{create_new:!0}}]),r={coupon:new c({label:m("Select offer..."),required:!0,options:o,onChange:n=>{if(n&&"create_new"in n&&n.create_new){i(l);let n=window.open("".concat((0,a.SVA)(t),"/publish/offers/new?popup=true"),"_blank");n&&n.addEventListener&&n.addEventListener("message",t=>{let{data:n}=t;n&&n.coupon&&u({coupon:n.coupon,state:e,dispatch:f,schema:e.schema})},!1)}}})},l=Object.assign({title:m("Special Offer"),fields:r,language:null==t?void 0:t.language,onSubmit:t=>{let{coupon:n}=t;u({coupon:n,state:e,dispatch:p.dispatch,schema:e.schema})},onClose:()=>{p.focus()}},h);s(l)}).catch(e=>{i(b),alert(l(e))}),!1}},x=e=>{let{scrollParent:t,parentClass:n,TextField:o,openPrompt:r,publication:u}=e;return(e,a,c)=>{let{iString:s}=I18N.i({pub:u});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let i={parentClass:n,title:s("Create a button"),root:t?document.querySelector(".".concat(t)):c.dom.parentNode,scrollParent:t,offsetTop:10,language:null==u?void 0:u.language,fields:{text:new o({label:s("Enter text..."),required:!0,clean:e=>(e||"").trim(),validate:e=>{if(e.length>40)return s("Too long")}}),href:new o({label:s("Enter URL..."),required:!0,clean:e=>(e||"").trim(),validate:e=>{if(!/^%%.*%%$/.test(e)){try{let t=new URL(e);if(["http:","https:","mailto:"].includes(t.protocol))return}catch(e){console.error("Failed to parse URL:",e)}return s("Invalid URL")}}})}};return i.onSubmit=t=>{let n={url:t.href,text:t.text};if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;a&&c.dispatch((0,l.o4)(e,e.schema.nodes.button.create(n)))},i.onClose=()=>{c.focus()},r(i),!0}},T=e=>{let{publication:t}=e;return(e,n)=>{let{iTemplate:o}=I18N.i({pub:t});if(!e.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(e,e.schema.nodes.button))return!1;let u=t.default_group_coupon,a={url:"".concat(r.W.CHECKOUT_URL,"group=true").concat(u?"&coupon=".concat(u):""),text:(0,s.getSubscriptionSentenceWithCustomWords)(t,()=>{var e;return u&&t.default_group_coupon_percent_off?o(m(),null!==(e=t.default_group_coupon_percent_off.split(".")[0])&&void 0!==e?e:""):o(h())},e=>u&&t.default_group_coupon_percent_off?"Get ".concat(t.default_group_coupon_percent_off.split(".")[0],"% off a group ").concat(e.subscription):"Get a group ".concat(e.subscription))};return n&&n((0,l.o4)(e,e.schema.nodes.button.create(a))),!0}},k=e=>(t,n)=>{let{iTemplate:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let u={url:"".concat(r.W.CHECKOUT_URL,"&gift=true"),text:(0,s.getSubscriptionSentenceWithCustomWords)(e,()=>o(b()),e=>"Give a gift ".concat(e.subscription))};return n&&n((0,l.o4)(t,t.schema.nodes.button.create(u))),!0},E=e=>(t,n)=>{if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let o={url:r.W.CHECKOUT_URL,text:(0,s.getSubscribeText)(e,{now:!0}),language:e.language};return n&&n((0,l.o4)(t,t.schema.nodes.button.create(o))),!0},W=e=>(t,n)=>{let{iTemplate:o}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!t.schema.nodes.subscribeWidget)return console.error("subscribeWidget node type not found in schema"),!1;if(!t.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let u="enabled"!==e.payments_state?o(g(),e.author_name===e.name?"Thanks for reading":"Thanks for reading ".concat(e.name)):o(_(),e.author_name===e.name?"This Substack is reader-supported":"".concat(e.name," is a reader-supported publication")),a={url:r.W.CHECKOUT_URL,text:(0,s.getSubscribeText)(e),language:e.language},c=t.schema.nodes.subscribeWidget.create(a,[t.schema.nodes.ctaCaption.create(null,[t.schema.text(u)])]);return n&&n((0,l.o4)(t,c)),!0},N=e=>(t,n)=>{let{iString:o,iTemplate:u}=I18N.i({pub:e});if(!t.schema.nodes.button)return console.error("Button node type not found in schema"),!1;if(!t.schema.nodes.captionedShareButton)return console.error("captionedShareButton node type not found in schema"),!1;if(!t.schema.nodes.ctaCaption)return console.error("ctaCaption node type not found in schema"),!1;if(!(0,d.o)(t,t.schema.nodes.button))return!1;let a=u(y(),e.author_name===e.name?"Thanks for reading":"Thanks for reading ".concat(e.name)),c={url:r.W.SHARE_URL,text:o("Share")},s=t.schema.nodes.captionedShareButton.create(c,t.schema.nodes.ctaCaption.create(null,[t.schema.text(a)]));return n&&n((0,l.o4)(t,s)),!0}},57208:function(e,t,n){n.d(t,{f2:()=>u});var o=n(68303);let r=e=>!(0,o.DY)(e.doc.toJSON(),e=>"paywall"===e.type),u=e=>(t,n)=>{if(!r(t))return!1;let{schema:o,tr:u}=t,c=o.nodes.paywall.create();return 1===u.selection.anchor?a(e)(t,n):(u.insert(u.selection.anchor,c),n&&(n(u),e()),!0)},a=e=>(t,n)=>{if(!r(t))return!1;let{schema:o,tr:u}=t,a=o.nodes.paywall.create(),c=0,s=0;for(;c<10&&s<3;){let e=t.doc.resolve(c).nodeAfter;if(!e)break;c+=e.nodeSize,s++}return u.insert(c,a),n&&(n(u),e()),!0}}}]);