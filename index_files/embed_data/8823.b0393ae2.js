(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8823"],{24271:function(e,t,a){"use strict";a.d(t,{Z:()=>n});let n={popover:"popover-Q5L48i",visible:"visible-w2GbD1",mounted:"mounted-xAyTLJ",disabled:"disabled-qyVgYn",explainer:"explainer-FXmc_P",dismissExplainer:"dismissExplainer-ns56FG",mobileFooter:"mobileFooter-CGz8PV",button:"button-r00Nrm"}},98550:function(e,t,a){"use strict";a.d(t,{Z:()=>n});let n={trigger:"trigger-V8d1vI",absolute:"absolute-PTY2O3",fixed:"fixed-n4RrZu",line:"line-DsYVXw",active:"active-Yh0Zwm","indent-1":"indent-1-vdeuvl",indent1:"indent-1-vdeuvl","indent-2":"indent-2-yiZ6hb",indent2:"indent-2-yiZ6hb","indent-3":"indent-3-levoo9",indent3:"indent-3-levoo9",label:"label-ZmMXKp",menu:"menu-IsOZj4",row:"row-gbMU1E",show:"show-n4RWCG",hide:"hide-PNwIsV"}},63523:function(e,t,a){"use strict";a.d(t,{Z:()=>n});let n={transcriptionStatus:"transcriptionStatus-OyxRN5",transcriptionChunk:"transcriptionChunk-DKBYAw",hoverChunk:"hoverChunk-IPtOLw",rowIndicator:"rowIndicator-jiY8sp",hoverRow:"hoverRow-zMw3pV",activeRow:"activeRow-S2HzS9",rowText:"rowText-T4jYBi",speakerText:"speakerText-lh6QvQ",rowEditableText:"rowEditableText-PLHmec",activeWord:"activeWord-J6YmxG",loadingSilhouette:"loadingSilhouette-znOXmS",playCircle:"playCircle-Ech_eu"}},71004:function(e,t,a){"use strict";a.d(t,{Z:()=>n});let n={subscribeButton:"subscribeButton-LcKYi7"}},59961:function(e,t,a){"use strict";a.d(t,{Z:()=>n});let n={"byline-wrapper":"byline-wrapper-rwhTzJ",bylineWrapper:"byline-wrapper-rwhTzJ",bottomWithTos:"bottomWithTos-g5MwKO","byline-wrapper--swap-on-mobile":"byline-wrapper--swap-on-mobile-Cs2Jac",bylineWrapperSwapOnMobile:"byline-wrapper--swap-on-mobile-Cs2Jac","byline-faces--swap-on-mobile":"byline-faces--swap-on-mobile-ucRXf3",bylineFacesSwapOnMobile:"byline-faces--swap-on-mobile-ucRXf3",subscribeWidget:"subscribeWidget-sIP7pQ"}},24407:function(e,t,a){"use strict";a.d(t,{Z:()=>n});let n={customThemeHeader:"customThemeHeader-hnC_lZ",headerImageContainer:"headerImageContainer-RUy6uK",portraitImage:"portraitImage-IxD7Ka",fullWidthImageHeader:"fullWidthImageHeader-t5EqiB",fullWidthHeaderContent:"fullWidthHeaderContent-HjaASe",fullWidthHeaderSubtitle:"fullWidthHeaderSubtitle-VOunOK",titleAndImageContainer:"titleAndImageContainer-Eb9L9t",titleAndImageHeader:"titleAndImageHeader-IHm_Y5",noImage:"noImage-uj9DyC",image:"image-_uMo6d",thickRule:"thickRule-aN1kyk","portrait-image-container":"portrait-image-container-zwwsEI",portraitImageContainer:"portrait-image-container-zwwsEI","landscape-image-container":"landscape-image-container-QgDAqQ",landscapeImageContainer:"landscape-image-container-QgDAqQ",bylineWrapper:"bylineWrapper-AHoCt5",bylineContainer:"bylineContainer-TXwfpr"}},37381:function(e,t,a){"use strict";a.d(t,{Z:()=>n});let n={inputWithIcons:"inputWithIcons-vs0rlV",error:"error-nMG79e",inputWrapper:"inputWrapper-Wvkzvn",icon:"icon-wnhO6c"}},4373:function(e,t,a){"use strict";a.d(t,{C:()=>h,a:()=>p});var n=a(16584),r=a(95441),i=a(90099),l=a(94874),o=a(15771),s=a(19081),d=a(58175),c=a(63651),u=a(47929),m=a(45537);function p(e){let{pub:t,subdomain:a}=e,{iString:i}=(0,r.M1)();return(0,n.BX)(s.tu,{className:m.Z.webContainer,alignItems:"center",border:"detail-themed",radius:"md",padding:20,gap:16,as:"a",href:g(a),target:"_blank","data-component-name":"CommunityChatEmbed",children:[(0,n.tZ)(l.qE,{size:64,photoUrl:(0,c.zF4)(t.author_photo_url)}),(0,n.BX)(s.tu,{gap:4,alignItems:"center",children:[(0,n.BX)(d.xv.H3,{translated:!0,as:"div",color:"pub-primary-text",children:["Join ",I18N.p(t.author_name),"’s subscriber chat"]}),(0,n.tZ)(d.xv.B4,{translated:!0,color:"pub-secondary-text",children:"Available in the Substack app and on web"})]}),(0,n.tZ)(s.tu,{alignSelf:"stretch",children:(0,n.tZ)(o.zx,{priority:"primary",href:g(a),children:i("Join chat")})})]})}function h(e){let{pub:t,subdomain:a}=e,{iString:l}=(0,r.M1)();return(0,n.tZ)("a",{className:m.Z.emailWrapper,href:g(a),"data-component-name":"EmailCommunityChatEmbed",children:(0,n.BX)("div",{className:m.Z.container,children:[(0,n.tZ)(i.NS,{size:64,src:(0,c.zF4)(t.author_photo_url),framed:!0}),(0,n.BX)("div",{className:m.Z.text,children:[(0,n.BX)(d.xv.H3,{translated:!0,className:m.Z.title,as:"div",color:"pub-primary-text",children:["Join ",I18N.p(t.author_name),"’s subscriber chat"]}),(0,n.tZ)(d.xv.B4,{translated:!0,color:"pub-secondary-text",children:"Available in the Substack app and on web"})]}),(0,n.tZ)(i.Bj,{tableClassName:m.Z.button,children:l("Join chat")})]})})}function g(e){return(0,c.ZVW)({pubKey:e,utm_source:u.b3.chatEmbed})}},62049:function(e,t,a){"use strict";a.d(t,{V:()=>E,s:()=>N});var n=a(7409),r=a(99282),i=a(16584),l=a(93974),o=a(2564),s=a(12281),d=a(90099);a(71068);var c=a(58175);a(60308);var u=a(63651),m=a(84864);let p={bubble:"bubble-ufWvfM",img:"img-cbG6oW",linkImg:"linkImg-_n19TI",paywallBubble:"paywallBubble-VDFuNU bubble-ufWvfM"};function h(e){var t,a,n;let{communityPost:r,author:u,cta:p,withAttribution:h,attributionText:y,hideReply:_,truncateBodyAt:w}=e,Z=!r,C=null==r?void 0:null===(a=r.threadMediaUploads)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:t.mediaUpload,k=null;return!Z&&r.body&&(k=w?(0,m.truncateText)(r.body,w):r.body),(0,i.BX)(d.zK,{gap:12,verticalAlign:"top",children:[(0,i.tZ)(d.NS,{src:null!==(n=null==u?void 0:u.photo_url)&&void 0!==n?n:"",size:40}),(0,i.BX)(d.i$,{gap:4,style:{lineHeight:0},children:[h&&(0,i.tZ)(l.xn,{isStatic:!0,text:y||"From ".concat((null==u?void 0:u.name)?(0,m.possessive)(u.name):"Substack user"," subscriber chat")}),Z?(0,i.tZ)(b,{}):["media"===r.type&&r.media_assets?r.media_assets.slice(0,1).map(e=>(0,i.tZ)(f,{asset:e},e.url)):"link"===r.type&&(0,i.tZ)(v,{communityPost:r}),C&&(0,i.tZ)(s.L,{mediaUpload:C}),k&&(0,i.tZ)(g,{children:(0,i.BX)("span",{children:[(0,i.tZ)(c.xv,{as:"span",weight:"bold",children:u?u.name:"Substack writer"})," ",k]})})],!_&&(0,i.tZ)(g,{children:(0,i.tZ)(d.YF,{children:(0,i.BX)("tr",{children:[(0,i.tZ)("td",{align:"left",children:(0,i.tZ)(c.xv,{as:"span",color:"secondary",children:"Reply..."})}),(0,i.tZ)("td",{align:"right",children:(0,i.tZ)(o.Z,{size:20,stroke:"var(--color-secondary}"})})]})})}),p&&(0,i.tZ)(d.b9,{fullWidth:!0,href:p.url,children:p.text}),p&&p.blurb&&(0,i.tZ)("div",{children:(0,i.tZ)(c.xv,{color:"secondary",align:"center",size:14,lineHeight:20,children:p.blurb})})]})]})}function g(e){return(0,i.tZ)("div",(0,n._)({className:p.bubble},e))}function b(){return(0,i.tZ)("div",{className:p.paywallBubble,style:{backgroundImage:"url(".concat((0,u.zF4)("/img/community/paywall-pixels-light.png"),")")},children:(0,i.tZ)(c.xv.Meta,{children:"SUBSCRIBERS ONLY"})})}function f(e){var t;let{asset:a}=e;return(0,i.tZ)("img",{className:p.img,width:400,src:(0,u.zF4)(null!==(t=a.url)&&void 0!==t?t:"",800,{crop:"limit",height:800})})}function v(e){var t,a;let n,{communityPost:r}=e,{link_metadata:l,link_url:o}=r,s=null!==(a=null!==(t=null==l?void 0:l.url)&&void 0!==t?t:o)&&void 0!==a?a:"";try{let e=new URL(s);n="".concat(e.host).concat(e.pathname).concat(e.search).concat(e.hash)}catch(e){n=s}return(0,i.tZ)(g,{children:(0,i.tZ)(d.YF,{style:{width:"400px"},children:(0,i.BX)("tr",{children:[(0,i.BX)("td",{align:"left",style:{verticalAlign:"top"},children:[(null==l?void 0:l.title)&&(0,i.tZ)(c.xv,{font:"serif",lineHeight:24,children:l.title}),(0,i.tZ)(c.xv.Meta,{color:"secondary",children:n})]}),(0,i.tZ)("td",{width:"16"}),(0,i.tZ)("td",{align:"right",children:(null==l?void 0:l.image)&&(0,i.tZ)("img",{className:p.linkImg,src:(0,u.zF4)(l.image,144,{height:144,smartCrop:!0})})})]})})})}var y=a(68833),_=a(48980),w=a(7882),Z=a(9682),C=a(19081),k=a(47929),S=a(18427);function E(e){var t,a,n,r,o;let s,{postId:d}=e,[{path:c}]=(0,Z.tv)();"undefined"!=typeof window&&(s=c.startsWith("/inbox/post/")?Number(c.split("/post/")[1]):"post"in window._preloads?null===(o=window._preloads)||void 0===o?void 0:null===(r=o.post)||void 0===r?void 0:r.id:void 0);let{error:m,result:p}=(0,w.ib)({pathname:"/api/v1/community/posts/".concat(d),auto:!0,deps:[d]}),h=m instanceof _.kp&&402===m.response.status&&((null===(t=m.body)||void 0===t?void 0:t.status)==="PAID_SUBSCRIPTION_REQUIRED"||(null===(a=m.body)||void 0===a?void 0:a.status)==="FOUNDING_SUBSCRIPTION_REQUIRED"||(null===(n=m.body)||void 0===n?void 0:n.status)==="FREE_SUBSCRIPTION_REQUIRED")?m.body:null;return(0,i.tZ)(C.hs,{as:"a",className:S.Z.container,target:"_blank",href:(0,u._5K)({postId:d,utm_source:k.b3.threadEmbed}),"data-component-name":"CommunityPostEmbed",onClick:()=>(0,y.j)(y.FP.EMBEDDED_COMMUNITY_POST_CLICKED,{post_id:s,community_post_id:d}),children:h?"FREE_SUBSCRIPTION_REQUIRED"===h.status&&h.communityPost?(0,i.tZ)(l.Jg,{author:h.user,communityPost:h.communityPost,surface:"community_post_embed",communityPostEmbedPostId:s,useClientSideRouting:!1,withAttribution:!0,isReadOnly:!0,utmSource:k.b3.threadEmbed}):(0,i.tZ)(l.V8,{author:h.user,audience:"FREE_SUBSCRIPTION_REQUIRED"===h.status?"all_subscribers":"PAID_SUBSCRIPTION_REQUIRED"===h.status?"only_paid":"only_founding"}):m?"Could not load chat message: Click to view":p&&(0,i.tZ)(l.Jg,{author:p.user,communityPost:p.communityPost,surface:"community_post_embed",communityPostEmbedPostId:s,utmSource:k.b3.threadEmbed,useClientSideRouting:!1,withAttribution:!0,isReadOnly:!0})})}function N(e){let{postId:t}=e;return(0,i.tZ)("a",{className:S.Z.emailWrapper,href:(0,u._5K)({postId:t,utm_source:k.b3.threadEmbed,modal:"1"}),"data-component-name":"EmailCommunityPostEmbed",children:(0,i.tZ)("div",{className:S.Z.container,children:(0,i.tZ)(h,(0,r._)((0,n._)({},e),{withAttribution:!0}))})})}},7464:function(e,t,a){"use strict";a.d(t,{m:()=>b});var n=a(16584),r=a(30396),i=a(12936),l=a(95441),o=a(68833),s=a(62981),d=a(94874),c=a(15771),u=a(19081),m=a(6490),p=a(58175),h=a(60308),g=a(47929);let b=e=>{let{pub:t,slug:a}=e,{iString:b}=(0,l.M1)(),[f,v]=(0,s.Z)("app-footer-sheet",604800),[y,_]=(0,r.eJ)(!f),w=(0,i.Su)();(0,r.d4)(()=>{y&&(w(),(0,o.j)(o.FP.APP_FOOTER_SHEET_CTA_VIEWED),v())},[]);let Z=(0,h.K8_)(t.subdomain,a,{redirect:"app-store",source:g.b3.postFooter});return(0,n.tZ)(m.u_,{isOpen:y,onClose:()=>{_(!1)},position:"bottom",className:"grow_from_bottom-zeI7HJ",children:(0,n.tZ)(m.fe,{children:(0,n.BX)(u.tu,{gap:20,alignItems:"center",paddingY:12,children:[(0,n.tZ)(d.qE,{size:80,user:{id:t.author_id,name:t.author_name,handle:t.author_handle,photo_url:t.author_photo_url}}),(0,n.BX)(u.tu,{gap:8,alignItems:"center",children:[(0,n.BX)(p.xv.H3,{translated:!0,align:"center",weight:"heavy",children:["Continue reading ",I18N.p(t.author_name)]}),(0,n.tZ)(p.xv.B2,{translated:!0,align:"center",children:"Available for iOS and Android"})]}),(0,n.BX)(u.tu,{gap:8,alignItems:"center",children:[(0,n.tZ)(c.zx,{priority:"primary",onClick:()=>{(0,o.j)(o.FP.APP_BANNER_TAPPED,{surface:"post",type:"sheet"})},href:Z,style:{width:"355px",boxShadow:"none"},children:b("Read in the app")}),(0,n.tZ)(c.zx,{priority:"tertiary",onClick:()=>{(0,o.j)(o.FP.APP_FOOTER_SHEET_CTA_DISMISSED),_(!1)},style:{width:"355px"},children:b("Read in browser")})]})]})})})}},84844:function(e,t,a){"use strict";a.d(t,{j:()=>p});var n=a(16584),r=a(30396),i=a(2564),l=a(75778),o=a(68833),s=a(61254),d=a(19081),c=a(58175),u=a(60836),m=a(47929);let p=e=>{let{user:t,isMobile:a,post:p}=e,h=(0,l.LC)(),g=(null==t?void 0:t.is_contributor)&&!h,b=!a||!g;return((0,r.d4)(()=>{b||(0,o.j)(o.FP.POST_STATS_IN_APP_UPSELL_SEEN,{post_id:p.id,source:"mobile_post_page"})}),b)?null:(0,n.BX)(d.sg,{children:[(0,n.tZ)(s.iz,{}),(0,n.BX)(d.X2,{className:"statsLink-zUlL_7",alignItems:"center",justifyContent:"space-between",children:[(0,n.tZ)(c.xv.B3,{paddingY:16,as:"a",weight:"semibold",translated:!0,href:(0,u.rN)({postId:p.id,params:{utm_source:m.b3.substack,utm_medium:m.lP.web,utm_campaign:m.VX.postStatsUpsellMobilePostPage,redirect:"app-store"}}),onClick:()=>(0,o.j)(o.FP.POST_STATS_IN_APP_UPSELL_CLICKED,{post_id:p.id,source:"mobile_post_page"}),children:"View stats in the app"}),(0,n.tZ)(i.Z,{})]}),(0,n.tZ)(s.iz,{})]})}},89074:function(e,t,a){"use strict";a.d(t,{F:()=>h});var n=a(7409),r=a(99282),i=a(16584),l=a(94184),o=a.n(l),s=a(76157),d=a(3258),c=a(19081),u=a(58175),m=a(63651);let p={container:"container-kkGPPk",podcastContainer:"podcastContainer-pYPdn8",attribution:"attribution-l47pL9",icon:"icon-a9qh78",pub:"pub-MZ2bx3"},h=e=>{let{postType:t,crossPostInfo:{introText:a,crossPostedPub:l,crossPostingByLine:h}}=e,g=null==h?void 0:h[0];return(0,i.BX)(c.tu,{className:o()(p.container,"podcast"===t&&p.podcastContainer),paddingLeft:16,gap:20,paddingTop:12,paddingBottom:20,children:[(0,i.BX)(c.hs,{className:p.attribution,gap:4,alignItems:"center",children:[(0,i.tZ)(s.Z,{className:p.icon,height:16})," ",(0,i.BX)(u.xv.Meta,{translated:!0,color:"accent-themed",children:["Cross-post from"," ",(0,i.tZ)("a",{className:p.pub,href:(0,m.SVA)(l),children:I18N.p(l.name)})]})]}),(0,i.BX)(u.xv.B2,{color:"pub-primary-text",children:[a," - ",g?(0,i.tZ)(d.ZP,(0,r._)((0,n._)({},g),{type:"user",uuid:""})):(0,i.tZ)(i.HY,{})]})]})}},92828:function(e,t,a){"use strict";a.d(t,{yi:()=>J});var n=a(7409),r=a(99282),i=a(58865),l=a(16584),o=a(30396),s=a(83034),d=a(75744),c=a(57391),u=a(35543),m=a(95441),p=a(60807),h=a(68833),g=a(48980),b=a(59176),f=a(7882),v=a(98914),y=a(94184),_=a.n(y),w=a(94874),Z=a(19081),C=a(58175),k=a(84864);let S={faceCloudContainer:"faceCloudContainer-_kz9BO",primaryFaceContainer:"primaryFaceContainer-QzdEHY",face:"face-a11rOP",primaryFace:"primaryFace-Zu2iVg",primaryFaceAuthorContainer:"primaryFaceAuthorContainer-mPPOG3",primaryFaceAuthor:"primaryFaceAuthor-N0sPLb",secondaryFaces:"secondaryFaces-RiD4aO",secondaryFace0:"secondaryFace0-cUCgnT",secondaryFace1:"secondaryFace1-rYcX59",secondaryFace2:"secondaryFace2-AmFCpK",secondaryFace3:"secondaryFace3-twgHiS",secondaryFace4:"secondaryFace4-nKprf4",secondaryFace5:"secondaryFace5-nvsfNi",secondaryFace6:"secondaryFace6-R9pNd0",secondaryFace7:"secondaryFace7-KnD5jG",secondaryFace8:"secondaryFace8-Ozyivi"},E=e=>{let{pub:t,suggestions:a}=e,n=[82,68,68,55,54,36,36,36,36];return(0,l.BX)("div",{className:S.faceCloudContainer,children:[(0,l.BX)("div",{className:S.primaryFaceContainer,children:[(0,l.tZ)(w.qE,{className:_()(S.face,S.primaryFace),size:100,showProfileHovercard:!0,user:{id:t.author_id,name:t.author_name,handle:t.author_handle,photo_url:t.author_photo_url}}),t.author_name&&(0,l.tZ)(Z.tu,{className:S.primaryFaceAuthorContainer,alignItems:"center",justifyContent:"center",children:(0,l.tZ)(C.xv.B4,{className:S.primaryFaceAuthor,children:(0,k.guessFirstName)(t.author_name)})})]}),a.map((e,t)=>(0,l.tZ)(w.qE,{className:_()(S.face,S.secondaryFaces,S["secondaryFace".concat(t)]),size:n[t],showProfileHovercard:!0,user:e.recommendedPublication.author}))]})};var N=a(15771),x=a(6490),O=a(51776),M=a(70379),B=a(91400),I=a(98012),T=a(60308),A=a(26111),P=a(23945),D=a(47929);let L={is_www:!0,is_personal_mode:!1,id:0,name:"Substack",subdomain:"www",copyright:"Substack Inc.",mailing_address:"548 Market Street PMB 72296\nSan Francisco, CA 94104",email_from:"no-reply@substack.com",email_from_name:"Substack",logo_url:"/img/substack.png?v=3",language:"en",theme:void 0,theme_var_color_links:void 0,theme_var_background_pop:void 0,theme_var_cover_bg_color:void 0,custom_domain:void 0,type:void 0},R={avatarContainer:"avatarContainer-Bvvbb6",avatar:"avatar-Gt1fvo",termsFooter:"termsFooter-KerNk3"};function F(){let e=(0,i._)(["Already following ",""]);return F=function(){return e},e}function H(){let e=(0,i._)(["",", a paid subscriber of ",", shared this with you."]);return H=function(){return e},e}function X(){let e=(0,i._)(["",", a subscriber of ",", shared this with you."]);return X=function(){return e},e}function z(){let e=(0,i._)([""," shared this with you."]);return z=function(){return e},e}function U(){let e=(0,i._)(["Follow "," to see what else they're reading."]);return U=function(){return e},e}function V(){let e=(0,i._)(["Follow "," and continue reading"]);return V=function(){return e},e}function W(){let e=(0,i._)(["Sign up and follow ",""]);return W=function(){return e},e}let J=e=>{var t,a;let{pub:i,post:s,referringUser:d,freeSignupEmail:y,forceFollowPrompt:_,surface:w}=e,[C,k]=(0,o.eJ)(!1),[S,E]=(0,o.eJ)(!1),[N,O]=(0,o.eJ)(0),[D,L]=(0,o.eJ)(y),[R,H]=(0,o.eJ)(!1),{iString:X,iTemplate:z}=(0,m.M1)(),U=(0,B.XA)(),V=(0,M.pm)(),W=(0,p.aF)(),{getExperimentVariant:J}=(0,c.jc)(),G=J("app_upsell_follow_prompt"),$=!!W||!!y,K=(0,u.Sv)(d,null!=w?w:"follow-referrer-prompt",void 0,{auto:$}),Q=(0,f.ib)({pathname:"/api/v1/user/".concat(d.id,"/subscriber-lists?lists=following"),auto:!0}),ee=null!==(a=null===(t=Q.result)||void 0===t?void 0:t.subscriberLists.flatMap(e=>e.groups.flatMap(e=>e.users)).slice(0,9))&&void 0!==a?a:[],et=(0,o.Ye)(()=>({free_signup_email:y,post_id:null==s?void 0:s.id,referring_user_id:d.id}),[y,null==s?void 0:s.id,d.id]);(0,o.d4)(()=>{if(!Q.hasLoadedOnce||$&&!K.isLoaded||K.isFollowing){_&&K.isFollowing&&V.popToast(e=>(0,l.tZ)(M.FN,(0,r._)((0,n._)({},e),{text:z(F(),(0,P.Q1)(d.name))})));return}try{let e=new URL(document.referrer);if(/(\b|\.)google\./.test(e.hostname)||["news.ycombinator.com","hckrnews.com"].includes(e.hostname))return}catch(e){}if(W&&(0,A.x)("follow-referrer-on-load")){(0,v.iO)("follow-referrer-on-load"),(0,h.j)(h.FP.FOLLOW_REFERRER_PROMPT_REDIRECTED,et),ei({fromRedirect:!0}).then(()=>k(!0));return}let e="follow-prompt-for-post-".concat(null==s?void 0:s.id,"-and-referrer-").concat(d.id,"-shown-at"),t=(0,b.mM)(e);!(!_&&t&&(0,I.Z)().subtract(7,"days").isBefore(t))&&((0,b.ex)(e,Date.now()),k(!0),(0,h.j)(h.FP.FOLLOW_REFERRER_PROMPT_SHOWN,et))},[W,Q.hasLoadedOnce,K.isLoaded]);let ea=(0,o.I4)(()=>{(0,h.j)(h.FP.FOLLOW_REFERRER_PROMPT_DISMISSED,(0,r._)((0,n._)({},et),{step:N})),k(!1)},[et,k,N]),en=(0,o.I4)(function(){let{email:e,reason:t="sign-in-click"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,h.j)(h.FP.FOLLOW_REFERRER_PROMPT_SIGN_IN_INITIATED,(0,r._)((0,n._)({},et),{reason:t}));let a=(0,T.rhs)({"follow-referrer-on-load":d.id});(0,v.uX)((0,T.uXE)({email:e,for_pub:null==i?void 0:i.subdomain,redirect:a}))},[et,null==i?void 0:i.subdomain,d.id]),er=(0,o.I4)(async function(){let e,t,a,{email:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{({user:e,userExists:t}=await (0,g.rd)("/api/v1/reader/signup/just_email",{method:"POST",json:{email:i}}))}catch(e){e instanceof g.kp&&(a=e.getMessage())}return e?(L(i),0):t?((0,h.j)(h.FP.FOLLOW_REFERRER_PROMPT_EXISTING_EMAIL_ENTERED,(0,r._)((0,n._)({},et),{email:i})),L(i),2):((0,h.j)(h.FP.FOLLOW_REFERRER_PROMPT_SIGNUP_FAILED,(0,r._)((0,n._)({},et),{email:i,error:a})),V.popToast(e=>(0,l.tZ)(M.FN,(0,r._)((0,n._)({},e),{text:a||X("Something went wrong. Please try again later.")}))),1)},[et,V,X]),ei=(0,o.I4)(async function(){let e,{email:t,fromRedirect:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!S){if(E(!0),a||(0,h.j)(h.FP.FOLLOW_REFERRER_PROMPT_CTA_CLICKED,(0,r._)((0,n._)({},et),{email:t})),!$){if(!t){O(1),E(!1);return}if(1===(e=await er({email:t}))){E(!1);return}}K.isFollowing||void 0!==e&&0!==e||(await K.toggle(),H(!0)),!W||a?O(2):k(!1),E(!1)}},[W,$,K,et,S,E,O,er]);return(0,l.tZ)(x.u_,{position:U?"bottom":"default",fullscreenMobile:0!==N,isOpen:C,onClose:ea,children:(0,l.BX)(Z.tu,{style:{height:"100%"},children:[(0,l.tZ)(x.xB,{showClose:!0,onClose:ea}),(0,l.BX)(Z.tu,{flex:"grow",gap:48,paddingX:32,paddingBottom:32,paddingTop:12,children:[0===N&&(0,l.tZ)(q,{pub:i,referringUser:d,referrerFollowingList:ee,loading:S,showFaceCloud:!W&&"treatment_cloud"===G,onFollowClick:ei,onDismiss:ea}),1===N&&(0,l.tZ)(j,{referringUser:d,loading:S,onFollowWithEmail:ei,onSignInClick:en}),2===N&&(0,l.tZ)(Y,{email:D,referringUser:d,followed:R,onDismiss:ea})]})]})})},q=e=>{var t,a,n,r,i,o;let s,{pub:d,referringUser:c,referrerFollowingList:u,loading:p,showFaceCloud:h,onFollowClick:g,onDismiss:b}=e,{iTemplate:f,iString:v}=(0,m.M1)(),y=null!==(i=null!==(r=null!==(n=c.photo_url)&&void 0!==n?n:null==d?void 0:d.logo_url)&&void 0!==r?r:null==d?void 0:d.author_photo_url)&&void 0!==i?i:(0,T.I4e)(c.id),_=(0,P.Q1)(c.name),k=null===(a=c.subscriptions)||void 0===a?void 0:null===(t=a.find(e=>e.publication_id==(null==d?void 0:d.id)))||void 0===t?void 0:t.membership_state;s=d&&"subscribed"===k?f(H(),c.name,d.name):d&&"free_signup"===k?f(X(),c.name,d.name):f(z(),c.name);let S="".concat(s," ").concat(f(U(),_));return(0,l.BX)(Z.tu,{alignItems:"center",gap:8,children:[h?(0,l.BX)(l.HY,{children:[(0,l.BX)(C.xv.H2,{translated:!0,align:"center",weight:"heavy",children:["Follow ",I18N.p(c.name)]}),(0,l.tZ)(C.xv.B3,{align:"center",color:"secondary",children:S}),(0,l.tZ)(Z.gq,{paddingY:24,children:(0,l.tZ)(E,{pub:{author_id:c.id,author_name:c.name,author_photo_url:null!==(o=c.photo_url)&&void 0!==o?o:""},suggestions:u.map(e=>({recommendedPublication:{author:e}}))})})]}):(0,l.BX)(Z.tu,{alignItems:"center",gap:16,paddingBottom:16,children:[(0,l.tZ)("div",{className:R.avatarContainer,children:(0,l.tZ)(w.qE,{className:R.avatar,user:{photo_url:y},size:64})}),(0,l.tZ)(C.xv.H3,{align:"center",weight:"heavy",children:s})]}),(0,l.tZ)(N.zx,{priority:"primary",disabled:p,onClick:g,children:f(V(),_)}),(0,l.tZ)(N.zx,{priority:"secondary",onClick:b,children:v("Skip")})]})},j=e=>{let{referringUser:t,loading:a,onFollowWithEmail:n,onSignInClick:r}=e,[i,s]=(0,o.eJ)(""),{iTemplate:c}=(0,m.M1)(),u=(0,o.sO)(null);(0,o.d4)(()=>{var e;null===(e=u.current)||void 0===e||e.focus()},[]);let p=(0,o.I4)(e=>{e.preventDefault(),""!==i&&n({email:i})},[n,i]),h=(0,P.Q1)(t.name);return(0,l.BX)(l.HY,{children:[(0,l.BX)(Z.tu,{alignItems:"center",gap:8,children:[(0,l.BX)(C.xv.H3,{translated:!0,align:"center",weight:"heavy",children:["Sign up to follow ",I18N.p(h)]}),(0,l.tZ)(C.xv.B4,{translated:!0,align:"center",color:"secondary",children:"Discover great writing and follow your friends on Substack"})]}),(0,l.BX)(Z.tu,{gap:12,children:[(0,l.tZ)(C.xv.B4,{translated:!0,weight:"semibold",children:"Your email address"}),(0,l.tZ)("form",{onSubmit:p,children:(0,l.tZ)(O.oi,{ref:u,placeholder:"bob@gmail.com",value:i,onChange:e=>s(e.currentTarget.value)})})]}),(0,l.BX)(Z.tu,{alignItems:"center",gap:16,justifyContent:"center",children:[(0,l.tZ)(N.zx,{disabled:a||""===i,onClick:p,children:c(W(),h)}),(0,l.BX)(C.xv.B4,{translated:!0,align:"center",color:"secondary",children:["Already have a Substack account?"," ",(0,l.tZ)(C.xv.B4,{translated:!0,color:"secondary",decoration:"underline",as:"a",href:"#",onClick:r,children:"Sign in"})]})]}),(0,l.tZ)(Z.tu,{flex:"grow",justifyContent:"end",children:(0,l.tZ)(C.xv.B4,{align:"center",children:(0,l.tZ)(d.fJ,{className:R.termsFooter,publication:L})})})]})},Y=e=>{let{onDismiss:t,email:a,referringUser:i,followed:o}=e,{iString:d}=(0,m.M1)(),u=(0,B.XA)(),{getExperimentVariant:p}=(0,c.jc)(),h=p("app_install_send_code"),g={utm_medium:D.lP.web,utm_campaign:D.VX.postFollowReferrerPrompt,utm_source:D.b3.post};return(0,l.BX)(l.HY,{children:[o?(0,l.BX)(Z.tu,{alignItems:"center",gap:4,children:[(0,l.tZ)(C.xv.H3,{translated:!0,align:"center",weight:"heavy",children:"Read and follow in the app"}),(0,l.BX)(C.xv.B4,{translated:!0,align:"center",color:"secondary",children:["See who else ",I18N.p((0,P.Q1)(i.name))," reads in the Substack app"]})]}):(0,l.BX)(Z.tu,{alignItems:"center",gap:4,children:[(0,l.BX)(C.xv.H3,{translated:!0,align:"center",weight:"heavy",children:["Finish following ",I18N.p((0,P.Q1)(i.name))," in the app"]}),(0,l.BX)(C.xv.B4,{translated:!0,align:"center",color:"secondary",children:["See who else ",I18N.p((0,P.Q1)(i.name))," reads on Substack"]})]}),u?(0,l.BX)(l.HY,{children:[(0,l.tZ)(Z.gq,{alignSelf:"center",children:(0,l.tZ)("img",{src:(0,T.zF4)("/img/app-preview-card.png"),height:265})}),(0,l.tZ)(Z.gq,{flex:"grow",children:(0,l.BX)(Z.tu,{alignItems:"center",flex:"grow",gap:8,children:[(0,l.tZ)(N.zx,{href:(0,T.D4e)(g),children:d("Get the Substack app")}),(0,l.tZ)(N.zx,{priority:"tertiary",onClick:t,children:d("Skip")})]})})]}):(0,l.BX)(Z.tu,{alignItems:"center",gap:24,children:[(0,l.tZ)("div",{style:{minHeight:"text"===h?355:"email"===h?325:231},children:(0,l.tZ)(s.AppInstallContent,(0,r._)((0,n._)({},g),{suggestedEmail:a,size:180,padding:0}))}),(0,l.tZ)(N.zx,{priority:"secondary",onClick:t,children:d("Continue reading")})]})]})}},75021:function(e,t,a){"use strict";a.d(t,{E:()=>T,f:()=>M});var n=a(7409),r=a(99282),i=a(58865),l=a(16584),o=a(30396),s=a(84488),d=a(80569),c=a.n(d),u=a(92002),m=a(73580),p=a(64515);let h=function(e){var t=(0,u._)({},(0,m._)(e));return(0,l.BX)(p.l,(0,r._)((0,n._)({name:"ReaderSubscriberGiftBadgeIcon",svgParams:{height:26,width:26,viewBox:"1.5 1.5 23 23",fill:"none"},fill:"none"},t),{children:[(0,l.tZ)("rect",{x:"1.5",y:"1.5",width:"23",height:"23",rx:"11.5",fill:"#fff",stroke:"none"}),(0,l.tZ)("g",{"clip-path":"url(#clip0_24306_47333)",children:(0,l.tZ)("path",{style:"fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(21.176471%,21.568627%,21.568627%);stroke-opacity:1;stroke-miterlimit:4;",d:"M 12 7.998047 L 12 21 M 12 7.998047 C 11.636719 6.509766 11.015625 5.232422 10.212891 4.341797 C 9.410156 3.451172 8.466797 2.982422 7.5 3 C 6.837891 3 6.199219 3.263672 5.730469 3.732422 C 5.261719 4.201172 4.998047 4.833984 4.998047 5.501953 C 4.998047 6.164062 5.261719 6.796875 5.730469 7.265625 C 6.199219 7.734375 6.837891 7.998047 7.5 7.998047 M 12 7.998047 C 12.363281 6.509766 12.984375 5.232422 13.787109 4.341797 C 14.589844 3.451172 15.533203 2.982422 16.5 3 C 17.162109 3 17.800781 3.263672 18.269531 3.732422 C 18.738281 4.201172 19.001953 4.833984 19.001953 5.501953 C 19.001953 6.164062 18.738281 6.796875 18.269531 7.265625 C 17.800781 7.734375 17.162109 7.998047 16.5 7.998047 M 19.001953 12 L 19.001953 19.001953 C 19.001953 19.529297 18.791016 20.039062 18.416016 20.414062 C 18.041016 20.789062 17.53125 21 16.998047 21 L 7.001953 21 C 6.46875 21 5.958984 20.789062 5.583984 20.414062 C 5.208984 20.039062 4.998047 19.529297 4.998047 19.001953 L 4.998047 12 M 4.001953 7.998047 L 19.998047 7.998047 C 20.554688 7.998047 21 8.449219 21 9 L 21 10.998047 C 21 11.554688 20.554688 12 19.998047 12 L 4.001953 12 C 3.445312 12 3 11.554688 3 10.998047 L 3 9 C 3 8.449219 3.445312 7.998047 4.001953 7.998047 Z M 4.001953 7.998047 ",transform:"matrix(0.75,0,0,0.75,0,0) translate(5 5)"})}),(0,l.tZ)("defs",{children:(0,l.tZ)("clipPath",{id:"clip0_24306_47333",children:(0,l.tZ)("rect",{width:"16",height:"16",fill:"white",transform:"translate(4 4)",stroke:"none"})})})]}))};var g=a(95441),b=a(33668),f=a(68833),v=a(94874),y=a(15771),_=a(19081),w=a(6490),Z=a(58175),C=a(51776),k=a(60308),S=a(23945),E=a(47929);function N(){let e=(0,i._)(["Accept ","gift"]);return N=function(){return e},e}function x(){let e=(0,i._)(["Decline ","gift"]);return x=function(){return e},e}function O(){let e=(0,i._)([""," gifted you this paid post. Unlock it in the free Substack app"]);return O=function(){return e},e}let M=e=>{let{post:t,pub:a,referringUser:n,freeSignupEmail:r,user:i,variant:d,startOnEmailCollection:u}=e,[m,p]=(0,o.eJ)(!0),[h,b]=(0,o.eJ)(!1),[v,Z]=(0,o.eJ)(!!u),{iString:C,iTemplate:O}=(0,g.M1)(),M=(0,S.Q1)(n.name);(0,o.d4)(()=>{m&&(0,f.j)(f.FP.GIFT_POST_POPOVER_VIEWED,{post_id:t.id,pub_id:a.id,referring_user_id:n.id,user_id:null==i?void 0:i.id,start_on_email_collection:u,variant:d,source:u?"paywall":"popover"})},[m,t.id,a.id,n.id,null==i?void 0:i.id,u,d]);let T=()=>{p(!1)},A=async e=>{if((0,f.j)(e?f.FP.GIFT_POST_EMAIL_SUBMITTED:f.FP.GIFT_POST_CLAIM_CTA_CLICKED,{post_id:t.id,pub_id:a.id,referring_user_id:n.id,user_id:null==i?void 0:i.id,variant:d,source:u?"paywall":"popover"}),!i&&!e){Z(!0);return}b(!0);try{await c().post("/api/v1/post_unlock_token").send({post_id:t.id,gifting_user_id:n.id,email:e}),window.location.href=(0,k.K8_)(a.subdomain,t.slug,{redirect:"app-store",source:E.b3.giftPostPrompt})}catch(e){console.error(e)}finally{b(!1)}};return(0,l.tZ)(w.u_,{position:v?"default":"bottom",isOpen:m,onClose:T,fullscreenMobile:v,className:"grow_from_bottom-xX6ELN",children:(0,l.tZ)(w.fe,{children:v?(0,l.tZ)(_.tu,{gap:8,children:(0,l.tZ)(I,{freeSignupEmail:r,onClose:T,onSubmit:A,isLoading:h})}):(0,l.BX)(_.tu,{gap:8,children:[(0,l.tZ)(B,{referringUser:n}),(0,l.tZ)(y.zx,{leading:(0,l.tZ)(s.Z,{}),priority:"primary",paddingY:12,disabled:h,onClick:()=>A(),children:"treatment_more_gifty"===d?O(N(),M?"".concat(M,"'s "):""):C("Claim my free post")}),(0,l.tZ)(y.zx,{priority:"secondary",onClick:T,children:"treatment_more_gifty"===d?O(x(),M?"".concat(M,"'s "):""):C("Continue reading with paywall")})]})})})},B=e=>{let{referringUser:t}=e,{iTemplate:a}=(0,g.M1)(),n=(0,S.Q1)(t.name),r=a(O(),n);return(0,l.tZ)(_.tu,{alignItems:"stretch",gap:8,children:(0,l.BX)(_.tu,{alignItems:"center",gap:16,paddingBottom:16,children:[(0,l.BX)("div",{className:"avatarContainer-dQGv93",children:[(0,l.tZ)(v.qE,{user:t,size:80}),(0,l.tZ)(T,{})]}),(0,l.tZ)(Z.xv.H3,{textAlign:"center",children:r}),(0,l.tZ)(Z.xv.B3,{color:"secondary",align:"center",paddingTop:4,paddingX:12,fontSize:15,translated:!0,children:"Available now for iOS and Android"})]})})},I=e=>{let{freeSignupEmail:t,onClose:a,onSubmit:n,isLoading:r}=e,[i,s]=(0,o.eJ)(null!=t?t:""),{iString:d}=(0,g.M1)(),c=(0,b.e)();return(0,l.BX)(_.tu,{gap:16,children:[(0,l.tZ)(w.xB,{showClose:!0,onClose:a}),(0,l.tZ)(Z.xv.H3,{translated:!0,children:"Claim your Free Post"}),(0,l.tZ)(Z.xv.B3,{color:"secondary",translated:!0,children:"Enter your email to claim under your existing Substack account or to create a new one."}),(0,l.tZ)(C.oi,{type:"email",name:"email",placeholder:d("Email Address"),ref:c,value:i,onInput:e=>s(e.currentTarget.value)}),(0,l.tZ)(y.zx,{priority:"primary",onClick:()=>n(i),disabled:r,children:r?"Submitting...":"Submit"})]})},T=e=>{let{size:t=32,style:a}=e;return(0,l.tZ)("div",{className:"badge-ijM1EO",style:(0,r._)((0,n._)({},a),{height:t,width:t}),children:(0,l.tZ)(h,{height:t})})}},22582:function(e,t,a){"use strict";a.d(t,{hJ:()=>Z,yW:()=>C});var n=a(7409),r=a(99282),i=a(16584),l=a(30396),o=a(94184),s=a.n(o),d=a(59543),c=a(86790),u=a(2563),m=a(20888),p=a(80026),h=a(19081),g=a(63651),b=a(81567);let f=(e,t)=>1===t?"large":2===t||4===t?"medium":t%3==0?"small":5===t||7===t?e<=2?"small":"medium":e<=5?"small":"medium",v={small:237,medium:360,large:728},y=e=>{let{src:t,size:a,onSelectImage:n,useViewer:r=!1,alt:l}=e;return(0,i.tZ)(m.e,{src:t,alt:l,maxWidth:2*v[a],className:s()(b.Z.image,b.Z[a],r&&b.Z.zoom,(0,p.oB)({pressable:"lg"})),onClick:()=>{r&&n()}})},_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=[];for(let r in e){let i=e[r],{height:l=0,width:o=0}=i&&(0,g.zJH)(i.src)||{},s="(".concat(Number(r)+1," of ").concat(e.length,")"),d={src:i.src,height:l,width:o,alt:"".concat(a," ").concat(s),title:"".concat(t," ").concat(s)};n.push({attrs:d})}return n},w=e=>{let{onEditGallery:t,editGalleryRef:a}=e;return(0,i.tZ)(h.hs,{justifyContent:"center",alignItems:"center",className:b.Z.editGalleryWrap,children:(0,i.tZ)(c.Fx,{ref:a,noList:!0,children:(0,i.tZ)(h.tu,{onClick:t,justifyContent:"center",alignItems:"center",className:b.Z.editGallery,children:(0,i.tZ)(d.Z,{height:20})})})})},Z=e=>{let{node:t,editor:a}=e,{gallery:o}=t.attrs,d=t.attrs.isEditor||a,{caption:c,alt:m}=o,p=o.images.map((e,t)=>(0,r._)((0,n._)({},e),{idx:t})),g="undefined"!=typeof window&&!window.location.pathname.startsWith("/publish"),[v,Z]=(0,l.eJ)(!1),[C,k]=(0,l.eJ)(0),S=(0,l.sO)(null),E=1===p.length,N=_(p,c),x=e=>{k(e),Z(!0)};if(0===p.length)return null;let O=e=>{var t,a;d&&(e?null===(t=S.current)||void 0===t||t.open():null===(a=S.current)||void 0===a||a.close())},M=function e(t){let a=4===t.length?2:3,n=[t.slice(0,a)],r=t.slice(a);return r.length>0&&(n=n.concat(e(r))),n}(p);return(0,i.BX)("figure",{className:s()(b.Z.imageGallery,d&&b.Z.canEdit),onMouseEnter:()=>O(!0),onMouseLeave:()=>O(!1),"data-drag-handle":!0,"data-component-name":"ImageGallery",children:[d&&o&&(0,i.tZ)(w,{onEditGallery:()=>{document.dispatchEvent(new Event("editSelectedImageGallery"))},editGalleryRef:S}),(0,i.BX)(h.tu,{gap:8,children:[E?(0,i.tZ)(y,{src:p[0].src,alt:m,caption:c,size:f(0,1),onSelectImage:()=>x(0),useViewer:g}):M.map(e=>(0,i.tZ)(h.hs,{className:s()(b.Z.imageRow,b.Z["length-".concat(e.length)]),gap:8,children:e.map(e=>(0,i.tZ)(y,{src:e.src,alt:m,caption:c,size:f(e.idx,p.length),onSelectImage:()=>x(e.idx),useViewer:g}))})),c&&(0,i.tZ)("figcaption",{className:b.Z.imageCaption,children:c})]}),(0,i.tZ)(u.ImageViewerModal,{showModal:v,modalContent:N,onClose:()=>Z(!1),step:C})]})},C=e=>{let{node:t}=e,{gallery:a}=t.attrs;if(!a)return null;let{alt:n,staticGalleryImage:r,caption:l}=a;return r?(0,i.BX)("div",{className:s()(b.Z.static,b.Z.imageGallery),"data-component-name":"ImageGalleryStatic",children:[(0,i.tZ)("img",{src:(0,g.zF4)(r.src,2*v.large),alt:n}),l&&(0,i.tZ)("div",{className:s()(b.Z.imageCaption,b.Z.static),children:l})]}):null}},3862:function(e,t,a){"use strict";a.d(t,{E:()=>Z});var n=a(7409),r=a(99282),i=a(16584),l=a(94184),o=a.n(l),s=a(1548),d=a(85685),c=a(95441),u=a(40647),m=a(94874),p=a(13229),h=a(19081),g=a(58175),b=a(98012),f=a(31377),v=a(60308),y=a(63651),_=a(84864),w=a(59961);function Z(e){let{variant:t="",post:a,pub:l,relativeLinks:Z=!1,hideMeta:C=!1,hideFaces:k=!1,showAudience:S=!1,renderBylines:E,className:N}=e,{getConfigFor:x}=(0,u.xR)(),O=!!x("enable_author_pages"),{publishedBylines:M=[]}=a,B=M.map(e=>{if(!O)return e;let t=l.contributors.find(t=>t.user_id===e.id);return t?(0,r._)((0,n._)({},e),{name:t.name||e.name,bio:t.bio||e.bio,photo_url:t.photo_url||e.photo_url}):e}),I=l.bylines_enabled&&(0,_.getPrintedByline)(l,a),T=!k&&I&&l.byline_images_enabled&&B.some(e=>{let{photo_url:t}=e;return!!t});S||(S="page"!==a.type);let{iContext:A,language:P}=(0,c.M1)(),D=e=>{let t=O?(0,v.rfk)({userId:e.id,pub:l}):null;return O&&!t?{href:void 0}:t?{href:t}:{href:(0,y.NNq)(e)}};return(0,i.BX)(h.hs,{className:o()("byline-wrapper",{[w.Z["byline-wrapper--swap-on-mobile"]]:"shows"===t},N),gap:12,alignItems:"center",children:[T&&(0,i.tZ)(h.hs,{className:o()({[w.Z["byline-faces--swap-on-mobile"]]:"shows"===t}),children:(0,i.tZ)(p.H,{users:B,max:4,size:36,renderAvatar:e=>(0,i.tZ)(m.xV,(0,r._)((0,n._)({},e),{noBase:Z}))})}),(0,i.BX)(h.tu,{children:[I&&(E?E({publishedBylines:B,getLinkProps:D}):(0,i.tZ)(g.xv.Meta,{color:"pub-primary-text",children:(0,i.tZ)(s.M,{array:B,formatter:e=>(0,i.tZ)(d.ProfileHoverCard,{disabled:O,subject:e,utmSource:"byline",children:(0,i.tZ)(g.xv,(0,r._)((0,n._)({as:"a"},D(e)),{decoration:"hover-underline",children:e.name}))}),limit:4})})),!C&&(0,i.BX)(h.hs,{gap:4,children:[(0,i.tZ)(g.xv.Meta,{color:"pub-secondary-text",children:(0,b.Z)(a.post_date).locale(P).format("MMM DD, YYYY")}),S&&(0,f.isPaidAudience)(a.audience)&&(0,i.BX)(g.xv.Meta,{color:"pub-secondary-text",children:["∙ ",A("postAudience","Paid")]})]})]})]})}},21316:function(e,t,a){"use strict";a.d(t,{m:()=>h});var n=a(7409),r=a(98848),i=a(16584),l=a(99282),o=a(64515);let s=e=>{var{stroke:t="black",height:a=19,width:s=19}=e,d=(0,r._)(e,["stroke","height","width"]);return(0,i.BX)(o.l,(0,l._)((0,n._)({},d),{name:"AdhocEmailIcon",svgParams:{height:a,width:s,viewBox:"0 0 19 19"},children:[(0,i.tZ)("path",{d:"M3 4C3 3.72386 3.22386 3.5 3.5 3.5H13C13.2761 3.5 13.5 3.72386 13.5 4V12.5C13.5 12.7761 13.2761 13 13 13H3.5C3.22386 13 3 12.7761 3 12.5V4Z",stroke:t}),(0,i.tZ)("path",{d:"M3.5 4L8.25 9.02499L13 4",stroke:t,"stroke-linecap":"round","stroke-linejoin":"round"}),(0,i.tZ)("path",{d:"M5 13.5V15C5 15.2761 5.22386 15.5 5.5 15.5H15.3151C15.5913 15.5 15.8151 15.2761 15.8151 15V7C15.8151 6.72386 15.5913 6.5 15.3151 6.5H14",stroke:t})]}))};var d=a(76157),c=a(4878);let u=e=>(0,i.BX)(o.l,(0,l._)((0,n._)({},e),{name:"PodcastIcon",svgParams:{height:19,width:19},children:[(0,i.tZ)("path",{d:"M10.1505 3H8.61291C6.06527 3 4 4.9401 4 7.33333V10","stroke-linejoin":"round"}),(0,i.tZ)("path",{d:"M8.89246 3H10.4301C12.9778 3 15.043 4.9401 15.043 7.33333V10.5","stroke-linejoin":"round"}),(0,i.tZ)("path",{d:"M3 12.1429V13.3571C3 14.5406 3.81359 15.5 4.81721 15.5H6.42473V10H4.81721C3.81359 10 3 10.9594 3 12.1429Z","stroke-linejoin":"round"}),(0,i.tZ)("path",{d:"M16 12.1429V13.3571C16 14.5406 15.1864 15.5 14.1828 15.5H12.5753V10H14.1828C15.1864 10 16 10.9594 16 12.1429Z","stroke-linejoin":"round"})]}));var m=a(34293);let p=e=>{var{stroke:t="black",height:a=19,width:s=19}=e,d=(0,r._)(e,["stroke","height","width"]);return(0,i.tZ)(o.l,(0,l._)((0,n._)({},d),{name:"VideoIcon",svgParams:{height:a,width:s,viewBox:"2 2 15 15"},children:(0,i.BX)("g",{fill:"transparent",children:[(0,i.tZ)("path",{d:"M15.5 15H3.5V4H15.5V15Z",stroke:t,"stroke-linejoin":"round"}),(0,i.tZ)("path",{d:"M11.5 11L8.5 9V12.5L11.5 11Z",stroke:t,"stroke-linejoin":"round"}),(0,i.tZ)("path",{d:"M4 7H15",stroke:t}),(0,i.tZ)("path",{d:"M4.5 4L7.5 7",stroke:t}),(0,i.tZ)("path",{d:"M8 4L11 7",stroke:t}),(0,i.tZ)("path",{d:"M11.5 4L14.5 7",stroke:t})]})}))},h=e=>{var{postType:t}=e,a=(0,r._)(e,["postType"]);switch(t){case"newsletter":return(0,i.tZ)(c.Z,(0,n._)({},a));case"adhoc_email":return(0,i.tZ)(s,(0,n._)({},a));case"thread":return(0,i.tZ)(m.Z,(0,n._)({},a));case"podcast":return(0,i.tZ)(u,(0,n._)({},a));case"video":return(0,i.tZ)(p,(0,n._)({},a));case"restack":return(0,i.tZ)(d.Z,(0,n._)({},a));default:return console.warn("Unrecognized post type: [".concat(t,"]")),null}}},94594:function(e,t,a){"use strict";a.d(t,{o:()=>M});var n=a(7409),r=a(99282),i=a(58865),l=a(16584),o=a(30396),s=a(80569),d=a.n(s),c=a(71375),u=a(50515),m=a(95441),p=a(68833),h=a(98914),g=a(71068),b=a(15771),f=a(19081),v=a(10510),y=a(58175),_=a(64300),w=a(70379),Z=a(84864);function C(){let e=(0,i._)(["Why do you recommend this Substack?"]);return C=function(){return e},e}function k(){let e=(0,i._)(["Optional"]);return k=function(){return e},e}let S={CHOOSE:"choose"},E=e=>{var t;let{pubToRecommendBack:a,recommendingPub:i,recommendedPubs:s,setStep:p,close:E,setLoading:x,source:O}=e,{iString:M,iTemplate:B}=(0,m.M1)(),[I,T]=(0,o.eJ)(null),{popToast:A}=(0,w.pm)();(0,o.d4)(()=>{let e=null==s?void 0:s.find(e=>{let{id:t}=e;return t===a.id});if(null===I&&e){var t;T(null!==(t=e.blurb)&&void 0!==t?t:null)}},[I,s,a.id]);let P=async()=>{if(!i){console.warn("No recommending pub");return}await d().put("/api/v1/recommendations").send((0,n._)({recommended_publication_id:a.id,recommending_publication_id:i.id,source:O||"recommendation_notification_email",suggested:!1},I&&I.trim()?{description:I.trim()}:{})),(null==s?void 0:s.some(e=>{let{id:t}=e;return t!==a.id}))?null==E||E():null==p||p(S.CHOOSE),x?(x(!0),null==E||E()):((0,h.uX)("/publish/recommendations"),A(e=>(0,l.tZ)(w.FN,(0,r._)((0,n._)({},e),{text:M("Recommendation added")}))))},D=(0,Z.getByLine)(a);return(0,l.BX)(l.HY,{children:[(0,l.BX)(f.gq,{justifyContent:"space-between",alignItems:"center",flex:"grow",paddingX:20,paddingTop:20,paddingBottom:16,borderBottom:"detail",children:[(0,l.tZ)(y.xv.H3,{weight:"heavy",flex:"grow",children:M("New recommendation")}),(0,l.tZ)(b.hU,{priority:"tertiary",role:"button",size:"sm",title:"Close",onClick:()=>{E&&E()},"aria-label":"close",children:(0,l.tZ)(c.Z,{size:20})})]}),(0,l.tZ)(f.tu,{padding:20,children:(0,l.BX)(f.tu,{gap:24,children:[(0,l.tZ)(f.tu,{padding:12,gap:12,bg:"secondary",radius:"sm",shadow:"xs",children:(0,l.BX)(f.gq,{gap:12,flex:"grow",alignItems:"center",children:[(0,l.tZ)(g.xu,{radius:"xs",border:"detail",children:(0,l.tZ)(v.wk,{pub:a,size:56,radius:"xs"})}),(0,l.BX)(f.tu,{flex:"grow",minWidth:0,children:[(0,l.tZ)(y.xv.B3,{weight:"semibold",ellipsis:!0,children:a.name}),D&&(0,l.tZ)(y.xv.B4,{color:"secondary",children:"By ".concat(D)})]})]})}),(0,l.BX)(f.tu,{gap:8,children:[(0,l.BX)(f.gq,{flex:"grow",justifyContent:"space-between",children:[(0,l.tZ)(y.xv.B4,{weight:"semibold",children:B(C())}),(0,l.tZ)(y.xv.B4,{color:"secondary",children:B(k())})]}),(0,l.tZ)(_.g,(0,n._)({placeholder:M("Tell your subscribers why they might enjoy ".concat(a.name,"...")),onChange:e=>T(e.currentTarget.value),value:null!=I?I:"",rows:6,maxlength:500},u.J))]}),(0,l.BX)(f.tu,{gap:12,children:[(0,l.tZ)(b.zx,{disabled:(null!==(t=null==I?void 0:I.length)&&void 0!==t?t:0)>500,onClick:P,children:M("Recommend ".concat(a.name))}),(0,l.tZ)(N,{})]})]})})]})},N=()=>{let{iString:e}=(0,m.M1)();return(0,l.BX)(y.xv.B4,{color:"secondary",align:"center",children:[e("Recommendations will be shown to people after they subscribe to your Substack.")," ",(0,l.tZ)(y.hh,{href:"https://support.substack.com/hc/en-us/articles/5036794583828-How-can-I-recommend-other-publications-on-Substack-",onClick:()=>{(0,p.j)(p.FP.MANAGE_RECOMMENDATIONS_LEARN_MORE_CLICKED,{source:"modal-recommend-pub"})},decoration:"underline",children:e("Learn more")})]})};var x=a(6490);function O(){let e=(0,i._)(["Recommend "," to your readers"]);return O=function(){return e},e}let M=e=>{let{pub:t}=e,[a,n]=(0,o.eJ)(!0),[r,i]=(0,o.eJ)(null),[s,c]=(0,o.eJ)(!1),[u,h]=(0,o.eJ)(!1),{iString:g,iTemplate:_}=(0,m.M1)();return((0,o.d4)(()=>{let e=async()=>{try{let e=(await d().get("/api/v1/publication_user/default")).body;if(i(e),!e||e.id===t.id){c(!0),n(!1);return}let a=await d().get("/api/v1/recommendations/from/".concat(e.id,"/to/").concat(t.id));c(!!a.body),n(!1)}catch(e){console.error("Failed to load recommend cta: ",e)}};!r&&a&&e()},[t,a,r]),a||s||r&&r.invite_only)?null:(0,l.BX)(l.HY,{children:[(0,l.BX)(f.tu,{alignItems:"center",padding:32,gap:20,borderTop:"detail",style:{marginTop:24},"data-testid":"recommendation-footer",children:[(0,l.tZ)(v.jM,{pub:t,size:48,openInNewTab:!0}),(0,l.BX)(f.tu,{gap:8,children:[(0,l.tZ)(y.xv.H4,{align:"center",children:_(O(),t.name)}),t.hero_text&&(0,l.tZ)(y.xv.B3,{color:"secondary",align:"center",clamp:3,children:t.hero_text})]}),(0,l.tZ)(b.zx,{onClick:()=>{(0,p.j)(p.FP.END_OF_POST_RECOMMEND_CTA_CLICKED,{recommended_pub_id:t.id,recommending_pub_id:null==r?void 0:r.id}),h(!0)},children:g("Recommend")})]}),(0,l.tZ)(B,{isOpen:u,onClose:()=>h(!1),pubToRecommend:t,recommendingPub:r,setStep:()=>{h(!1)},setLoading:n})]})},B=e=>{let{isOpen:t,onClose:a,pubToRecommend:i,recommendingPub:o,setLoading:s,setStep:d}=e,c=(0,w.pm)(),{iString:u}=(0,m.M1)();return(0,l.tZ)(x.u_,{isOpen:t,onClose:a,children:(0,l.tZ)(E,{pubToRecommendBack:i,recommendingPub:o,setStep:d,close:a,setLoading:e=>{s(e),c.popToast(e=>(0,l.tZ)(w.FN,(0,r._)((0,n._)({},e),{text:u("Recommendation added")})))},source:"end-of-post-recommend-cta"})})}},93678:function(e,t,a){"use strict";a.d(t,{O7:()=>q,Up:()=>W});var n=a(92002),r=a(73580),i=a(7409),l=a(99282),o=a(16584),s=a(30396),d=a(94184),c=a.n(d),u=a(31131),m=a(74655),p=a(29032),h=a(71212),g=a(99869),b=a(46990),f=a(27543),v=a(20068),y=a(33804),_=a(75697),w=a(16354),Z=a(2236),C=a(4038),k=a(81821);let S=e=>{let{pub:t,post:a,style:n,selectionId:r,size:i,hoverOverlay:l=!0}=e,{img:d,imgDownload:c,shareData:u,useNativeShare:m}=(0,C.Q)((0,Z.lx)({pub:t,post:a,selectionId:r,style:n})),p=(0,s.I4)(async()=>{await (0,Z.mT)({post_id:a.id,selection_id:r,aspect_ratio:n.aspectRatio,type:"post_selection",shareData:m?u:void 0,eventName:"SHARE_SELECTION_IMAGE_DOWNLOADED",additionalTrackingData:{interaction:"click"}})},[a.id,r,n.aspectRatio,m,u]);return(0,o.tZ)(Z.kA,{onClick:p,href:m?void 0:c,children:(0,o.BX)(Z.A4,{size:i,children:[!(0,k.tq)()&&d&&l&&(0,o.tZ)(Z.rA,{onClick:p}),(0,o.tZ)(Z.M$,{img:d})]})})};var E=a(95441),N=a(60807),x=a(68833),O=a(48980),M=a(7882),B=a(98914),I=a(15771),T=a(19081),A=a(6490),P=a(70379),D=a(60308),L=a(63651),R=a(47929);let F=e=>{let{assetStyle:t,aspectRatio:a,loadingSelection:n,post:r,pub:i,themeVariables:l,setAspectRatio:s,assetTheme:d,setAssetTheme:c,selectionId:u}=e,m=[],p=(null==r?void 0:r.cover_image)||(null==i?void 0:i.cover_photo_url);return p&&m.push("image"),l.background_pop&&m.push("accent"),m.push("primary"),(0,o.tZ)(A.fe,{children:(0,o.BX)(T.tu,{gap:20,children:[(0,o.tZ)(T.hs,{className:"imageContainer-OjAkhl",alignItems:"center",justifyContent:"center",children:r&&u&&!n&&(0,o.tZ)(S,{pub:i,post:r,style:t,selectionId:u,size:400,hoverOverlay:!1})}),(0,o.BX)(w.k2,{children:[(0,o.tZ)(w.Qe,{assetThemes:m,assetTheme:d,setAssetTheme:c,theme:l,pubCoverImageUrl:p}),(0,o.tZ)(w.zw,{aspectRatio:a,setAspectRatio:s})]})]})})},H=e=>{let{pub:t,post:a,isOpen:n,onClose:r,selection:d,selectionId:c,setSelectionId:u,themeVariables:m}=e,{iString:p}=(0,E.M1)(),[w,Z]=(0,s.eJ)(!1),[C,S]=(0,s.eJ)("stories"),H=(null==a?void 0:a.cover_image)||(null==t?void 0:t.cover_photo_url),[X,z]=(0,s.eJ)(H?"image":"accent"),U=(0,N.aF)(),V=(0,P.pm)(),W=(0,k.tq)({checkFirst4:!0}),{result:J}=(0,M.ib)({pathname:"/api/v1/publication/".concat(t.id,"/theme"),auto:!!d&&a&&n&&!m,cacheTtl:1/0,initialResult:m,deps:[d,a,n,m]}),q=n&&(!!c||w)&&!!J;(0,s.d4)(()=>{q&&(null==a?void 0:a.id)&&(0,x.j)(x.FP.SHARE_SELECTION_MODAL_OPENED,{post_id:a.id})},[q,a]),(0,s.d4)(()=>{d&&a&&n&&(async()=>{Z(!0);try{let e=await (0,O.rd)("/api/v1/post_selection",{method:"PUT",json:{postId:a.id,publication_id:t.id,startParagraph:d.startParagraph,endParagraph:d.endParagraph,startOffset:d.startOffset,endOffset:d.endOffset}});if(Z(!1),e instanceof Error)throw e;u(e.selection.id.toString())}catch(e){alert((0,O.i)(e)),Z(!1),r()}})()},[t,a,d,n,u,r]);let j=(e,n)=>{let r=(0,_.O1)(null,{pub:t,post:a,selectionId:c,user:U||void 0,medium:"web",utm_campaign:R.VX.postShareSelection});(0,_.I)(e,n,{shareUrl:r,post:a,pub:t,selectionId:c,utm_campaign:R.VX.postShareSelection})},Y=async()=>{j("copy",e=>((0,B.vQ)(e),V.popToast(e=>(0,o.tZ)(P.FN,(0,l._)((0,i._)({},e),{text:p("Copied link to clipboard")}))),!1))},G=async()=>{j("facebook",e=>(0,L.n1t)("https://www.facebook.com/sharer/sharer.php",{u:e}))},$=async()=>{a&&j("twitter",e=>(0,D.LaP)({url:e,text:a.title}))},K=async()=>{j("linkedin",e=>(0,L.n1t)("https://www.linkedin.com/sharing/share-offsite/",{url:e}))},Q=()=>{if(!J)return{aspectRatio:C};switch(X){case"image":return{aspectRatio:C,textColor:"#ffffff",bgImage:!0};case"accent":return{aspectRatio:C,bgColor:J.background_pop,textColor:J.print_on_pop};default:return{aspectRatio:C,bgColor:J.web_bg_color||J.cover_bg_color,textColor:J.print_on_web_bg_color||J.cover_print_primary||"#1a1a1a"}}},ee=async()=>{let e=Q(),n="Share Selection - ".concat(e.aspectRatio);(0,x.j)(x.FP.SHARE_SELECTION_IMAGE_DOWNLOADED,{post_id:null==a?void 0:a.id,selection_id:c,type:n,aspect_ratio:C,interaction:"click"});let r=document.createElement("a");r.href=a&&c?(0,D.BPe)(t,a,c,e,n):"",r.download="Share Selection - ".concat(C),r.target="_blank",r.rel="noopener noreferrer",r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)};return(0,o.tZ)(A.u_,{isOpen:q,onClose:r,width:640,fullscreenMobile:!0,children:(0,o.BX)(y.w,{children:[(0,o.tZ)(A.xB,{title:p("Share quote"),showClose:!0,onClose:r,showDivider:!0}),(0,o.tZ)(F,{assetStyle:Q(),aspectRatio:C,loadingSelection:w,post:a,pub:t,themeVariables:J,setAspectRatio:S,assetTheme:X,setAssetTheme:z,selectionId:c,setSelectionId:u}),(0,o.tZ)(A.mz,{direction:"row",showDivider:!0,primaryButton:W?void 0:(0,o.tZ)(I.zx,{priority:"primary",flex:"grow",disabled:!c,onClick:ee,leading:(0,o.tZ)(h.Z,{size:20}),children:p("Download")}),secondaryButton:(0,o.BX)(T.gq,{gap:8,children:[(0,o.tZ)(I.hU,{priority:"secondary-outline",onClick:Y,disabled:!c,children:(0,o.tZ)(g.Z,{height:20,width:20})}),(0,o.tZ)(I.hU,{priority:"secondary-outline",onClick:$,disabled:!c,children:(0,o.tZ)(v.Z,{height:20,width:20})}),(0,o.tZ)(I.hU,{priority:"secondary-outline",onClick:G,disabled:!c,children:(0,o.tZ)(b.Z,{height:20,width:20})}),(0,o.tZ)(I.hU,{priority:"secondary-outline",onClick:K,disabled:!c,children:(0,o.tZ)(f.Z,{height:20,width:20})})]})})]})})};var X=a(58175),z=a(75419),U=a(91400),V=a(24271);function W(e){var t,a,n;let{post:r,pub:i,selection:l,onClose:d,themeVariables:c,userInteractionDisabled:u}=e,[m,p]=(0,s.eJ)(!1),[h,g]=(0,s.eJ)(),b=(null==l?void 0:null===(n=l.text)||void 0===n?void 0:null===(a=n.split)||void 0===a?void 0:null===(t=a.call(n," "))||void 0===t?void 0:t.length)||0,f=!l||!(b>=3)||r.is_draft||(null==i?void 0:i.invite_only)?null:(0,o.tZ)(J,{selection:l,onClose:d,userInteractionDisabled:u,onShowSelectionModal:p,post:r,pub:i});return(0,o.BX)(o.HY,{children:[f,(0,o.tZ)(H,{selection:l,pub:i,post:r,isOpen:m,onClose:()=>p(!1),selectionId:h,setSelectionId:g,themeVariables:c})]})}function J(e){let{selection:t,onClose:a,userInteractionDisabled:n,onShowSelectionModal:r,post:d,pub:c}=e,{iString:h}=(0,E.M1)(),g=(0,U.XA)(),b=(0,N.aF)(),f=(0,z.i3)(),v=(0,P.pm)(),y=!d.is_draft&&!!b,[_,w]=(0,s.eJ)(!1),[Z,C]=(0,s.eJ)(!1);(0,s.d4)(()=>{C(!0)},[]),(0,s.d4)(()=>{let e=()=>{C(!1),a()};return window.addEventListener("scroll",e,{passive:!0,capture:!0,once:!0}),()=>{window.removeEventListener("scroll",e,{capture:!0})}},[a]),(0,s.d4)(()=>{let e=()=>{t.y-57*!!g<104?S({top:t.rect.bottom+12}):S({top:t.y-92-12})};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[t,g]);let[k,S]=(0,s.eJ)({top:-1}),M=async()=>{w(!0);try{let e=await (0,O.rd)("/api/v1/post_selection",{method:"PUT",json:{postId:d.id,publication_id:c.id,startParagraph:t.startParagraph,endParagraph:t.endParagraph,startOffset:t.startOffset,endOffset:t.endOffset}});if(w(!1),e instanceof Error)throw e;return e.selection.id}catch(e){alert((0,O.i)(e)),w(!1)}},I=async()=>{let e=await M();if((0,x.j)(x.FP.RESTACK_SELECTION_CLICKED,{post_id:d.id}),!b){let t=(0,D.rhs)(document.location.href,{action:"restack-comment",selection:e}),a=(0,D.uXE)({redirect:t});(0,B.uX)(a,{local_navigation:!1,event});return}let t=(0,D.uRy)(c,d,{urlParams:{r:b?b.id.toString(36):null,selection:e,utm_campaign:R.VX.postShareSelection,utm_medium:R.lP.web}});await f.open({restackUrl:t}) instanceof Error?v.popToast(e=>(0,o.tZ)(P.FN,(0,l._)((0,i._)({},e),{text:"Failed to post"}))):v.popToast(e=>(0,o.tZ)(P.FN,(0,l._)((0,i._)({},e),{text:"Note sent",cta:"View",href:(0,L.E2n)()})))},A=!y&&!_&&!!b;return -1===k.top?null:(0,o.tZ)(p.C,{children:(0,o.BX)(T.tu,{style:{top:k.top,bottom:k.bottom,left:t.rect.x+t.rect.width/2},justifyContent:"center",outline:"detail",shadow:"md",radius:"md",className:"".concat(V.Z.popover," ").concat(Z?V.Z.visible:""," ").concat(n?V.Z.disabled:""),padding:4,gap:4,children:[(0,o.BX)(q,{onClick:()=>{r(!0)},children:[(0,o.tZ)(u.Z,{stroke:"var(--color-utility-white)",size:20}),(0,o.tZ)(X.xv.B4,{color:"vibrance-primary",weight:"medium",children:h("Share")})]}),!c.hide_post_restacks&&y&&(0,o.BX)(q,{onClick:I,disabled:A,children:[(0,o.tZ)(m.Z,{stroke:"var(--color-utility-white)",size:20}),(0,o.tZ)(X.xv.B4,{color:"vibrance-primary",weight:"medium",children:h("Restack")})]})]})})}function q(e){var t=(0,n._)({},(0,r._)(e));return(0,o.tZ)(I.kG,(0,i._)({className:c()(V.Z.button,t.disabled&&V.Z.disabled),resetCss:!0},t))}},90156:function(e,t,a){"use strict";a.d(t,{H:()=>F});var n=a(7409),r=a(58865),i=a(16584),l=a(30396),o=a(80569),s=a.n(o),d=a(7464),c=a(347),u=a(94184),m=a.n(u),p=a(13304),h=a(74626),g=a(7523),b=a(95441),f=a(68833),v=a(98914),y=a(94874),_=a(19081),w=a(60308);let Z={subscribeDialog:"subscribeDialog-ApxQJS",dismissButton:"dismissButton-gWmS4u",pictureBox:"pictureBox-yO_tQ9",childPublicationIcon:"childPublicationIcon-u5S7bv",signInLink:"signInLink-v__pXF",background:"background-qPxN3C",error:"error-ekhTFi",closeIcon:"closeIcon-pSUQVJ",fp:"fp-sXrGxn",form:"form-mUblsD",subscribeButton:"subscribeButton-GT6UQz",signInLinkWrapper:"signInLinkWrapper-WFxaK4",hed:"hed-pyKjVu",dek:"dek-YOBGIH",emailInput:"emailInput-Znhurz"},C=e=>{let{position:t,offset:a,target:n,left:r,modal:l,pub:o,setDismissed:s,subscribe:d,email:c,setEmail:u,loading:C,errors:k,post:S,opacityOfBackground:E,onBackgroundClicked:N}=e,{iString:x}=(0,b.M1)();return(0,i.BX)(i.HY,{children:[(0,i.tZ)(_.tu,{ref:l,alignItems:"center",className:m()(Z.subscribeDialog,Z.fp),style:{top:"absolute"===t?"".concat(a,"px"):"".concat(n,"px"),left:"".concat(r,"px"),position:t},children:(0,i.BX)(i.HY,{children:[(0,i.BX)(_.gq,{alignItems:"end",justifyContent:"center",paddingBottom:8,children:[(0,i.tZ)("div",{className:Z.pictureBox,children:(0,i.tZ)(y.qE,{className:Z.authorIcon,size:80,user:{photo_url:o.logo_url}})}),(0,i.tZ)("div",{className:Z.closeIcon,onClick:()=>s(!0),children:(0,i.tZ)(p.Z,{})})]}),(0,i.BX)(g.Z,{align:"center",className:Z.hed,preset:"h4-sans-condensed",children:[x("Discover more from"),(0,i.tZ)("br",{}),I18N.p(o.name)]}),(0,i.tZ)(g.Z,{align:"center",className:Z.dek,preset:"body",children:o.hero_text}),(0,i.BX)("form",{className:Z.form,onSubmit:e=>{e.preventDefault(),d(c)},children:[(0,i.tZ)("input",{className:Z.emailInput,disabled:C,placeholder:x("Enter your email"),value:c,onChange:e=>{e.stopPropagation(),e.preventDefault(),u(e.currentTarget.value)}}),(0,i.tZ)("div",{id:"error-container",children:k&&k.map(e=>(0,i.tZ)("div",{className:Z.error,children:e}))}),(0,i.tZ)(h._,{className:Z.subscribeButton,disabled:C,type:"submit",children:x("Subscribe")})]}),(0,i.tZ)(h._,{className:Z.dismissButton,trailingIcon:"chevron-right",variant:"tertiary",onClick:()=>s(!0),children:x("Continue reading")}),(0,i.BX)(g.Z,{align:"center",className:Z.signInLinkWrapper,preset:"caption",children:[(0,i.tZ)("div",{children:x("Already have an account?")}),(0,i.BX)("div",{children:[(0,i.tZ)("a",{className:Z.signInLink,style:{cursor:"pointer"},onClick:()=>{(0,f.j)(f.FP.SUBSCRIBE_PROMPT_SIGN_IN_CLICKED,{post_id:S.id}),(0,v.uX)((0,w.uXE)({for_pub:o.subdomain,redirect:(0,w.uRy)(o,S)}))},children:x("Sign in")})," "]})]})]})}),E>0&&(0,i.tZ)("div",{className:Z.background,style:{opacity:"".concat(E,"%")},onClick:N})]})};var k=a(57391),S=a(59176),E=a(71068),N=a(15771),x=a(1844),O=a(65523),M=a(58175),B=a(51776),I=a(41233),T=a(91400),A=a(57641),P=a(98012),D=a(6070),L=a(47929);function R(){let e=(0,r._)(["Discover more from ",""]);return R=function(){return e},e}let F=e=>{var t;let{pub:a,post:r,appUpsellEligible:o,isTest:u}=e,[m,p]=(0,l.eJ)(!1),[h,g]=(0,l.eJ)(!1),[F,H]=(0,l.eJ)(!1),[X,z]=(0,l.eJ)(!1),[U,V]=(0,l.eJ)(""),[W,J]=(0,l.eJ)([]),[q,j]=(0,l.eJ)(200),[Y,G]=(0,l.eJ)(0),$=(0,l.sO)(null),{exposeExperiment:K,getExperimentVariant:Q}=(0,k.jc)(),ee=(0,T.XA)(),et="pub-".concat(a.id,"-subscribe-prompt-next-shown-at"),ea="pub-".concat(a.id,"-takeover-next-shown-at"),en="undefined"!=typeof window&&(null===(t=window)||void 0===t?void 0:t.innerHeight)?window.innerHeight:700,er=document.getElementsByClassName("available-content"),ei=er.length>0&&er[0]?er[0].scrollHeight:0,el=600;el=Math.max(Math.min(600,ei-en),600),(()=>{var e;let{height:t,width:a}=(null===(e=$.current)||void 0===e?void 0:e.getBoundingClientRect())||{height:0,width:0};j("undefined"!=typeof window&&window&&$.current?(window.innerHeight-t)/2:200),G("undefined"!=typeof window&&window&&$.current?(window.innerWidth-a)/2:0)})();let[eo,es]=(0,l.eJ)(en+Math.max(q,el)),[ed,ec]=(0,l.eJ)(Math.max(document.documentElement.scrollTop||document.body.scrollTop,0)),[eu,em]=(0,l.eJ)("absolute"),[ep,eh]=(0,l.eJ)("fixed"===eu||ed>eo-en),eg="fixed"===eu?60:Math.min(Math.max((ed-eo+en)/(en-q)*60,0),60),eb=(0,l.I4)(()=>{!ee&&ed>=eo-300&&H(!0)},[ed,ee,eo,q,H]);(0,l.d4)(()=>{var e;if(u)return;let t=!0;ei<=1.5*en&&(p(!0),t=!1);let a=null;if(null===(e=document)||void 0===e?void 0:e.referrer){try{a=new URL(document.referrer)}catch(e){}((null==a?void 0:a.hostname)==="news.ycombinator.com"||(null==a?void 0:a.hostname)==="hckrnews.com")&&(p(!0),t=!1)}(0,S.mM)(et)>Date.now()&&(p(!0),t=!1),t&&(K("hide_subscribe_prompt_on_post_page"),"treatment"===Q("hide_subscribe_prompt_on_post_page")&&p(!0))},[]),(0,l.d4)(()=>{m&&o&&(K("app_install_prompts"),"drawer"===Q("app_install_prompts")&&g(!0))},[m,o,K,Q]),(0,l.d4)(()=>{ep&&(m||((0,f.j)(f.FP.SUBSCRIBE_PROMPT_SHOWN,{post_id:r.id}),(0,S.ex)(et,(0,P.Z)().add(1,"hour").valueOf()),(0,S.ex)(ea,(0,P.Z)().add(1,"hour").valueOf())))},[ep,m]),(0,l.d4)(()=>{F&&((0,f.j)(f.FP.SUBSCRIBE_PROMPT_DISMISSED,{post_id:r.id}),(0,S.ex)(et,(0,P.Z)().add(1,"day").valueOf()),(0,S.ex)(ea,(0,P.Z)().add(1,"hour").valueOf()))},[F]);let ef=e=>{window.location.href=(0,w.uRy)(a,r,{urlParams:{subscribe_prompt:e}})},ev=(0,l.I4)(async e=>{if(!X){z(!0),J([]),(0,f.j)(f.FP.SUBSCRIBE_PROMPT_SUBMITTED,{post_id:r.id});try{let t=await s().post("/api/v1/free").send({email:e,source:"post-subscribe-prompt"});(0,f.IU)(),"enabled"===a.payments_state||a.has_recommendations?document.location.href=(0,w.W1P)(a,(0,n._)({utm_medium:L.lP.web,utm_source:L.b3.postSubscribePrompt,utm_content:r&&r.id,simple:!0,just_signed_up:!0,next:(0,w.uRy)(a,r),requires_confirmation:t.body.requires_confirmation?"true":""},t.body.subscription_id&&{subscription_id:t.body.subscription_id},t.body.referral_token&&{referral_token:t.body.referral_token})):ef("free")}catch(e){var t,i,l,o,d;(null==e?void 0:null===(i=e.response)||void 0===i?void 0:null===(t=i.body)||void 0===t?void 0:t.error)&&"string"==typeof e.response.body.error?J([e.response.body.error]):(null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(l=o.body)||void 0===l?void 0:l.errors)&&Array.isArray(e.response.body.errors)&&e.response.body.errors.length>0&&"string"==typeof(null===(d=e.response.body.errors[0])||void 0===d?void 0:d.msg)&&J(e.response.body.errors.map(e=>e.msg))}finally{z(!1)}}},[r,a,X,z]);(0,l.d4)(()=>{if(m||F)return;let e=()=>{let e=Math.max(document.documentElement.scrollTop||document.body.scrollTop,0),t=e-ed;t>0&&"absolute"===eu&&e>eo-q&&em("fixed"),t<0&&"fixed"===eu&&(em("absolute"),es(ed+q)),t<0&&"absolute"===eu&&e<eo-en&&es(en+Math.max(q,el,ed)),ec(e),("fixed"===eu||t>0&&e>eo-en)&&eh(!0)};return window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[eu,eo,es,ed,ec,eh]),(0,l.d4)(()=>{if(m||F)return;let e=e=>{"Escape"===e.key&&H(!0)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[m,F,H]);let{iString:ey,iTemplate:e_}=(0,b.M1)();return h?(0,i.tZ)(d.m,{pub:a,slug:r.slug}):m||F?(0,i.tZ)(i.HY,{}):(0,D.HD)({pub:a})?(0,i.tZ)(C,{position:eu,offset:eo,target:q,left:Y,modal:$,pub:a,setDismissed:H,subscribe:ev,email:U,setEmail:V,loading:X,errors:W,post:r,opacityOfBackground:eg,onBackgroundClicked:eb}):(0,i.BX)(c.h,{children:[(0,i.BX)(_.tu,{ref:$,bg:"primary",border:"detail",radius:"md",shadow:"xl",className:Z.subscribeDialog,style:{top:"absolute"===eu?"".concat(eo,"px"):"".concat(q,"px"),left:"".concat(Y,"px"),position:eu},role:"dialog","aria-label":ey("Subscribe modal"),children:[(0,i.BX)(_.tu,{gap:20,position:"relative",padding:20,children:[(0,i.tZ)(O.hQ,{onClose:()=>H(!0)}),(0,i.tZ)(E.xu,{alignSelf:"center",children:(0,i.tZ)(y.qE,{size:64,photoUrl:a.author_photo_url})}),(0,i.BX)(_.tu,{justifyContent:"center",gap:4,alignItems:"center",textAlign:"center",children:[(0,i.tZ)(M.xv.B2,{weight:"semibold",color:"primary",children:e_(R(),a.name)}),a.hero_text&&(0,i.tZ)(M.xv.B3,{color:"secondary",clamp:3,children:a.hero_text}),a.rankingDetailFreeSubscriberCount&&(0,i.tZ)(M.xv.B4,{paddingBottom:24,align:"center",color:"pub-secondary-text",children:a.rankingDetailFreeSubscriberCount})]}),(0,i.tZ)("form",{onSubmit:e=>{e.preventDefault(),ev(U)},children:(0,i.BX)(_.tu,{gap:8,children:[(0,i.tZ)(B.oi,{placeholder:ey("Enter your email..."),value:U,disabled:X,onChange:e=>{e.stopPropagation(),e.preventDefault(),V(e.currentTarget.value)}}),W.length>0&&(0,i.tZ)(_.tu,{gap:4,children:W.map(e=>(0,i.tZ)(x.y,{align:"center",children:e}))}),(0,i.tZ)(N.zx,{type:"submit",disabled:X,priority:"primary",children:ey("Subscribe")}),(0,i.tZ)(_.sg,{paddingTop:8,opacity:80,children:(0,i.tZ)(A.O,{includeCheckbox:!1,addSubscribePreamble:!0,color:"secondary",textAlign:"center"})})]})})]}),(0,i.tZ)(I.et,{children:(0,i.BX)(i.HY,{children:[ey("Already have an account? "),(0,i.tZ)(M.hh,{color:"accent-themed",decoration:"hover-underline",onClick:()=>{(0,f.j)(f.FP.SUBSCRIBE_PROMPT_SIGN_IN_CLICKED,{post_id:r.id}),(0,v.uX)((0,w.uXE)({for_pub:a.subdomain,redirect:(0,w.uRy)(a,r)}))},cursor:"pointer",children:ey("Sign in")})]})})]}),eg>0&&(0,i.tZ)("div",{className:Z.background,onClick:eb,style:{opacity:"".concat(eg,"%")}})]})}},44881:function(e,t,a){"use strict";a.d(t,{O:()=>b});var n=a(7409),r=a(99282),i=a(16584),l=a(80569),o=a.n(l),s=a(33804),d=a(72508),c=a(95441),u=a(15771),m=a(19081),p=a(68709),h=a(6490),g=a(51776);function b(e){let{isOpen:t,onClose:a,speakers:l,speakerMap:b,onChangeSpeakerMap:f,postId:v}=e,{iString:y}=(0,c.M1)();return(0,i.tZ)(h.u_,{isOpen:t,onClose:a,children:(0,i.BX)(s.w,{children:[(0,i.tZ)(h.xB,{title:y("Assign Speakers"),description:y("Assign names to each identified speaker to show them on the transcript. If there are too many speakers, you may have to duplicate a name."),showClose:!0,onClose:a,showDivider:!0}),(0,i.tZ)(h.fe,{children:(0,i.tZ)(m.tu,{gap:20,children:l.map(e=>(0,i.BX)(g.fv,{children:[(0,i.tZ)(p.__,{children:(0,d.ml)(e)}),(0,i.tZ)(g.oi,{onChange:t=>{var a;return f((0,r._)((0,n._)({},b),{[e]:null===(a=t.target)||void 0===a?void 0:a.value}))},value:(null==b?void 0:b[e])||"",placeholder:y("Assign a name...")})]}))})}),(0,i.tZ)(h.mz,{direction:"column",showDivider:!0,primaryButton:(0,i.tZ)(u.zx,{priority:"primary",onClick:()=>{b&&Object.keys(b).length>0&&o().put("/api/v1/drafts/".concat(v,"/transcript")).send({speaker_map:b}).then(e=>{e.body.data&&a()})},children:y("Save changes")})})]})})}},9573:function(e,t,a){"use strict";a.d(t,{v:()=>o});var n=a(16584),r=a(60826);let i=e=>{let{children:t,href:a}=e;return(0,n.tZ)(n.HY,{children:(0,n.tZ)("table",{cellSpacing:"0",cellPadding:"8",border:"0",width:"100%",children:(0,n.tZ)("tr",{children:(0,n.tZ)("td",{align:"center",children:(0,n.tZ)("a",{href:a,className:"tw-font-sans tw-text-[13px] tw-font-semibold tw-text-error",children:t})})})})})};var l=a(47929);let o=e=>{let{post:t,compAlreadyExpired:a=!1}=e,o="".concat(r.W.CHECKOUT_URL,"&utm_medium=").concat(l.lP.email,"&utm_campaign=").concat(l.VX.continueYourSupport,"&utm_content=").concat(t.id);return(0,n.BX)("table",{width:"100%",cellSpacing:"0",cellPadding:"0",border:"0",className:"tw-bg-error-wash",bgcolor:"#FFFAFA",children:[(0,n.tZ)("tr",{children:(0,n.tZ)("td",{height:"16"})}),(0,n.tZ)("tr",{children:(0,n.BX)("td",{align:"center",className:"tw-leading-5",children:[(0,n.tZ)("span",{className:"tw-font-sans tw-text-base tw-font-bold tw-text-error",children:"Continue your support"}),(0,n.tZ)("br",{}),a?(0,n.BX)("span",{className:"tw-font-sans tw-text-ssm tw-text-error",children:["Your free trial has ended!",(0,n.tZ)("br",{}),"Continue your support to access paid-only content."]}):(0,n.BX)("span",{className:"tw-font-sans tw-text-ssm tw-text-error",children:["Subscribe now to keep your paid status. You won't be",(0,n.tZ)("br",{}),"charged until your free trial ends on ",r.W.SUBSCRIPTION_EXPIRY_DATE,"."]})]})}),(0,n.tZ)("tr",{children:(0,n.tZ)("td",{height:"16"})}),(0,n.tZ)("tr",{children:(0,n.tZ)("td",{children:(0,n.tZ)(i,{href:o,children:"Subscribe now"})})}),(0,n.tZ)("tr",{children:(0,n.tZ)("td",{height:"16"})})]})}},36441:function(e,t,a){"use strict";a.d(t,{W5:()=>eE,L0:()=>eS,Do:()=>eZ,G3:()=>ex,mx:()=>eC,tj:()=>ew,TW:()=>ek,EK:()=>eO,b3:()=>eM,Gz:()=>eN});var n=a(7409),r=a(99282),i=a(16584),l=a(17218),o=a(98848),s=a(94184),d=a.n(s),c=a(26224),u=a(26522),m=a(77116),p=a(57219),h=a(90099);let g=e=>{let{post:t}=e,{title:a,canonical_url:n}=t;return(0,i.BX)(h.i$,{gap:4,children:[(0,i.tZ)("div",{className:"heading-UGv4c2",children:"Read"}),(0,i.tZ)("a",{className:"link-jbVsqJ",href:n,children:a})]})};var b=a(1548),f=a(63651);let v={meta:"meta-XhipYq",inheritColor:"inheritColor-eP1Bab"},y=e=>{let{bylines:t}=e;return(null==t?void 0:t.length)?(0,i.tZ)("div",{className:v.meta,children:(0,i.tZ)(b.M,{array:t||[],formatter:e=>{let{id:t,name:a}=e;return(0,i.tZ)("a",{className:v.inheritColor,href:(0,f.GR3)(t,a),children:a})},limit:3})}):null};var _=a(64343);let w=e=>{var t,a;let{href:n,size:r,cta:l}=e;return(0,i.BX)(h.zK,{gap:8,verticalAlign:"middle",children:[(0,i.tZ)("div",{className:d()("button-fZfkQf",{[(t="buttonSm-PaaWgJ",void 0!==t)?t:""]:"sm"===r,[(a="buttonMd-Lg5kyv",void 0!==a)?a:""]:"md"===r}),children:(0,i.tZ)("a",{href:n,children:l||"Read full story"})}),(0,i.tZ)("a",{href:n,children:(0,i.tZ)(_.Z,{className:"icon-Nb1wbo",isStatic:!0,stroke:"#f2312c"})})]})},Z=e=>{let{href:t,size:a,title:n}=e;return(0,i.tZ)("a",{className:"link-AiRTNr",href:t,children:(0,i.tZ)("div",{className:"title-RKep04",style:{fontSize:a},children:n})})};var C=a(17043);let k=e=>{let{caption:t,cta:a,post:n,showBylines:r}=e,{publishedBylines:l,title:o,canonical_url:s,cover_image:d,cover_image_alt:c}=n;return(0,i.BX)(h.i$,{gap:16,style:{width:"100%"},children:[(0,i.tZ)(Z,{href:s,size:24,title:o}),r&&(0,i.tZ)(y,{bylines:l}),d&&(0,i.tZ)("a",{href:s,children:(0,i.tZ)("img",{alt:null!=c?c:o,src:(0,C.zF)(d,1100,{quality:"auto:good",smartCrop:!0}),style:{width:"auto",height:"auto",maxWidth:"100%"},width:550})}),(0,i.BX)(h.i$,{gap:16,children:[(0,i.tZ)("div",{children:t}),(0,i.tZ)(w,{cta:a,href:s,size:"md"})]})]})},S=e=>{let{post:t,cta:a,showBylines:n}=e,{publishedBylines:r,title:l,canonical_url:o,cover_image:s,cover_image_alt:d}=t;return(0,i.tZ)(h.YF,{style:{width:"100%"},children:(0,i.BX)("tr",{children:[s&&(0,i.BX)(i.HY,{children:[(0,i.tZ)("td",{style:{verticalAlign:"top"},width:90,children:(0,i.tZ)("a",{href:o,children:(0,i.tZ)("img",{alt:null!=d?d:l,src:(0,C.zF)(s,180,{quality:"auto:good",smartCrop:!0,aspect:"1:1"}),style:{width:"auto",height:"auto",maxWidth:"100%"},width:90})})}),(0,i.tZ)("td",{style:"min-width: 16px",width:16})]}),(0,i.tZ)("td",{style:{verticalAlign:"top"},children:(0,i.BX)(h.i$,{gap:16,children:[(0,i.tZ)(Z,{href:o,size:18,title:l}),n&&(0,i.tZ)(y,{bylines:r}),(0,i.tZ)(w,{cta:a,href:o,size:"sm"})]})})]})})},E=e=>{let{post:t,cta:a,showBylines:n}=e,{publishedBylines:r,title:l,canonical_url:o}=t;return(0,i.BX)(h.i$,{gap:16,children:[(0,i.tZ)(Z,{href:o,size:18,title:l}),n&&(0,i.tZ)(y,{bylines:r}),(0,i.tZ)(w,{cta:a,href:o,size:"sm"})]})};var N=a(6070),x=a(71075);let O=e=>{var{caption:t,size:a,pub:n,cta:r,showBylines:l}=e,s=(0,o._)(e,["caption","size","pub","cta","showBylines"]);if(!s)return null;let u=(0,N.HD)({pub:n});return(0,i.tZ)("div",{className:d()(x.Z.digestPostEmbed,c.A.digestPostEmbed),"data-component-name":"DigestPostEmbedStatic",children:M({size:a,post:s,caption:t,isTheFP:u,cta:r,showBylines:l})})},M=e=>{let{size:t,post:a,caption:n,isTheFP:r,cta:l,showBylines:o}=e;switch(t){case"lg":return r?(0,i.tZ)(k,{caption:n,cta:l,post:a,showBylines:o}):(0,i.tZ)(u.Y,{post:a,children:B(n)});case"md":return r?(0,i.tZ)(S,{cta:l,post:a,showBylines:o}):(0,i.tZ)(m._,{post:a,children:B(n)});case"sm":return r?(0,i.tZ)(E,{cta:l,post:a,showBylines:o}):(0,i.tZ)(p.o,{post:a});case"xs":return r?(0,i.tZ)(g,{post:a}):(0,i.tZ)(p.o,{post:a});default:return console.warn("unrecognized size",t),null}},B=e=>(0,i.tZ)("p",{className:x.Z.caption,dangerouslySetInnerHTML:{__html:e}});var I=a(58865),T=a(95441);function A(e){let{children:t,href:a,className:n}=e;return(0,i.tZ)("a",{className:d()("button primary email cta subscribe-btn",n),href:a,children:t})}var P=a(62515);function D(){let e=(0,I._)(["Message ",""]);return D=function(){return e},e}let L=e=>{let{userId:t,userName:a}=e,{iTemplate:n}=(0,T.M1)();return(0,i.tZ)("p",{className:"button-wrapper","data-component-name":"DirectMessageStatic",children:(0,i.tZ)(A,{href:(0,P.Ds)({userId:t,userName:a}),children:n(D(),a)})})};var R=a(30396),F=a(28596),H=a(13639),X=a(92027),z=a(347),U=a(14952),V=a(60807),W=a(68833),J=a(7882),q=a(15771),j=a(19081),Y=a(6490),G=a(58175),$=a(83963),K=a(60308);function Q(){let e=(0,I._)(["Message ",""]);return Q=function(){return e},e}let ee=e=>{let{userId:t,userName:a}=e,{iTemplate:n}=(0,T.M1)(),r=(0,U.Ij)(),l=(0,V.aF)(),[o,s]=(0,R.eJ)(!1),[d,c]=(0,R.eJ)([]),[u,m]=(0,R.eJ)(!1),[p,h]=(0,R.eJ)(!1),[g,b]=(0,R.eJ)(!1),v=(0,f.JlE)({userId:t,userName:a}),{result:y}=(0,J.ib)({pathname:(0,f.gKm)({userId:t,userName:a}),deps:[t],auto:!0});(0,R.d4)(()=>{if(y){var e;s(null!==(e=y.can_dm)&&void 0!==e&&e),c(y.dm_upgrade_options||[])}},[y]);let _=n(Q(),(null==y?void 0:y.name)||a);return(0,i.tZ)(i.HY,{children:(0,i.BX)(z.h,{children:[(0,i.BX)(j.hs,{flex:"grow",style:{marginBottom:"20px"},justifyContent:"center","data-component-name":"DirectMessageWeb",children:[!!o&&(0,i.tZ)(q.zx,{priority:"primary",onClick:()=>(0,W.j)(W.FP.DIRECT_MESSAGE_WRITER_BUTTON_CLICKED,{locked:!1}),href:(0,P.gp)({urlParams:{user:v,utm_source:"direct-message-writer"}}),newTab:!0,leading:(0,i.tZ)(F.Z,{size:20}),children:_}),!o&&(0,i.tZ)(q.zx,{onClick:()=>{(0,W.j)(W.FP.DIRECT_MESSAGE_WRITER_BUTTON_CLICKED,{locked:!0}),l?l.id===t?b(!0):m(!0):h(!0)},priority:"secondary",leading:(0,i.tZ)(H.Z,{size:20}),children:_})]}),(0,i.tZ)(ea,{isOpen:p,onClose:()=>h(!1),profile:y,pub:r}),(0,i.tZ)(et,{isOpen:g,onClose:()=>b(!1)}),(0,i.tZ)($.B,{isOpen:u,onClose:()=>m(!1),profile:y,dmUpgradeOptions:d,isEditor:!0})]})})},et=e=>{let{isOpen:t,onClose:a}=e,{iString:n}=(0,T.M1)();return(0,i.tZ)(Y.u_,{width:360,isOpen:t,onClose:a,children:(0,i.tZ)(Y.fe,{children:(0,i.BX)(j.tu,{gap:16,children:[(0,i.tZ)(j.hs,{alignSelf:"center",flex:"auto",bg:"secondary",radius:"full",padding:16,children:(0,i.tZ)(X.Z,{size:24})}),(0,i.tZ)(j.tu,{children:(0,i.tZ)(G.xv.B2,{weight:"semibold",align:"center",children:n("You can't message yourself, but others will be able to message you via this button.")})}),(0,i.tZ)(j.tu,{children:(0,i.tZ)(q.zx,{justifyContent:"center",onClick:a,priority:"secondary",children:n("Okay")})})]})})})},ea=e=>{let{isOpen:t,onClose:a,profile:n,pub:r}=e,{iString:l}=(0,T.M1)();return(0,i.tZ)(Y.u_,{width:360,isOpen:t,onClose:a,children:(0,i.tZ)(Y.fe,{children:(0,i.BX)(j.tu,{gap:16,children:[(0,i.tZ)(j.hs,{alignSelf:"center",flex:"auto",bg:"secondary",radius:"full",padding:16,children:(0,i.tZ)(H.Z,{size:24})}),(0,i.tZ)(j.tu,{children:(0,i.tZ)(G.xv.B2,{weight:"semibold",align:"center",children:l("Sign in to send ".concat(null==n?void 0:n.name," a message"))})}),(0,i.BX)(j.tu,{gap:8,children:[(0,i.tZ)(q.zx,{justifyContent:"center",href:(0,K.uXE)({for_pub:null==r?void 0:r.subdomain}),children:l("Sign in")}),(0,i.tZ)(q.zx,{justifyContent:"center",onClick:a,priority:"secondary",children:l("Maybe later")})]})]})})})},en=e=>{let{href:t,children:a}=e;return t?(0,i.tZ)("a",{href:t,target:"_blank",rel:"noopener",style:{textDecoration:"none"},children:a}):a};var er=a(57747);let ei=e=>{let{align:t,width:a}=e,n={};return"center"===t||"100%"===a||a>=K.bxL||(n["left"===t?"paddingRight":"paddingLeft"]=K.bxL-a),n},el=e=>{let{src:t,alt:a,title:n,width:r,height:l,align:o,href:s,captionHtml:c}=e,u="100%"===r?K.bxL:r;return(0,i.tZ)("div",{className:d()(er.Z.staticView),"data-component-name":"Image3Static",children:(0,i.tZ)(en,{href:s,children:(0,i.BX)("div",{style:ei({align:o,width:r}),className:d()(er.Z.staticImageWrap),children:[(0,i.tZ)("img",{width:u,height:l,src:(0,K.zF4)(t,2*K.bxL),alt:a}),!c&&n&&(0,i.tZ)("div",{className:d()(er.Z.caption,er.Z.static),children:n}),!!c&&(0,i.tZ)("div",{className:d()(er.Z.caption,er.Z.static),dangerouslySetInnerHTML:{__html:c}})]})})})};var eo=a(2563),es=a(20888);let ed=e=>{let{src:t,alt:a,title:n,width:r,size:l,align:o,href:s,captionHtml:c}=e,u=s||null,[m,p]=(0,R.eJ)(!1),h=(0,R.sO)(null);return(0,i.BX)("figure",{className:d()(er.Z.mediaNodeView,o&&er.Z["align-".concat(o)||""]),"data-component-name":"Image3Dynamic",children:[(0,i.tZ)(j.gq,{className:d()(er.Z.imageContainer,er.Z[l],{[er.Z.pointer]:u,[er.Z.zoom]:!u}),onClick:()=>{s?window.open(s,"_blank"):p(!0)},children:(0,i.BX)(j.tu,{gap:8,children:[(0,i.tZ)(es.e,{className:er.Z[l],src:t,alt:a,title:n,maxWidth:(()=>{switch(l){case"large":return K.urw;case"full":if("undefined"!=typeof window)return window.innerWidth;return K.hI6;default:if("100%"===r)return K.qN9;return r}})(),imageRef:h,useRetinaSizing:!0,imageIsFixedWidth:!1}),!c&&!!n&&(0,i.tZ)("figcaption",{"data-component-name":"Image3DynamicTitle",className:er.Z.caption,children:n}),!!c&&(0,i.tZ)("figcaption",{"data-component-name":"Image3DynamicCaption",className:er.Z.caption,dangerouslySetInnerHTML:{__html:c}})]})}),(0,i.tZ)(eo.ImageViewerModal,{showModal:m,modalContent:[{attrs:{src:t,alt:a,title:n}}],onClose:()=>p(!1),step:0})]})};var ec=a(12277),eu=a(89716),em=a(22582);let ep=e=>{let{text:t,url:a,exposeExperiment:n,variant:r}=e;(0,R.d4)(()=>{r&&n("overwrite_share_button_on_post_pages")},[r]);let l={url:a};return(0,i.tZ)("p",{className:"button-wrapper",children:(0,i.tZ)("a",{className:"button primary",onClick:e=>{e.preventDefault(),navigator.share(l)},children:t})})};var eh=a(84881),eg=a(13693),eb=a(92314),ef=a(12281);let ev=e=>{let{mediaUpload:t,post:a,pub:n}=e;if(!t)return(0,i.tZ)("div",{"data-testid":"video-embed-player-static-missing-media",children:"Did not find video"});let r=(0,f.wsn)({pub:n,post:a,mediaUploadId:t.id});return(0,i.tZ)(ef.L,{mediaUpload:t,href:r})};var ey=a(93903),e_=a(81821);let ew=(e,t)=>{let{pub:a,props:{isStatic:n,post:r,dataForEmailRender:l}}=t;try{let t=e.getAttribute("data-attrs");if(t){let{mediaUploadId:e}=JSON.parse((0,ey.Z)(t));if(n){var o,s;return(0,i.tZ)(ev,{pub:a,post:r,mediaUpload:null!==(s=null===(o=l.idToMediaUpload)||void 0===o?void 0:o[e])&&void 0!==s?s:null})}return(0,i.tZ)(eb.c,{pub:a,post:r,mediaUploadId:e})}}catch(e){console.error("Failed to parse video:",e)}return(0,i.tZ)(i.HY,{})},eZ=(e,t)=>{let{pub:a,props:{isStatic:o}}=t;try{let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse((0,ey.Z)(t));return o?(0,i.tZ)(O,(0,r._)((0,n._)({},e),{pub:a,isEditor:!1})):(0,i.tZ)(l.F,(0,r._)((0,n._)({},e),{pub:a,isEditor:!1}))}}catch(e){console.error("Failed to parse digest post embed:",e)}return(0,i.tZ)(i.HY,{})},eC=(e,t)=>{let{pub:a,props:{isStatic:l}}=t;try{let t=e.getAttribute("data-attrs"),o=JSON.parse((0,ey.Z)(t));return l?(0,i.tZ)(eh.S,(0,r._)((0,n._)({},o),{pub:a})):(0,i.tZ)(eh.y,(0,r._)((0,n._)({},o),{pub:a}))}catch(e){console.error("Failed to parse referrals card:",e)}return(0,i.tZ)(i.HY,{})},ek=(e,t)=>{try{var a;let n=JSON.parse((0,ey.Z)(e.getAttribute("data-attrs")));if((null==n?void 0:null===(a=n.url)||void 0===a?void 0:a.includes("/p/"))&&"Share"===n.text){let e=!!navigator.share&&navigator.canShare({url:(0,f.uRy)(t.props.pub,t.props.post)})&&(0,e_.tq)();if(e&&"treatment"===t.props.variant)return(0,i.tZ)(ep,{text:n.text,url:n.url,variant:t.props.variant,exposeExperiment:t.props.exposeExperiment});if(e&&"control"===t.props.variant){t.props.exposeExperiment("overwrite_share_button_on_post_pages");return}}}catch(e){console.error("Failed to parse button:",e)}},eS=(e,t)=>{let{props:{isStatic:a}}=t;try{let t=e.getAttribute("data-attrs");if(t){var l;let o=null!==(l=JSON.parse(t))&&void 0!==l?l:{};return a?(0,i.tZ)(el,(0,r._)((0,n._)({},o),{captionHtml:e.innerHTML})):(0,i.tZ)(ed,(0,r._)((0,n._)({},o),{captionHtml:e.innerHTML}))}}catch(e){console.error("Failed to parse image3:",e)}return(0,i.tZ)(i.HY,{})},eE=(e,t)=>{let{props:{isStatic:a}}=t;try{let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse(t),l={node:{attrs:(0,r._)((0,n._)({},e),{isEditor:!1})}};return a?(0,i.tZ)(em.yW,(0,n._)({},l)):(0,i.tZ)(em.hJ,(0,n._)({},l))}}catch(e){console.error("Failed to parse image gallery embed:",e)}return(0,i.tZ)(i.HY,{})},eN=(e,t)=>{let{props:{isStatic:a}}=t;try{let t=e.getAttribute("data-attrs");if(t){let e=JSON.parse(t),r=(0,n._)({},e);return a?(0,i.tZ)(L,(0,n._)({},r)):(0,i.tZ)(ee,(0,n._)({},r))}}catch(e){console.error("Failed to parse direct message embed:",e)}return(0,i.tZ)(i.HY,{})},ex=(e,t)=>{try{let n=JSON.parse((0,ey.Z)(e.getAttribute("data-attrs")));if(null==n?void 0:n.isEmail){var a;return(0,i.tZ)("table",{className:"recipe-embed recipe-email",cellSpacing:"16px",width:"100%",children:(0,i.tZ)("tbody",{children:(0,i.tZ)("tr",{children:(0,i.tZ)("td",{children:(0,i.tZ)(eu.k,{node:{attrs:{id:n.id}},editable:!1,staticData:null===(a=t.props.dataForEmailRender)||void 0===a?void 0:a.recipes[n.id]})})})})})}return(0,i.tZ)("div",{className:"recipe-embed",dataAttrs:e.getAttribute("data-attrs"),children:(0,i.tZ)(eu.k,{node:{attrs:{id:n.id}},editable:!1})})}catch(e){return console.log("Failed to parse recipe:",e),(0,i.tZ)(i.HY,{})}},eO=e=>{try{let t=JSON.parse((0,ey.Z)(e.getAttribute("data-attrs")));return(0,i.tZ)(ec.M,{attrs:t})}catch(e){console.error("Failed to parse pinterest:",e)}return(0,i.tZ)(i.HY,{})},eM=(e,t)=>{var a,n,r,l,o,s,d;let c=null!==(d=null===(n=t.props)||void 0===n?void 0:null===(a=n.post)||void 0===a?void 0:a.sponsorshipCampaigns)&&void 0!==d?d:null===(l=t.props)||void 0===l?void 0:null===(r=l.dataForEmailRender)||void 0===r?void 0:r.sponsorshipCampaigns;if(!c)return(0,i.tZ)(i.HY,{});let u=e.getAttribute("data-attrs"),m=c[JSON.parse((0,ey.Z)(u)).id];if(!m)return(0,i.tZ)(i.HY,{});let p=m.exclude_audience_minimum;if("paid"===p&&!1===t.props.is_freemail||"paid"===p&&(null===(o=t.props.user)||void 0===o?void 0:o.is_subscribed)||"founding"===p&&(null===(s=t.props.user)||void 0===s?void 0:s.is_founding))return(0,i.tZ)(i.HY,{});try{let a=JSON.parse((0,ey.Z)(e.getAttribute("data-attrs")));if(null==a?void 0:a.isEmail)return(0,i.tZ)(eg.O,{campaign:m,pub:t.pub});return(0,i.tZ)(eg.V,{dataAttrs:e.getAttribute("data-attrs"),pub:t.pub,campaign:m})}catch(e){return console.log("Failed to parse sponsorship campaign:",e),(0,i.tZ)(i.HY,{})}}},13723:function(e,t,a){"use strict";a.d(t,{$:()=>h,c:()=>g});var n=a(16584),r=a(94184),i=a.n(r),l=a(67749),o=a(94442),s=a(14952),d=a(60807),c=a(90099),u=a(19081),m=a(58175),p=a(71075);let h=e=>{var t;let{disableLinks:a,href:r,includeUfi:c=!1,paddingBottom:h=0,paddingTop:g=0,post:b}=e,f=(0,d.aF)(),v=(0,s.Ij)();return(0,n.BX)(u.gq,{alignItems:"center",gap:16,paddingBottom:h,paddingTop:g,children:[c&&v&&f&&b&&(0,n.BX)(u.gq,{className:"post-ufi",gap:8,children:[(0,n.tZ)(o.RY,{post:b,pub:v,user:f}),(0,n.tZ)(o.L9,{post:b,pub:v}),(0,n.tZ)(o.pD,{labelStyle:"cta",post:b,pub:v,style:"button",user:f})]}),(0,n.tZ)(m.xv.B4,{align:"center",as:"a",className:i()({[null!==(t=p.Z.disableLink)&&void 0!==t?t:""]:a}),href:r,weight:"medium",children:(0,n.BX)(u.gq,{alignItems:"center",className:p.Z.link,gap:8,children:[(0,n.tZ)(m.xv.B4,{as:"span",color:"accent-themed",size:14,weight:"semibold",children:"Read full story"}),(0,n.tZ)(l.Z,{size:16})]})})]})},g=e=>{let{href:t,paddingTop:a=0,paddingBottom:r=0}=e;return(0,n.tZ)(c.zK,{gap:16,style:{paddingTop:a,paddingBottom:r},children:(0,n.tZ)(m.xv.B4,{align:"center",as:"a",href:t,weight:"medium",children:(0,n.tZ)(c.zK,{gap:8,children:(0,n.tZ)(m.xv.B4,{as:"span",className:p.Z.link,color:"accent-themed",size:14,children:"Read full story"})})})})}},57336:function(e,t,a){"use strict";a.d(t,{I:()=>h,h:()=>p});var n=a(16584),r=a(94184),i=a.n(r),l=a(1548),o=a(90099),s=a(98914),d=a(19081),c=a(58175),u=a(63651),m=a(71075);let p=e=>{let{bylines:t,date:a,disableLinks:r}=e;return(0,n.BX)(d.gq,{alignItems:"center",gap:4,children:[(null==t?void 0:t.length)?(0,n.BX)(n.HY,{children:[(0,n.tZ)(c.xv.Meta,{className:i()({[m.Z.disableLink]:r}),color:"pub-secondary-text",children:(0,n.tZ)(l.M,{array:t||[],formatter:e=>{let{id:t,name:a}=e;return(0,n.tZ)("a",{className:m.Z.inheritColor,href:(0,u.GR3)(t,a),children:a})},limit:3})}),(0,n.tZ)(c.xv,{color:"pub-secondary-text",children:"\xb7"})]}):null,(0,n.tZ)(c.xv.Meta,{color:"pub-secondary-text",children:(0,s.Po)(a)})]})},h=e=>{let{bylines:t,date:a}=e;return(0,n.BX)(o.zK,{gap:4,children:[(null==t?void 0:t.length)?(0,n.BX)(o.zK,{gap:4,children:[(0,n.tZ)(c.xv.Meta,{color:"pub-secondary-text",children:(0,n.tZ)(l.M,{array:t||[],formatter:e=>{let{id:t,name:a}=e;return(0,n.tZ)("a",{className:m.Z.inheritColor,href:(0,u.GR3)(t,a),children:a})},limit:3})}),(0,n.tZ)(c.xv,{color:"pub-secondary-text",children:"\xb7"})]}):null,(0,n.tZ)(c.xv.Meta,{color:"pub-secondary-text",children:(0,s.Po)(a)})]})}},77116:function(e,t,a){"use strict";a.d(t,{_:()=>f,a:()=>b});var n=a(16584),r=a(94184),i=a.n(r),l=a(19691),o=a(13723),s=a(57336),d=a(26522),c=a(20888),u=a(71068),m=a(19081),p=a(58175),h=a(91400),g=a(71075);let b=e=>{var t,a,r;let{caption:d,disableLinks:b,post:f,isEditingCaption:v,onEditCaption:y,onSaveCaption:_,onCancelCaption:w}=e,{publishedBylines:Z,title:C,canonical_url:k,post_date:S,section_name:E,cover_image:N,cover_image_alt:x}=f,O=(0,h.XA)();return(0,n.BX)(m.tu,{children:[E&&(0,n.tZ)("a",{className:i()({[null!==(t=g.Z.disableLink)&&void 0!==t?t:""]:b}),href:k,rel:"noopener",target:"_blank",children:(0,n.tZ)(p.xv.Meta,{color:"pub-primary-text",paddingBottom:8,children:E})}),(0,n.tZ)("a",{className:i()({[null!==(a=g.Z.disableLink)&&void 0!==a?a:""]:b}),href:k,rel:"noopener",target:"_blank",children:(0,n.tZ)(p.xv.H2,{color:"pub-primary-text",children:C})}),(0,n.tZ)(s.h,{bylines:Z,date:S,disableLinks:b}),(0,n.BX)(m.hs,{direction:{mobile:"column",desktop:"row"},gap:16,paddingTop:16,children:[N&&(0,n.tZ)(u.xu,{style:{width:O?"unset":140},children:(0,n.tZ)("a",{className:i()({[null!==(r=g.Z.disableLink)&&void 0!==r?r:""]:b}),href:k,rel:"noopener",target:"_blank",children:(0,n.tZ)(c.e,{alt:null!=x?x:C,className:O?g.Z.fullWidth:g.Z.mdSquare,imageProps:{height:Math.round(O?1300:280),smartCrop:!0},maxWidth:O?1300:280,src:N})})}),(0,n.BX)(m.tu,{flex:"grow",children:[v&&_&&w?(0,n.tZ)(l.Z,{initialCaption:d,onCancel:w,onSave:_}):(0,n.tZ)("p",{className:g.Z.caption,dangerouslySetInnerHTML:{__html:d},onClick:null!=y?y:void 0}),(0,n.tZ)(o.$,{disableLinks:b,href:k,post:f})]})]})]})},f=e=>{let{post:t,children:a}=e;return(0,n.tZ)(d.Y,{children:a,post:t})}},57219:function(e,t,a){"use strict";a.d(t,{o:()=>g,u:()=>h});var n=a(16584),r=a(94184),i=a.n(r),l=a(13723),o=a(57336),s=a(20888),d=a(90099),c=a(71068),u=a(19081),m=a(58175),p=a(71075);let h=e=>{var t;let{post:a,disableLinks:r}=e,{publishedBylines:d,title:h,canonical_url:g,post_date:b,cover_image:f,cover_image_alt:v}=a;return(0,n.tZ)("a",{className:i()({[null!==(t=p.Z.disableLink)&&void 0!==t?t:""]:r}),href:g,rel:"noopener",target:"_blank",children:(0,n.BX)(u.gq,{gap:16,children:[f&&(0,n.tZ)(c.xu,{style:{width:70,height:70},children:(0,n.tZ)(s.e,{alt:null!=v?v:h,className:p.Z.smSquare,imageProps:{height:Math.round(140),smartCrop:!0},maxWidth:140,src:f})}),(0,n.BX)(u.tu,{children:[(0,n.tZ)(m.xv.H4,{color:"pub-primary-text",children:h}),(0,n.tZ)(o.h,{bylines:d,date:b,disableLinks:r}),(0,n.tZ)(l.$,{disableLinks:r,href:g,includeUfi:!1,post:a})]})]})})},g=e=>{let{post:t}=e,{publishedBylines:a,title:r,canonical_url:i,post_date:u,cover_image:h,cover_image_alt:g}=t;return(0,n.BX)(d.zK,{gap:16,children:[h&&(0,n.tZ)(c.xu,{style:{width:70},children:(0,n.tZ)("a",{href:i,children:(0,n.tZ)(s.e,{alt:null!=g?g:r,className:p.Z.smSquare,imageProps:{height:140,smartCrop:!0},maxWidth:140,src:h})})}),(0,n.BX)(d.i$,{children:[(0,n.tZ)(m.xv.H4,{color:"pub-primary-text",children:(0,n.tZ)("a",{href:i,children:r})}),(0,n.tZ)(o.I,{bylines:a,date:u}),(0,n.tZ)(l.c,{href:i})]})]})}},78435:function(e,t,a){"use strict";a.d(t,{kq:()=>D,n_:()=>P,v8:()=>A});var n=a(7409),r=a(99282),i=a(58865),l=a(16584),o=a(30396),s=a(94184),d=a.n(s),c=a(99869),u=a(47976),m=a(72183),p=a(38724),h=a(77216),g=a(38735),b=a(52573),f=a(47906),v=a(54917),y=a(67434),_=a(60437),w=a(45823),Z=a(95441),C=a(14952),k=a(60807),S=a(90099),E=a(98914),N=a(19081),x=a(58175),O=a(70379),M=a(98012),B=a(6070),I=a(60308);function T(){let e=(0,i._)(["Option ",""]);return T=function(){return e},e}let A=(e,t)=>{let{iTemplate:a}=I18N.i(t);return a(T(),e+1)},P=e=>{var t,a;let{id:i,isEditor:s,post:S,isVersionView:T}=e,{iString:P,language:D}=(0,Z.M1)(),L=(0,C.Ij)(),R=(0,w.K)(),[F,H]=(0,o.eJ)(!1),[X,z]=(0,o.eJ)(!1),U=(0,o.sO)(null),V=(0,O.pm)(),W=(0,k.aF)()||{},J=(0,B.HD)({pub:L}),q=(0,o.I4)(()=>{H(!1)},[]),{error:j,loading:Y,poll:G,savePoll:$,voteForOption:K}=(0,f.B)({isEditor:s,isVersionView:!!T,pollId:i,post:S,onFinishSaving:q}),Q=!!(null==G?void 0:G.is_published),ee=G&&G.published_at&&(0,M.Z)(G.published_at).add(G.expiry,"hour"),et=(0,M.Z)(),ea=!!Q&&!!ee&&ee.isBefore(et),en=ee?ee.diff(et,"hour"):0,er=s&&((null==G?void 0:G.post_type)!=="adhoc_email"||!Q),ei=!!G&&G.options.some(e=>e.my_vote),el=(null==G?void 0:G.audience)==="only_paid"?!!W.is_subscribed:!!(W.is_free_subscribed||R),eo=!ei&&Q&&!ea&&el&&(!s||(null==G?void 0:G.post_type)==="adhoc_email"),es=s?null:"".concat((0,I.uRy)(L,S),"#poll-").concat(i),ed=er?Array(Math.max(2,(null==G?void 0:null===(t=G.options)||void 0===t?void 0:t.length)||0)).fill("").map((e,t)=>{var a,n,r;return G&&(null===(a=G.options)||void 0===a?void 0:a.length)>t?null!==(r=null===(n=G.options[t])||void 0===n?void 0:n.label)&&void 0!==r?r:"":A(t,D)}):null==G?void 0:null===(a=G.options)||void 0===a?void 0:a.map(e=>e.label),ec=(0,o.I4)(async e=>{if(!s&&!ea&&Q){if(!el){var t;null===(t=U.current)||void 0===t||t.open();return}await K(e)}},[el,s,ea,Q,K]);return null===j||G?(0,l.BX)(N.tu,{className:d()("poll-wrapper poll-web",{"poll-wrapper--thefp":J}),"data-component-name":"Poll",gap:24,children:[es&&(0,l.tZ)("div",{className:"poll-anchor-target",id:"poll-".concat(i),children:(0,l.tZ)("div",{className:"poll-anchor-copy-button",onClick:e=>{var t;(null===(t=location)||void 0===t?void 0:t.href)&&(e.preventDefault(),(0,E.vQ)(es),V.popToast(e=>(0,l.tZ)(O.FN,(0,r._)((0,n._)({},e),{Icon:c.Z,text:P("Copied link to clipboard")}))))},children:(0,l.tZ)("a",{href:es,children:(0,l.tZ)(c.Z,{size:20})})})}),er&&G&&(0,l.tZ)(m.Z,{isOpen:F,isPublished:Q,poll:G,shouldShowAudiencePicker:"adhoc_email"!==G.post_type,onClose:()=>{H(!1)},onSave:$}),!s&&G&&L&&(0,l.tZ)(p.Z,{ref:U,audience:G.audience,className:"poll-dialog",noCloseButton:!0,pollId:G.id,post:S,pub:L,user:W}),Y?(0,l.tZ)(N.tu,{alignItems:"center",gap:8,justifyContent:"center",paddingY:48,children:(0,l.tZ)(x.xv.Meta,{translated:!0,children:"Loading..."})}):(0,l.BX)(l.HY,{children:[er&&(0,l.tZ)("button",{className:"poll-edit",disabled:Y,onClick:()=>{H(!0)},children:(0,l.tZ)(u.Z,{height:20})}),J?(0,l.tZ)(v.y,{poll:G}):(0,l.tZ)(h.Z,{poll:G}),null!==j&&(0,l.tZ)("div",{className:"poll-error",children:j}),(0,l.tZ)(N.tu,{className:d()("poll-options",{"no-margins":!Q}),gap:J?16:12,children:ed&&ed.map((e,t)=>{var a,n,r,i,o,s;return J?(0,l.tZ)(_.g,{currentVotes:(null==G?void 0:null===(a=G.options[t])||void 0===a?void 0:a.votes)||0,hasVoted:ei,id:(null==G?void 0:null===(n=G.options[t])||void 0===n?void 0:n.id)||null,index:t,myVote:(null==G?void 0:null===(r=G.options[t])||void 0===r?void 0:r.my_vote)||!1,showVotes:ei||ea||!!(W.is_contributor||W.is_admin||W.is_author)&&X,text:e,totalVotes:(null==G?void 0:G.total_votes)||0,onVote:ec}):(0,l.tZ)(b.w,{canVote:eo,currentVotes:(null==G?void 0:null===(i=G.options[t])||void 0===i?void 0:i.votes)||0,id:(null==G?void 0:null===(o=G.options[t])||void 0===o?void 0:o.id)||null,myVote:(null==G?void 0:null===(s=G.options[t])||void 0===s?void 0:s.my_vote)||!1,showVotes:ei||ea||!!(W.is_contributor||W.is_admin||W.is_author)&&X,text:e,totalVotes:(null==G?void 0:G.total_votes)||0,onVote:ec})})}),Q&&G&&(J?(0,l.tZ)(y.r,{hasVoted:ei,poll:G,user:W}):(0,l.tZ)(g.k,{hasVoted:ei,isExpired:ea,poll:G,remainingHours:en,showResults:X,user:W,onToggleShowResults:()=>{z(!X)}}))]})]}):(0,l.tZ)("div",{className:"poll-wrapper poll-web",children:(0,l.tZ)("div",{className:"poll-error",children:j})})},D=e=>{let{id:t,embeddedPolls:a,pub:n}=e,r=a.find(e=>e.id===t),{iString:i,language:o}=(0,Z.M1)(),s=(0,B.HD)({pub:n});return r?(0,l.tZ)(S.YF,{className:d()("poll-email-wrapper",{"poll-email-wrapper--thefp":s}),"data-component-name":"StaticPoll",children:(0,l.tZ)("tr",{children:(0,l.tZ)("td",{children:(0,l.BX)(S.YF,{width:"100%",children:[!s&&(0,l.tZ)("tr",{children:(0,l.tZ)("td",{className:"poll-header",children:i((null==r?void 0:r.audience)==="only_paid"?"SUBSCRIBER-ONLY POLL":"POLL")})}),(0,l.tZ)("tr",{className:"poll-question",width:"100%",children:(0,l.tZ)("td",{children:r.question||i("New Poll")})}),r.description&&(0,l.tZ)("tr",{className:"poll-description",width:"100%",children:(0,l.tZ)("td",{children:r.description})}),(0,l.tZ)("tr",{children:(0,l.tZ)("td",{children:(0,l.tZ)(S.YF,{className:"poll-options",width:"100%",children:r.options.map((e,t)=>{let{label:a,id:n}=e;return(0,l.tZ)("tr",{children:(0,l.tZ)("td",{className:"poll-option",width:"100%",children:(0,l.tZ)("a",{className:"poll-vote-link",href:"%%poll_vote_option_".concat(n,"_url%%"),width:"100%",children:(0,l.tZ)("div",{className:"poll-vote-contents",children:a||A(t,o)})})})})})})})})]})})})}):(0,l.tZ)("table",{className:"poll-wrapper","data-component-name":"StaticPollError",children:i("Something went wrong.")})}},80836:function(e,t,a){"use strict";a.d(t,{Z:()=>f});var n=a(16584),r=a(30396),i=a(94184),l=a.n(i),o=a(99869),s=a(347),d=a(75905),c=a(68833),u=a(12799),m=a(98914),p=a(71068),h=a(15771),g=a(19081),b=a(60308);function f(e){let{text:t,post:a,pub:i,offsetTop:f,isAboutPage:v}=e,{isStatic:y}=(0,r.qp)(d.E),_=(0,m.VA)(t,!0),w=(0,m.VA)(t,!1),Z=(0,u.g)(),C=(null==a?void 0:a.id)<0x3f9b46c&&_!==w?w:_;if(!a&&!v||!i||y)return null;let k=v?"".concat((0,b.d6h)(i,{addBase:!0}),"#\xa7").concat(_):"".concat((0,b.SVA)(i),"/i/").concat(null==a?void 0:a.id,"/").concat(_);return(0,n.tZ)(g.hs,{position:"absolute",alignItems:"center",className:"header-anchor-parent",children:(0,n.BX)(s.h,{children:[(0,n.tZ)(p.xu,{className:l()("header-anchor",{"offset-top":f}),id:"\xa7".concat(C)}),(0,n.tZ)(h.hU,{priority:"secondary",rounded:!1,size:"sm",onClick:e=>{var t;(null===(t=location)||void 0===t?void 0:t.href)&&(e.preventDefault(),(0,c.j)(c.FP.HEADER_ANCHOR_WIDGET_CLICKED,{destination:k}),Z(k))},href:k,children:(0,n.tZ)(o.Z,{size:18})})]})})}},39432:function(e,t,a){"use strict";a.d(t,{Z:()=>o});var n=a(7409),r=a(99282),i=a(16584),l=a(64515);let o=e=>(0,i.tZ)(l.l,(0,r._)((0,n._)({},e),{name:"EmailIcon",svgParams:{height:25,width:25,strokeWidth:0,fill:"#000Z"},children:(0,i.tZ)("g",{children:(0,i.tZ)("path",{d:"M22.93,7a2.43,2.43,0,0,0-.41-.93A2.61,2.61,0,0,0,20.39,5H4.61A2.61,2.61,0,0,0,2.48,6.1,2.43,2.43,0,0,0,2.07,7h0A2.78,2.78,0,0,0,2,7.61v9.78A2.61,2.61,0,0,0,4.61,20H20.39A2.61,2.61,0,0,0,23,17.39V7.61A2.25,2.25,0,0,0,22.93,7ZM4.61,6H20.39a1.58,1.58,0,0,1,1.26.62l-8.91,5.31a.49.49,0,0,1-.47,0L3.35,6.62A1.58,1.58,0,0,1,4.61,6ZM22,17.39A1.61,1.61,0,0,1,20.39,19H4.61A1.61,1.61,0,0,1,3,17.39V7.58l8.77,5.22a1.48,1.48,0,0,0,1.47,0L22,7.58Z"})})}))},40034:function(e,t,a){"use strict";a.d(t,{Z:()=>d});var n=a(7409),r=a(99282),i=a(98848),l=a(16584),o=a(64515),s=a(24476);let d=e=>{var{isHovered:t}=e,a=(0,i._)(e,["isHovered"]);let d=t?s.t.brightOrange.hex:s.t.lightGray.hex;return(0,l.BX)(o.l,(0,r._)((0,n._)({},a),{name:"FPShareIcon",svgParams:{width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"none"},children:[(0,l.tZ)("path",{d:"M5 10H1V22H3V24H21V22H23V10H19V20H5V10Z",fill:d}),(0,l.tZ)("path",{d:"M11 0H13V2H15V4H17V6H19V8H15V17H9V8H5V6H7V4H9V2H11V0Z",fill:d})]}))}},64579:function(e,t,a){"use strict";a.d(t,{Z:()=>s});var n=a(7409),r=a(99282),i=a(98848),l=a(16584),o=a(64515);let s=e=>{var{color:t="#B6B6B6",height:a=18}=e,s=(0,i._)(e,["color","height"]);return(0,l.BX)(o.l,(0,r._)((0,n._)({},s),{height:a,name:"LockFullIcon",svgParams:{height:18,width:18,viewBox:"0 0 18 18"},children:[(0,l.tZ)("rect",{x:"5.5",y:"2.5",width:"7",height:"13",rx:"3.5",stroke:t,fill:"none"}),(0,l.tZ)("rect",{x:"3.5",y:"8.5",width:"11",height:"8",rx:"0.5",fill:t,stroke:t})]}))}},21206:function(e,t,a){"use strict";a.d(t,{Z:()=>s});var n=a(7409),r=a(99282),i=a(16584),l=a(96220),o=a(64515);let s=e=>(0,i.tZ)(o.l,(0,r._)((0,n._)({},e),{name:"LucideRecommend",svgParams:{height:24,width:24,fill:"#000000",strokeWidth:0},children:(0,i.tZ)(l.Z,{height:24,stroke:e.stroke,fill:e.fill,strokeWidth:e.strokeWidth})}))},4878:function(e,t,a){"use strict";a.d(t,{Z:()=>s});var n=a(7409),r=a(99282),i=a(98848),l=a(16584),o=a(64515);let s=e=>{var{stroke:t="black",height:a=19,width:s=19}=e,d=(0,i._)(e,["stroke","height","width"]);return(0,l.BX)(o.l,(0,r._)((0,n._)({},d),{name:"NewsletterIcon",svgParams:{height:a,width:s,viewBox:"0 0 19 19"},children:[(0,l.tZ)("path",{d:"M3.5 3.5H15.5",stroke:t,"stroke-linecap":"round","stroke-linejoin":"round"}),(0,l.tZ)("path",{d:"M3.5 7.5H15.5",stroke:t,"stroke-linecap":"round","stroke-linejoin":"round"}),(0,l.tZ)("path",{d:"M3.5 11.5H15.5",stroke:t,"stroke-linecap":"round","stroke-linejoin":"round"}),(0,l.tZ)("path",{d:"M3.5 15.5H12",stroke:t,"stroke-linecap":"round","stroke-linejoin":"round"})]}))}},34293:function(e,t,a){"use strict";a.d(t,{Z:()=>s});var n=a(7409),r=a(99282),i=a(98848),l=a(16584),o=a(64515);let s=e=>{var{stroke:t="black"}=e,a=(0,i._)(e,["stroke"]);return(0,l.tZ)(o.l,(0,r._)((0,n._)({},a),{name:"ThreadIcon",svgParams:{height:19,width:19},children:(0,l.tZ)("path",{d:"M10.4286 3H8.57143C5.49441 3 3 5.49441 3 8.57143C3 10.2355 4.16477 12.1934 5.32143 13.2143V16L11.3571 14.1429C14.6071 13.067 16 10.9973 16 8.57143C16 5.49441 13.5056 3 10.4286 3Z",stroke:t,"stroke-linejoin":"round"})}))}},54688:function(e,t,a){"use strict";a.d(t,{Z:()=>o});var n=a(7409),r=a(99282),i=a(16584),l=a(64515);let o=e=>(0,i.BX)(l.l,(0,r._)((0,n._)({},e),{name:"UsersIcon",svgParams:{height:14,width:15,stroke:"#B6B6B6"},children:[(0,i.tZ)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.91732 12.249V11.0824C9.91732 9.79369 8.87265 8.74902 7.58398 8.74902H2.91732C1.62865 8.74902 0.583984 9.79369 0.583984 11.0824V12.249",fill:"#838383",stroke:"#838383","stroke-linecap":"round","stroke-linejoin":"round"}),(0,i.tZ)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.24935 6.41423C6.53801 6.41423 7.58268 5.36956 7.58268 4.08089C7.58268 2.79223 6.53801 1.74756 5.24935 1.74756C3.96068 1.74756 2.91602 2.79223 2.91602 4.08089C2.91602 5.36956 3.96068 6.41423 5.24935 6.41423Z",fill:"#838383",stroke:"#838383","stroke-linecap":"round","stroke-linejoin":"round"}),(0,i.tZ)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.8118 12.2659H13.563C13.5622 11.2025 14.0005 8.82373 11.666 8.82373",fill:"#838383",stroke:"#838383","stroke-linecap":"round","stroke-linejoin":"round"}),(0,i.tZ)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.33398 1.82227C10.3664 2.08661 11.0886 3.01693 11.0886 4.08268C11.0886 5.14844 10.3664 6.07875 9.33398 6.3431",fill:"#838383",stroke:"#838383","stroke-linecap":"round","stroke-linejoin":"round"})]}))},17350:function(e,t,a){"use strict";a.d(t,{i:()=>h});var n=a(16584),r=a(60484),i=a(67749),l=a(20042),o=a(347),s=a(95441),d=a(56629),c=a(68833),u=a(15771),m=a(19081),p=a(91400);let h=e=>{let{post:t}=e,a=(0,d.So)().getSettingFor("enable_prev_next_nav"),h=(0,p.XA)(),{iString:g}=(0,s.M1)();if(!a)return null;let b=t.next_post_slug,f=t.previous_post_slug;return b||f?(0,n.tZ)(o.h,{children:(0,n.BX)(m.hs,{justifyContent:b&&f?"space-between":b?"end":"start",paddingY:16,children:[f&&(0,n.tZ)(u.zx,{leading:(0,n.tZ)(r.Z,{size:20}),priority:h?"tertiary":"secondary",size:h?"sm":"md",onClick:()=>{(0,c.j)(c.FP.PREVIOUS_POST_LINK_CLICKED,{post_id:t.id}),(0,l.route)("/p/".concat(f))},children:g("Previous")}),b&&(0,n.tZ)(u.zx,{trailing:(0,n.tZ)(i.Z,{size:20}),priority:h?"tertiary":"secondary",size:h?"sm":"md",onClick:()=>{(0,c.j)(c.FP.NEXT_POST_LINK_CLICKED,{post_id:t.id}),(0,l.route)("/p/".concat(b))},children:g("Next")})]})}):null}},94922:function(e,t,a){"use strict";a.d(t,{v:()=>c});var n=a(27412),r=a(16584),i=a(6400),l=a(60826),o=a(95398),s=a(51014),d=a(68833);class c extends i.Component{onShare(e){var t,a;this.props.position&&(0,d.j)(d.FP.POST_SHARE_BUTTON_CLICKED,{position:this.props.position}),this.props.isStatic||(e&&e.stopPropagation(),this.props.sharedShareDialog?null===(t=e.target)||void 0===t||t.dispatchEvent(new CustomEvent("share-post",{bubbles:!0})):null===(a=this.modal)||void 0===a||a.open())}render(e){let t,{className:a,linkClassName:n,user:i,pub:d,post:c,reaction_token:u,height:m,onChange:p,isStatic:h,children:g,sharedShareDialog:b,noIcon:f}=e;return t=c.share_url_override?c.share_url_override:h?c?l.W.SHARE_URL:l.W.SHARE_PUB_URL:"javascript:void(0)",(0,r.BX)("span",{className:a,children:[(0,r.BX)("a",{href:t,onClick:e=>this.onShare(e),className:n,children:[!f&&(0,r.tZ)(o.Z,{className:"recommend-icon post-meta-icon",isStatic:h,height:m,alt:"Share",stroke:"#757575",fill:"transparent",strokeWidth:h?1:1.5}),g]}),!h&&!b&&(0,r.tZ)(s.ZP,{ref:this.assignModal,user:i,pub:d,post:c,reaction_token:u,onChange:p})]})}constructor(...e){super(...e),(0,n._)(this,"modal",void 0),(0,n._)(this,"assignModal",e=>{this.modal=e})}}},16944:function(e,t,a){"use strict";a.d(t,{a:()=>E});var n=a(7409),r=a(16584),i=a(94184),l=a.n(i),o=a(7703),s=a(54688),d=a(94442),c=a(85685),u=a(60308);function m(e){var t;let{pub:a,post:n}=e,i=(0,u.zF4)("".concat((0,u.SVA)(a),"/p/").concat(n.slug,"/authors.svg"),800,{format:"png",crop:"scale"}),{height:l,width:o}={width:((null==n?void 0:null===(t=n.publishedBylines)||void 0===t?void 0:t.length)-1)*32+40+4,height:44};return(0,r.tZ)("img",{src:i,width:o,height:l})}var p=a(95441),h=a(56629),g=a(49762),b=a(94874),f=a(13229),v=a(19081),y=a(71460),_=a(98012),w=a(6070),Z=a(31377),C=a(79582),k=a(81821),S=a(84864);function E(e){let{post:t,pub:a,user:i,showDate:E,showDatetime:N,isStatic:x,className:O,postReactionToken:M,onChange:B,allowEdit:I,hidePinning:T,showEmailSent:A,allowSendEmail:P,allowMobileFooter:D,onCommentsClick:L,showRestackModal:R,setFooterShown:F}=e,H=(0,k.tq)({checkFirst4:!0}),X="undefined"==typeof window,z=(0,S.getBylineUsers)(t),{language:U}=(0,p.M1)(),V=N?(0,_.Z)(t.post_date).locale(U).standardDatetime():x?(0,_.Z)(t.post_date).locale(U).standardDate():(0,_.Z)(t.post_date).locale(U).standardDateOrTime(),{getSettingFor:W}=(0,h.So)(),J=a.bylines_enabled&&(0,S.getPrintedByline)(a,t)&&"podcast"!==t.type,q=J&&a.byline_images_enabled&&z.some(e=>{let{photo_url:t}=e;return!!t}),j="page"!==t.type,Y=H&&q&&z.length>2,G=(null==a?void 0:a.community_enabled)&&t.slug&&!t.is_draft&&(0,S.showCommentsOnPost)({publication:a,post:t}),$=J&&1===z.length&&z[0].is_guest&&z[0].primaryPublicationSubscribeUrl&&z[0].primaryPublicationId!==a.id&&!t.is_draft&&!(0,g.default)("dont_show_guest_byline"),K=(0,S.oxfordComma)(z.map(e=>x?(0,r.tZ)("a",{className:"byline-profile-link",href:(0,u.LwU)(e,a,{base:x}),onClick:e=>e.stopPropagation(),children:e.name}):(0,r.BX)(v.gq,{inline:!0,gap:4,alignItems:"center",children:[(0,r.tZ)(c.ProfileHoverCard,{subject:e,utmSource:"byline",children:(0,r.tZ)("a",{className:"byline-profile-link",href:(0,u.LwU)(e,a,{base:x}),onClick:e=>e.stopPropagation(),children:e.name})}),!x&&(0,r.tZ)(y.UserBadge,{tier:e.bestseller_tier,size:"sm",userId:e.id})]}))),Q=!t.is_draft&&(0,C.x)(i,{enable_restacking:!!W("enable_restacking")},t,a,x);return(0,r.BX)("div",{className:l()("post-subheader",O),children:[(0,r.BX)("div",{className:l()("left",{vertical:Y}),children:[q&&(x?(0,r.tZ)(m,{pub:a,post:t}):(0,r.tZ)(f.H,{users:z.map(e=>{let{id:t,name:a,photo_url:n}=e;return{id:t,name:a,photo_url:n}}),max:5,size:36,renderAvatar:e=>(0,r.tZ)(b.xV,(0,n._)({},e))})),(0,r.BX)("div",{className:"label-stack",children:[J&&(0,r.tZ)("div",{className:"bylines",children:(0,r.tZ)("span",{className:"byline-names",children:K})}),$&&(0,r.BX)("div",{className:"guest-author-publication",children:["Writes\xa0",(0,r.tZ)("a",{className:"guest-author-publication-name",href:z[0].primaryPublicationUrl,title:z[0].primaryPublicationName,children:z[0].primaryPublicationName}),"\xa0\xb7\xa0",(0,r.tZ)("a",{className:"guest-author-publication-subscribe",href:z[0].primaryPublicationSubscribeUrl,children:"Subscribe"})]}),(0,r.BX)("div",{className:"publish-context",children:["adhoc_email"===t.type?(0,r.tZ)(s.Z,{className:"audience-icon adhoc-email-icon",height:16,isStatic:x}):j&&(0,Z.isPaidAudience)(t.audience)&&!(0,w.lp)({post:t})&&(0,r.tZ)(o.Z,{audience:t.audience,className:"audience-icon audience-lock-icon",size:16,isStatic:x,thin:!0}),(E||N)&&t.post_date&&!t.is_draft&&(0,r.tZ)("time",{dateTime:(0,_.Z)(t.post_date).toISOString(),children:V}),t.is_draft&&(E||N)&&"Draft"]})]})]}),(0,r.BX)("div",{className:"right",children:[H&&!X&&D&&(0,r.tZ)(d.mt,{post:t,pub:a,user:i,isStatic:x,onChange:B,allowEdit:I,hidePinning:T,showEmailSent:A,allowSendEmail:P,hideComments:!G,onCommentsClick:L,showRestackButton:Q,showRestackModal:R,setFooterShown:F,postReactionToken:M}),!H&&(0,r.tZ)(d._2,{post:t,pub:a,user:i,isStatic:x,style:"button",onChange:B,allowEdit:I,hidePinning:T,showEmailSent:A,allowSendEmail:P,labelStyle:"counts-or-none",hideComments:!G,onCommentsClick:L,position:"post-header",showRestackButton:Q,showRestackModal:R,showClipping:"podcast"===t.type,editButtonIsLast:!0,postReactionToken:M})]})]})}},11712:function(e,t,a){"use strict";a.d(t,{Z:()=>J});var n=a(27412),r=a(7409),i=a(99282),l=a(98848),o=a(16584),s=a(6400),d=a(39693),c=a.n(d),u=a(23279),m=a.n(u),p=a(18446),h=a.n(p),g=a(30845),b=a(59708),f=a(30396),v=a(14293),y=a.n(v),_=a(98188),w=a(29032),Z=a(93678),C=a(60807),k=a(68833),S=a(98914),E=a(19081),N=a(58175),x=a(39493),O=a(63651),M=a(24271);function B(e){var t,a,n,i,l;let{nuxModal:s,showRestackNux:d}=(0,x.y)("post");return(0,o.BX)(o.HY,{children:[s,!y()(null===(t=e.selection)||void 0===t?void 0:t.text)&&(null===(l=e.selection)||void 0===l?void 0:null===(i=l.text)||void 0===i?void 0:null===(n=i.split)||void 0===n?void 0:null===(a=n.call(i," "))||void 0===a?void 0:a.length)>=3&&(0,o.tZ)(I,(0,r._)({onShare:d},e))]})}function I(e){let{pub:t,post:a,selection:n,onClose:r,userInteractionDisabled:i}=e,l=(0,C.aF)(),[s,d]=(0,f.eJ)(!1);(0,f.d4)(()=>{d(!0)},[]);let c=async()=>{(0,k.j)(k.FP.VIDEO_QUOTE_TEXT_SELECTED,{post_id:a.id,selection_id:n.id}),(0,S.uX)((0,O.fQy)(t,a.id,{selectionForQuote:n.text}),{local_navigation:!1})};(0,f.d4)(()=>(window.addEventListener("scroll",r,{passive:!0,capture:!0,once:!0}),()=>{window.removeEventListener("scroll",r,{capture:!0,once:!0})}),[r]);let u=n.text&&n.text.length>2048;return(0,o.tZ)(w.C,{children:(0,o.tZ)(E.tu,{style:{top:n.y-48-12,left:n.rect.x+n.rect.width/2,transform:"translateX(-50%)",pointerEvents:i?"none":"auto",maxWidth:240},justifyContent:"center",outline:"detail",shadow:"md",radius:"md",className:"".concat(M.Z.popover," ").concat(s?M.Z.visible:""," ").concat(i?M.Z.disabled:""),padding:4,gap:4,children:(0,o.BX)(Z.O7,{onClick:c,disabled:!!(!l||u),children:[(0,o.tZ)(_.Z,{size:20,color:"var(--color-utility-white)"}),(0,o.tZ)(N.xv.B4,{color:"vibrance-primary",weight:"medium",children:u?"Selection too long":"Use this text"})]})})})}var T=a(57391),A=a(2563),P=a(48980),D=a(75419),L=a(47929);let R=(0,s.createContext)({action:null,selectedImage:null}),F=async e=>{let{imgSrc:t,post:a,pub:n}=e,r=await (0,P.rd)("/api/v1/post_selection/image",{method:"PUT",json:{post_id:a.id,publication_id:n.id,img_src:t}});if(r instanceof Error)throw r;return r.selection.id},H=async e=>{let{imgSrc:t,pub:a,post:n}=e,r=await F({imgSrc:t,post:n,pub:a});return(0,O.uRy)(a,n,{urlParams:{utm_campaign:L.VX.postSelection,utm_medium:L.lP.web,imgSelection:r}})},X=e=>{var t;let{children:a,imageState:n,selectedImageIndex:r,selectedImageAction:i=null,onClose:l,pub:s,post:d}=e,c=(0,D.i3)(),[u,m]=(0,f.eJ)(r&&null!==(t=null==n?void 0:n[r])&&void 0!==t?t:null);(0,f.d4)(()=>{if(null!=r&&n){var e;m(null!==(e=n[r])&&void 0!==e?e:null)}},[n,r]);let p=(0,f.I4)(async()=>{(null==u?void 0:u.src)&&c.open({restackUrl:await H({imgSrc:null==u?void 0:u.src,pub:s,post:d}),onCompose(){m(null),l()},onDismiss(){m(null),l()}})},[c,l,d,s,null==u?void 0:u.src]);return(0,f.d4)(()=>{u&&"restack"===i&&!c.state.isOpen&&p()},[i,c.state.isOpen,u,p]),(0,o.BX)(R.Provider,{value:{action:i,selectedImage:u},children:[a,(0,o.tZ)(A.ImageViewerModal,{showModal:"view"===i,modalContent:n,onClose:l,step:null!=r?r:0})]})};var z=a(81355),U=a(60308),V=a(84864);let W="\n:is(\n  div.body.markup, .pullquote, blockquote, li, caption, .footnote-content\n) > :is(\n  h1, h2, h3, h4, h5, h6, p:not(.button-wrapper)\n)\n";class J extends s.Component{async componentDidMount(){if(!this.body.current)return;let e=Array.from(this.body.current.querySelectorAll(W));this.originalParagraphState=e.map(e=>({text:e.textContent}));let t=new URL(window.location.href).searchParams.get("img"),a=new URL(window.location.href).searchParams.get("cutoffElementIndex"),n=Array.from(this.body.current.querySelectorAll(".image-link.image2"));n.forEach(e=>{"A"!==e.tagName&&console.warn("while parsing prosemirror doc for images, expected an anchor tag, but got",e.tagName)});let r=c()(n.map(e=>{let t=e.querySelector("img");if(!t)return console.warn("missing img when rendering prosemirror document"),null;let a=t.getAttribute("data-attrs"),n=a?JSON.parse(a):{},r=n.width/n.height,i=n.resizeWidth?n.resizeWidth/r:n.height,l=n.resizeWidth?n.resizeWidth/i:r;return{element:e,image:t,attrs:n,extraAttrs:{imageRatio:r,resizeHeight:i,resizeRatio:l}}})),i=0;if(t){let e=r.find(e=>e.attrs.src===t);e&&(i=e.image.getBoundingClientRect().top-65)}else if(a){let e=this.body.current.querySelector("*:nth-child(".concat(a,")"));e&&e.scrollIntoView()}if(r=(r=(r=r.filter(e=>(0,U.UH4)(e.image.src)===(0,U.UH4)(e.element.href))).filter(e=>Number(e.attrs.height)>240&&e.extraAttrs.resizeHeight>240)).filter(e=>e.extraAttrs.imageRatio<4&&e.extraAttrs.resizeRatio<4),this.originalImageState=r.map(e=>{let t=e.image.src,a=null,n=e.element.parentElement;if(n&&"FIGURE"===n.tagName){var r;a=null===(r=n.querySelector(":scope > figcaption"))||void 0===r?void 0:r.textContent}return{src:t,attrs:e.attrs,caption:a}}),t&&this.originalImageState){window.scrollTo({top:i});let e=this.originalImageState.findIndex(e=>e.attrs.src===t);e>=0&&this.setState({selectedImgIndex:e})}"undefined"!=typeof window&&(document.addEventListener("selectionchange",this.onSelectionChange),document.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mouseup",this.onMouseUp))}componentWillUnmount(){"undefined"!=typeof window&&(document.removeEventListener("selectionchange",this.onSelectionChange),document.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mouseup",this.onMouseUp))}shouldComponentUpdate(e,t){return this.props.html!==e.html||this.state.selectedImgIndex!==t.selectedImgIndex||this.state.selection!==t.selection||this.state.selectionUserInteractionDisabled!==t.selectionUserInteractionDisabled||this.state.selectingTextForQuote!==t.selectingTextForQuote}onLinkClick(e){var t,a;if(!e.target||!(null===(t=e.target)||void 0===t?void 0:t.nodeName)||"A"!==e.target.nodeName&&(null===(a=e.target.parentNode)||void 0===a?void 0:a.nodeName)!=="A")return;let n="A"===e.target.nodeName?e.target:e.target.parentNode;if((0,k.j)(k.FP.POST_LINK_CLICKED,{post_id:this.props.post.id,publication_id:this.props.post.publication_id,url:n.href}),window.location.host===n.host){let t=(0,V.transformDocumentLink)(n.href);t!==n.href&&(0,S.uX)(t,{local_navigation:!1,event:e});return}e.preventDefault(),(0,V.handleDocumentLinkClick)(n.href)}getSelectionState(){if(this.props.trackSelection&&window.getSelection)try{let e=window.getSelection();if(!e||e.isCollapsed||e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset)return;let t=this.findParentParagraph(e.anchorNode);if(!t)return;let a=this.findParentParagraph(e.focusNode);if(!a||!this.body.current)return;let n=Array.from(this.body.current.querySelectorAll(W)),r=n.findIndex(e=>e.isSameNode(t));if(-1===r)return;let i=n.findIndex(e=>e.isSameNode(a));if(-1===i)return;let l=this.getCharacterOffsetParagraph(t,e.anchorNode,e.anchorOffset);if(null===l)return;let o=this.getCharacterOffsetParagraph(a,e.focusNode,e.focusOffset);if(null===o)return;let s=r>i||r===i&&l>o,d=e.getRangeAt(0).getBoundingClientRect();return{startParagraph:s?i:r,endParagraph:s?r:i,startOffset:s?o:l,endOffset:s?l:o,y:d.y,height:d.height,rect:d,text:e.toString()}}catch(e){console.error("Failed to parse selection:",e)}}findParentParagraph(e){return e?["P","H1","H2","H3","H4","H5","H6"].includes(e.nodeName)?e:this.findParentParagraph(e.parentNode):null}isAncestorOf(e,t){return null!==e&&(!!e.isSameNode(t)||this.isAncestorOf(e.parentNode,t))}getCharacterOffsetParagraph(e,t,a){let n=a;for(let a=0;a<e.childNodes.length;a++){let i=e.childNodes[a];if(i){if(this.isAncestorOf(t,i))break;if(i instanceof HTMLElement){if("BR"===i.tagName)n+=1;else if("footnote-anchor"!==i.className){var r;n+=(null===(r=i.textContent)||void 0===r?void 0:r.length)||0}}}}return n}shouldShowImageViewerModal(){let{selectedImgIndex:e}=this.state;return null!=e}render(e){var{children:t,html:a,pub:n,isAboutPage:s,canRestackImage:d}=e,c=(0,l._)(e,["children","html","pub","isAboutPage","canRestackImage"]);let{selection:u,selectedImgIndex:m,shouldUseSelectionV2Popover:p,selectingTextForQuote:h,imgAction:g}=this.state;if("undefined"==typeof window||h||"true"!==new URLSearchParams(window.location.search).get("selectQuote")||this.setState({selectingTextForQuote:!0}),a){let e=this.context.getExperimentVariant("overwrite_share_button_on_post_pages");c.variant=e,c.exposeExperiment=this.context.exposeExperiment,(t=this.memoizedDeepPrepareDocumentBody(a,n,(0,i._)((0,r._)({},c),{isAboutPage:s,canRestackImage:d})))&&(a=null)}let b=!!t&&Array.from(t).some(e=>{var t,a,n,r;return(null===(t=e.props)||void 0===t?void 0:t.className)==="latex-rendered"||(null===(r=e.props)||void 0===r?void 0:null===(n=r.children)||void 0===n?void 0:null===(a=n.props)||void 0===a?void 0:a.className)==="latex-rendered"}),f=(0,o.tZ)(o.HY,{children:(0,o.BX)(X,{imageState:this.originalImageState,selectedImageIndex:m,selectedImageAction:g,onClose:this.onCloseViewer,pub:n,post:this.props.post,children:[(0,o.tZ)("div",{className:"body markup",dangerouslySetInnerHTML:a?{__html:a}:null,ref:this.body,onClick:this.onDocumentClick,onMouseDown:this.onBodyMouseDown,onMouseUp:this.onMouseUp,dir:"auto",children:t}),p&&!h?(0,o.tZ)(Z.Up,{pub:n,post:this.props.post,selection:u,onClose:this.clearActiveSelection,userInteractionDisabled:this.state.selectionUserInteractionDisabled,themeVariables:this.props.themeVariables}):u&&(0,o.tZ)(B,{pub:n,post:this.props.post,selection:u,onClose:this.clearActiveSelection,userInteractionDisabled:this.state.selectionUserInteractionDisabled})]})});return b&&!c.isStatic?(0,o.tZ)(z.e,{children:f}):f}constructor(e,t){super(e,t),(0,n._)(this,"body",void 0),(0,n._)(this,"originalParagraphState",void 0),(0,n._)(this,"originalImageState",void 0),(0,n._)(this,"state",{selection:null,urlSelection:null,selectedImgIndex:null,selectionUserInteractionDisabled:!1,shouldUseSelectionV2Popover:!1,imgAction:null}),(0,n._)(this,"onBodyMouseDown",()=>{this.setState({selectionUserInteractionDisabled:!0})}),(0,n._)(this,"onMouseUp",()=>{this.setState((e,t)=>e.selectionUserInteractionDisabled?(e.selection&&t.trackSelection&&(0,k.j)(k.FP.POST_TEXT_SELECTED,{post_id:t.post.id,post_audience:t.post.audience,post_type:t.post.type}),{selectionUserInteractionDisabled:!1}):null)}),(0,n._)(this,"onSelectionChange",m()(()=>{let e=this.getSelectionState();if(e){let t=this.shouldShowShareSelectionPopover();this.setState({selection:e,shouldUseSelectionV2Popover:t})}else this.state.selection&&this.setState({selection:null})},10)),(0,n._)(this,"onDocumentClick",e=>{if(!e.target)return;let t=e.target.closest(".image-link.image2");if(t&&this.originalImageState){var a;let n=t.querySelector("img"),r=this.originalImageState.findIndex(e=>e.src===(null==n?void 0:n.src)),i=e.target,l=this.props.canRestackImage&&(null==i?void 0:i.classList.contains("restack-image"))||(null==i?void 0:null===(a=i.parentElement)||void 0===a?void 0:a.classList.contains("restack-image"));if(r>=0){e.preventDefault(),this.setState({selectedImgIndex:r,imgAction:l?"restack":"view"});return}}if(this.props.skipTrackClick)return null;this.onLinkClick(e)}),(0,n._)(this,"onCloseViewer",()=>{this.setState({selectedImgIndex:null,imgAction:null})}),(0,n._)(this,"clearActiveSelection",()=>{this.setState({selection:null})}),(0,n._)(this,"closeImageViewerModal",()=>{this.setState({selectedImgIndex:null})}),(0,n._)(this,"shouldShowShareSelectionPopover",()=>{let e;return"undefined"!=typeof window&&(e="true"===new URLSearchParams(window.location.search).get("selectQuote")),!e}),(0,n._)(this,"memoizedDeepPrepareDocumentBody",(0,g.Z)(b.Kd,h())),this.body=(0,s.createRef)()}}(0,n._)(J,"contextType",T.kx)},84881:function(e,t,a){"use strict";a.d(t,{S:()=>y,y:()=>v});var n=a(16584),r=a(30396),i=a(80569),l=a.n(i),o=a(60826),s=a(20145),d=a(95441),c=a(90099),u=a(19081),m=a(10510),p=a(58175),h=a(18967),g=a(60308),b=a(47929),f=a(34009);let v=e=>{let{tierNumber:t,rewardDescription:a,numReferralsRequired:i,pub:o}=e,[c,b]=(0,r.eJ)([]),f=async()=>{let{body:e}=await l().get("/api/v1/reader_referrals/tiers");b(e.tiers)},{iString:v}=(0,d.M1)();if((0,r.d4)(()=>{f()},[]),!t||!o.id)return(0,n.tZ)("div",{"data-component-name":"ReferralsTierCardError"});let y=c[t-1],_=y?"custom"===y.reward_type?y.reward_description:v(h.ML[y.reward_type]):a,w=y?y.num_referrals_required:i;return w?(0,n.BX)(u.tu,{"data-component-name":"ReferralsTierCard",className:"milestone-tier-card",justifyContent:"start",border:"detail-themed",radius:"md",padding:20,gap:16,children:[(0,n.tZ)("div",{className:"tier-stars-container",children:Array(t).fill(0).map((e,t)=>(0,n.tZ)(s.Z,{width:20,height:20,strokeWidth:2,stroke:o.theme_var_background_pop||"#FF6719",fill:o.theme_var_background_pop||"#FF6719"},t))}),(0,n.BX)(u.tu,{gap:4,children:[(0,n.tZ)(p.xv.H4,{children:_}),(0,n.BX)(p.xv.Meta,{translated:!0,children:["Tier ",I18N.p(t)," reward - ",I18N.p(w)," Referrals"]})]}),(0,n.BX)(u.gq,{alignItems:"center",children:[(0,n.tZ)(m.wk,{pub:o,size:24}),(0,n.tZ)(p.xv.Meta,{color:"primary",as:"a",href:(0,g.SVA)(o),decoration:"none",weight:"bold",children:o.name})]})]}):(0,n.tZ)("div",{"data-component-name":"ReferralsTierCardError"})},y=e=>{let{tierNumber:t,pub:a}=e;return t&&a.id?(0,n.tZ)("a",{href:"".concat(o.W.LEADERBOARD_URL,"&utm_source=").concat(b.b3.rewardEmail),className:f.Z.referralsTierCard,children:(0,n.BX)(c.i$,{gap:16,children:[(0,n.tZ)(c.zK,{style:{lineHeight:0},gap:4,children:Array(t).fill(0).map((e,t)=>(0,n.tZ)(s.Z,{width:20,height:20,strokeWidth:2,stroke:a.theme_var_background_pop||"#FF6719",fill:a.theme_var_background_pop||"#FF6719",isStatic:!0},t))}),(0,n.BX)(c.i$,{gap:4,children:[(0,n.tZ)(p.xv.H4,{children:o.W.REWARD_DESCRIPTION}),(0,n.BX)(p.xv.Meta,{translated:!0,children:["Tier ",I18N.p(t)," reward - ",I18N.p(o.W.NUM_REFERRALS_REQUIRED)," Referrals"]})]}),(0,n.BX)(c.zK,{verticalAlign:"middle",children:[(0,n.tZ)(m.CN,{pub:a,size:24}),(0,n.tZ)(p.xv.Meta,{color:"primary",as:"a",href:(0,g.SVA)(a),decoration:"none",weight:"bold",children:a.name})]})]})}):(0,n.tZ)("div",{})}},13693:function(e,t,a){"use strict";a.d(t,{O:()=>f,V:()=>b});var n=a(16584),r=a(94184),i=a.n(r),l=a(60826),o=a(60807),s=a(90099),d=a(19081),c=a(58175),u=a(71106),m=a(60308),p=a(63651),h=a(37175),g=a(24718);let b=e=>{var t;let{campaign:a,pub:r,isEditor:l,dataAttrs:o}=e;return(0,n.tZ)("div",{className:i()("sponsorship-campaign-embed",{"sponsorship-campaign-embed-structured":"structured"===a.campaign_type,[null!==(t=g.Z.editorBorder)&&void 0!==t?t:""]:l}),dataAttrs:o,children:"structured"===a.campaign_type?(0,n.tZ)(v,{campaign:a,pub:r,isEditor:l}):(0,n.tZ)(w,{campaign:a,pub:r,isEditor:l})})},f=e=>{let{campaign:t,pub:a}=e;return(0,n.tZ)("table",{className:"sponsorship-campaign-embed",width:"100%",children:(0,n.tZ)("tbody",{children:(0,n.tZ)("tr",{children:(0,n.tZ)("td",{children:"structured"===t.campaign_type?(0,n.tZ)(y,{campaign:t,pub:a}):(0,n.tZ)(Z,{campaign:t,pub:a})})})})})},v=e=>{var t,a;let{campaign:r,pub:i,isEditor:l}=e,s=(0,o.aF)();return(0,n.BX)(d.gq,{className:g.Z.sponsorshipCampaign,alignItems:"center",justifyContent:"center",borderTop:"detail",borderBottom:"detail",paddingY:8,gap:16,as:"a",href:l?"#":(0,m.l5Q)({campaignId:r.id,medium:"web",pubId:null!==(t=null==i?void 0:i.id)&&void 0!==t?t:0,userId:null==s?void 0:s.id}),children:[r.short_text&&(0,n.tZ)("span",{className:g.Z.presentedBy,children:r.short_text}),r.image_url&&(0,n.tZ)("div",{className:g.Z.imageContainer,children:(0,n.tZ)("img",{alt:null!==(a=r.image_alt_text)&&void 0!==a?a:"",className:g.Z.image,src:(0,p.zF4)(r.image_url,300)})})]})},y=e=>{var t;let{campaign:a,pub:r}=e;return(0,n.tZ)("a",{href:(0,m.l5Q)({campaignId:a.id,medium:"email",pubId:null!==(t=null==r?void 0:r.id)&&void 0!==t?t:0,userId:l.W.USER_ID}),style:{textDecoration:"none"},children:(0,n.tZ)(s.YF,{className:g.Z.emailWrapper,"data-component-name":"StaticSponsorshipCampaignBlock",children:(0,n.tZ)("tr",{children:(0,n.BX)("td",{style:{padding:"8px 0",textAlign:"center"},children:[a.short_text&&(0,n.tZ)("span",{className:g.Z.presentedByEmail,style:{verticalAlign:"middle",marginRight:"16px"},children:a.short_text}),a.image_url&&(0,n.tZ)("img",{style:{display:"inline-block",maxWidth:"100px",maxHeight:"80px",width:"auto",height:"auto",verticalAlign:"middle"},width:"100",height:"80",src:(0,p.zF4)(a.image_url,300)})]})})})})},_=e=>{let{html:t,campaign:a,pub:n,userId:r}=e;return t.replace(/href="([^"]*)"/g,(e,t)=>{var i;let l=(0,m.l5Q)({campaignId:a.id,medium:"web",pubId:null!==(i=null==n?void 0:n.id)&&void 0!==i?i:0,userId:r,url:t});return'href="'.concat(l,'"')})},w=e=>{let{campaign:t,pub:a,isEditor:r}=e,i=(0,o.aF)();if(!a)return null;let l=h.toHtml(t.doc_content,!1,{pubId:a.id}),s=r?l:_({html:(0,u.A)(l,{pub:a,user:i}),campaign:t,pub:a,userId:String(null==i?void 0:i.id),medium:"web"}),d=(0,n.tZ)("div",{className:g.Z.docContentWrapper,dangerouslySetInnerHTML:{__html:s}});return r?(0,n.BX)("div",{className:g.Z.editorWrapper,children:[(0,n.BX)(c.xv.Digit,{color:"secondary",className:g.Z.editorHelperText,children:["paid"===t.exclude_audience_minimum?"Sponsored content (free subscribers only)":"Sponsored content",a&&(0,n.BX)(n.HY,{children:[" - ",(0,n.tZ)("a",{href:(0,m.p$H)({campaignId:t.id,pub:a}),children:"Edit"})]})]}),d]}):d},Z=e=>{let{campaign:t,pub:a}=e;if(!a)return null;let r=_({html:h.toHtml(t.doc_content,!0,{pubId:a.id}),campaign:t,pub:a,userId:l.W.USER_ID,medium:"email"});return(0,n.tZ)("div",{className:g.Z.docContentWrapperEmail,dangerouslySetInnerHTML:{__html:r}})}},33665:function(e,t,a){"use strict";a.d(t,{n:()=>O,Z:()=>M});var n=a(27412),r=a(7409),i=a(99282),l=a(16584),o=a(6400),s=a(94184),d=a.n(s),c=a(25380),u=a(60826),m=a(12620),p=a(64515);let h=e=>(0,l.tZ)(p.l,(0,i._)((0,r._)({},e),{name:"LucideCheck",svgParams:{height:24,width:24,fill:"#000000",strokeWidth:0},children:(0,l.tZ)(c.Z,{height:24,stroke:e.stroke,fill:e.fill,strokeWidth:e.strokeWidth})}));var g=a(64719),b=a(95441),f=a(56629),v=a(75905),y=a(90406),_=a(71068),w=a(15771),Z=a(19081),C=a(60308),k=a(26111),S=a(84864),E=a(47929);let N=["Subscribe","Subscribe now","Sign up","Sign up now"];function x(e){let{isStatic:t,pub:a,user:n,freeSignup:r,children:i,pledgesEnabled:o}=e;if(t)return(0,l.tZ)(v.E.Consumer,{children:e=>{let{isFreemail:t,isFreeSubscribed:n,isPledged:r}=e;return i({isFreeSubscribed:n,isSubscribed:!t,isFullySubscribed:a.plans?!t:!o||r,isForPaidSubscription:!!a.plans&&t,isPledged:r})}});let s=r||(null==n?void 0:n.is_free_subscribed),d=null==n?void 0:n.is_subscribed,c=(null==n?void 0:n.is_subscribed)&&(null==n?void 0:n.is_founding),u=null==n?void 0:n.is_pledged;return i({isFreeSubscribed:s,isSubscribed:d,isFullySubscribed:a.plans?d:s&&(!o||u),isForPaidSubscription:!!a.plans&&s&&!d,isPledged:u,isFoundingSubscribed:c})}function O(e){let{pub:t,user:a,now:n,isStatic:r}=e,{language:i}=(0,b.M1)();return(0,l.tZ)(f.vz.Consumer,{children:e=>{let{getSettingFor:o}=e,s="disabled"===t.payments_state&&!t.invite_only&&!!o("payment_pledges_enabled");return(0,l.tZ)(x,{isStatic:r,user:a,pub:t,pledgesEnabled:s,children:e=>{let{isFreeSubscribed:a,isPledged:r}=e;return(0,l.tZ)(l.HY,{children:(0,S.getSubscribeText)(t,{now:n,isFreeSubscribed:a,isPledged:r,pledgesEnabled:s,language:i})})}})}})}class M extends o.Component{onSignup(e,t){let{pledgesEnabled:a}=t;this.setState({loading:!0}),this.props.onSignup?this.props.onSignup(e):!this.props.forceEmailInput&&(this.props.pub.plans||this.props.pub.has_recommendations||a)?document.location.href=(0,C.W1P)(this.props.pub,(0,r._)((0,i._)((0,r._)({addBase:!0,utm_medium:E.lP.web,utm_source:this.props.source||E.b3.subscribeWidget,utm_content:this.props.post&&this.props.post.id,just_signed_up:!0,requires_confirmation:e.body.requires_confirmation?"true":""},e.body.subscription_id&&{subscription_id:e.body.subscription_id},e.body.referral_token&&{referral_token:e.body.referral_token}),{next:this.props.next||document.location.href}),this.props.foundingUpsell&&{plan:"founding"})):(window.history.replaceState({},"",(0,C.n1t)(document.location.href,{just_subscribed:!0})),document.location.reload())}getHref(e,t){let{pub:a,subscribeButtonAttrs:n,isStatic:i,source:l,post:o,next:s,foundingUpsell:d}=this.props,c=(0,r._)({utm_medium:i?E.lP.email:E.lP.web,utm_source:l||E.b3.subscribeWidget,utm_content:o&&o.id,next:i?s:s||document.location.href,referring_pub_ids:i?void 0:(0,k.x)("referring_pub_ids")},d&&{plan:"founding"});return e?i?u.W.ACCOUNT_URL:(0,C.mGw)(a,{params:c,addBase:t.isSubstack}):(0,C.W1P)(a,(0,r._)({addBase:!0,root:n?n.url:i?u.W.CHECKOUT_URL:void 0},c))}getButtonLabel(e,t,a){let{isPledged:n,pledgesEnabled:r,foundingUpsell:i,isFoundingSubscribed:l}=a,{pub:o,subscribeButtonAttrs:s}=this.props,{iString:d}=I18N.i({pub:o});if(e||n)return d("Subscribed");let c=s&&s.text;return c&&!N.includes(c)?c:(0,S.getSubscribeText)(o,{now:!t,isFreeSubscribed:t,isPledged:n,pledgesEnabled:r,language:this.context.language,foundingUpsell:i,isFoundingSubscribed:l})}render(e,t){let{align:a,pub:n,additionalPubIds:r,user:i,freeSignup:o,freeSignupEmail:s,source:u,isStatic:p,forceEmailInput:b,expectTruncation:v,onPrepareData:C,onError:k,foundingUpsell:N,onConfirmationRequired:O,className:M}=e,{loading:B}=t;return(0,l.tZ)(f.vz.Consumer,{children:e=>{let{getSettingFor:t}=e;return(0,l.tZ)(g._j.Consumer,{children:e=>{let g=!e.isSubstack&&"undefined"!=typeof window&&n.hostname!==window.location.hostname.replace(/[.]localhost$/,"");return(0,l.tZ)(x,{pub:n,user:i,isStatic:p,freeSignup:o,pledgesEnabled:"disabled"===n.payments_state&&!n.invite_only&&!!t("payment_pledges_enabled"),children:f=>{var x;let{isFreeSubscribed:I,isSubscribed:T,isFullySubscribed:A,isPledged:P,isFoundingSubscribed:D}=f,L=this.getButtonLabel(A,I,{isPledged:P,pledgesEnabled:"disabled"===n.payments_state&&!n.invite_only&&!!t("payment_pledges_enabled"),isFoundingSubscribed:D,foundingUpsell:N}),R=I||T;return(0,l.tZ)("div",{className:d()("subscribe-widget",{"is-signed-up":R,"is-fully-subscribed":A},M),"data-component-name":"SubscribeWidget",children:!b&&(R||p)?(0,l.tZ)(_.xu,{className:"button-wrapper",children:p?(0,l.BX)("a",{className:d()("button subscribe-btn",A?"outline":"primary"),href:this.getHref(A,e),native:!p,children:[A&&(0,l.tZ)(h,{stroke:(null==n?void 0:null===(x=n.theme)||void 0===x?void 0:x.background_pop_color)||(null==n?void 0:n.theme_var_background_pop)||y.Hu,fill:"transparent",isStatic:!0,className:"check-icon static",height:20}),(0,l.tZ)("span",{children:L})]}):(0,l.tZ)(Z.gq,{justifyContent:"left"===a?"start":"center",children:(0,l.tZ)(w.zx,{href:this.getHref(A,e),localNavigation:!1,priority:A&&(D||!N)?"secondary-accent":"primary",leading:A&&(D||!N)?(0,l.tZ)(c.Z,{size:20}):null,children:(0,l.tZ)("span",{children:L})})})}):(0,l.tZ)(Z.gq,{justifyContent:"center",children:(0,l.tZ)(m.Z,{disabled:R||B,freeSignup:o,freeSignupEmail:s,expectTruncation:v,next:g?window.location.href:null,pub:n,source:u||"subscribe-widget",submitButtonText:R?"✓":(0,S.getSubscribeText)(n,{language:this.context.language}),useSubscribeLink:g,useGenericEndpoint:null==e?void 0:e.isSubstack,additionalPubIds:r,user:i,utm_campaign:(null==e?void 0:e.isSubstack)?E.VX.reader2:g?E.VX.crossPost:null,onConfirmationRequired:O||((null==n?void 0:n.payments_state)==="enabled"?()=>null:void 0),onError:k,onPrepareData:C,onSuccess:e=>this.onSignup(e,{pledgesEnabled:"disabled"===n.payments_state&&!n.invite_only&&!!t("payment_pledges_enabled")})})})})}})}})}})}}(0,n._)(M,"contextType",b.wj)},84722:function(e,t,a){"use strict";a.d(t,{Z:()=>o});var n=a(16584),r=a(12620),i=a(98914),l=a(60308);function o(e){let{pub:t,user:a,post:o,utmSource:s}=e;return(0,n.tZ)(r.Z,{className:"emailContainer-JfVhvU",inputClassName:"emailInput-VN3GpJ",placeholder:"ENTER YOUR EMAIL",promptClassName:"prompt-j7JgJU",pub:t,source:s,submitButtonText:"SIGN UP",subscribeButtonClassName:"subscribeButton-fDC87J",user:a,onAccentBackground:!0,onSuccess:e=>{(0,i.uX)((0,l.Zs0)(t,{just_signed_up:!0,autoSubmit:!!e.body.prompt_to_login||void 0,email:e.body.email,next:(0,l.uRy)(t,o)}),{replace:!0,local_navigation:!1})}})}},16506:function(e,t,a){"use strict";a.d(t,{Z:()=>f});var n=a(16584),r=a(30396),i=a(94184),l=a.n(i),o=a(347),s=a(84722),d=a(7523),c=a(57391),u=a(15771),m=a(19081),p=a(60308),h=a(47929);let g={wrapper:"wrapper-TFWk0w",fade:"fade-vBsC3Z",signInLink:"signInLink-TZ6ND4",subscribeButtonLarge:"subscribeButtonLarge-lAytbH"},b={control:{headline:"Enjoying the story?",body:"Enter your email to read this article and receive our daily newsletter."},treatment_a:{headline:(0,n.tZ)(n.HY,{children:"There’s more where this came from"}),body:(0,n.tZ)(n.HY,{children:"Give use your email and we’ll give you more articles, columns, and deep investigations, directly to your inbox."})},treatment_b:{headline:"Get More With a Subscription",body:(0,n.BX)(n.HY,{children:["Sign up here to receive deep investigations and provocative commentary about the world as it actually is, every day from ",(0,n.tZ)("em",{children:"The Free Press."})]})}},f=e=>{var t;let{post:a,user:i,pub:f,freeSignupEmail:v}=e,{getExperimentVariant:y,exposeExperiment:_}=(0,c.jc)(),w="newsletter"===a.type,Z=!!(v||(null==i?void 0:i.is_free_subscribed)||!a.current_user_post_meter),C=y("fp_registration_wall_copy_test");if((0,r.d4)(()=>{Z||_("fp_registration_wall_copy_test",{ignoreDownsampling:!0})},[Z]),Z)return(0,n.tZ)(o.h,{children:(0,n.BX)(m.tu,{alignItems:"center",className:l()(g.wrapper,{[g.fade]:w}),gap:24,justifyContent:"center",textAlign:"center",children:[(0,n.BX)(m.tu,{gap:16,children:[(0,n.BX)(d.Z,{preset:"h5-sans",children:["Maintaining ",(0,n.tZ)("em",{children:"The Free Press"})," is Expensive!"]}),!!a.current_user_post_meter&&(0,n.tZ)(d.Z,{preset:"d2-serif",children:"You’ve reached your monthly article limit"}),(0,n.tZ)(d.Z,{preset:"d3-serif",children:"To support independent journalism, and unlock all of our investigative stories and provocative commentary about the world as it actually is, subscribe below."})]}),(0,n.tZ)(u.kG,{className:g.subscribeButtonLarge,href:(0,p.Zs0)(f,{utm_source:h.b3.meteredPostPaywall,next:(0,p.uRy)(f,a)}),localNavigation:!1,children:(0,n.tZ)(d.Z,{color:"white",preset:"detail-large",children:"Subscribe Now"})}),(0,n.BX)(m.gq,{gap:16,children:[(0,n.tZ)(d.Z,{preset:"caption",children:"Already have an account?"}),(0,n.tZ)("a",{className:g.signInLink,href:(0,p.Zs0)(f,{isSignInAttempt:!0}),children:(0,n.tZ)(d.Z,{color:"accent",preset:"caption",children:"Sign In"})})]})]})});let{headline:k,body:S}=C&&null!==(t=b[C])&&void 0!==t?t:b.control;return(0,n.tZ)(o.h,{children:(0,n.BX)(m.tu,{alignItems:"center",className:l()(g.wrapper,{[g.fade]:w}),gap:24,justifyContent:"center",textAlign:"center",children:[(0,n.BX)(m.tu,{gap:16,children:[(0,n.tZ)(d.Z,{preset:"h5-sans",children:k}),(0,n.tZ)(d.Z,{preset:"d2-serif",children:S})]}),(0,n.tZ)(s.Z,{post:a,pub:f,user:i,utmSource:h.b3.meteredPostRegistrationWall}),(0,n.BX)(m.gq,{gap:16,children:[(0,n.tZ)(d.Z,{preset:"caption",children:"Already have an account?"}),(0,n.tZ)("a",{className:g.signInLink,href:(0,p.Zs0)(f,{isSignInAttempt:!0}),children:(0,n.tZ)(d.Z,{color:"accent",preset:"caption",children:"Sign In"})})]})]})})}},24658:function(e,t,a){"use strict";a.d(t,{R:()=>F});var n=a(16584),r=a(94184),i=a.n(r),l=a(7409),o=a(99282),s=a(30396),d=a(62372),c=a(88216),u=a(74626),m=a(98848),p=a(347);let h={popoverContainer:"popoverContainer-EjJsJc"},g=e=>{let{children:t,closeOnOutsideClick:a,content:r,isOpen:s,onClose:c,onToggle:u}=e,{arrowProps:g,layerProps:b,renderLayer:f,triggerProps:v}=(0,d.sJ)({auto:!0,containerOffset:28,isOpen:s,overflowContainer:!0,placement:"bottom-center",possiblePlacements:["bottom-center"],triggerOffset:16,onOutsideClick:a?c:void 0}),y=b.style,{style:_}=b,w=(0,m._)(b,["style"]),Z="undefined"==typeof window;return(0,n.BX)(n.HY,{children:[(0,n.tZ)("div",(0,o._)((0,l._)({},v),{onClick:()=>{null==u||u(!s)},children:t})),s&&!Z&&f((0,n.BX)("div",(0,o._)((0,l._)({style:y},w),{className:i()(h.popoverContainer,"the-free-press-theme"),children:[(0,n.tZ)(p.h,{children:r}),(0,n.tZ)(d.Eh,(0,o._)((0,l._)({},g),{borderColor:"var(--color-primary-themed)",borderWidth:2,size:10}))]})))]})};var b=a(7523),f=a(19081),v=a(60308),y=a(47929);let _=e=>{let{children:t,isFreeSubscribed:a,isOpen:r,isSubscribed:i,pub:l,onClose:o}=e,s=(0,v.W1P)(l,{utm_source:y.b3.downloadPdfButton,simple:!0,next:(0,v.n1t)(document.location.href,{triggerPDF:!0}),addBase:!0});return(0,n.tZ)(g,{closeOnOutsideClick:!0,content:(0,n.BX)(f.tu,{gap:4,position:"relative",children:[(0,n.tZ)(b.Z,{preset:"d4-serif",children:i?"Paid subscribers can now save articles as PDFs, formatted for printing out and enjoying offline.":"Saving articles as PDFs, formatted for printing and reading offline, is a benefit we're proud to offer our\n              paid subscribers. ".concat(a?"Upgrade":"Sign up"," today to unlock this feature.")}),!i&&(0,n.tZ)(f.gq,{children:(0,n.tZ)(u._,{href:s,localNavigation:!1,size:"sm",trailingIcon:"chevron-right",variant:"tertiary",children:a?"Upgrade now":"Subscribe now"})})]}),isOpen:r,onClose:o,children:t})};var w=a(68833),Z=a(98914),C=a(63651);let k=e=>{let{post:t,pub:a,user:r}=e,[i,u]=(0,d.XI)(),[m,p]=(0,s.eJ)(!1),h=!!(null==r?void 0:r.is_subscribed),g=!!(null==r?void 0:r.is_free_subscribed);return(0,s.d4)(()=>{let e=new URL(document.location.href);if(e.searchParams.get("triggerPDF")){if(h){var n;(0,Z.uX)((0,C.SUl)(a,t.id,{token:"token"in window._preloads&&null!==(n=window._preloads.token)&&void 0!==n?n:void 0}),{local_navigation:!1,newTab:!0})}e.searchParams.delete("triggerPDF"),window.history.replaceState({},"",e)}},[h,t.id,a]),(0,n.tZ)(_,{isFreeSubscribed:g,isOpen:m,isSubscribed:h,pub:a,onClose:()=>{p(!1)},children:(0,n.tZ)(f.hs,(0,o._)((0,l._)({},u),{cursor:"pointer",onClick:()=>{if((0,w.j)(w.FP.POST_PDF_BUTTON_CLICKED,{post_id:t.id}),!h){p(!m);return}(0,Z.uX)((0,C.SUl)(a,t.id),{local_navigation:!1,newTab:!0})},children:(0,n.tZ)(c.Z,{height:24,isHovered:i,width:24})}))})};var S=a(35845),E=a(16564),N=a(86657),x=a(92002),O=a(73580),M=a(64515);let B=e=>{var t=(0,x._)({},(0,O._)(e));return(0,n.tZ)(M.l,(0,o._)((0,l._)({},t),{name:"FPPauseIcon",svgParams:{width:25,height:25,viewBox:"0 0 25 24",fill:"none",stroke:"none"},children:(0,n.BX)("g",{id:"play-circle",children:[(0,n.tZ)("path",{id:"Icon",d:"M12.5 22C18.0228 22 22.5 17.5228 22.5 12C22.5 6.47715 18.0228 2 12.5 2C6.97715 2 2.5 6.47715 2.5 12C2.5 17.5228 6.97715 22 12.5 22Z",stroke:"#F2312C","stroke-width":"2","stroke-linecap":"round"}),(0,n.tZ)("rect",{id:"Rectangle 2398",x:"8.5",y:"7.08496",width:"3",height:"10",fill:"#F2312C"}),(0,n.tZ)("rect",{id:"Rectangle 2399",x:"13.5",y:"7.08496",width:"3",height:"10",fill:"#F2312C"})]})}))};var I=a(41193),T=a(84864);let A="ctaMode-zO5a9a",P=e=>{let{containerRef:t,currentTime:a,remainingTime:r,progress:i,onMouseDown:l,className:o}=e;return(0,n.BX)(f.gq,{alignItems:"center",className:o,gap:4,children:[(0,n.tZ)(b.Z,{preset:"caption",style:{flexShrink:0,minWidth:"28px"},children:a}),(0,n.BX)("div",{ref:t,className:"progressBar-yUZk3A",onMouseDown:l,children:[(0,n.tZ)("div",{className:"progressBarBackground-rOIsbW"}),(0,n.tZ)("div",{className:"progressBarProgress-EiVcPg",style:{width:"".concat(100*i,"%")}}),(0,n.tZ)("div",{className:"progressBarPlayhead-KWfdzC",style:{left:"".concat(100*i,"%")}})]}),(0,n.tZ)(b.Z,{preset:"caption",style:{flexShrink:0,paddingLeft:"4px",minWidth:"36px"},children:r})]})},D=e=>{var{mediaUploadId:t,user:a,post:r,pub:d}=e,c=(0,m._)(e,["mediaUploadId","user","post","pub"]);let[p,h]=(0,s.eJ)(!0),[_,Z]=(0,s.eJ)(!1),C=!!(null==a?void 0:a.is_subscribed),k=!!(null==a?void 0:a.is_free_subscribed);return(0,s.d4)(()=>{_&&(0,w.j)(w.FP.TTS_UPGRADE_TO_LISTEN_CLICKED,{post_id:r.id})},[_,r.id]),(0,n.tZ)(N.Z,(0,o._)((0,l._)({},c),{feature:E.MR.Voiceover,metricsPost:r,post:r,pub:d,render:e=>{let{isPaywalled:t,currentTime:a,isPlaying:l,progress:o,progressBarRef:s,progressBarOnMouseDown:c,remainingTime:m,duration:w,togglePlayback:S}=e,E=()=>{if(t){Z(!0);return}p&&h(!1),S()},N=(0,n.BX)(f.gq,{alignItems:"center",className:i()("wrapper-LdgflB",{[A||""]:p}),gap:16,justifyContent:"space-between",children:[(0,n.BX)(f.gq,{alignItems:"center",className:i()("innerWrapper-ersGfZ",{[A||""]:p}),gap:16,onClick:p?E:void 0,children:[(0,n.tZ)(f.tu,{className:i()("playButton-vLW5qd",{[A||""]:p,"static-tP398S":t}),style:{flexShrink:0},onClick:()=>{E()},children:l?(0,n.tZ)(B,{}):(0,n.tZ)(I.Z,{})}),(0,n.tZ)(P,{className:i()("progressBarWrap-vpoiUw",{[A||""]:p}),containerRef:s,currentTime:a,progress:o,remainingTime:m,onMouseDown:c}),(0,n.BX)(f.gq,{alignItems:"center",className:i()("cta-GdLXe1",{[A||""]:p}),gap:16,children:[(0,n.tZ)(b.Z,{preset:"detail-small",children:t?"Upgrade to Listen":"Listen to Article"}),(0,n.tZ)(b.Z,{color:"tertiary",preset:"caption",style:{flexShrink:0},children:(0,T.secondsToLargestUnit)(w||300)})]})]}),(0,n.tZ)(b.Z,{className:i()("disclaimer-i3yYG0",{[A||""]:p}),color:"tertiary",preset:"caption",children:"Produced by ElevenLabs using AI narration"})]});return t?(0,n.tZ)(g,{closeOnOutsideClick:!0,content:(0,n.BX)(f.tu,{gap:4,position:"relative",children:[(0,n.tZ)(b.Z,{preset:"d4-serif",children:"Listening to articles, is a benefit we're proud to offer our paid subscribers. Sign up today to unlock this feature."}),!C&&(0,n.tZ)(f.gq,{children:(0,n.tZ)(u._,{href:(0,v.Zs0)(d,{UTM_SOURCE:y.b3.voiceoverPlayer,next:(0,v.uRy)(d,r)}),localNavigation:!1,size:"sm",trailingIcon:"chevron-right",variant:"tertiary",children:k?"Upgrade now":"Subscribe now"})})]}),isOpen:_,onClose:()=>{Z(!1)},children:N}):N},src:t?"/api/v1/audio/upload/".concat(t,"/src"):null,trackingProps:{}}))};var L=a(40647);let R={postUFI:"postUFI-Oh86n4",hasVoiceover:"hasVoiceover-rbvr3u",editButtonContainer:"editButtonContainer-hWwvUO"},F=e=>{var t;let{post:a,pub:r,user:l,autoPlayVoiceOver:o,variant:s}=e,{getConfigFor:d}=(0,L.xR)(),c=a.has_voiceover||!!a.voiceoverUpload,u="newsletter-post"===s&&(0,T.showCommentsOnPost)({publication:r,post:a}),m="newsletter-post"===s&&r.community_enabled,p="newsletter-post"===s,h=!!(null==l?void 0:l.is_contributor),g="newsletter-post"===s&&!!d("show_open_post_as_pdf_button");return u||m||p||h?(0,n.BX)(f.hs,{className:i()(R.postUFI,{[R.hasVoiceover||""]:c}),gap:24,justifyContent:"end",children:[c&&(0,n.tZ)(D,{autoPlay:o,duration:null===(t=a.voiceoverUpload)||void 0===t?void 0:t.duration,href:a.canonical_url,isPaywalled:!(null==l?void 0:l.is_subscribed),mediaUploadId:a.voiceover_upload_id,post:a,pub:r,user:l}),(0,n.BX)(f.gq,{alignItems:"center",gap:16,children:[u&&(0,n.tZ)(S.Ck,{post:a,pub:r,size:"large"}),m&&(0,n.tZ)(S.gV,{post:a,pub:r,size:"large",user:l}),p&&(0,n.tZ)(S.fA,{post:a,pub:r,user:l}),g&&(0,n.tZ)(k,{post:a,pub:r,user:l}),h&&(0,n.tZ)(S.ND,{className:R.editButtonContainer,context:"post-page",post:a,pub:r,user:l})]})]}):null}},89276:function(e,t,a){"use strict";a.d(t,{j:()=>d});var n=a(16584),r=a(94184),i=a.n(r),l=a(347),o=a(71068);let s={thefpPostBodyWrapper:"thefpPostBodyWrapper-Sk9SUV",noPaddingOnMobile:"noPaddingOnMobile-SkPaHP",withDropCap:"withDropCap-izNtyr",withSpaceForMissingDropCap:"withSpaceForMissingDropCap-MMwASG",threadHeadBody:"threadHeadBody-gHFj3E","full-width-image":"full-width-image-D14YHi",fullWidthImage:"full-width-image-D14YHi"},d=e=>{var t,a;let{children:r,disabled:d,inThreadHead:c,isCustomPage:u,isShowsPost:m,post:p}=e,h=!!(null==p?void 0:null===(t=p.postTheme)||void 0===t?void 0:t.disable_drop_cap);return d?(0,n.tZ)(n.HY,{children:r}):(0,n.tZ)(l.h,{children:(0,n.tZ)(o.xu,{className:i()(s.thefpPostBodyWrapper,s[null==p?void 0:null===(a=p.postTheme)||void 0===a?void 0:a.header_variant],{[s.withDropCap]:!(c||u||h),[s.withSpaceForMissingDropCap]:h,[s.threadHeadBody]:c,[s.noPaddingOnMobile]:m||c||u}),children:r})})}},35845:function(e,t,a){"use strict";a.d(t,{Ck:()=>S,ND:()=>N,gV:()=>k,fA:()=>E});var n=a(7409),r=a(99282),i=a(16584),l=a(30396),o=a(12297),s=a.n(o),d=a(85200),c=a(62372),u=a(98848),m=a(64515),p=a(24476);let h=e=>{var{isHovered:t}=e,a=(0,u._)(e,["isHovered"]);let l=t?p.t.brightOrange.hex:p.t.lightGray.hex;return(0,i.BX)(m.l,(0,r._)((0,n._)({},a),{name:"FPCommentIcon",svgParams:{width:24,height:24,viewBox:"0 0 24 24",stroke:"none",fill:"none"},children:[(0,i.tZ)("path",{d:"M22.1538 1V2.83333H24V15.6667H22.1538V17.5H16.6154V19.3333H14.7692V21.1667H12.9231V23H11.0769V21.1667H9.23077V19.3333H7.38462V17.5H1.84615V15.6667H0V2.83333H1.84615V1H22.1538Z",fill:l}),(0,i.tZ)("rect",{x:"5",y:"9",width:"2",height:"2",fill:"white"}),(0,i.tZ)("rect",{x:"11",y:"9",width:"2",height:"2",fill:"white"}),(0,i.tZ)("rect",{x:"17",y:"9",width:"2",height:"2",fill:"white"})]}))},g=e=>{var{isHovered:t,isLiked:a}=e,l=(0,u._)(e,["isHovered","isLiked"]);let o=a?p.t.mediumRed.hex:t?p.t.brightOrange.hex:p.t.lightGray.hex;return(0,i.BX)(m.l,(0,r._)((0,n._)({},l),{name:"FPLikeIcon",svgParams:{width:24,height:24,viewBox:"0 0 24 24",stroke:"none",fill:"none"},children:[(0,i.tZ)("path",{d:"M3.69231 1H9.23077V2.83333H11.0769V4.66667H12.9231V2.83333H14.7692V1H20.3077V2.83333H22.1538V4.66667H24V12H22.1538V13.8333H20.3077V15.6667H18.4615V17.5H16.6154V19.3333H14.7692V21.1667H12.9231V23H11.0769V21.1667H9.23077V19.3333H7.38462V17.5H5.53846V15.6667H3.69231V13.8333H1.84615V12H0V4.66667H1.84615V2.83333H3.69231V1Z",fill:o}),(0,i.tZ)("rect",{x:"5",y:"4",width:"2",height:"2",fill:"white"}),(0,i.tZ)("rect",{x:"3",y:"6",width:"2",height:"4",fill:"white"})]}))};var b=a(40034),f=a(48917),v=a(94442),y=a(67203),_=a(7523),w=a(19081),Z=a(63651),C=a(84864);let k=e=>{let{cta:t,post:a,pub:l,showCounts:o=!0,size:d,user:u,onChange:m}=e,[p,h]=(0,c.XI)(),b=s()(Object.values((null==a?void 0:a.reactions)||{})),f=(0,C.numberToString)(b||0),y="small"===d?16:24,Z="small"===d?"sm-preview-byline":"detail-large";return(0,i.tZ)(v.Hg,{isStatic:!1,post:a,pub:l,style:"button",user:u,onChange:m,children:e=>{let{isLiked:a,handleLike:l}=e;return(0,i.BX)(w.gq,(0,r._)((0,n._)({},h),{alignItems:"center",cursor:"pointer",gap:8,role:"button",onClick:l,children:[(0,i.BX)(w.gq,{alignItems:"center",gap:"small"===d?4:6,children:[(0,i.tZ)(g,{height:y,isHovered:p,isLiked:a,width:y}),o&&b>0&&(0,i.tZ)(_.Z,{preset:Z,children:f})]}),t&&(0,i.tZ)(_.Z,{preset:"detail-large",children:t})]}))}})},S=e=>{let t,{post:a,pub:l,showCounts:o=!0,size:s,cta:d}=e,[u,m]=(0,c.XI)(),p=(0,C.numberToString)(a.comment_count),g="small"===s?16:24;return t=(null==a?void 0:a.comment_url_override)?a.comment_url_override:(0,Z.uRy)(l,a,{comments:!0}),(0,i.BX)(w.gq,(0,r._)((0,n._)({},m),{alignItems:"center",cursor:"pointer",gap:8,role:"button",onClick:e=>{e.stopPropagation(),window.location.href=t},children:[(0,i.BX)(w.gq,{alignItems:"center",gap:"small"===s?4:6,children:[(0,i.tZ)(h,{height:g,isHovered:u,width:g}),a.comment_count>0&&o&&(0,i.tZ)(_.Z,{preset:"small"===s?"sm-preview-byline":"detail-large",children:p})]}),d&&(0,i.tZ)(_.Z,{preset:"detail-large",children:d})]}))},E=e=>{let{pub:t,post:a,user:l,cta:o}=e,[s,d]=(0,c.XI)();return(0,i.tZ)(y.sp,{post:a,pub:t,trigger:(0,i.BX)(w.hs,(0,r._)((0,n._)({},d),{alignItems:"center",cursor:"pointer",gap:8,children:[(0,i.tZ)(b.Z,{height:24,isHovered:s,width:24}),o&&(0,i.tZ)(_.Z,{preset:"detail-large",children:o})]})),user:l})},N=e=>{let{className:t,context:a,post:o,pub:s,user:u}=e,m=(0,l.sO)(),[h,g]=(0,c.XI)();if(!u)return null;let b=h?p.t.brightOrange.hex:p.t.lightGray.hex;return(0,i.BX)("div",{className:t,style:{cursor:"pointer"},children:[(0,i.tZ)(w.gq,(0,r._)((0,n._)({},g),{onClick:e=>{var t;e.stopPropagation(),null===(t=m.current)||void 0===t||t.open()},children:(0,i.tZ)(d.Z,{color:b,size:"post-preview"===a?16:24})})),(0,i.tZ)(f.y,{ref:m,hideDropCapOption:"post-preview"===a,hidePinning:!0,hidePostHeaderOptions:"post-preview"===a,post:o,pub:s,useDrawerOnMobile:!0,user:u})]})}},79160:function(e,t,a){"use strict";a.d(t,{r:()=>h});var n=a(16584),r=a(30396),i=a(95441),l=a(68833),o=a(15771),s=a(19081),d=a(6490),c=a(58175),u=a(4953),m=a(60308),p=a(47929);function h(e){let{postId:t,onClose:a}=e,{iString:u}=(0,i.M1)();return(0,r.d4)(()=>{(0,l.j)(l.FP.LISTEN_TO_THIS_POST_MODAL_SHOWN,{post_id:t})},[]),(0,n.BX)(d.u_,{isOpen:!0,onClose:a,children:[(0,n.tZ)(d.xB,{showClose:!0,onClose:a}),(0,n.tZ)(d.fe,{children:(0,n.BX)(s.tu,{alignItems:"center",gap:24,children:[(0,n.BX)(s.tu,{style:{textAlign:"center"},justifyContent:"center",gap:8,children:[(0,n.tZ)(c.xv.H3,{weight:"heavy",children:u("Listen to this post")}),(0,n.tZ)(c.xv,{color:"secondary",style:{lineHeight:1.5},children:u("Get the Substack app to hear this article read aloud.")})]}),(0,n.tZ)(g,{})]})}),(0,n.tZ)(d.mz,{showDivider:!0,direction:"column",primaryButton:(0,n.tZ)(o.zx,{priority:"primary",href:(0,m.D4e)({utm_source:p.b3.web,utm_campaign:p.VX.ttsModal}),onClick:()=>(0,l.j)(l.FP.LISTEN_TO_THIS_POST_MODAL_GET_THE_APP_CLICKED,{post_id:t}),children:u("Get the app")})})]})}function g(){let e="/img/main/tts-dialog";return(0,n.BX)("video",{height:220,autoPlay:!0,muted:!0,loop:!0,children:[(0,n.tZ)("source",{src:"".concat(e,"/nux.mp4"),type:"video/mp4"}),(0,n.tZ)("img",{width:374,height:233,src:"".concat(e,"/1x.png"),srcset:Array.from((0,u.w)(1,4)).map(t=>"".concat(e,"/").concat(t,"x.png ").concat(t,"x")).join(", ")})]})}},26989:function(e,t,a){"use strict";a.d(t,{Eo:()=>w});var n=a(16584),r=a(64515),i=a(666);a(91355);var l=a(7409),o=a(99282);let s=e=>(0,n.BX)(r.l,(0,o._)((0,l._)({},e),{name:"MoreIcon",svgParams:{height:24,width:24,fill:e.fill,stroke:e.stroke,strokeWidth:e.strokeWidth},children:[(0,n.tZ)("path",{d:"M12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12C11 12.5523 11.4477 13 12 13Z"}),(0,n.tZ)("path",{d:"M19 13C19.5523 13 20 12.5523 20 12C20 11.4477 19.5523 11 19 11C18.4477 11 18 11.4477 18 12C18 12.5523 18.4477 13 19 13Z"}),(0,n.tZ)("path",{d:"M5 13C5.55228 13 6 12.5523 6 12C6 11.4477 5.55228 11 5 11C4.44772 11 4 11.4477 4 12C4 12.5523 4.44772 13 5 13Z"})]}));var d=a(50137),c=a(1467);a(95441);var u=a(90099),m=a(92291),p=a(6246),h=a(71068),g=a(58175);a(71460),a(65749);var b=a(98012),f=a(31377),v=a(60308),y=a(63651),_=a(84864);function w(e){var t,a,r,l,o,p,f,w,x;let{comment:O,utmSource:M,hideUfi:B,commentLinkUrl:I}=e;if(!O)return(0,n.tZ)(g.xv.B3,{"data-component-name":"EmailCommentEmbedError",translated:!0,children:"Could not load comment"});let T=null===(t=O.attachments)||void 0===t?void 0:t.find(e=>"image"===e.type),A=null===(a=O.attachments)||void 0===a?void 0:a.find(e=>"post"===e.type),P=null==A?void 0:A.postSelection,D=null===(r=O.attachments)||void 0===r?void 0:r.find(e=>"image"!==e.type),L=D&&(0,m.kW)(D),R=null===(l=O.attachments)||void 0===l?void 0:l.find(e=>"video"===e.type);return(0,n.tZ)(h.xu,{as:"a",href:null!=I?I:(0,y.Sgq)(O,{urlParams:{utm_source:M}}),display:"block",padding:16,radius:"md",border:"detail",color:"primary",className:"note-flsrqQ","data-component-name":"EmailCommentEmbed",children:(0,n.BX)(u.zK,{style:{width:"100%"},verticalAlign:"top",gap:12,growLastChild:!0,children:[(0,n.tZ)(u.NS,{src:null!==(p=O.photo_url)&&void 0!==p?p:(0,v.I4e)(null!==(o=O.user_id)&&void 0!==o?o:0),size:48}),(0,n.BX)(u.i$,{gap:12,style:{lineHeight:1,width:"100%"},children:[(0,n.BX)(h.xu,{children:[(0,n.BX)(g.xv.B3,{children:[(0,n.tZ)(g.xv,{as:"span",weight:"semibold",children:O.name})," ",(0,n.tZ)(g.xv,{as:"span",color:"secondary",children:(0,b.Z)(O.date).fromNowShort()})]}),(0,n.tZ)(g.xv.B3,{children:(0,_.truncateWords)(O.body,420)})]}),A&&P&&(0,n.tZ)(g.xv.B3,{children:(0,n.tZ)(S,{attachment:A,selection:P})}),L&&!A&&(0,n.tZ)(g.xv.B4,{color:"accent-cyan",children:L}),R&&(0,n.tZ)(N,{attachment:R}),T&&(0,n.tZ)(E,{attachment:T}),!B&&(0,n.tZ)(u.YF,{width:"100%",style:{width:"100%"},children:(0,n.BX)("tr",{children:[(0,n.BX)("td",{width:"20%",children:[(0,n.tZ)(i.Z,{width:16,height:16,strokeWidth:1.5,stroke:k,style:Z,fill:"none",isStatic:!0}),(0,n.tZ)(C,{count:null!==(f=O.reaction_count)&&void 0!==f?f:0})]}),(0,n.BX)("td",{width:"20%",children:[(0,n.tZ)(c.Z,{height:16,width:16,strokeWidth:1.5,stroke:k,style:Z,isStatic:!0}),(0,n.tZ)(C,{count:null!==(w=O.children_count)&&void 0!==w?w:0})]}),(0,n.BX)("td",{width:"20%",children:[(0,n.tZ)(d.Z,{height:16,width:16,strokeWidth:1.5,stroke:k,style:Z,isStatic:!0}),(0,n.tZ)(C,{count:null!==(x=O.restacks)&&void 0!==x?x:0})]}),(0,n.tZ)("td",{width:"20%",children:(0,n.tZ)(s,{height:16,width:16,strokeWidth:2,stroke:k,fill:k,style:Z,isStatic:!0})})]})})]})]})})}let Z={display:"inline-block",verticalAlign:"middle"};function C(e){let{count:t}=e;return(0,n.tZ)(g.xv.B4,{size:12,as:"span",weight:"semibold",color:"secondary",style:{marginLeft:4},children:t>0?(0,p.u)(t):" "})}let k="#808080";function S(e){let{attachment:t,selection:a}=e;return(0,n.tZ)(h.xu,{padding:12,radius:"md",bg:"secondary",children:(0,n.BX)(g.xv,{color:"secondary",font:"serif",fontStyle:"italic",lineHeight:24,children:[(0,_.truncateWords)(a.text.replaceAll("“","‘").replaceAll("”","’"),180),"” — ",(0,f.getPostAuthor)(t.publication,t.post).name]})})}function E(e){let{attachment:t}=e;return(0,n.tZ)(h.xu,{as:"img",src:(0,y.zF4)(t.imageUrl,800,{crop:"limit",height:800}),width:400,radius:"md",style:{maxHeight:600,objectFit:"cover",margin:0}})}function N(e){let{attachment:t}=e,a=t.mediaUpload;return(0,n.tZ)(h.xu,{as:"img",src:(0,v.kOB)(a,{isStatic:!0}),width:400,radius:"md",style:{maxHeight:600,objectFit:"cover",margin:0}})}},25530:function(e,t,a){"use strict";a.d(t,{v:()=>r});var n=a(1852);let r=()=>({isPrint:(0,n.useMediaQuery)({query:"print"})})},29927:function(e,t,a){"use strict";a.d(t,{X:()=>f});var n=a(16584),r=a(30396),i=a(83034),l=a(20888),o=a(68833),s=a(98422),d=a(95901),c=a(61254),u=a(19081),m=a(6490),p=a(58175),h=a(60308),g=a(47929);let b="appStoreBadgeButton-PoDbV8",f=e=>{let{onClose:t}=e,{isMobile:a}=(0,s.v9)();return(0,r.d4)(()=>{(0,o.j)(o.FP.SAVE_VIDEO_UPSELL_MODAL_SEEN)},[]),(0,n.tZ)(m.u_,{disableCloseOnBackdropClick:!0,isOpen:!0,width:a?void 0:850,onClose:t,children:(0,n.BX)(u.gq,{position:"relative",padding:20,gap:32,justifyContent:a?"center":void 0,children:[(0,n.tZ)(u.gq,{position:"absolute",style:{top:8,right:8},children:(0,n.tZ)(d.P,{priority:"secondary",size:"sm",onClick:t})}),!a&&(0,n.tZ)("div",{children:(0,n.tZ)(l.e,{src:(0,h.zF4)("/img/marketing/save-video-upsell.png",762),maxWidth:381,useRetinaSizing:!0,imageIsFixedWidth:!0})}),(0,n.BX)(u.tu,{justifyContent:"center",gap:20,children:[(0,n.BX)(u.tu,{gap:8,children:[(0,n.tZ)(p.xv.H3,{align:"center",translated:!0,paddingBottom:8,children:"Video saved to your app"}),(0,n.tZ)(p.xv.B3,{align:"center",translated:!0,children:"Download now on iOS or Android to see all saved videos."})]}),(0,n.tZ)(i.AppInstallContent,{hideEmailPrompt:!0,size:160,padding:0}),(0,n.tZ)(c.ZC,{}),(0,n.BX)(u.gq,{gap:16,justifyContent:"center",paddingTop:8,children:[(0,n.tZ)("a",{className:b,href:(0,h.RMm)({utm_campaign:g.VX.saveVideoUpsellModal,utm_source:g.b3.post}),onClick:()=>{(0,o.j)(o.FP.APP_STORE_LINK_CLICKED,{source:"save_video_upsell_modal",app_store:"ios"})},children:(0,n.tZ)("img",{src:(0,h.zF4)("/img/app_page/app-store.png",320),height:40})}),(0,n.tZ)("a",{className:b,href:(0,h.AaB)({utm_campaign:g.VX.saveVideoUpsellModal,utm_source:g.b3.post}),onClick:()=>{(0,o.j)(o.FP.APP_STORE_LINK_CLICKED,{source:"save_video_upsell_modal",app_store:"android"})},children:(0,n.tZ)("img",{src:(0,h.zF4)("/img/app_page/google-play.png",320),height:40})})]})]})]})})}},55706:function(e,t,a){"use strict";a.d(t,{R:()=>p,W:()=>m});var n=a(16584),r=a(95441),i=a(90099),l=a(98914),o=a(94874),s=a(15771),d=a(19081),c=a(58175),u=a(54991);let m=e=>{let{avatarUrl:t,name:a,url:l}=e,{iString:o}=(0,r.M1)();return(0,n.BX)(i.i$,{gap:12,style:{padding:"16px",border:"1px solid #E0E0E0",borderRadius:"8px",margin:"0 auto 20px"},children:[(0,n.BX)(i.zK,{gap:12,children:[(0,n.tZ)(i.NS,{src:t,size:40}),(0,n.BX)(i.i$,{children:[(0,n.BX)(c.xv.H4,{translated:!0,size:14,paddingBottom:4,color:"pub-primary-text",children:["Book a meeting with ",I18N.p(a)]}),(0,n.tZ)(c.xv.B4,{translated:!0,color:"pub-secondary-text",children:"Schedule a meeting"})]})]}),(0,n.tZ)(i.Bj,{tableClassName:u.Z.emailButton,href:l,children:o("Book meeting")})]})},p=e=>{let{avatarUrl:t,name:a,url:i}=e,{iString:m}=(0,r.M1)();return(0,n.BX)(d.hs,{direction:{mobile:"column",desktop:"row"},radius:"md",padding:24,alignItems:"center",className:u.Z.container,justifyContent:"space-between","data-component-name":"MeetingEmbed",children:[(0,n.BX)(d.gq,{className:u.Z.header,gap:16,paddingBottom:{mobile:20,desktop:0},children:[(0,n.tZ)(o.qE,{photoUrl:t,size:40}),(0,n.BX)("div",{children:[(0,n.BX)(c.xv.H4,{translated:!0,paddingBottom:4,color:"pub-primary-text",children:["Book a meeting with ",I18N.p(a)]}),(0,n.tZ)(c.xv.B4,{translated:!0,color:"pub-secondary-text",children:"Schedule a meeting"})]})]}),(0,n.tZ)(s.zx,{className:u.Z.cta,priority:"primary",onClick:()=>{(0,l.uX)(i,{newTab:!0})},children:m("Book meeting")})]})}},23776:function(e,t,a){"use strict";a.d(t,{Z:()=>u});var n=a(16584),r=a(30396),i=a(18787),l=a(72508),o=a(95441),s=a(68833),d=a(24791),c=a(84864);let u=e=>{let{post:t,pub:a,user:u,playerRef:m}=e,p=!(0,c.canSeeTranscription)(u,t),h=(0,d.LH)(t),{iString:g}=(0,o.M1)();return((0,r.d4)(()=>{(0,s.j)(s.FP.TRANSCRIPTION_PAGE_VIEWED,{post_id:t.id})},[t.id]),h)?p?(0,n.tZ)(i.f1,{user:u,publication:a,post:t,title:g("Transcriptions on this post are for paid subscribers"),reauthenticationTitle:g("To see the post, please re-authenticate.")}):(0,n.tZ)(l.ZP,{transcription:h,player:m,postId:t.id}):null}},83963:function(e,t,a){"use strict";a.d(t,{B:()=>b});var n=a(16584),r=a(30396),i=a(13639),l=a(95441),o=a(68833),s=a(71068),d=a(15771),c=a(19081),u=a(6490),m=a(58175),p=a(63651);let h=e=>e?e.includes("free_subscribers")?"free_subscribers":e.includes("paid_subscribers")?"paid_subscribers":e.includes("founding_subscribers")?"founding_subscribers":null:null,g=e=>{switch(e){case"free_subscribers":return"Subscribers";case"paid_subscribers":return"Paid subscribers";case"founding_subscribers":return"Founding members"}},b=e=>{let{isOpen:t,onClose:a,profile:b,dmUpgradeOptions:f,isEditor:v=!1}=e,{iString:y}=(0,l.M1)();(0,r.d4)(()=>{(0,o.j)(o.FP.DIRECT_MESSAGE_WRITER_UPSELL_MODAL_SEEN,{subscribeButtonShown:C})},[]);let _=null==b?void 0:b.primaryPublication,w=h(f),Z=w?g(w):null,C=Z&&(v||!v&&_),k="founding_subscribers"===w?{plan:"founding",utm_source:"direct-message-writer"}:void 0,S=!v&&_?(0,p.W1P)(_,{addBase:!v,params:k}):(0,p.W1P)({},{addBase:!1,params:k}),E=(0,s.oB)({width:200});return(0,n.tZ)(u.u_,{isOpen:t,onClose:a,children:(0,n.tZ)(u.fe,{children:(0,n.BX)(c.tu,{gap:16,alignItems:"center",children:[(0,n.tZ)(s.xu,{bg:"secondary",radius:"full",padding:16,children:(0,n.tZ)(i.Z,{size:32})}),(0,n.BX)(c.tu,{gap:8,alignItems:"center",padding:8,children:[!!Z&&(0,n.BX)(m.xv.B1,{children:[Z," only"]}),!!Z&&(0,n.tZ)(m.xv.B3,{color:"secondary",align:"center",children:y("".concat(null==b?void 0:b.name," only accepts messages from ").concat(null==Z?void 0:Z.toLowerCase()))}),!Z&&(0,n.tZ)(m.xv.B3,{color:"secondary",align:"center",children:y("".concat(null==b?void 0:b.name," is not currently accepting message invites"))})]}),(0,n.BX)(c.tu,{gap:8,alignItems:"center",padding:8,children:[C&&(0,n.BX)(n.HY,{children:[(0,n.tZ)(d.zx,{className:E,priority:"primary",href:S,newTab:!0,children:y((null==b?void 0:b.isSubscribed)?"Upgrade":"Subscribe")}),(0,n.tZ)(d.zx,{className:E,onClick:()=>{(0,o.j)(o.FP.DIRECT_MESSAGE_WRITER_UPSELL_MODAL_MAYBE_LATER_CLICKED),a()},priority:"secondary",children:y("Maybe later")})]}),!C&&(0,n.tZ)(d.zx,{className:E,onClick:()=>{(0,o.j)(o.FP.DIRECT_MESSAGE_WRITER_UPSELL_MODAL_OKAY_CLICKED),a()},priority:"secondary",children:y("Okay")})]})]})})})}},65749:function(e){e.exports=function(e){if(!e)return 0;let t=(e=e.replace(/<(.|\n)*?>/g," ")).match(/[a-zA-ZÀ-ÿ0-9_\u0392-\u03c9\u0410-\u04F9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g)||e.match(/([\u0600-\u06ff]+|[\u0591-\u05F4]+)/g);if(null===t)return 0;let a=0;for(let e=0;e<t.length;e+=1){let n=t[e];n&&(n.charCodeAt(0)>=19968?a+=n.length:a+=1)}return a}},5835:function(e,t,a){"use strict";a.d(t,{$y:()=>d,hE:()=>m,ph:()=>g,uF:()=>p});var n=a(7409),r=a(80569),i=a.n(r),l=a(84864),o=a(15233),s=a(30548);let d={attrs:{url:{default:""},isEpisode:{default:!1},imageUrl:{default:""},title:{default:""},podcastTitle:{default:""},podcastByline:{default:""},duration:{default:""},numEpisodes:{default:""},targetUrl:{default:""},releaseDate:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"iframe.apple-podcast",getAttrs:a(30837).Y}],toDOM:e=>{let{url:t,isEpisode:a}=e.attrs;return["div",{class:"apple-podcast-container","data-component-name":"ApplePodcastToDom"},["iframe",{class:"apple-podcast ".concat(a?"":"episode-list"),"data-attrs":JSON.stringify(e.attrs),src:t,frameborder:"0",allow:"autoplay *; encrypted-media *;",allowfullscreen:"true"}]]},toDOMStatic:e=>{let{imageUrl:t,isEpisode:a,podcastTitle:n,podcastByline:r,duration:i,numEpisodes:s,targetUrl:d}=e.attrs,c=e.attrs.title,u=n,m=(0,l.secondsToHHMMSS)(i/1e3);return a||(c=n,u=r,m=(0,l.pluralize)(s,"episode",{zero_fallback:"No episodes"})),(0,o.L)(t,c,u,m,{targetUrl:d})}},c=/[<iframe]?.*[src="]?(https?:\/\/(embed\.)?podcasts\.apple\.com\/([^/]+)?\/?podcast\/([^/]+)\/?(id\d+)\??(i=(\d+))?)[\S]*/,u=e=>{var t;let a=c.exec(e);return a?{match:a[0],embedLink:a[2],countryCode:a[3],slug:a[4],podcastId:null===(t=a[5])||void 0===t?void 0:t.substr(2),episodeId:a[7]}:{match:!1}},m=(0,s.S)({name:"applePodcast",nodeSpec:d,addCommands(){return{insertApplePodcast:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),p=function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t&&!t.nodes.applePodcast?null:u(e).match||null},h=async e=>{let t=u(e),{slug:a,podcastId:r,episodeId:l,countryCode:o}=t,s=(await i().get("/api/v1/apple_podcast").query({slug:a,podcastId:r,episodeId:l,country:o})).body;return(0,n._)({url:b(t),isEpisode:!!t.episodeId},s)},g=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.applePodcast.create(await h(e))},b=e=>{let{countryCode:t,slug:a,podcastId:n,episodeId:r}=e,i=encodeURIComponent(a||"");return"https://embed.podcasts.apple.com/".concat(t||"us","/podcast/").concat(i,"/id").concat(n).concat(r?"?i=".concat(r):"")}},26603:function(e,t,a){"use strict";a.d(t,{$:()=>p,a:()=>h});var n=a(7409),r=a(6400),i=a(55679),l=a(52244),o=a(10656),s=a(84864),d=a(19520),c=a(30548),u=a(30837);let m="image-asset-error",p={attrs:{url:{default:""}},group:"block",defining:!0,parseDOM:[{tag:"div.".concat(m),getAttrs:u.Y}],toDOM:e=>{if("undefined"!=typeof window)try{e.attrs.isEditor=!0;let t=document.createElement("div");return t.className=m,t.setAttribute("data-attrs",JSON.stringify(e.attrs)),(0,o.G5)((0,r.h)(l.v,{node:(0,n._)({},e)}),t),t}catch(t){return console.error("Error rendering ImageAssetError",t),(0,d.s)({msg:null,node:e,err:t,group:"block"})}return["div",{"data-attrs":JSON.stringify((0,n._)({},e.attrs)),"data-component-name":"AssetErrorToDOM"},["picture",["img",{src:s.MISSING_IMAGE_URL,height:s.MISSING_IMAGE_HEIGHT,width:s.MISSING_IMAGE_WIDTH}]]]},toDOMStatic:e=>["div",{"data-attrs":JSON.stringify((0,n._)({},e.attrs)),"data-component-name":"AssetErrorToDOMStatic"}]},h=(0,c.S)({name:"assetError",nodeSpec:p,addNodeView:()=>(0,i.fW)(l.v)})},57937:function(e,t,a){"use strict";a.d(t,{$y:()=>m,DW:()=>p});var n=a(7409),r=a(99282),i=a(6400),l=a(55679),o=a(16564),s=a(74204),d=a(10656),c=a(19520),u=a(30548);let m={attrs:{label:{default:null},mediaUploadId:{default:null},duration:{default:null},isEditorNode:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.native-audio-embed",getAttrs:a(30837).Y}],toDOM:e=>{if("undefined"!=typeof window&&e.attrs.isEditorNode)try{let t=document.createElement("div");return t.className="native-audio-embed",t.setAttribute("data-attrs",JSON.stringify(e.attrs)),(0,d.G5)((0,i.h)(o.cM,{label:e.attrs.label,src:"/api/v1/audio/upload/".concat(e.attrs.mediaUploadId,"/src"),duration:e.attrs.duration}),t),t}catch(t){return console.error("Error rendering AudioEmbedPlayer",t),(0,c.s)({msg:null,node:e,err:t,group:"block"})}return h(e)},toDOMStatic:e=>h(e)},p=(0,u.S)({name:"audio",nodeSpec:m,addNodeView:()=>(0,l.fW)(s.$),addCommands(){return{insertAudio:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:(0,r._)((0,n._)({},e),{isEditorNode:!0})})}}}}),h=e=>["div",{class:"native-audio-embed","data-component-name":"AudioPlaceholder","data-attrs":JSON.stringify(e.attrs)}]},55633:function(e,t,a){"use strict";a.d(t,{$y:()=>r,E4:()=>i});var n=a(30548);let r={attrs:{label:{default:null},url:{default:null},duration:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.native-audio-url-embed",getAttrs:a(30837).Y}],toDOM:e=>["div",{class:"native-audio-url-embed","data-attrs":JSON.stringify(e.attrs),"data-component-name":"AudioUrlPlaceholder"}]},i=(0,n.S)({name:"audioUrl",nodeSpec:r})},1451:function(e,t,a){"use strict";a.d(t,{$:()=>i,h:()=>l});var n=a(84864),r=a(30548);let i={attrs:{request_id:{default:null},url:{default:null},src:{default:null},type:{default:null}},untrackedAttrs:["src"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"a.augmentation-placeholder",getAttrs:a(30837).Y}],toDOM:e=>["a",{class:"augmentation-placeholder image-link","data-attrs":JSON.stringify(e.attrs),href:"javascript:void(0)","data-component-name":"AugmentationPlaceholderToDOM"},["img",{src:e.attrs.src||n.TRANSPARENT_IMAGE_URL}]]},l=(0,r.S)({name:"augmentation_placeholder",nodeSpec:i,addCommands(){return{insertLoadingPlaceholder:(e,t)=>a=>{let{commands:n}=a;return t?n.insertContentAt(t,{type:this.name,attrs:e}):n.insertContent({type:this.name,attrs:e})}}}})},44262:function(e,t,a){"use strict";a.d(t,{$y:()=>s,XC:()=>u,bo:()=>h,hV:()=>d});var n=a(7409),r=a(99282),i=a(69332),l=a(15233),o=a(30548);let s={attrs:{url:{default:""},title:{default:""},description:{default:""},thumbnail_url:{default:""},author:{default:""},embed_url:{default:""},is_album:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.bandcamp-wrap",getAttrs:a(30837).Y}],toDOM:e=>["div",{class:"bandcamp-wrap".concat(e.attrs.is_album?" album":""),"data-attrs":JSON.stringify(e.attrs),"data-component-name":"BandcampToDOM"},["iframe",{src:e.attrs.embed_url,frameborder:"0",gesture:"media",scrolling:"no",allowfullscreen:"true"}]],toDOMStatic:e=>{let{thumbnail_url:t,author:a,title:n,description:r,url:i}=e.attrs;return(0,l.L)(t,n,(a||"").toString(),r,{targetUrl:i})}},d=(0,o.S)({name:"bandcamp",nodeSpec:s,addCommands(){return{insertBandcamp:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),c=/^.*(https?\:\/\/(\S+)?.bandcamp.com\/(...+)\/[^\/]+(\/[^\/]+)?(\?[\#]*)?(\#.*)?).*$/,u=e=>{var t;let a=c.exec(e);return null!==(t=a&&a[1])&&void 0!==t?t:null},m=e=>{let t=c.exec(e);return!!t&&"album"===t[3]},p=async e=>{let t=m(e),l=(await Promise.resolve().then(a.t.bind(a,80569,23))).default,o="dark"===(0,i.m)(e).theme?"dark":"light",s=(await l.get("/api/v1/bandcamp").query({url:e.trim(),is_album:t,theme:o})).body;return(0,r._)((0,n._)({},s),{is_album:t})},h=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.bandcamp.create(await p(e))}},41676:function(e,t,a){"use strict";a.d(t,{$:()=>i,M:()=>l});var n=a(88897),r=a(19512);let i={content:"block+",group:"block",parseDOM:[{tag:"blockquote"},{tag:"p",priority:100,getAttrs:e=>!(!e.style.marginLeft||e.style.marginLeft.startsWith("0"))&&{}}],toDOM:()=>["blockquote",0]},l=r.ZP.extend({parseHTML:()=>i.parseDOM,addCommands(){return{setBlockquote:()=>e=>{let{state:t,commands:a}=e;return!(!(0,n.Ig)(t,"paragraph")||(0,n.Ig)(t,"pullquote"))&&a.wrapIn(this.name)},toggleBlockquote:()=>e=>{let{state:t,commands:a}=e;return!(!(0,n.Ig)(t,"paragraph")||(0,n.Ig)(t,"pullquote"))&&a.toggleWrap(this.name)},unsetBlockquote:()=>e=>{let{commands:t}=e;return t.lift(this.name)}}}})},82032:function(e,t,a){"use strict";a.d(t,{$y:()=>c,IS:()=>g,X2:()=>u,q7:()=>p});var n=a(39693),r=a.n(n),i=a(48980),l=a(98012),o=a(30548),s=a(30837),d=a(35934);let c={attrs:{postId:{default:""},authorDid:{default:""},authorName:{default:""},authorHandle:{default:""},authorAvatarUrl:{default:""},text:{default:""},createdAt:{default:""},uri:{default:""},imageUrls:{default:[]}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.bluesky-wrap",getAttrs:s.Y}],toDOM:e=>(function(e){var t,a,n;let r=String(Math.random()).slice(2),i=(t=e.attrs.authorDid,a=e.attrs.postId,n=r,"https://embed.bsky.app/embed/".concat(t,"/app.bsky.feed.post/").concat(a,"?id=").concat(n)),l=document.createElement("div");l.className="bluesky-wrap outer",l.style.height="auto",l.style.display="flex",l.style.marginBottom="24px",l.dataset.attrs=JSON.stringify(e.attrs),l.setAttribute("data-component-name","BlueskyCreateBlueskyEmbed");let o=document.createElement("iframe");return o.id=b(e.attrs.postId),o.setAttribute("data-bluesky-id",r),o.src=i,o.width="100%",o.style.border="none",o.style.display="block",o.style.flexGrow="1",o.frameBorder="0",o.scrolling="no",l.appendChild(o),l})(e),toDOMStatic:e=>(function(e){var t,a,n;let r=e.attrs,i=document.createElement("div");i.className="bluesky-wrap static",i.setAttribute("data-component-name","BlueskyCreateStaticBlueskyEmbed");let o=document.createElement("div"),s=document.createElement("img");s.className="bluesky-avatar",r.authorAvatarUrl&&(s.src=r.authorAvatarUrl),o.appendChild(s);let d=document.createElement("span");d.className="bluesky-author-name",d.textContent="".concat(null!==(t=r.authorName)&&void 0!==t?t:r.authorHandle," "),o.appendChild(d);let c=document.createElement("span");c.className="bluesky-author-handle",c.textContent="@".concat(r.authorHandle),o.appendChild(c),i.appendChild(o);let u=document.createElement("div");if(u.textContent=r.text,i.appendChild(u),r.imageUrls.length>0&&r.imageUrls[0]){let e=document.createElement("img");e.src=r.imageUrls[0],i.append(e)}let m=document.createElement("div");m.className="bluesky-created-at",m.textContent=(0,l.Z)(r.createdAt).toString(),i.appendChild(m);let p=document.createElement("a");return p.href=(a=r.authorDid,n=r.postId,"https://bsky.app/profile/".concat(a,"/post/").concat(n,"?ref_src=embed")),p.text="View on Bluesky",i.appendChild(p),i})(e)},u=(0,o.S)({name:"bluesky",nodeSpec:c,addCommands(){return{insertBluesky:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),m=/^https:\/\/bsky.app\/profile\/([^\/]+)\/post\/([^\?]+)(\?.+)?$/;function p(e){let t=m.exec(e);return m.lastIndex=0,t&&t[0]}async function h(e){var t,a,n,o,s,d,c,u,p,h,g,b,f,v;let y=function(e){let t=m.exec(e);return t&&t[1]&&t[2]?{handle:t[1],postId:t[2]}:null}(e);if(!y)return null;let{handle:_,postId:w}=y,Z=await (0,i.rd)((f=_,v=w,"https://public.api.bsky.app/xrpc/app.bsky.feed.getPostThread?uri=at://".concat(f,"/app.bsky.feed.post/").concat(v)));if("blocked"in Z.thread||"notFound"in Z.thread)return null;let C=null;return(null===(a=Z.thread)||void 0===a?void 0:null===(t=a.post)||void 0===t?void 0:t.embed)&&((null===(n=Z.thread.post.embed)||void 0===n?void 0:n.thumbnail)?C=null===(s=Z.thread.post.embed)||void 0===s?void 0:s.thumbnail:(null!==(o=Z.thread.post.embed.images)&&void 0!==o?o:[]).length>0&&(C=Z.thread.post.embed.images[0].thumb)),{postId:w,authorDid:null!==(d=Z.thread.post.author.did)&&void 0!==d?d:"",authorName:null!==(c=Z.thread.post.author.displayName)&&void 0!==c?c:"",authorHandle:null!==(u=Z.thread.post.author.handle)&&void 0!==u?u:"",authorAvatarUrl:null!==(p=Z.thread.post.author.avatar)&&void 0!==p?p:"",text:null!==(h=Z.thread.post.record.text)&&void 0!==h?h:"",createdAt:(0,l.Z)(null!==(g=Z.thread.post.record.createdAt)&&void 0!==g?g:"").toISOString(),uri:null!==(b=Z.thread.post.uri)&&void 0!==b?b:"",imageUrls:r()([C])}}async function g(e){var t;let{customSchema:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(n?{schema:n}:await Promise.resolve().then(a.bind(a,37175))).schema;if(!(null===(t=r.nodes.bluesky)||void 0===t?void 0:t.create))throw new d.gz("Bluesky node schema is missing");return r.nodes.bluesky.create(await h(e))}let b=e=>"bluesky-".concat(e)},95068:function(e,t,a){"use strict";a.d(t,{$y:()=>C,H9:()=>k,ax:()=>S});var n=a(7409),r=a(99282),i=a(58865),l=a(60826),o=a(68833),s=a(98914),d=a(60308),c=a(63651),u=a(84864),m=a(47929),p=a(39947),h=a(30548);function g(){let e=(0,i._)(["Thanks for reading ","! Subscribe for free to receive new posts and support my work."]);return g=function(){return e},e}function b(){let e=(0,i._)([""," is a reader-supported publication. To receive new posts and support my work, consider becoming a free or paid subscriber."]);return b=function(){return e},e}function f(){let e=(0,i._)(["","! This post is public so feel free to share it."]);return f=function(){return e},e}function v(){let e=(0,i._)(["Share ",""]);return v=function(){return e},e}function y(){let e=(0,i._)(["Give a gift subscription"]);return y=function(){return e},e}function _(){let e=(0,i._)(["Get ","% off a group subscription"]);return _=function(){return e},e}function w(){let e=(0,i._)(["Get a group subscription"]);return w=function(){return e},e}function Z(){let e=(0,i._)(["Start writing today. Use the button below to create a Substack of your own."]);return Z=function(){return e},e}let C={attrs:{url:{default:null},text:{default:null},action:{default:null},class:{default:null}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"p.button-wrapper[data-attrs]",priority:100,getAttrs:a(30837).Y}],toDOM:e=>S(e)},k=(0,h.S)({name:"button",nodeSpec:C,addCommands(){var e=this;return{insertSubscribeButton:e=>t=>{let{commands:a}=t,n={url:l.W.CHECKOUT_URL,text:(0,u.getSubscribeText)(e,{now:!0})};return a.insertContent({type:this.name,attrs:n})},insertCustomButtonEditorV2:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})},insertSubscribeButtonWithPreamble:e=>t=>{let{commands:a,editor:n}=t,{iTemplate:r,iString:i}=I18N.i({pub:e}),o=e.author_name===e.name?i("enabled"!==e.payments_state?"Thanks for reading! Subscribe for free to receive new posts and support my work.":"This Substack is reader-supported. To receive new posts and support my work, consider becoming a free or paid subscriber."):r("enabled"!==e.payments_state?g():b(),e.name),s={url:l.W.CHECKOUT_URL,text:(0,u.getSubscribeText)(e),language:e.language};return a.insertContent({type:"subscribeWidget",attrs:s,content:[n.schema.nodes.ctaCaption.create(null,[n.schema.text(o)]).toJSON()]})},insertCaptionedShareButton:e=>t=>{let{commands:a,editor:n}=t,{iString:r,iTemplate:i}=I18N.i({pub:e}),o=i(f(),e.author_name===e.name?"Thanks for reading":"Thanks for reading ".concat(e.name)),s={url:l.W.SHARE_URL,text:r("Share")};return a.insertContent({type:"captionedShareButton",attrs:s,content:[n.state.schema.nodes.ctaCaption.create(null,[n.state.schema.text(o)]).toJSON()]})},insertSharePostButton:e=>t=>{let{commands:a}=t,{iString:n}=I18N.i({pub:e}),r={url:l.W.SHARE_URL,text:n("Share")};return a.insertContent({type:this.name,attrs:r})},insertSharePubButton:e=>t=>{let{commands:a}=t,{iTemplate:n}=I18N.i({pub:e}),r={url:l.W.SHARE_PUB_URL,text:n(v(),e.name)};return a.insertContent({type:this.name,attrs:r})},insertCommentsButton:e=>t=>{let{commands:a}=t,{iString:n}=I18N.i({pub:e}),r={url:l.W.HALF_MAGIC_COMMENTS_URL,text:n("Leave a comment")};return a.insertContent({type:this.name,attrs:r})},insertGiftButton:e=>t=>{let{commands:a}=t,{iTemplate:n}=I18N.i({pub:e}),r={url:"".concat(l.W.CHECKOUT_URL,"&gift=true"),text:(0,u.getSubscriptionSentenceWithCustomWords)(e,()=>n(y()),e=>"Give a gift ".concat(e.subscription))};return a.insertContent({type:this.name,attrs:r})},insertDonateButton:e=>t=>{let{commands:a}=t,{iString:n}=I18N.i({pub:e}),r={url:"".concat(l.W.CHECKOUT_URL,"&donate=true"),text:n("Donate Subscriptions")};return a.insertContent({type:this.name,attrs:r})},insertSurveyButton:(e,t,a)=>n=>{let{commands:r}=n;(0,o.j)(o.FP.READER_SURVEY_LINKED_IN_POST,{editorVersion:"2",surveyId:t.id});let i={url:"".concat((0,c.h8g)(e,t.id)),text:a};return r.insertContent({type:this.name,attrs:i})},insertGroupSubscriptionButton:e=>{let{publication:t}=e;return e=>{let{commands:a}=e,{iTemplate:n}=I18N.i({pub:t}),r=t.default_group_coupon,i={url:"".concat(l.W.CHECKOUT_URL,"group=true").concat(r?"&coupon=".concat(r):""),text:(0,u.getSubscriptionSentenceWithCustomWords)(t,()=>r&&t.default_group_coupon_percent_off?n(_(),t.default_group_coupon_percent_off.split(".")[0]):n(w()),e=>r&&t.default_group_coupon_percent_off?"Get ".concat(t.default_group_coupon_percent_off.split(".")[0],"% off a group ").concat(e.subscription):"Get a group ".concat(e.subscription))};return a.insertContent({type:this.name,attrs:i})}},insertCoupon:function(t,a){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l=>{let{commands:o}=l,c={url:(0,d.n1t)("".concat(t.base_url,"/subscribe"),(0,r._)((0,n._)({coupon:a.id},a.group_only&&{group:!0}),{utm_content:i.postId})),text:"Get ".concat((0,s.ig)(a))};return o.insertContent({type:e.name,attrs:c})}},insertReferralButton:e=>t=>{let{commands:a}=t,{iString:n}=I18N.i({pub:e}),r={url:"".concat(l.W.LEADERBOARD_URL,"&utm_source=").concat(m.b3.post),text:n("Refer a friend")};return a.insertContent({type:this.name,attrs:r})},insertCaptionedWriterReferralButtonV2:e=>{let{writerReferralCode:t,publication:a,postId:n}=e;return e=>{let{commands:r,state:i,dispatch:l}=e;if(!(0,p.o)(i,i.schema.nodes.button))return!1;let{iString:o,iTemplate:s}=I18N.i({pub:a}),c=s(Z()),u={url:"".concat((0,d.Fnz)(t||""),"?utm_source=").concat(m.b3.substack,"&utm_context=").concat(m.gD.post,"&utm_content=").concat(n,"&utm_campaign=").concat(m.VX.writerReferralButton),text:o("Start a Substack")},h=i.schema.nodes.captionedWriterReferralButton.create(u,i.schema.nodes.ctaCaption.create(null,[i.schema.text(c)]));return!l||r.insertContent(h.toJSON())}}}}}),S=e=>{let t=document.createElement("span");t.textContent=e.attrs.text;let a=document.createElement("a");a.className="button primary",e.attrs.class&&(a.className+=" ".concat(e.attrs.class)),a.href=e.attrs.url,a.appendChild(t),a.addEventListener("click",e=>{/^.*%%.*%%/.test(a.href)&&(e.preventDefault(),(0,u.handleDocumentLinkClick)(a.href))});let n=document.createElement("p");return n.className="button-wrapper",n.setAttribute("data-attrs",JSON.stringify(e.attrs)),n.setAttribute("data-component-name","ButtonCreateButton"),n.appendChild(a),n}},12568:function(e,t,a){"use strict";a.d(t,{$:()=>r,_:()=>i});var n=a(30548);let r={content:"text*",group:"block",selectable:!0,defining:!0,isolating:!0,parseDOM:[{tag:"figcaption"}],toDOM:()=>["figcaption",{class:"image-caption"},0]},i=(0,n.S)({name:"caption",nodeSpec:r})},65626:function(e,t,a){"use strict";a.d(t,{$y:()=>s,R7:()=>c,zj:()=>u});var n=a(7409),r=a(60826),i=a(95068),l=a(30548),o=a(30837);let s=e=>({content:"ctaCaption",attrs:{url:{default:null},text:{default:null}},inline:!1,group:"block",draggable:!0,atom:!1,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.captioned-button-wrap",getAttrs:o.Y}],toDOM:t=>{let a=document.createElement("div");a.className="captioned-button-wrap",a.setAttribute("data-attrs",JSON.stringify(t.attrs)),a.setAttribute("data-component-name","CaptionedButtonToDOM");let r=document.createElement("div");r.className="preamble";let l=(0,i.ax)({attrs:(0,n._)({},t.attrs,e)});return a.appendChild(r),a.appendChild(l),{dom:a,contentDOM:r}}}),d=e=>{let{substitutionAttrs:t,name:a}=e;return(0,l.S)({name:a,nodeSpec:s(t)})},c=d({name:"captionedShareButton",substitutionAttrs:{url:r.W.SHARE_URL}}),u=d({name:"captionedWriterReferralButton",substitutionAttrs:{hasDynamicSubstitutions:!1}})},37622:function(e,t,a){"use strict";a.d(t,{$:()=>r,Y:()=>i});var n=a(30548);let r={content:"block caption*",atom:!1,selectable:!0,isolating:!1,defining:!0,draggable:!0,group:"block",parseDOM:[{tag:"figure"}],toDOM:()=>["div",{class:"captioned-image-container"},["figure",0]],toDOMStatic:()=>["div",{class:"captioned-image-container-static"},["figure",0]]},i=(0,n.S)({name:"captionedImage",nodeSpec:r})},36621:function(e,t,a){"use strict";a.d(t,{$:()=>c,l:()=>u});var n=a(7409),r=a(99282),i=a(6400),l=a(17117),o=a(10656),s=a(19520),d=a(30548);let c={attrs:{symbol:{default:""}},atom:!0,editable:!1,selectable:!0,isolating:!1,defining:!0,draggable:!1,inline:!0,group:"inline",parseDOM:[{tag:".cashtag-wrap",getAttrs:e=>{try{return JSON.parse(e.getElementsByTagName("a")[0].getAttribute("data-attrs"))}catch(e){return!1}}}],toDOM:e=>{if("undefined"!=typeof window)try{let t=document.createElement("span");return t.className="cashtag-wrap",(0,o.G5)((0,i.h)(l.Z,{symbol:e.attrs.symbol.trim()}),t),t}catch(t){return console.error("Error rendering Cashtag",t),(0,s.s)({msg:null,node:e,err:t,group:"inline"})}return["span",{class:"cashtag-wrap","data-attrs":JSON.stringify(e.attrs),"data-component-name":"CashtagToDOM"}]},toDOMStatic:e=>["span",{class:"cashtag-wrap","data-component-name":"CashtagToDOMStatic","data-attrs":JSON.stringify((0,r._)((0,n._)({},e.attrs),{prependSymbol:!0,isStatic:!0}))}]},u=(0,d.S)({name:"cashtag",nodeSpec:c})},31188:function(e,t,a){"use strict";a.d(t,{Z:()=>o,s:()=>s});var n=a(80508),r=a(54809),i=a(30548);let l=new n.ZP({actionButtonAttr:"href",substackType:"comic",mimeTypesToSignature:r.ER,actionButtonText:"Read now"}),o=l,s=(0,i.S)({name:"comic",nodeSpec:l.nodeSpec})},71993:function(e,t,a){"use strict";a.d(t,{$y:()=>m,Gq:()=>y,Xc:()=>p,a7:()=>f,aE:()=>g});var n=a(7409),r=a(6400),i=a(57796),l=a(10656),o=a(33884),s=a(63651),d=a(47929),c=a(19520),u=a(30548);let m={attrs:{url:{default:""},commentId:{default:null},comment:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.comment",getAttrs:e=>{if(e instanceof HTMLElement)try{var t;return JSON.parse(null!==(t=e.getAttribute("data-attrs"))&&void 0!==t?t:"")}catch(e){}return!1}}],toDOM:e=>{if("undefined"!=typeof window)try{let t=document.createElement("div");return Object.assign(t,{className:"comment","data-attrs":JSON.stringify(e.attrs)}),(0,l.G5)((0,r.h)(i.d,{commentId:e.attrs.commentId}),t),t}catch(t){return console.error("Error rendering CommentEmbed",t),(0,c.s)({msg:null,node:e,err:t,group:"block"})}return h(e)},toDOMStatic:e=>h(e)},p=(0,u.S)({name:"comment",nodeSpec:m,addCommands(){return{insertComment:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}});function h(e){return["div",{class:"comment","data-attrs":JSON.stringify(e.attrs),"data-component-name":"CommentPlaceholder"}]}function g(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&!t.nodes.comment)return null;let a=(0,s.en2)(e);return a&&(0,o.Th)(a.pathname)?e:null}async function b(e){let t;let r=(await Promise.resolve().then(a.t.bind(a,80569,23))).default,i=(0,s.en2)(e),l=i&&(0,o.Th)(i.pathname);if(!l)return console.warn("pathname did not match"),null;try{let{body:{item:{comment:{id:e,date:a,edited_at:n,body:i,body_json:o,restacks:s,reaction_count:d,attachments:c,name:u,user_id:m,photo_url:p,user_bestseller_tier:h}}}}=await r.get("/api/v1/reader/comment/".concat(l.id));t={comment:{id:e,date:a,edited_at:n,body:i,body_json:o,restacks:s,reaction_count:d,attachments:c,name:u,user_id:m,photo_url:p,user_bestseller_tier:h}}}catch(e){return console.warn(e),null}let c=(0,s.BMD)(l,{urlParams:{utm_source:d.b3.commentEmbed}});return(0,n._)({url:c,commentId:l.id},t)}async function f(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema,r=await b(e);return r?n.nodes.comment.create(r):null}async function v(){let e;let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;try{e=(await t.get("/api/v1/reader/feed/last-note")).body;let a=(0,s.Sgq)(e);return b(a)}catch(e){return null}}async function y(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema,r=await v();return r?n.nodes.comment.create(r):null}},88954:function(e,t,a){"use strict";a.d(t,{$y:()=>c,Z9:()=>b,kr:()=>u,uL:()=>v});var n=a(6400),r=a(4373),i=a(10656),l=a(63651),o=a(47929),s=a(19520),d=a(30548);let c={attrs:{url:{default:""},subdomain:{default:null},pub:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.community-chat",getAttrs:e=>{if(e instanceof HTMLElement)try{var t;return JSON.parse(null!==(t=e.getAttribute("data-attrs"))&&void 0!==t?t:"")}catch(e){}return!1}}],toDOM:e=>{if("undefined"!=typeof window)try{let t=document.createElement("div");if(Object.assign(t,{className:"community-chat","data-attrs":JSON.stringify(e.attrs)}),!e.attrs.pub||!e.attrs.subdomain){let e=document.createElement("div");return e.innerText="Could not load subscriber chat link",t.appendChild(e),t}return(0,i.G5)((0,n.h)(r.a,{pub:e.attrs.pub,subdomain:e.attrs.subdomain}),t),t}catch(t){return console.error("Error rendering CommunityChatEmbed",t),(0,s.s)({msg:null,node:e,err:t,group:"block"})}return m(e)},toDOMStatic:e=>m(e)},u=(0,d.S)({name:"communityChat",nodeSpec:c,addCommands(){return{insertCommunityChat:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})},insertCommunityChatEmbed:e=>t=>{var a,n;let{commands:r}=t,i={url:(0,l.ZVW)({pubKey:e.subdomain,utm_source:o.b3.chatEmbed}),subdomain:e.subdomain,pub:{id:e.id,name:e.name,author_name:null!==(a=e.primary_profile_name)&&void 0!==a?a:e.author_name,author_photo_url:null!==(n=e.primary_profile_photo_url)&&void 0!==n?n:e.author_photo_url}};return r.insertContent({type:this.name,attrs:i})},insertVisitThreadButton:e=>t=>{let{commands:a}=t;return a.insertCommunityChatEmbed(e)}}}});function m(e){return["div",{class:"community-chat","data-attrs":JSON.stringify(e.attrs),"data-component-name":"CommunityChatRenderPlaceholder"}]}let p=/^https?:\/\/open\.substack\.com(?:\.localhost:5000)?\/pub\/([^/]+)\/chat(\?.*)?$/,h=/^https?:\/\/([^.]+)\.substack\.com(?:\.localhost:5000)?\/chat(\?.*)?$/,g=/^https?:\/\/substack\.com(?:\.localhost:5000)?\/chat\/(\d+)/;function b(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&!t.nodes.communityChat)return null;let a=(0,l.en2)(e);return a&&a.pathname.match(/^(\/pub\/[^/]+)?\/chat($|\/)/)?e:null}async function f(e){var t,n;let r,i=(await Promise.resolve().then(a.t.bind(a,80569,23))).default,s=((r=(t=e).match(p))||(r=t.match(h)))&&null!==(n=r[1])&&void 0!==n?n:null,d=null;try{if(s){let{body:t}=await i.get("/api/v1/publication/chat-embed").query({subdomain:s,url:e});d=t}else{let t=function(e){var t;let a=e.match(g);return a&&null!==(t=a[1])&&void 0!==t?t:null}(e);if(t){let e=await i.get("/api/v1/publication/public/".concat(t));d=e.body.pub,s=e.body.pub.subdomain}}}catch(e){}return d?{url:(0,l.ZVW)({pubKey:d.subdomain,utm_source:o.b3.chatEmbed}),subdomain:s,pub:d}:null}async function v(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema,r=await f(e);return r?n.nodes.communityChat.create(r):null}},13991:function(e,t,a){"use strict";a.d(t,{$y:()=>h,H6:()=>v,dB:()=>g,yv:()=>_});var n=a(7409),r=a(99282),i=a(6400),l=a(55679),o=a(19925),s=a(62049),d=a(10656),c=a(63651),u=a(47929),m=a(19520),p=a(30548);let h={attrs:{url:{default:""},postId:{default:null},communityPost:{default:null},author:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.community-post",getAttrs:e=>{if(e instanceof HTMLElement)try{var t;return JSON.parse(null!==(t=e.getAttribute("data-attrs"))&&void 0!==t?t:"")}catch(e){}return!1}}],toDOM:e=>{if("undefined"!=typeof window)try{let t=document.createElement("div");return Object.assign(t,{className:"community-post","data-attrs":JSON.stringify(e.attrs)}),(0,d.G5)((0,i.h)(s.V,{postId:e.attrs.postId}),t),t}catch(t){return console.error("Error rendering CommunityPostEmbed",t),(0,m.s)({msg:null,node:e,err:t,group:"block"})}return b(e)},toDOMStatic:e=>b(e)},g=(0,p.S)({name:"communityPost",nodeSpec:h,addCommands(){return{insertCommunityPost:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}},addNodeView:()=>(0,l.fW)(o.A)});function b(e){return["div",{class:"community-post","data-attrs":JSON.stringify(e.attrs),"data-component-name":"CommunityPostPlaceholder"}]}let f=/^\/chat(?:\/\d+)?\/posts?\/([-A-Fa-f0-9]+)$/;function v(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&!t.nodes.communityPost)return null;let a=(0,c.en2)(e);return a&&a.pathname.match(f)?e:null}async function y(e){var t,i;let l;let o=(await Promise.resolve().then(a.t.bind(a,80569,23))).default,s=(0,c.en2)(e),d=s&&(null===(t=s.pathname.match(f))||void 0===t?void 0:t[1]);if(!d)return null;try{l=(await o.get("/api/v1/community/posts/".concat(d))).body}catch(e){if(!(e instanceof Error))return null;{let t=e.response;if(402!==t.status||null===(i=t.body)||void 0===i||!i.status)return null;l=null==t?void 0:t.body}}let{user:m,communityPost:{id:p,publication_id:h,body:g,audience:b,type:v,media_assets:y,link_url:_,threadMediaUploads:w},status:Z}=l,C={author:m},k=(null==w?void 0:w.length)&&w[0]?w[0].mediaUpload:null;"all_subscribers"!==b||Z&&"FREE_SUBSCRIPTION_REQUIRED"!==Z||(C=(0,r._)((0,n._)({},C),{communityPost:{id:p,publication_id:h,body:g,audience:b,type:v,media_assets:y,threadMediaUploads:k?[{mediaUpload:k}]:[],link_url:_?(0,c.n1t)(_,{utm_source:u.b3.postEmbed}):null}}));let S=(0,c._5K)({postId:d,utm_source:u.b3.threadEmbed});return(0,n._)({url:S,postId:d},C)}async function _(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema,r=await y(e);return r?n.nodes.communityPost.create(r):null}},36122:function(e,t,a){"use strict";a.d(t,{$:()=>r,B:()=>i});var n=a(30548);let r={content:"text*",group:"block",draggable:!1,selectable:!0,isolating:!0,defining:!0,atom:!1,parseDOM:[{tag:"p.cta-caption"}],toDOM:()=>["p",{class:"cta-caption"},0]},i=(0,n.S)({name:"ctaCaption",nodeSpec:r})},72270:function(e,t,a){"use strict";a.d(t,{$y:()=>o,Bs:()=>s,HL:()=>p,s3:()=>b,vb:()=>u});var n=a(27412),r=a(60308),i=a(64314),l=a(30548);let o={attrs:{url:{default:""},thumbnail_url:{default:""},height:{default:""},title:{default:""},description:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.datawrapper-wrap",getAttrs:a(30837).Y}],toDOM:e=>g(e),toDOMStatic:e=>h(e)},s=(0,l.S)({name:"datawrapper",nodeSpec:o,addCommands(){return{insertDatawrapper:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),d=/^.*https?:\/\/datawrapper\.dwcdn\.net\/.*$/,c=/^.*https?:\/\/(www\.)?datawrapper.de\/_\/.*$/,u=e=>{let t=d.exec(e);if(t)return t[0];let a=c.exec(e);return a&&a[0]},m=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await t.get("/api/v1/datawrapper-embed").query({url:e.trim()})).body},p=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.datawrapper.create(await m(e))},h=function(e){let{}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=document.createElement("div");t.className="datawrapper-wrap static",t.setAttribute("data-component-name","DatawrapperToDOMStatic");let a=document.createElement("a");if(a.href=e.attrs.url.replace(/embed\//,""),a.setAttribute("target","_blank"),e.attrs.title){let a=document.createElement("div");a.className="datawrapper-title",a.innerHTML=e.attrs.title,t.appendChild(a)}if(e.attrs.description){let a=document.createElement("div");a.className="datawrapper-description",a.innerHTML=e.attrs.description,t.appendChild(a)}let n=document.createElement("div"),i=document.createElement("img");return i.className="datawrapper-wrap thumbnail",i.src=(0,r.zF4)(e.attrs.thumbnail_url,640),i.style.backgroundImage="url(".concat(e.attrs.thumbnail_url,")"),e.attrs.belowTheFold&&i.setAttribute("loading","lazy"),a.append(i),n.append(a),t.appendChild(n),t},g=e=>{let t=document.createElement("div");t.id="datawrapper-iframe",t.className="datawrapper-wrap outer",t.dataset.attrs=JSON.stringify(e.attrs),t.setAttribute("data-component-name","DatawrapperToDOM");let a=document.createElement("iframe");a.id="iframe-datawrapper",a.className="datawrapper-iframe",a.src=e.attrs.url,a.width="730",a.height=e.attrs.height||"455",a.frameBorder="0",a.scrolling="no",e.attrs.belowTheFold&&a.setAttribute("loading","lazy"),t.appendChild(a);let n=document.createElement("script");return n.type="text/javascript",n.text=i.N,t.appendChild(n),t};class b{constructor(e){(0,n._)(this,"dom",void 0);let t=g(e),a=t.querySelector(".datawrapper-iframe"),r=document.createElement("div");r.className="datawrapper-screen",r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),t.appendChild(r),this.dom=t}}},82167:function(e,t,a){"use strict";a.d(t,{$y:()=>w,Cr:()=>Z,lQ:()=>k,wM:()=>S});var n=a(7409),r=a(99282),i=a(98848),l=a(6400),o=a(92007),s=a(55679),d=a(78718),c=a.n(d),u=a(80569),m=a.n(u),p=a(17218),h=a(89198),g=a(98914),b=a(10656),f=a(63651),v=a(19520),y=a(30548);let _="digest-post-embed",w={attrs:{nodeId:{default:null},caption:{default:null},cta:{default:null},showBylines:{default:!0},size:{default:null},isEditorNode:{default:!1},title:{default:null},publishedBylines:{default:null},post_date:{default:null},cover_image:{default:null},cover_image_alt:{default:null},canonical_url:{default:null},section_name:{default:null},id:{default:null},type:{default:null},reaction_count:{default:null},comment_count:{default:null},publication_name:{default:null},publication_logo_url:{default:null},belowTheFold:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,editable:!1,parseDOM:[{tag:".".concat(_),getAttrs:e=>{try{let t=JSON.parse(e.getAttribute("data-attrs"));return(0,r._)((0,n._)({},t),{nodeId:(0,g.EH)()})}catch(e){return!1}}}],toDOM:e=>{if("undefined"!=typeof window&&e.attrs.isEditorNode)try{let t=document.createElement("div");return t.className=_,t.setAttribute("data-attrs",JSON.stringify(e.attrs)),(0,b.G5)((0,l.h)(p.F,(0,r._)((0,n._)({},e.attrs),{caption:e.attrs.caption,cta:e.attrs.cta,showBylines:e.attrs.showBylines,size:e.attrs.size||void 0,isEditor:!0,pub:window._preloads.pub})),t),t}catch(t){return console.error("Error rendering DigestPostEmbedWeb",t),(0,v.s)({msg:null,node:e,err:t,group:"block"})}return C(e)},toDOMStatic:e=>["div",{class:_,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},e.attrs))}]},Z=(0,y.S)({name:"digestPostEmbed",nodeSpec:w,addNodeView:()=>(0,s.fW)(h.X),addCommands:()=>({convertDigestPostEmbedToLinkV2:e=>{let{pos:t,url:a}=e;return e=>{let{dispatch:n,state:r,chain:i}=e;if(n){let e=r.tr,n=t+a.length;return i().setNodeSelection(t).deleteSelection().command(e=>{let{tr:n}=e;return n.insertText(a,t),!0}).command(e=>{let{tr:i}=e;return i.addMark(t,n+1,r.schema.marks.link.create({text:a,href:a})),!0}).setTextSelection(o.Bs.create(e.doc,t,n+1)).scrollIntoView().focus(n+2).run()}return!0}},convertDigestPostEmbedToEmbeddedPostV2:e=>{let{pos:t,attrs:a}=e;return e=>{let{dispatch:n,chain:r}=e;if(n){let e={id:a.id,url:a.url,title:a.title,publication_name:a.publication_name,publication_logo_url:a.publication_logo_url,date:a.post_date,comment_count:a.comment_count,bylines:a.publishedBylines};return r().setNodeSelection(t).deleteCurrentNode().insertContent({type:"embeddedPost",attrs:e}).run()}return!0}}})}),C=e=>["div",{class:_,"data-attrs":JSON.stringify(e.attrs)}],k=function(e){var t,a,n,r;let{customSchema:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i&&!i.nodes.digestPostEmbed)return null;let l=(0,f.en2)(e);if(!l)return null;let o=(0,f.SjL)({url:e,currentSubdomain:null===(a=window._preloads)||void 0===a?void 0:null===(t=a.pub)||void 0===t?void 0:t.subdomain,currentCustomDomain:null===(r=window._preloads)||void 0===r?void 0:null===(n=r.pub)||void 0===n?void 0:n.custom_domain});return l&&(l.pathname.startsWith("/p/")||(0,f.RKj)(l))&&o?e:null},S=async e=>{let{pub:t,post:a}=(await m().get("/api/v1/posts/digest_embed").query({url:e.trim()})).body,{truncated_body_text:l}=a,o=(0,i._)(a,["truncated_body_text"]),{name:s,logo_url:d}=t,u=c()(o,["title","publishedBylines","post_date","cover_image","cover_image_alt","canonical_url","section_name","id","type","reaction_count","comment_count"]);return(0,r._)((0,n._)({caption:null!=l?l:"",cta:"Read full story",size:"lg",isEditor:!0},u),{publishedBylines:u.publishedBylines.map(e=>c()(e,["id","name","bio","photo_url","is_guest","bestseller_tier","primaryPublicationSubscribeUrl","primaryPublicationUrl","primaryPublicationName","primaryPublicationId"])),publication_name:s,publication_logo_url:null!=d?d:""})}},47456:function(e,t,a){"use strict";a.d(t,{$y:()=>g,RE:()=>f,e1:()=>b});var n=a(7409),r=a(99282),i=a(6400),l=a(88897),o=a(55679),s=a(33730),d=a(10656),c=a(57125),u=a(19520),m=a(68303),p=a(30548);let h="directMessage",g={name:h,group:"block",selectable:!0,inline:!1,draggable:!0,atom:!0,attrs:(0,c.Op)({attrs:{userId:{default:null,keepOnSplit:!1},userName:{default:null,keepOnSplit:!1},canDm:{default:null,keepOnSplit:!1},dmUpgradeOptions:{default:null,keepOnSplit:!1},isEditorNode:{default:!1,keepOnSplit:!1}}}),parseDOM:[{tag:"div.directMessage",getAttrs:e=>{try{if(e instanceof HTMLElement){let t=e.getAttribute("data-attrs");if(t)return JSON.parse(t)}}catch(e){}return!1}}],toDOM:e=>{if("undefined"!=typeof window&&e.attrs.isEditorNode)try{e.attrs.isEditor=!0;let t=document.createElement("div");return t.className=h,t.setAttribute("data-attrs",JSON.stringify(e.attrs)),(0,d.G5)((0,i.h)(s.V,{node:(0,n._)({},e)}),t),t}catch(t){return console.error("Error rendering DirectMessageEditor",t),(0,u.s)({msg:null,node:e,err:t,group:"block"})}return["div",{class:"".concat(h," button"),"data-attrs":JSON.stringify((0,n._)({},e.attrs)),"data-component-name":"DirectMessageToDOM"}]},toDOMStatic:e=>["div",{class:h,"data-attrs":JSON.stringify((0,r._)((0,n._)({},e.attrs),{isEmail:!0})),"data-component-name":"DirectMessageToDOMStatic"}]},b=l.hj.create({name:"directMessageExtension",addCommands:()=>({insertDirectMessage:e=>t=>{let{dispatch:a,state:n}=t,{user:r}=e,i={userName:r.name,userId:r.id,isEditorNode:!0};return a&&a((0,m.o4)(n,n.schema.nodes.directMessage.create(i))),!0}})}),f=(0,p.S)({name:"directMessage",nodeSpec:g,addCommands:b.addCommands,addNodeView:()=>(0,o.fW)(s.V)})},32978:function(e,t,a){"use strict";a.d(t,{Z:()=>o,r:()=>s});var n=a(80508),r=a(54809),i=a(30548);let l=new n.ZP({actionButtonAttr:null,substackType:"ebook",mimeTypesToSignature:r.uM,actionButtonText:null}),o=l,s=(0,i.S)({name:"ebook",nodeSpec:l.nodeSpec})},40924:function(e,t,a){"use strict";a.d(t,{$y:()=>c,Ez:()=>u,Ng:()=>m,O5:()=>h});var n=a(7409),r=a(99282),i=a(60308),l=a(63651),o=a(84864),s=a(47929),d=a(30548);let c={attrs:{id:{default:null},url:{default:null},publication_id:{default:null},publication_name:{default:null},publication_logo_url:{default:null},title:{default:null},truncated_body_text:{default:null},date:{default:null},like_count:{default:null},comment_count:{default:null},bylines:{default:null},utm_campaign:{default:null},belowTheFold:{default:!1},type:{default:null},language:{default:"en"}},untrackedAttrs:["truncated_body_text","bylines"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.embedded-post-wrap",getAttrs:a(30837).Y}],toDOM:e=>{let{publication_logo_url:t,publication_name:a,title:n,truncated_body_text:r,url:l,bylines:d,date:c,like_count:u,comment_count:m,utm_campaign:p,id:h,type:g,language:b}=e.attrs,{iString:f}=I18N.i(b),v=(0,i.n1t)(l,{utm_source:s.b3.substack,utm_campaign:p||s.VX.postEmbed,utm_medium:s.lP.web});""===v&&console.error("Invalid path (".concat(l,") for post: ").concat(h));let y=document.createElement("div");y.classList.add("embedded-post-title-icon"),y.innerHTML='<svg width="19" height="19" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path\n  d="M3 18V12C3 9.61305 3.94821 7.32387 5.63604 5.63604C7.32387 3.94821 9.61305 3 12 3C14.3869 3 16.6761 3.94821 18.364 5.63604C20.0518 7.32387 21 9.61305 21 12V18"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  />\n  <path\n  d="M21 19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H18C17.4696 21 16.9609 20.7893 16.5858 20.4142C16.2107 20.0391 16 19.5304 16 19V16C16 15.4696 16.2107 14.9609 16.5858 14.5858C16.9609 14.2107 17.4696 14 18 14H21V19ZM3 19C3 19.5304 3.21071 20.0391 3.58579 20.4142C3.96086 20.7893 4.46957 21 5 21H6C6.53043 21 7.03914 20.7893 7.41421 20.4142C7.78929 20.0391 8 19.5304 8 19V16C8 15.4696 7.78929 14.9609 7.41421 14.5858C7.03914 14.2107 6.53043 14 6 14H3V19Z"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  />\n</svg>';let _=document.createElement("div");return _.classList.add("embedded-post-cta-icon"),_.innerHTML='<svg width="32" height="32" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n  <path\n  className="inner-triangle"\n  d="M10 8L16 12L10 16V8Z"\n  stroke-width="1.5"\n  stroke-linecap="round"\n  stroke-linejoin="round"\n  />\n</svg>',["div",{class:"embedded-post-wrap","data-attrs":JSON.stringify(e.attrs),"data-component-name":"EmbeddedPostToDOM"},["a",{class:"embedded-post",native:!0,href:v},["div",{class:"embedded-post-header"},t?["img",{class:"embedded-post-publication-logo",src:(0,i.zF4)(t,56),loading:e.attrs.belowTheFold?"lazy":null}]:["span",{}],["span",{class:"embedded-post-publication-name"},a||f("Failed to embed post")]],["div",{class:"embedded-post-title-wrapper"},..."podcast"===g?[y]:[],["div",{class:"embedded-post-title"},n||f("Failed to embed post")]],...r?[["div",{class:"embedded-post-body"},(0,o.formatEllipsis)(r)]]:[],["div",{class:"embedded-post-cta-wrapper"},..."podcast"===g?[_]:[],["span",{class:"embedded-post-cta"},f("podcast"===g?"Listen now":"Read more")]],["div",{class:"embedded-post-meta"},(0,o.getPostEmbedMeta)({date:c,bylines:d,like_count:u,comment_count:m,language:b})]]]},toDOMStatic:e=>{let{publication_logo_url:t,publication_name:a,title:n,truncated_body_text:r,url:l,bylines:d,date:c,like_count:u,comment_count:m,utm_campaign:p,type:h,language:g}=e.attrs,{iString:b}=I18N.i(g),f=(0,i.n1t)(l,{utm_source:s.b3.substack,utm_campaign:p||s.VX.postEmbed,utm_medium:s.lP.email}),v=(0,i.zF4)("/img/podcast-headphones.svg",19,{format:"png"}),y=(0,i.zF4)("/img/audio-player-play.png",12);return["div",{class:"embedded-post-wrap","data-component-name":"EmbeddedPostToDOMStatic"},["div",{class:"embedded-post"},["div",{class:"embedded-post-header"},t?["img",{class:"embedded-post-publication-logo",src:(0,i.zF4)(t,56),width:28,height:28}]:["span",{}],["span",{class:"embedded-post-publication-name"},a||b("Failed to embed post")]],["div",{class:"embedded-post-title-wrapper"},..."podcast"===h?[["img",{class:"embedded-post-title-icon embedded-post-title-icon-static",src:v}]]:[],["a",{class:"embedded-post-title",href:f||"#"},n||b("Failed to embed post")]],...r?[["div",{class:"embedded-post-body"},(0,o.formatEllipsis)(r)]]:[["br"],["br"]],["div",{class:"embedded-post-cta-wrapper"},..."podcast"===h?[["img",{width:12,height:12,class:"embedded-post-cta-icon-static",src:y}]]:[],["a",{class:"embedded-post-cta",href:f||"#"},b("podcast"===h?"Listen now":"Read more")]],["div",{class:"embedded-post-meta"},(0,o.getPostEmbedMeta)({date:c,bylines:d,like_count:u,comment_count:m,language:g})]]]}},u=(0,d.S)({name:"embeddedPost",nodeSpec:c,addCommands(){return{insertEmbeddedPost:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),m=function(e){var t,a,n,r;let{customSchema:o,forceAllowOwnPub:s=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o&&!o.nodes.embeddedPost)return null;let d=(0,i.en2)(e);if(!d)return null;let c=(0,l.SjL)({url:e,currentSubdomain:null===(a=window._preloads)||void 0===a?void 0:null===(t=a.pub)||void 0===t?void 0:t.subdomain,currentCustomDomain:null===(r=window._preloads)||void 0===r?void 0:null===(n=r.pub)||void 0===n?void 0:n.custom_domain});return d&&(d.pathname.startsWith("/p/")||(0,l.RKj)(d))&&!(c&&!s)?e:null},p=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;try{return(await t.get("/api/v1/posts/embed").query({url:e.trim()})).body}catch(e){return null}},h=async function(e){let{customSchema:t,language:i="en"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema,o=await p(e);return o?l.nodes.embeddedPost.create((0,r._)((0,n._)({},o),{language:i})):null}},86725:function(e,t,a){"use strict";a.d(t,{$y:()=>p,l6:()=>b,mt:()=>v,t3:()=>g,zJ:()=>h});var n=a(7409),r=a(99282),i=a(58865),l=a(60308),o=a(47929),s=a(30548),d=a(30837);function c(){let e=(0,i._)(["By ",""]);return c=function(){return e},e}function u(){let e=(0,i._)(["By ",""]);return u=function(){return e},e}let m=e=>e?{style:"background-color: ".concat(e)}:{},p={attrs:{id:{default:null},name:{default:""},logo_url:{default:null},base_url:{default:null},hero_text:{default:null},author_name:{default:null},show_subscribe:{default:!0},logo_bg_color:{default:null},language:{default:"en"}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.embedded-publication-wrap",getAttrs:d.Y}],toDOMWithSubscribe:e=>{let{name:t,logo_url:a,base_url:r,hero_text:i,author_name:s,logo_bg_color:d,language:u}=e.attrs,{iString:p,iTemplate:h}=I18N.i(u);return["div",{class:"embedded-publication-wrap","data-attrs":JSON.stringify(e.attrs),"data-component-name":"EmbeddedPublicationToDOMWithSubscribe"},["div",{class:"embedded-publication show-subscribe"},["a",{class:"embedded-publication-link-part",native:!0,href:(0,l.n1t)(r,{utm_source:o.b3.substack,utm_campaign:o.VX.publicationEmbed,utm_medium:o.lP.web})},...a?[["img",(0,n._)({class:"embedded-publication-logo",src:(0,l.zF4)(a),width:56,height:56},m(d))]]:[],["span",{class:"embedded-publication-name"},t||p("Failed to embed publication")],...i?[["div",{class:"embedded-publication-hero-text"},i]]:[],...s&&!t.includes(s)?[["div",{class:"embedded-publication-author-name"},h(c(),s)]]:[]],["form",{class:"embedded-publication-subscribe",method:"GET",action:(0,l.W1P)({base_url:r},{addBase:!0})},["input",{type:"hidden",name:"source",value:"publication-embed"}],["input",{type:"hidden",name:"autoSubmit",value:"true"}],["input",{type:"email",class:"email-input",name:"email",placeholder:p("Type your email...")}],["input",{type:"submit",class:"button primary",value:p("Subscribe")}]]]]},toDOMWithoutSubscribe:e=>{let{name:t,logo_url:a,base_url:r,hero_text:i,author_name:s,logo_bg_color:d,language:c}=e.attrs,{iString:p,iTemplate:h}=I18N.i(c);return["div",{class:"embedded-publication-wrap","data-attrs":JSON.stringify(e.attrs)},["a",{class:"embedded-publication embedded-publication-flex",native:!0,href:(0,l.n1t)(r,{utm_source:o.b3.substack,utm_campaign:o.VX.publicationEmbed,utm_medium:o.lP.web})},...a?[["div",{class:"embedded-publication-left"},["img",(0,n._)({class:"embedded-publication-logo",src:(0,l.zF4)(a),width:40,height:40},m(d))]]]:[],["div",{class:"embedded-publication-right"},["span",{class:"embedded-publication-name"},t||p("Failed to embed publication")],...i?[["div",{class:"embedded-publication-hero-text"},i]]:[],...s&&!t.includes(s)?[["div",{class:"embedded-publication-author-name"},h(u(),s)]]:[]]]]},toDOMStatic:e=>{let{name:t,logo_url:a,base_url:r,hero_text:i,author_name:s,logo_bg_color:d}=e.attrs,c=(0,l.n1t)(r,{utm_source:o.b3.substack,utm_campaign:o.VX.publicationEmbed,utm_medium:o.lP.email});return["div",{class:"embedded-publication-wrap","data-attrs":JSON.stringify(e.attrs),"data-component-name":"EmbeddedPublicationToDOMStatic"},["table",{class:"embedded-publication"},["tr",{},...a?[["td",{class:"embedded-publication-left",valign:"top",width:56},["img",(0,n._)({class:"embedded-publication-logo",src:(0,l.zF4)(a),width:40,height:40},m(d))]]]:[],["td",{class:"embedded-publication-right"},["span",{class:"embedded-publication-name"},["a",{href:c},t||"Failed to embed publication"]],...i?[["div",{class:"embedded-publication-hero-text"},["a",{href:c},i]]]:[],...s&&!t.includes(s)?[["div",{class:"embedded-publication-author-name"},["a",{href:c},"By ".concat(s)]]]:[]]]]]},toDOM:e=>e.attrs.show_subscribe?p.toDOMWithSubscribe(e):p.toDOMWithoutSubscribe(e)},h=(0,s.S)({name:"embeddedPublication",nodeSpec:p,addCommands(){return{insertEmbeddedPublication:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),g=function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&!t.nodes.embeddedPublication)return null;let a=(0,l.en2)(e);return a&&(!a.pathname||"/"===a.pathname)?e:null},b=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;try{let a=await t.get("/api/v1/publication/embed").query({url:e.trim()});if(!a.body.id)return null;return a.body}catch(e){return null}},f=async e=>{let t=await b(e);return t?(0,r._)((0,n._)({},t),{show_subscribe:!0}):null},v=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema,r=await f(e);return r?n.nodes.embeddedPublication.create(r):null}},1415:function(e,t,a){"use strict";a.d(t,{n:()=>d});var n=a(59981),r=a(92007),i=a(80569),l=a.n(i);let o=async(e,t,a)=>{let{schema:n}=t;if(!n.nodes.cashtag)return console.error("Cashtag node not found in schema"),!0;let r=n.nodes.cashtag.create({symbol:e,prependSymbol:!1}),i=t.tr;return i.replaceSelectionWith(r),a&&a(i),!0},s=async()=>(await l().get("/api/v1/symbols/all")).body.symbols,d=n.pf.configure({HTMLAttributes:{class:"mention"},suggestion:{char:"$",allowSpaces:!1,startOfLine:!1,command:()=>{},items:()=>[],render:()=>({onStart:()=>{s()},onUpdate(){},onKeyDown:e=>"Escape"===e.event.key,async onExit(e){let t=e.text.trim();if(["$",""].includes(t))return;let a=await s();if(!/\$[a-z]+$/i.test(t)||t.length>6||!a.includes(t.toUpperCase().replace("$",""))||["BTC","ETH","SOL","XRP","BNB","LUNA"].includes(t.toUpperCase().replace("$","")))return;let n=e.editor.state.tr;n.setSelection(r.Bs.create(n.doc,e.range.from,e.range.to)).deleteSelection(),e.editor.view.dispatch(n),o(t.toUpperCase(),e.editor.view.state,e.editor.view.dispatch),e.editor.commands.insertContent(" "),e.editor.view.dispatch(e.editor.state.tr)}})}})},98738:function(e,t,a){"use strict";a.d(t,{d:()=>i});var n=a(61767),r=a(19908);let i=n.r.extend({addKeyboardShortcuts(){return{"Mod-k":()=>this.editor.commands.addLink()}},addCommands:()=>({addLink:()=>e=>{let{state:t,dispatch:a,view:n}=e;return(0,r.M)(t.schema)(t,a,n)}})}).configure({autolink:!1,openOnClick:!1})},24653:function(e,t,a){"use strict";a.d(t,{p:()=>eC});var n=a(7409),r=a(18490),i=a(32018),l=a(94886),o=a(99218),s=a(89290),d=a(2799),c=a(5835),u=a(26603),m=a(57937),p=a(55633),h=a(1451),g=a(44262),b=a(41676),f=a(82032),v=a(95068),y=a(12568),_=a(65626),w=a(37622),Z=a(36621),C=a(31188),k=a(71993),S=a(88954),E=a(13991),N=a(36122),x=a(72270),O=a(82167),M=a(47456),B=a(32978),I=a(40924),T=a(86725),A=a(1415),P=a(98738),D=a(94413),L=a(80508),R=a(715),F=a(87113),H=a(98450),X=a(87413);let z=a(67338).Z.extend({draggable:!0});var U=a(69323),V=a(61601),W=a(57639),J=a(54793),q=a(29511),j=a(49640),Y=a(99975),G=a(41128),$=a(23431),K=a(73078),Q=a(85197),ee=a(53797),et=a(8220),ea=a(18119),en=a(44288),er=a(13938),ei=a(54757),el=a(11006),eo=a(11470),es=a(66928),ed=a(19805),ec=a(46393),eu=a(2107),em=a(99149),ep=a(79592),eh=a(39111),eg=a(57950),eb=a(78483),ef=a(57881),ev=a(84766),ey=a(60802),e_=a(45913),ew=a(34612),eZ=a(32751);let eC=e=>{let{isStatic:t,excludeDropCursor:a=!1}=e,eC={};return a&&(eC.dropcursor=!1),[d.Z.configure((0,n._)({history:!1,blockquote:!1,bulletList:!1,orderedList:!1,horizontalRule:!1},eC)),s.ZP,l.Z,o.Z,P.d,b.M,el.z.configure({isStatic:t}),r.ZP,i.ZP,V.hJ.configure({isStatic:t}),J.zk,m.DW.configure({isStatic:t}),c.hE.configure({isStatic:t}),ey.v.configure({isStatic:t}),ef.h.configure({isStatic:t}),ev.HU.configure({isStatic:t}),ew.O.configure({isStatic:t}),eZ.II.configure({isStatic:t}),v.H9.configure({isStatic:t}),U.y.configure({isStatic:t}),W.RK.configure({isStatic:t}),eh.K.configure({isStatic:t}),N.B.configure({isStatic:t}),O.Cr.configure({isStatic:t}),I.Ez.configure({isStatic:t}),T.zJ.configure({isStatic:t}),em.H.configure({isStatic:t}),ep.JV.configure({isStatic:t}),eo.v.configure({isStatic:t}),Z.l.configure({isStatic:t}),L.ag.configure({isStatic:t}),B.r.configure({isStatic:t}),C.s.configure({isStatic:t}),Q.H.configure({isStatic:t}),q.o0.configure({isStatic:t}),ea.x.configure({isStatic:t}),eu.a.configure({isStatic:t}),j.F.configure({isStatic:t}),g.hV.configure({isStatic:t}),e_.qM.configure({isStatic:t}),eb.du.configure({isStatic:t}),f.X2.configure({isStatic:t}),ee.q.configure({isStatic:t}),ec.uJ.configure({isStatic:t}),S.kr.configure({isStatic:t}),k.Xc.configure({isStatic:t}),E.dB.configure({isStatic:t}),X.Tu.configure({isStatic:t}),h.h.configure({isStatic:t}),en.OR.configure({isStatic:t}),en.kY.configure({isStatic:t}),Y.j7.configure({isStatic:t}),x.Bs.configure({isStatic:t}),$.eK.configure({isStatic:t}),w.Y.configure({isStatic:t}),y._.configure({isStatic:t}),_.R7.configure({isStatic:t}),_.zj.configure({isStatic:t}),G.qs.configure({isStatic:t}),R.z.configure({isStatic:t}),F.V.configure({isStatic:t}),er.T.configure({isStatic:t}),K.U.configure({isStatic:t}),p.E4.configure({isStatic:t}),eg.Z.configure({isStatic:t}),es.b.configure({isStatic:t}),ed.ym.configure({isStatic:t}),ei.t.configure({isStatic:t}),H.G.configure({isStatic:t}),u.a.configure({isStatic:t}),et.$u.configure({isStatic:t}),z,D.T,A.n,M.RE.configure({isStatic:t})]}},94413:function(e,t,a){"use strict";a.d(t,{T:()=>h});var n=a(58865),r=a(59981),i=a(92007),l=a(55679),o=a(42441),s=a.n(o),d=a(45088),c=a(70075),u=a(3258),m=a(98914);function p(){let e=(0,n._)(["No results for ",""]);return p=function(){return e},e}let h=r.pf.extend({name:"substack_mentions_extension"}).configure({HTMLAttributes:{class:"substack-mention"},suggestion:{char:"@",pluginKey:new i.H$("substack_mentions_extension"),decorationClass:"substack-mention",allowSpaces:!0,startOfLine:!1,command:e=>{var t;let{editor:a,range:n,props:r}=e;if(!r.item)return;let{name:l,id:o,type:s,url:d,photo_url:c}=r.item,u=a.view.state.selection.$to.nodeAfter;(null==u?void 0:null===(t=u.text)||void 0===t?void 0:t.startsWith(" "))&&(n.to+=1);let{schema:p}=a.state,h=a.state.tr;if(h.setSelection(i.Bs.create(h.doc,n.from,n.to)).deleteSelection(),a.view.dispatch(h),h=a.state.tr,!p.nodes.substack_mentions){console.error("substack_mentions node not found in schema");return}let g=p.nodes.substack_mentions.create({name:l,id:o,type:s,url:d,photo_url:c,uuid:(0,m.EH)()});h.insert(n.from,g),a.view.dispatch(h),a.commands.insertContent(" "),a.view.dispatch(a.state.tr),h.setSelection(i.Bs.near(h.doc.resolve(n.from+1)))},items:async e=>{let{query:t}=e;return t.length<1?[]:await (0,u.wg)(t)},render:()=>{let e,t;let a=s().prototype.stopCallback,n=function(e){var t,a,n;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i="undefined"!=typeof window&&null!==(n=null===(a=window._preloads)||void 0===a?void 0:null===(t=a.pub)||void 0===t?void 0:t.language)&&void 0!==n?n:"en",{iString:l,iTemplate:o}=I18N.i(i);return{items:e.items,query:e.query,isLoading:r,selectItem:t=>{t&&!t.disabledReason&&e.command({item:t})},placeholderText:l("Search for a person or publication"),noResultsText:o(p(),e.query),minQueryLength:2,language:i}};return{onStart:r=>{e=new l.M_(c.c,{props:n(r),editor:r.editor}),t=(0,d.ZP)("body",{getReferenceClientRect:r.clientRect,appendTo:()=>document.getElementsByClassName("editor-scroll")[0]||document.body,content:e.element,popperOptions:{strategy:"absolute",modifiers:[{options:{altAxis:!0}}]},showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}),s().prototype.stopCallback=function(e,t,n){return"esc"===n||a(e,t,n)}},onBeforeUpdate(a){t&&t[0].show(),e&&e.updateProps(n(a,!0)),a.clientRect&&t&&t[0].setProps({getReferenceClientRect:a.clientRect})},onUpdate(a){e&&e.updateProps(n(a,!1)),t&&t[0].setProps({getReferenceClientRect:a.clientRect})},onKeyDown(n){var r;return"Escape"===n.event.key?(t&&t[0]&&t[0].destroy(),t=null,e&&e.destroy(),e=null,setTimeout(()=>{s().prototype.stopCallback=a},0),!0):null==e?void 0:null===(r=e.ref)||void 0===r?void 0:r.onKeyDown(n)},onExit(){s().prototype.stopCallback=a,t&&t[0]&&t[0].destroy(),t=null,e&&e.destroy(),e=null}}}}})},80508:function(e,t,a){"use strict";a.d(t,{ZP:()=>m,ag:()=>h});var n=a(27412),r=a(80569),i=a.n(r),l=a(60826),o=a(60308),s=a(54809),d=a(30548);let c=e=>new Promise((t,a)=>{if(!window.FileReader){a(TypeError("File reader API not found"));return}let n=new FileReader;n.onerror=a,n.onload=()=>{t(n.result)},n.readAsDataURL(e)});class u{update(e){return e.type.name===this.fileEmbed.substackType}stopEvent(e){return"file-embed-menu-button"===e.target.className}constructor({fileEmbed:e,node:t,view:a,getPos:r}){(0,n._)(this,"dom",void 0),(0,n._)(this,"fileEmbed",void 0),this.fileEmbed=e,this.dom=e.buildNodeView(t,a,r)}}class m{getNodeView(e){let{editor:t,node:a,getPos:n}=e;return new u({fileEmbed:this,node:a,view:t.view,getPos:n})}get nodeSpec(){return{definition:this,attrs:{filename:{default:null},filetype:{default:null},filesize:{default:null},href:{default:null},title:{default:null},description:{default:null},thumbnail:{default:null},fileKey:{default:null},dirty:{default:!0},raw_href:{default:null},error:{default:null},empty:{default:!1}},substackType:this.substackType,inline:!1,atom:!0,group:"block",selectable:!1,draggable:!0,isolating:!0,defining:!0,parseDOM:(0,s.Xb)({mimeTypesToSignature:this.mimeTypesToSignature,substackType:this.substackType,actionButtonAttr:this.actionButtonAttr}),toDOM:e=>{let t=["div",{class:"file-embed-wrapper","data-component-name":"FileToDOM"},["div",{class:"file-embed-container-reader"},["div",{class:"file-embed-container-top"},["image",{class:"file-embed-thumbnail".concat(e.attrs.thumbnail?"":"-default"),src:e.attrs.thumbnail||(0,o.zF4)("/img/attachment_icon.svg")}],["div",{class:"file-embed-details"},["div",{class:"file-embed-details-h1"},e.attrs.title||e.attrs.filename||""],["div",{class:"file-embed-details-h2"},(0,s.Nf)({attrs:e.attrs})]],["a",{class:"file-embed-button wide",href:e.attrs[this.actionButtonAttr]},["span",{class:"file-embed-button-text"},this.actionButtonText]]]]];return e.attrs.description&&t[2].push(["div",{class:"file-embed-description"},e.attrs.description]),t[2].push(["a",{class:"file-embed-button narrow",href:e.attrs[this.actionButtonAttr]},["span",{class:"file-embed-button-text"},this.actionButtonText]]),t},toDOMStatic:e=>{var t;let a,n;let r=(null===(t=e.attrs)||void 0===t?void 0:t.title)||"";return e.attrs.thumbnail&&-1===e.attrs.thumbnail.indexOf("attachment_icon.svg")?(n=!1,a=(0,o.zF4)(e.attrs.thumbnail,100,{aspect:"1.5",crop:"fill",gravity:"auto",height:150})):(n=!0,a=(0,o.zF4)("/img/attachment_icon.svg",32,{aspect:"1",crop:"fill",gravity:"auto",height:32})),r&&r.length>40&&(r="".concat(r.substr(0,40),"...")),["table",{class:"static-file-embed-table",cellspacing:"16","data-component-name":"FileToDOMStatic"},["tr",{},["td",{class:"static-file-embed-thumbnail-container ".concat(n?"default":"")},["img",{class:"static-file-embed-thumbnail ".concat(n?"default":""),src:a}]],["td",{class:"static-file-embed-details ".concat(n?"default":"")},["div",{class:"static-file-embed-details-h1"},r],["div",{class:"static-file-embed-details-h2"},(0,s.Nf)({attrs:e.attrs})]]],...e.attrs.description?[["tr",{},["td",{class:"static-file-embed-description",colspan:"2"},["p",{style:"margin: 0;"},e.attrs.description||""]]]]:[],["tr",{},["td",{class:"static-file-embed-button-container",colspan:"2"},["table",{class:"static-file-embed-button",cellspacing:"0"},["tr",{},["td",{align:"center"},["a",{href:"".concat(e.attrs[this.actionButtonAttr],"?token=").concat(l.W.FILE_DOWNLOAD_TOKEN),class:"static-file-embed-anchor"},this.actionButtonText]]]]]]]}}}buildNodeView(e,t,a){var n,r,i,l;let s=document.createElement("div");s.className="file-embed-wrapper-editor";let d=document.createElement("div");d.className="file-embed-container",d.dataset.attrs=JSON.stringify(e.attrs),d.appendChild(this.generateContainerTop(e)),d.appendChild(this.generateDescription(e)),d.appendChild(this.generateButton("narrow"));let c=document.createElement("div");c.className="file-embed-aligner";let{button:u,menu:m}=this.generateDropdown(e,t,a);c.appendChild(d),c.appendChild(m),s.appendChild(c);let p=document.createElement("img");p.src=(0,o.zF4)("/img/file_drag_default.png");let h=document.createElement("img");h.src=(0,o.zF4)(null==e?void 0:null===(n=e.attrs)||void 0===n?void 0:n.thumbnail,100,{aspect:"1.5",crop:"fill",gravity:"auto",height:150}),s.addEventListener("dragstart",t=>{var a,n,r;(null==e?void 0:null===(a=e.attrs)||void 0===a?void 0:a.thumbnail)?null===(n=t.dataTransfer)||void 0===n||n.setDragImage(h,0,0):null===(r=t.dataTransfer)||void 0===r||r.setDragImage(p,0,0)}),(null===(i=t.state)||void 0===i?void 0:null===(r=i.doc)||void 0===r?void 0:r.nodeAt(t.state.doc.nodeSize-3))===e&&setTimeout(()=>{t.dispatch(t.state.tr.insertText("\r",t.state.doc.nodeSize-2))},0);let g=document.createElement("div");g.appendChild(this.generateSpinner());let b=this.generateErrorCover(t,e);return(null===(l=e.attrs)||void 0===l?void 0:l.error)&&(u.className="file-embed-menu-button hidden",d.className="file-embed-container covered error",d.appendChild(b)),e.startReplacing=()=>{g.className="file-embed-container cover",d.className="file-embed-container covered",u.className="file-embed-menu-button disabled",d.contains(b)&&d.removeChild(b),d.appendChild(g)},e.stopReplacing=e=>{e?(u.className="file-embed-menu-button hidden",d.className="file-embed-container covered error",d.appendChild(b)):(d.className="file-embed-container",u.className="file-embed-menu-button"),d.removeChild(g)},s}getFileAttrs(e){return{href:e.getAttribute("href"),filename:e.getAttribute("filename"),filetype:e.getAttribute("filetype"),filesize:e.getAttribute("filesize"),title:e.getAttribute("title"),dirty:e.getAttribute("dirty"),description:e.getAttribute("description"),error:e.getAttribute("error")}}generateThumbnail(e){let t=document.createElement("img");return t.className="file-embed-thumbnail".concat(e.attrs.thumbnail?"":"-default"),t.setAttribute("src",e.attrs.thumbnail||(0,o.zF4)("/img/attachment_icon.svg")),e.updateThumbnail=async function(a){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{aspect:"1.5",crop:"fill",gravity:"auto",width:400,height:600};if(e.attrs.dirty=!0,!a){e.attrs.thumbnail=null,t.onload=()=>{t.className="file-embed-thumbnail-default"},t.src=(0,o.zF4)("/img/attachment_icon.svg");return}let l=await c(a),s=await i().post("/api/v1/image").send({image:l}),d=(0,o.zF4)(s.body.url,n,r);return e.attrs.thumbnail=d,t.onload=()=>{t.className="file-embed-thumbnail"},t.src=d,d},t}generateDetails(e){let t=document.createElement("div");t.className="file-embed-details";let a=document.createElement("div");a.className="file-embed-details-h1",a.innerText=e.attrs.title||e.attrs.filename;let n=document.createElement("div");return n.className="file-embed-details-h2",n.innerText=(0,s.Nf)({attrs:e.attrs}),t.appendChild(a),t.appendChild(n),e.updateTitle=t=>{e.attrs.title=t,e.attrs.dirty=!0,a.innerText=t},t}generateButton(e){let t=document.createElement("button");t.className="file-embed-button primary mock ".concat(e);let a=document.createElement("span");return a.className="file-embed-button-text",a.innerText=this.actionButtonText,t.appendChild(a),t}generateDescription(e){let t=document.createElement("div");return t.className="file-embed-description ",t.innerText=e.attrs.description,e.updateDescription=a=>{e.attrs.dirty=!0,e.attrs.description=a?a.trim():null,t.innerText=a?a.trim():null},t}generateErrorCover(e,t){var a,n;let r=document.createElement("div");r.className="file-embed-container cover error";let i=document.createElement("div");i.className="file-embed-error-inner";let l=document.createElement("img");l.className="file-embed-error-icon",l.setAttribute("src",(0,o.aR6)("/img/alert-circle.svg"));let s=document.createElement("div");s.className="file-embed-error-message",s.innerText=null===(a=t.attrs.error)||void 0===a?void 0:a.message;let d=document.createElement("div");d.className="file-embed-error-button",d.onclick=this.makeReplaceButtonClickHandler(e,t);let c=document.createElement("span");return c.className="file-embed-error-button-text",c.innerText=(null===(n=t.attrs.error)||void 0===n?void 0:n.button)||"Try again",d.appendChild(c),i.appendChild(l),i.appendChild(s),i.appendChild(d),r.appendChild(i),r}generateSpinner(){let e=document.createElement("div");e.className="embed-loader-container";let t=document.createElement("div");t.className="embed-loader";let a=document.createElement("div");return a.innerText="Replacing...",a.className="embed-loader-text",e.appendChild(t),e.appendChild(a),e}makeReplaceButtonClickHandler(e,t){return()=>{let a=document.createElement("input");a.className="sidebar-item-hidden-file-input",a.type="file",a.oninput=a=>{var n,r;let i=null===(r=a.target)||void 0===r?void 0:null===(n=r.files)||void 0===n?void 0:n[0];e.dispatchEvent({type:"file_replace",node:t,file:i})},document.body.appendChild(a),a.click(),document.body.removeChild(a)}}generateDropdown(e,t,a){let n=document.createElement("div");n.className="post-editor-file-embed-dropdown-container dropdown-container";let r=document.createElement("div");r.className="dropdown-content";let i=document.createElement("div");i.className="dropdown-list",[{label:"Edit",icon:"edit",onclick:()=>{t.dispatchEvent(new CustomEvent("file_edit",{detail:{node:e}}))}},{label:"Replace",icon:"swap",onclick:this.makeReplaceButtonClickHandler(t,e)},{label:"Download",icon:"download",onclick:()=>{let t=document.createElement("a");t.href=e.attrs.raw_href,t.download=e.attrs.filename,document.body.appendChild(t);let a=window.onbeforeunload;window.onbeforeunload=null,t.click(),window.onbeforeunload=a,document.body.removeChild(t)}},{label:"Delete",icon:"trash",onclick:()=>{if("function"!=typeof a)return;let e=a();t.dispatch(t.state.tr.delete(e,e+1))}}].map(e=>{let t=document.createElement("div");t.className="dropdown-list-item",t.onclick=e.onclick;let a=document.createElement("div");a.className="dropdown-list-item-icon icon-".concat(e.icon);let n=document.createElement("span");return n.className="dropdown-list-item-text",n.innerText=e.label,t.appendChild(a),t.appendChild(n),t}).forEach(e=>{i.appendChild(e)}),r.appendChild(i);let l=document.createElement("div");l.className="file-embed-menu-button";let o=document.createElement("div");return o.className="dropdown-icon",o.appendChild(document.createElement("span")),o.appendChild(document.createElement("span")),o.appendChild(document.createElement("span")),o.appendChild(document.createElement("span")),l.appendChild(o),n.appendChild(l),n.appendChild(r),l.onclick=()=>{if("dropdown-content open"===r.className)return;r.className="dropdown-content open",o.className="dropdown-icon open",l.className="file-embed-menu-button open";let e=()=>{r.className="dropdown-content",o.className="dropdown-icon",l.className="file-embed-menu-button",document.removeEventListener("click",e)};setTimeout(()=>{document.addEventListener("click",e)},0)},{button:l,menu:n}}generateContainerTop(e){let t=document.createElement("div");return t.className="file-embed-container-top",t.appendChild(this.generateThumbnail(e)),t.appendChild(this.generateDetails(e)),t.appendChild(this.generateButton("wide")),t}constructor({substackType:e,actionButtonText:t,actionButtonAttr:a,mimeTypesToSignature:r}){(0,n._)(this,"substackType","file"),(0,n._)(this,"actionButtonText","Download"),(0,n._)(this,"actionButtonAttr","raw_href"),(0,n._)(this,"mimeTypesToSignature",void 0),e&&(this.substackType=e),t&&(this.actionButtonText=t),a&&(this.actionButtonAttr=a),this.mimeTypesToSignature=r}}let p=new m({actionButtonText:null,substackType:null,actionButtonAttr:null,mimeTypesToSignature:{}}),h=(0,d.S)({name:"file",nodeSpec:p.nodeSpec})},715:function(e,t,a){"use strict";a.d(t,{$:()=>o,z:()=>s});var n=a(92007),r=a(94826),i=a(30548),l=a(80870);let o={attrs:{number:{default:1}},content:"block+",atom:!1,selectable:!1,isolating:!1,defining:!0,draggable:!1,group:"block",parseDOM:[{tag:".footnote"}],toDOM:e=>{let{number:t}=e.attrs;return["div",{class:"footnote","data-component-name":"FootnoteToDOM"},["a",{id:"footnote-".concat(t),href:"#footnote-anchor-".concat(t),class:"footnote-number",contenteditable:!1,target:"_self"},"".concat(t)],["div",{class:"footnote-content"},0]]},toDOMStatic:e=>{let{number:t}=e.attrs;return["div",{class:"footnote","data-component-name":"FootnoteToDOMStatic"},["span",{class:"footnote-number"},"".concat(t)],["div",{class:"footnote-content"},0]]}},s=(0,i.S)({name:"footnote",nodeSpec:o,addCommands:()=>({insertFootnote:()=>e=>{let{state:t,editor:a,dispatch:i}=e;if(!(0,r.P)(t))return!1;let{schema:o}=a,s=o.nodes.footnote.create({number:1},o.nodes.paragraph.create()),d=o.nodes.footnoteAnchor.create({number:1}),c=t.tr,u=(0,l.dG)(c,o);if(c.replaceWith(u,u,s),c.replaceSelectionWith(d),(0,l.A0)(c,o),i){try{c.setSelection(n.Bs.create(c.doc,u+2,u+2)).scrollIntoView()}catch(e){return console.error("could not set footnote text selection"),!1}i(c)}return!0}})})},87113:function(e,t,a){"use strict";a.d(t,{$:()=>i,V:()=>l});var n=a(84864),r=a(30548);let i={attrs:{number:{default:1}},atom:!0,selectable:!0,isolating:!1,defining:!0,draggable:!0,inline:!0,group:"inline",parseDOM:[{tag:".footnote-anchor"}],toDOM:e=>{let{number:t}=e.attrs;return["a",{class:"footnote-anchor","data-component-name":"FootnoteAnchorToDOM",id:"footnote-anchor-".concat(t),href:"#footnote-".concat(t),target:"_self"},"".concat(t)]},toDOMStatic:e=>{let{number:t}=e.attrs;return["span",{class:"footnote-anchor-email","data-component-name":"FootnoteAnchorToDOMStatic"},"".concat((0,n.getSuperscriptNumberString)(t))]}},l=(0,r.S)({name:"footnoteAnchor",nodeSpec:i})},98450:function(e,t,a){"use strict";a.d(t,{$:()=>r,G:()=>i});var n=a(30548);let r={content:"block+",group:"block",toDOM:()=>["div",{"data-component-name":"FragmentNodeToDOM"},0]},i=(0,n.S)({name:"fragmentNode",nodeSpec:r})},87413:function(e,t,a){"use strict";a.d(t,{$y:()=>l,S:()=>d,Tu:()=>o,un:()=>m});var n=a(91036),r=a.n(n),i=a(30548);let l={attrs:{innerHTML:{default:""},stylesheet:{default:""}},untrackedAttrs:["innerHTML","stylesheet"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.github-gist",getAttrs:a(30837).Y}],toDOMStatic:e=>p(e,!0),toDOM:e=>p(e,!1)},o=(0,i.S)({name:"gitgist",nodeSpec:l,addCommands(){return{insertGithubGist:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),s=/(https?:\/\/gist.github.com\/([^\s]*\/[^\s\.#]*)([\.#][^\s]*)?)/,d=function(e){var t;let{customSchema:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a&&!a.nodes.gitgist)return null;let n=s.exec(e);return null!==(t=n&&n[1])&&void 0!==t?t:null},c=e=>{let t=e.match(s);return t&&t[2]?t[2]:null},u=async e=>{let t=c(e),n=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await n.get("/api/v1/github/gist").query({id:t})).body},m=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.gitgist.create(await u(e))};function p(e,t){let a=document.createElement("div");a.classList.add("github-gist"),t?a.setAttribute("data-component-name","GitgistToDOMStatic"):(a.dataset.attrs=JSON.stringify(e.attrs),a.setAttribute("data-component-name","GitgistToDOM")),a.innerHTML=r()(e.attrs.innerHTML,{allowedTags:r().defaults.allowedTags,allowedAttributes:Object.assign({},r().defaults.allowedAttributes,{"*":["href","style","id","data-*","itemprop","class"]})});let n=document.createElement("link");if(n.rel="stylesheet",n.href=e.attrs.stylesheet,a.prepend(n),t){a.classList.add("static");let e=a.getElementsByTagName("td");for(let t=0;t<e.length;t++){let a=e[t];a&&(a.dataset.lineNumber?(a.innerHTML=a.dataset.lineNumber,a.align="right"):(a.align="left",a.innerHTML="<pre>".concat(a.innerHTML,"</pre>")),a.classList.add("content"),a.height="20px")}}return a}},69323:function(e,t,a){"use strict";a.d(t,{$:()=>i,y:()=>l});var n=a(60308),r=a(30548);let i={attrs:{src:{default:""},height:{default:null},width:{default:null},alt:{default:null},title:{default:null}},inline:!0,group:"inline",draggable:!0,toDOM:e=>{let t=(0,n.zF4)(e.attrs.src,1100);return["img",{style:e.attrs.height&&e.attrs.width?"max-width:".concat(e.attrs.width,"px;max-height:").concat(e.attrs.height,"px"):"",src:t,alt:e.attrs.alt,title:e.attrs.title,"data-component-name":"ImageToDOM"}]},toDOMStatic:e=>{if(e.attrs.height&&e.attrs.width){let t=Math.min(e.attrs.width,550),a=(0,n.zF4)(e.attrs.src,t);return["table",{class:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"ImageToDOMStatic"},["tr",{},["td"],["td",{class:"content",width:t}],["td"]],["tr",{},["td"],["td",{align:"left",class:"content",width:t},["img",{src:a,alt:e.attrs.alt,title:e.attrs.title}]],["td"]]]}return["img",{src:(0,n.zF4)(e.attrs.src,550),alt:e.attrs.alt,title:e.attrs.title}]}},l=(0,r.S)({name:"image",nodeSpec:i})},54793:function(e,t,a){"use strict";a.d(t,{$y:()=>g,zk:()=>f});var n=a(7409),r=a(99282),i=a(88897),l=a(76405),o=a(55679),s=a(78718),d=a.n(s),c=a(78532),u=a(57639),m=a(57125);let p=()=>({src:{default:null,keepOnSplit:!1},alt:{default:null,keepOnSplit:!1},title:{default:null,keepOnSplit:!1},href:{default:null,keepOnSplit:!1},width:{default:"100%",keepOnSplit:!1},height:{default:"auto",keepOnSplit:!1},size:{default:"normal",keepOnSplit:!1},align:{default:"center",keepOnSplit:!1}}),h="image3",g={name:h,group:"block",atom:!1,selectable:!0,content:"inline*",draggable:!0,attrs:(0,m.Op)({attrs:p()}),parseDOM:[{tag:"image3",getAttrs:e=>{try{if(e instanceof HTMLElement){let t=e.getAttribute("data-attrs");if(t)return JSON.parse(t)}}catch(e){}return!1}}],toDOM:e=>{var t;let a=!!(null===(t=e.content)||void 0===t?void 0:t.size),r={class:"image3","data-attrs":JSON.stringify((0,n._)({},e.attrs))};return a?["div",["div",r,0]]:["div",r]},toDOMStatic:e=>{var t;let a=!!(null===(t=e.content)||void 0===t?void 0:t.size),i={class:"image3","data-attrs":JSON.stringify((0,r._)((0,n._)({},e.attrs),{isEmail:!0}))};return a?["div",["div",i,0]]:["div",i]}},b=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,f=i.NB.create({name:h,inline:!1,group:"block",content:"inline*",draggable:!0,selectable:!0,isolating:!0,defining:!0,addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>p(),parseHTML:()=>[{tag:'img[src]:not([src^="data:"])',getAttrs:e=>({src:e.getAttribute("src")})},{tag:"image3"},{tag:"p",priority:100,getAttrs:e=>{var t;if(null==e?void 0:null===(t=e.textContent)||void 0===t?void 0:t.trim())return!1;let[a]=Array.from(e.getElementsByTagName("img"));return!!a&&d()((0,u.Nh)(a,null),["src","alt","height","width"])}}],renderHTML(e){let{HTMLAttributes:t}=e;return["image3",(0,i.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{setImage:e=>t=>{let{commands:a}=t,n=e.title?[{type:"text",text:e.title}]:[];try{return a.insertContent({type:this.name,attrs:e,content:n})}catch(e){return!1}},setUnsplashImage:e=>{let{url:t,width:a,height:n,description:r,userName:i,userHref:o}=e;return e=>{let{commands:s,editor:d}=e,c=d.schema.text("Photo by "),u=d.schema.text(i,[d.schema.marks.link.create({title:i,href:o})]),m=d.schema.text(" on "),p=d.schema.text("Unsplash",[d.schema.marks.link.create({title:"Unsplash",href:"https://unsplash.com"})]);return s.insertContent({type:this.name,attrs:{alt:r,src:t,height:n,width:a,type:"image/jpg"},content:l.HY.fromArray([c,u,m,p]).toJSON()})}}}},addNodeView:()=>(0,o.fW)(c._),addInputRules(){return[(0,i.x2)({find:b,type:this.type,getAttributes:e=>{let[,,t,a,n,r,i]=e;return{src:a,type:n,alt:t,title:r,href:i}}})]}})},61601:function(e,t,a){"use strict";a.d(t,{$y:()=>m,hJ:()=>h});var n=a(7409),r=a(6400),i=a(88897),l=a(55679),o=a(81138),s=a(10656),d=a(19520),c=a(30837);let u="image-gallery-embed",m={attrs:{gallery:{default:{}},isEditorNode:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:u,getAttrs:c.Y}],toDOM:e=>{if("undefined"!=typeof window&&e.attrs.isEditorNode)try{e.attrs.isEditor=!0;let t=document.createElement("div");return t.className=u,t.setAttribute("data-attrs",JSON.stringify(e.attrs)),(0,s.G5)((0,r.h)(o.t,{node:(0,n._)({},e)}),t),t}catch(t){return console.error("Error rendering ImageGalleryComponent",t),(0,d.s)({msg:null,node:e,err:t,group:"block"})}return p(e)},toDOMStatic:e=>["div",{class:u,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},e.attrs))}]},p=e=>["div",{class:u,"data-attrs":JSON.stringify(e.attrs)}],h=i.NB.create({name:"imageGallery",group:m.group,draggable:!0,addAttributes:()=>({gallery:{default:{}},isEditorNode:{default:!0}}),parseHTML:()=>[{tag:u}],renderHTML(e){let{HTMLAttributes:t,node:a}=e;return this.options.isStatic&&m.toDOMStatic?m.toDOMStatic(a):["div",(0,n._)({class:u},(0,i.P1)(t))]},addNodeView:()=>(0,l.fW)(o.t),addCommands(){return{insertImageGallery:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})},updateImageGallery:e=>t=>{let{commands:a}=t;return a.updateAttributes(this.name,e)}}}})},29511:function(e,t,a){"use strict";a.d(t,{$p:()=>b,$y:()=>s,Dy:()=>c,o0:()=>d});var n=a(98012),r=a(63651),i=a(30548),l=a(30837);let o=/[@#][\w.]+|\n/g,s={attrs:{instagram_id:{default:""},title:{default:""},author_name:{default:""},thumbnail_url:{default:""},timestamp:{default:""},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.instagram",getAttrs:l.Y}],toDOM:e=>{let t=document.createElement("div");t.className="instagram",t.setAttribute("data-attrs",JSON.stringify(e.attrs)),t.setAttribute("data-component-name","InstagramToDOM");let a=document.createElement("div");a.className="instagram-top-bar",t.appendChild(a);let i=document.createElement("a");i.className="instagram-author-name",i.href=p(e.attrs.author_name),i.target="_blank",i.textContent=e.attrs.author_name,a.appendChild(i);let l=document.createElement("a");l.className="instagram-image",l.href=m(e.attrs.instagram_id),l.target="_blank",t.appendChild(l);let s=document.createElement("img");s.src=(0,r.zF4)(e.attrs.thumbnail_url,640),e.attrs.belowTheFold&&s.setAttribute("loading","lazy"),l.appendChild(s);let d=document.createElement("div");d.className="instagram-bottom-bar",t.appendChild(d);let c=document.createElement("div");if(c.className="instagram-title",function(e,t){let a,n;if(!e)return;let r=0;for(;a=o.exec(e);)switch(r<a.index&&t.appendChild(document.createTextNode(e.substring(r,a.index))),r=a.index+a[0].length,a[0][0]){case"\n":t.appendChild(document.createElement("br"));break;case"@":(n=document.createElement("a")).href=p(a[0].substr(1)),n.target="_blank",n.textContent=a[0],t.appendChild(n);break;case"#":(n=document.createElement("a")).href=h(a[0]),n.target="_blank",n.textContent=a[0],t.appendChild(n);break;default:t.appendChild(document.createTextNode(a[0]))}r<e.length&&t.appendChild(document.createTextNode(e.substr(r)))}(e.attrs.title,c),d.appendChild(c),e.attrs.timestamp){let t=document.createElement("div");t.className="instagram-timestamp",t.textContent=(0,n.Z)(e.attrs.timestamp).format("MMMM D, YYYY"),d.appendChild(t)}return t}},d=(0,i.S)({name:"instagram",nodeSpec:s,addCommands(){return{insertInstagram:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),c=function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t&&!t.nodes.instagram?null:f(e)[1]},u=e=>f(e)[0],m=e=>"https://instagram.com/p/".concat(e),p=e=>"https://instagram.com/".concat(e),h=e=>"https://instagram.com/explore/tags/".concat(e.substr(1),"/"),g=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await t.get("/api/v1/instagram/post/".concat(u(e)))).body},b=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.instagram.create(await g(e))},f=e=>{let t=/(https?:\/\/(?:www\.)?(?:instagram\.com|instagr\.am)\/(?:p|reel|reels)\/([^\/\b\s\?\#]+)[^\s]*)/.exec(e);if(t){var a,n;return[null!==(a=t[2])&&void 0!==a?a:null,null!==(n=t[1])&&void 0!==n?n:null]}return[null,null]}},49640:function(e,t,a){"use strict";a.d(t,{$:()=>m,F:()=>p});var n=a(58865),r=a(60308),i=a(47929),l=a(30548);function o(){let e=(0,n._)(["Get more from "," in the Substack app"]);return o=function(){return e},e}function s(){let e=(0,n._)(["Read "," in the Substack app"]);return s=function(){return e},e}function d(){let e=(0,n._)(["Get more from "," in the Substack app"]);return d=function(){return e},e}function c(){let e=(0,n._)(["Read "," in the Substack app"]);return c=function(){return e},e}let u=e=>(0,r.D4e)({utm_campaign:i.VX.appMarketing,utm_content:i.fZ.authorPostInsert,utm_source:e}),m={attrs:{logo_url:{default:null},publication_name:{default:null},publication_subdomain:{default:null},author_name:{default:null},language:{default:"en"}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.install-substack-app-embed"}],toDOM:e=>{let{logo_url:t,publication_name:a,publication_subdomain:n,author_name:i,language:l}=e.attrs,{iString:d,iTemplate:c}=I18N.i(l);return["div",{class:"install-substack-app-embed install-substack-app-embed-web","data-component-name":"InstallSubstackAppToDOM"},["img",{class:"install-substack-app-embed-img",src:(0,r.zF4)(t)}],["div",{class:"install-substack-app-embed-text"},["div",{class:"install-substack-app-header"},i?c(o(),i):c(s(),a)],["div",{class:"install-substack-app-text"},d("Available for iOS and Android")]],["a",{href:u(n),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},d("Get the app")]]]},toDOMStatic:e=>{let{logo_url:t,publication_name:a,publication_subdomain:n,author_name:i,language:l}=e.attrs,{iString:o,iTemplate:s}=I18N.i(l);return["div",{class:"install-substack-app-embed","data-component-name":"InstallSubstackAppToDOMStatic"},["table",{class:"install-substack-embed-table"},["tr",{},["td",{rowspan:2},["img",{class:"install-substack-app-embed-img",src:(0,r.zF4)(t),width:64,height:64}]],["td",{class:"install-substack-app-header"},i?s(d(),i):s(c(),a)]],["tr",{},["td",{class:"install-substack-app-text"},o("Available for iOS and Android")]],["tr",{},["td",{colspan:2},["a",{href:u(n),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},o("Get the app")]]]]]]}},p=(0,l.S)({name:"install_substack_app",nodeSpec:m,addCommands(){return{insertInstallSubstackAppEmbed:e=>t=>{let{commands:a}=t,n=(0,r.SVA)(e),i={logo_url:e.logo_url||"".concat(n,"/img/substack.png"),publication_name:e.name,language:e.language,author_name:e.author_name,publication_subdomain:e.subdomain};return a.insertContent({type:this.name,attrs:i})}}}})},99975:function(e,t,a){"use strict";a.d(t,{$y:()=>s,aI:()=>m,j7:()=>d,lA:()=>c});var n=a(60308),r=a(30548),i=a(30837);let l=/https?:\/\/read\.amazon(?:\.co)?\.[a-z]+\/kp\/(?:embed|card)\?asin=([^&#\s\b'"]+)[^\b\s'"]*/i,o=[RegExp('<iframe[^>]+src="'.concat(l.source,'"[^>]*><\\/iframe>'),"i"),l],s={attrs:{kindleId:{default:""},imageUrl:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.kindle-wrap",getAttrs:i.Y}],toDOM:e=>{let t=p(e.attrs.kindleId);return["div",{class:"kindle-wrap","data-attrs":JSON.stringify(e.attrs),"data-component-name":"KindleToDOM"},["iframe",{src:t,frameborder:"0",gesture:"media",allow:"autoplay; fullscreen",allowautoplay:"true",allowfullscreen:"true"}]]},toDOMStatic:e=>["table",{class:"kindle-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"KindleToDOMStatic"},["tr",{},["td"],["td",{align:"left",class:"content",width:200},["a",{class:"image-link",target:"_blank",href:h(e.attrs.kindleId)},["img",{"data-attrs":JSON.stringify(e.attrs),alt:"",width:"".concat(200),class:"wide-image",src:(0,n.zF4)(e.attrs.imageUrl,400)}]]],["td"]]]},d=(0,r.S)({name:"kindle",nodeSpec:s,addCommands(){return{insertKindle:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),c=e=>{for(let t of o){let a=t.exec(e);if(a)return a[0]}return null},u=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await t.get("/api/v1/kindle").query({embedText:e})).body},m=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.kindle.create(await u(e))},p=e=>(0,n.n1t)("https://read.amazon.com/kp/card",{asin:e,preview:"inline",linkCode:"kpe",hideShare:"true"}),h=e=>"https://www.amazon.com/gp/product/".concat(e,"/")},41128:function(e,t,a){"use strict";a.d(t,{$y:()=>p,Jd:()=>b,Ox:()=>m,qs:()=>h});var n=a(27412),r=a(7409),i=a(99282),l=a(6400),o=a(55679),s=a(81924),d=a(19520),c=a(30548),u=a(30837);let m=()=>{let e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=t.length;for(let n=0;n<10;n++)e+=t.charAt(Math.floor(Math.random()*a));return e},p={content:"text*",group:"block",code:!0,defining:!0,isolating:!0,attrs:{persistentExpression:{default:""},id:{default:""}},parseDOM:[{tag:"pre.text",preserveWhitespace:"full",priority:60},{tag:"div.latexWrapper",getAttrs:u.Y}],toDOM:e=>["div",{class:"latex-rendered","data-attrs":JSON.stringify((0,r._)({},e.attrs)),"data-component-name":"LatexBlockToDOM"}],toDOMStatic:e=>["div",{class:"latex-rendered","data-attrs":JSON.stringify((0,i._)((0,r._)({},e.attrs),{isEmail:!0})),"data-component-name":"LatexBlockToDOMStatic"}]},h=(0,c.S)({name:"latex_block",nodeSpec:p,addCommands(){return{insertLatex:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}},addNodeView:()=>(0,o.fW)(s.w)}),g=e=>{try{let t=document.createElement("span");t.className="latex-rendered";let a=m(),n=null==e?void 0:e.attrs.persistentExpression;return(0,l.render)((0,l.h)(s.w,{persistentExpression:n,node:e,id:a}),t),t}catch(t){return console.error("Error rendering LatexComponent",t),(0,d.s)({msg:null,node:e,err:t,group:"block"})}};class b{constructor(e){(0,n._)(this,"dom",void 0),e.updateExpression=t=>{e.attrs=(0,i._)((0,r._)({},e.attrs),{persistentExpression:t}),e.attrs.dirty=!0},this.dom=g(e)}}},23431:function(e,t,a){"use strict";a.d(t,{$1:()=>h,$y:()=>l,CA:()=>d,Ee:()=>u,eK:()=>o});var n=a(27412),r=a(60308),i=a(30548);let l={attrs:{url:{default:""},thumbnail_url:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.lichess-wrap",getAttrs:a(30837).Y}],toDOM:e=>p(e),toDOMStatic:e=>m(e)},o=(0,i.S)({name:"lichess",nodeSpec:l,addCommands(){return{insertLichess:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),s=/^.*(https?\:\/\/(\S+)?(?:(.?lichess.org\/.*).*)).*$/,d=e=>{let t=s.exec(e);return t&&t[0]},c=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await t.get("/api/v1/lichess-embed").query({url:e.trim()})).body},u=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.lichess.create(await c(e))},m=function(e){let{}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=document.createElement("div");t.className="lichess-wrap static",t.setAttribute("data-component-name","LichessToDOMStatic");let a=document.createElement("a");a.href=e.attrs.url.replace(/embed\//,""),a.setAttribute("target","_blank");let n=document.createElement("img");return n.className="lichess-wrap thumbnail",n.src=(0,r.zF4)(e.attrs.thumbnail_url,640),n.style.backgroundImage="url(".concat(e.attrs.thumbnail_url,")"),e.attrs.belowTheFold&&n.setAttribute("loading","lazy"),a.append(n),t.appendChild(a),t},p=e=>{let t=document.createElement("div");t.id="lichess-iframe",t.className="lichess-wrap outer",t.dataset.attrs=JSON.stringify(e.attrs),t.setAttribute("data-component-name","LichessToDOM");let a=document.createElement("iframe");return a.id="iframe-lichess",a.className="lichess-iframe",a.src=e.attrs.url,a.width="560",a.height="405px",a.frameBorder="0",e.attrs.belowTheFold&&a.setAttribute("loading","lazy"),t.appendChild(a),t};class h{constructor(e){(0,n._)(this,"dom",void 0);let t=p(e),a=t.querySelector(".lichess-iframe"),r=document.createElement("div");r.className="lichess-screen",r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),t.appendChild(r),this.dom=t}}},73078:function(e,t,a){"use strict";a.d(t,{$:()=>c,U:()=>u});var n=a(6400),r=a(10656),i=a(55706),l=a(60308),o=a(63651),s=a(19520),d=a(30548);let c={attrs:{name:{default:""},avatarUrl:{default:""},url:{default:""},isEditorNode:{default:!1}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.meeting-embed",getAttrs:a(30837).Y}],toDOM:e=>{if("undefined"!=typeof window&&e.attrs.isEditorNode)try{let t=document.createElement("div");return t.className="meeting-embed",t.setAttribute("data-attrs",JSON.stringify(e.attrs)),(0,r.G5)((0,n.h)(i.R,{name:e.attrs.name,avatarUrl:e.attrs.avatarUrl,url:e.attrs.url}),t),t}catch(t){return console.error("Error rendering MeetingEmbed",t),(0,s.s)({msg:null,node:e,err:t,group:"block"})}return m(e)},toDOMStatic:e=>m(e)},u=(0,d.S)({name:"meeting",nodeSpec:c,addCommands:()=>({insertMeeting:e=>t=>{let{commands:a,dispatch:n}=t,{publication:r,meetingsConfig:i,usePublicationName:s}=e,d=(0,l.SMH)({id:i.user_id,photo_url:i.user_profile_photo_url});return s&&r.logo_url&&(d=(0,o.zF4)(r.logo_url,112)),!n||a.insertContent({type:"meeting",attrs:{name:s?r.name:i.user_name,avatarUrl:d,url:(0,o.szv)(r,{addBase:!0,params:{source:"embed"}}),isEditorNode:!0}})}})}),m=e=>["div",{class:"meeting-embed","data-attrs":JSON.stringify(e.attrs),"data-component-name":"MeetingPlaceholder"}]},85197:function(e,t,a){"use strict";a.d(t,{$:()=>c,H:()=>u});var n=a(7409),r=a(99282),i=a(6400),l=a(3258),o=a(10656),s=a(19520),d=a(30548);let c={attrs:{name:{default:""},id:{default:null},type:{default:null},url:{default:null},photo_url:{default:null},uuid:{default:null}},atom:!0,editable:!1,selectable:!0,isolating:!1,defining:!0,draggable:!1,inline:!0,group:"inline",parseDOM:[{tag:".mention-wrap",getAttrs:e=>{try{return JSON.parse(e.getElementsByTagName("a")[0].getAttribute("data-attrs"))}catch(e){return!1}}}],toDOM:e=>{if("undefined"!=typeof window)try{var t;let a=document.createElement("span");return a.className="mention-wrap",a.setAttribute("data-attrs",JSON.stringify(e.attrs)),(0,o.G5)((0,i.h)(l.ZP,{name:(null===(t=e.attrs.name)||void 0===t?void 0:t.trim())||"",id:e.attrs.id||null,type:e.attrs.type||null,url:e.attrs.url||null,photo_url:e.attrs.photo_url||null,uuid:e.attrs.uuid||null,isEditorContext:!0}),a),a}catch(t){return console.error("Error rendering Mention",t),(0,s.s)({msg:null,node:e,err:t,group:"inline"})}return["span",{class:"mention-wrap","data-attrs":JSON.stringify(e.attrs),"data-component-name":"MentionToDOM"}]},toDOMStatic:e=>["span",{class:"mention-wrap","data-attrs":JSON.stringify((0,r._)((0,n._)({},e.attrs),{isStatic:!0})),"data-component-name":"MentionToDOMStatic"}]},u=(0,d.S)({name:"substack_mentions",nodeSpec:c})},53797:function(e,t,a){"use strict";a.d(t,{$y:()=>s,YT:()=>g,q:()=>d,vt:()=>p,zb:()=>b});var n=a(80569),r=a.n(n),i=a(60308),l=a(84864),o=a(30548);let s={attrs:{collection:{default:""},collection_slug:{default:""},creator:{default:""},description:{default:""},image_url:{default:""},name:{default:""},animation_url:{default:""},nft_logo_url:{default:""},permalink:{default:""},youtube_url:{default:null},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.opensea",getAttrs:a(30837).Y}],toDOMStatic:function(e){let t=document.createElement("div");t.className="opensea static",t.setAttribute("data-component-name","OpenseaToDOMStatic");let a=document.createElement("table");a.className="opensea-header-table";let n=document.createElement("tr");n.className="opensea-header-row";let r=document.createElement("tr"),o=document.createElement("td"),s=document.createElement("a");s.className="opensea-title",e.attrs.permalink&&s.setAttribute("href",e.attrs.permalink),s.textContent=e.attrs.name,o.appendChild(s),r.appendChild(s);let d=document.createElement("tr"),c=document.createElement("td"),u=document.createElement("a");u.className="opensea-collection",e.attrs.collection_slug&&u.setAttribute("href","https://opensea.io/collection/".concat(e.attrs.collection_slug)),u.textContent=(0,l.truncateText)(e.attrs.collection,50),c.appendChild(u),d.appendChild(c);let m=document.createElement("td"),p=document.createElement("table");m.className="opensea-masthead",p.appendChild(r),p.appendChild(d),m.appendChild(p);let h=document.createElement("td");h.className="nft-logo";let g=document.createElement("a"),b=document.createElement("img");e.attrs.nft_logo_url&&b.setAttribute("src",(0,i.zF4)(e.attrs.nft_logo_url)),e.attrs.permalink&&g.setAttribute("href",e.attrs.permalink),e.attrs.belowTheFold&&g.setAttribute("loading","lazy"),g.appendChild(b),h.appendChild(g),n.appendChild(m),n.appendChild(h),a.appendChild(n);let f=document.createElement("a");e.attrs.permalink&&f.setAttribute("href",e.attrs.permalink);let v=document.createElement("img");v.className="opensea-image",e.attrs.image_url&&v.setAttribute("src",(0,i.zF4)(e.attrs.image_url,600,{crop:"fill"})),v.setAttribute("alt",e.attrs.name),v.setAttribute("width","500"),e.attrs.belowTheFold&&v.setAttribute("loading","lazy"),f.appendChild(v);let y=document.createElement("table");y.className="opensea-footer-table";let _=document.createElement("tr"),w=document.createElement("td");w.className="opensea-description",w.textContent=(0,l.truncateText)(e.attrs.description,200),_.appendChild(w);let Z=document.createElement("tr"),C=document.createElement("td"),k=document.createElement("a");C.className="opensea-creator",e.attrs.creator&&k.setAttribute("href","https://opensea.io/".concat(e.attrs.creator,"?tab=created")),k.textContent="Created by ".concat((0,l.truncateText)(e.attrs.creator,50)),C.appendChild(k),Z.appendChild(C);let S=document.createElement("tr"),E=document.createElement("td"),N=document.createElement("a"),x=document.createElement("table"),O=document.createElement("tr"),M=document.createElement("td");return N.className="opensea-cta-link",e.attrs.permalink&&N.setAttribute("href",e.attrs.permalink),x.setAttribute("cellspacing","16"),x.className="opensea-cta-table",M.className="opensea-cta",M.textContent="View on OpenSea",O.appendChild(M),x.appendChild(O),N.appendChild(x),E.appendChild(N),S.appendChild(E),e.attrs.description&&y.appendChild(_),y.appendChild(Z),y.appendChild(S),t.appendChild(a),t.appendChild(f),t.appendChild(y),t.querySelectorAll&&Array.prototype.forEach.call(t.querySelectorAll("a"),e=>{e.target="_blank"}),t},toDOM:function(e){let t,a;let n=document.createElement("div");n.className="opensea",n.setAttribute("data-component-name","OpenseaToDOM");let r=document.createElement("a");r.className="opensea-title",e.attrs.permalink&&r.setAttribute("href",e.attrs.permalink),r.textContent=e.attrs.name;let o=document.createElement("a");o.className="opensea-collection",e.attrs.collection_slug&&o.setAttribute("href","https://opensea.io/collection/".concat(e.attrs.collection_slug)),o.textContent=(0,l.truncateText)(e.attrs.collection,50);let s=document.createElement("div");s.className="opensea-masthead",s.appendChild(r),s.appendChild(o);let d=document.createElement("a");e.attrs.permalink&&d.setAttribute("href",e.attrs.permalink);let c=document.createElement("img");e.attrs.nft_logo_url&&c.setAttribute("src",(0,i.zF4)(e.attrs.nft_logo_url)),e.attrs.belowTheFold&&c.setAttribute("loading","lazy"),d.appendChild(c);let u=document.createElement("div");u.className="opensea-header",u.appendChild(s),u.appendChild(d);let m=document.createElement("a");e.attrs.permalink&&m.setAttribute("href",e.attrs.permalink),m.className="opensea-media-link";let p=["mp3","wav","oga"].some(t=>{var a;return null===(a=e.attrs.animation_url)||void 0===a?void 0:a.endsWith(t)}),h=["gltf","glb","webm","mp4","m4v","ogv","ogg"].some(t=>{var a;return null===(a=e.attrs.animation_url)||void 0===a?void 0:a.endsWith(t)}),g=!e.attrs.animation_url,b=e.attrs.animation_url&&!p&&!h;(g||p||b||e.attrs.youtube_url)&&((a=document.createElement("img")).className="opensea-image",e.attrs.image_url&&a.setAttribute("src",(0,i.zF4)(e.attrs.image_url,600,{crop:"fill"})),e.attrs.belowTheFold&&a.setAttribute("loading","lazy"),a.setAttribute("alt",e.attrs.name),m.appendChild(a)),(p||h)&&((t=document.createElement(p?"audio":"video")).className="opensea-player",t.setAttribute("controls",!0),t.setAttribute("loop",!0),t.setAttribute("src",e.attrs.animation_url),t.setAttribute("alt","OpenSea NFT media"),e.attrs.belowTheFold&&t.setAttribute("loading","lazy")),a&&m.appendChild(a),t&&m.appendChild(t);let f=document.createElement("div");f.className="opensea-description",f.textContent=(0,l.truncateText)(e.attrs.description,200);let v=document.createElement("a");v.className="opensea-creator",e.attrs.creator&&v.setAttribute("href","https://opensea.io/".concat(e.attrs.creator,"?tab=created")),v.textContent="Created by ".concat((0,l.truncateText)(e.attrs.creator,50));let y=document.createElement("a");y.className="opensea-cta",e.attrs.permalink&&y.setAttribute("href",e.attrs.permalink),y.textContent="View on OpenSea";let _=document.createElement("div");return _.className="opensea-footer",e.attrs.description&&_.appendChild(f),_.appendChild(v),_.appendChild(y),n.appendChild(u),n.appendChild(m),n.appendChild(_),n.querySelectorAll&&Array.prototype.forEach.call(n.querySelectorAll("a"),e=>{e.target="_blank"}),n}},d=(0,o.S)({name:"opensea",nodeSpec:s,addCommands(){return{insertOpensea:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),c=e=>{var t,a,n;return null===(n=(0,i.en2)(e))||void 0===n?void 0:null===(a=n.pathname.match(/assets\/(ethereum\/)?(.+)/))||void 0===a?void 0:null===(t=a[2])||void 0===t?void 0:t.split("/")[0]},u=e=>{var t,a,n;return null===(n=(0,i.en2)(e))||void 0===n?void 0:null===(a=n.pathname.match(/assets\/(ethereum\/)?(.+)/))||void 0===a?void 0:null===(t=a[2])||void 0===t?void 0:t.split("/")[1]},m=async e=>(await r().get("/api/v1/opensea").query({contract:c(e),token_id:u(e)})).body,p=async(e,t)=>{let{customSchema:a}=t;return a.nodes.opensea.create(await m(e))},h=/^https:\/\/opensea.io\/assets\/.+/,g=e=>{let t=h.exec(e);return t&&t[0]},b=e=>null!==g(e)},8220:function(e,t,a){"use strict";a.d(t,{$u:()=>m,$y:()=>u,Yi:()=>h,pR:()=>b});var n=a(6400),r=a(12277),i=a(10656),l=a(60308),o=a(19520),s=a(30548),d=a(30837);let c="pinterest-embed",u={attrs:{url:{default:""},thumbnail_url:{default:""},title:{default:""},author_name:{default:""},author_url:{default:""},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.pinterest-embed-wrap",getAttrs:d.Y}],toDOM:e=>v(e),toDOMStatic:e=>f(e)},m=(0,s.S)({name:"pinterest",nodeSpec:u,addCommands(){return{insertPinterest:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),p=/^https?:\/\/(?:(?:www\.)?pinterest\.com\/(?:pin\/[^/]+|[^/]+\/[^/]+)|pin\.it\/[^/]+)\/?.*$/,h=e=>{let t=p.exec(e);return t&&t[0]},g=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await t.get("/api/v1/pinterest-embed").query({url:e.trim()})).body},b=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema;if(!n.nodes.pinterest)throw Error("Pinterest node type not found in schema");return n.nodes.pinterest.create(await g(e))},f=e=>{let t=e.attrs.url||"",a=350,n=350,r=350,i=350;return e.attrs.thumbnail_url?e.attrs.width&&e.attrs.height?(a=e.attrs.width,i=Math.round((n=e.attrs.height)*(r=Math.min(a,l.bxL))/a),["table",{className:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"PinterestToDOMStatic"},["tr",{},["td",{}],["td",{align:"left",className:"content",width:String(r)},["a",{className:"image-link",target:"_blank",href:t},["img",{"data-attrs":JSON.stringify(e.attrs),alt:e.attrs.title||"Pinterest Pin",title:e.attrs.title||"Pinterest Pin",width:String(r),height:String(i),className:a>l.bxL?"wide-image":"",src:(0,l.zF4)(e.attrs.thumbnail_url,2*Math.min(a,l.bxL)),loading:e.attrs.belowTheFold?"lazy":null}]]],["td",{}]],["tr",{},["td",{}],["td",{align:"center"},["figcaption",{className:"image-caption",style:"box-sizing: content-box;color: #777777;font-size: 14px;line-height: 20px;font-weight: 400;letter-spacing: -.15px;margin-top: 8px;width: 70%;padding-left: 15%;padding-right: 15%;text-align: center;"},["a",{href:e.attrs.url||"#",target:"_blank",style:"color: inherit; text-decoration: none;"},e.attrs.title||"View on Pinterest"]]],["td",{}]]]):["table",{className:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"PinterestToDOMStatic"},["tr",{},["td",{}],["td",{align:"left",className:"content",width:String(350)},["a",{className:"image-link",target:"_blank",href:t},["img",{"data-attrs":JSON.stringify(e.attrs),alt:e.attrs.title||"Pinterest Pin",title:e.attrs.title||"Pinterest Pin",src:(0,l.zF4)(e.attrs.thumbnail_url,2*l.bxL),loading:e.attrs.belowTheFold?"lazy":null}]]],["td",{}]],["tr",{},["td",{}],["td",{align:"center"},["figcaption",{class:"image-caption",style:"box-sizing: content-box;color: #777777;font-size: 14px;line-height: 20px;font-weight: 400;letter-spacing: -.15px;margin-top: 8px;width: 70%;padding-left: 15%;padding-right: 15%;text-align: center;"},["a",{href:e.attrs.url||"#",target:"_blank",style:"color: inherit; text-decoration: none;"},e.attrs.title||"View on Pinterest"]]],["td",{}]]]:["table",{className:"image-wrapper pinterest-text-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"PinterestToDOMStatic"},["tr",{},["td",{}],["td",{align:"left",className:"content",width:String(350)},["a",{className:"image-link pinterest-text-link",target:"_blank",href:t},["div",{className:"pinterest-fallback-text",style:"padding: 10px; border: 1px solid #e8e8e8; border-radius: 4px; text-align: center;"},["div",{className:"pinterest-identifier",style:"font-weight: bold; margin-bottom: 5px;"},"Pinterest"],["span",{style:"display: block;"},["a",{href:e.attrs.url||"#",target:"_blank",style:"color: inherit; text-decoration: none;"},e.attrs.title||"View on Pinterest"]],e.attrs.author_name?["span",{className:"pinterest-author",style:"display: block; margin-top: 8px; font-size: 0.9em; color: #666;"},"By ".concat(e.attrs.author_name)]:null]]],["td",{}]]]},v=e=>{if("undefined"!=typeof window)try{let t=document.createElement("div");return t.setAttribute("data-attrs",JSON.stringify(e.attrs)),t.className=c,t.setAttribute("data-component-name","PinterestNodeWrapper"),(0,i.G5)((0,n.h)(r.M,{attrs:e.attrs}),t),t}catch(t){return console.error("Error rendering PinterestNode:",t),(0,o.s)({msg:"Error rendering Pinterest embed",node:e,err:t,group:"block"})}let t=document.createElement("div");t.className="".concat(c," pinterest-ssr-fallback"),t.setAttribute("data-attrs",JSON.stringify(e.attrs)),t.setAttribute("data-component-name","PinterestToDOMPreact");let a=document.createElement("p");return a.textContent="Loading Pinterest Pin...",t.appendChild(a),t}},18119:function(e,t,a){"use strict";a.d(t,{$:()=>u,x:()=>m});var n=a(7409),r=a(6400),i=a(78435),l=a(10656),o=a(19520),s=a(30548),d=a(30837);let c="poll-embed",u={attrs:{id:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:c,getAttrs:d.Y}],toDOM:e=>{if("undefined"!=typeof window)try{let t=document.createElement("div");return t.setAttribute("data-attrs",JSON.stringify(e.attrs)),t.className=c,(0,l.G5)((0,r.h)(i.n_,{id:e.attrs.id,isEditor:!0}),t),t}catch(t){return console.error("Error rendering Poll",t),(0,o.s)({msg:null,node:e,err:t,group:"block"})}return["div",{class:c,"data-attrs":JSON.stringify(e.attrs),"data-component-name":"PollToDOM"}]},toDOMStatic:e=>["div",{class:c,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},e.attrs)),"data-component-name":"PollToDOMStatic"}]},m=(0,s.S)({name:"poll",nodeSpec:u,addCommands(){return{insertPoll:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}})},44288:function(e,t,a){"use strict";a.d(t,{$y:()=>l,Gd:()=>c,OR:()=>s,eC:()=>g,kY:()=>o,sv:()=>m});var n=a(27412),r=a(60308),i=a(30548);let l={attrs:{url:{default:""},thumbnail_url:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.prediction-market-wrap",getAttrs:a(30837).Y}],toDOM:e=>h(e),toDOMStatic:e=>p(e)},o=(0,i.S)({name:"prediction_market",nodeSpec:l,addCommands(){return{insertPredictionMarket:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),s=(0,i.S)({name:"manifold",nodeSpec:l}),d=/^.*(https?:\/\/(\S+)?(?:(.?manifold\.markets|metaculus\.com\/questions\/.*\/|polymarket\.com\/event\/[^\/]+(\/[^\/]+)?))).*$/,c=e=>{let t=d.exec(e);return t&&t[0]},u=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await t.get("/api/v1/prediction-embed").query({url:e.trim()})).body},m=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.prediction_market.create(await u(e))},p=function(e){let{}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=document.createElement("div");t.className="prediction-market-wrap static",t.setAttribute("data-component-name","PredictionMarketToDOMStatic");let a=document.createElement("a");a.href=e.attrs.url.replace(/embed\//,""),a.setAttribute("target","_blank");let n=document.createElement("img");return n.className="prediction-market thumbnail",n.src=(0,r.zF4)(e.attrs.thumbnail_url,640),n.style.backgroundImage="url(".concat(e.attrs.thumbnail_url,")"),e.attrs.belowTheFold&&n.setAttribute("loading","lazy"),a.append(n),t.appendChild(a),t},h=e=>{let t=document.createElement("div"),a=e.attrs.url.includes("polymarket");t.id="prediction-market-iframe",t.className="prediction-market-wrap outer",t.dataset.attrs=JSON.stringify(e.attrs),t.setAttribute("data-component-name","PredictionMarketToDOM");let n=document.createElement("iframe");return n.id="iframe-prediction-market",n.className="prediction-market-iframe",n.src=e.attrs.url,n.width=a?"400px":"560px",n.height=a?"180px":"405px",n.frameBorder="0",e.attrs.belowTheFold&&n.setAttribute("loading","lazy"),t.appendChild(n),t};class g{constructor(e){(0,n._)(this,"dom",void 0);let t=h(e),a=t.querySelector(".prediction-market-iframe"),r=document.createElement("div");r.className="prediction-market-screen",r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),t.appendChild(r),this.dom=t}}},13938:function(e,t,a){"use strict";a.d(t,{$:()=>r,T:()=>i});var n=a(30548);let r={content:"text*",group:"block",code:!0,defining:!0,isolating:!0,attrs:{params:{default:""},language:{default:"en"}},parseDOM:[{tag:"pre.text",preserveWhitespace:"full",priority:60}],toDOM:()=>{var e,t,a;let{iString:n}=I18N.i("undefined"!=typeof window&&null!==(a=null===(t=window._preloads)||void 0===t?void 0:null===(e=t.pub)||void 0===e?void 0:e.language)&&void 0!==a?a:"en");return["div",{class:"preformatted-block","data-component-name":"PreformattedTextBlockToDOM"},["label",{class:"hide-text",contenteditable:!1},n("Text within this block will maintain its original spacing when published")],["pre",{class:"text"},0]]},toDOMStatic:()=>["pre",{class:"text","data-component-name":"PreformattedTextBlockToDOMStatic"},0]},i=(0,n.S)({name:"preformatted_text_block",nodeSpec:r})},54757:function(e,t,a){"use strict";a.d(t,{$:()=>i,t:()=>l});var n=a(60308),r=a(30548);let i={attrs:{pub:{default:null},uuid:{default:null}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.install-substack-app-embed.preview-inapp"}],toDOM:e=>{let{pub:t,uuid:a}=e.attrs,{iString:r}=I18N.i({pub:t}),i="object"==typeof t?(0,n.SVA)(t):(0,n.SVA)({id:t}),l=t.logo_url||"".concat(i,"/img/substack.png");return["div",{class:"install-substack-app-embed preview-inapp","data-component-name":"PreviewInSubstackAppToDOM"},["img",{class:"install-substack-app-embed-img",src:(0,n.zF4)(l)}],["div",{class:"install-substack-app-embed-text"},["div",{class:"install-substack-app-header"},r("Test in the Substack app")],["div",{class:"install-substack-app-text"},r("This section is only visible to you")]],["a",{href:(0,n.uyd)(t,a),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},r("Open in app")]]]},toDOMStatic:e=>{let{pub:t,uuid:a}=e.attrs,{iString:r}=I18N.i({pub:t}),i="object"==typeof t?(0,n.SVA)(t):(0,n.SVA)({id:t}),l=t.logo_url||"".concat(i,"/img/substack.png");return["div",{class:"install-substack-app-embed preview-inapp","data-component-name":"PreviewInSubstackAppToDOMStatic"},["table",{class:"install-substack-embed-table"},["tr",{},["td",{rowspan:2},["img",{class:"install-substack-app-embed-img",src:(0,n.zF4)(l),width:64,height:64}]],["td",{class:"install-substack-app-header"},r("Test in the Substack app")]],["tr",{},["td",{class:"install-substack-app-text"},r("This section is only visible to you")]],["tr",{},["td",{colspan:2},["a",{href:(0,n.uyd)(t,a),target:"_blank",class:"install-substack-app-embed-link"},["button",{class:"install-substack-app-embed-btn button primary"},r("Open in app")]]]]]]}},l=(0,r.S)({name:"preview_in_substack_app",nodeSpec:i})},11006:function(e,t,a){"use strict";a.d(t,{$:()=>r,z:()=>i});var n=a(88897);let r={content:"block+",group:"block",defining:!0,parseDOM:[{tag:"q"},{tag:"div.pullquote"}],toDOM:()=>["div",{class:"pullquote"},0]},i=n.NB.create({name:"pullquote",defining:!0,content:r.content,group:r.group,renderHTML:e=>r.toDOM(e.node),parseHTML:()=>r.parseDOM,addCommands(){return{setPullquote:()=>e=>{let{state:t,commands:a}=e;return!(!(0,n.Ig)(t,"paragraph")||(0,n.Ig)(t,"blockquote"))&&a.wrapIn(this.name)},togglePullquote:()=>e=>{let{state:t,commands:a}=e;return!(!(0,n.Ig)(t,"paragraph")||(0,n.Ig)(t,"blockquote"))&&a.toggleWrap(this.name)},unsetPullquote:()=>e=>{let{commands:t}=e;return t.lift(this.name)}}}})},11470:function(e,t,a){"use strict";a.d(t,{$:()=>h,v:()=>g});var n=a(7409),r=a(6400),i=a(88897),l=a(55679),o=a(89716),s=a(10656),d=a(8072),c=a(19520),u=a(30548),m=a(30837);let p="recipe-embed",h={attrs:{id:{default:null}},group:"block",draggable:!1,atom:!1,selectable:!1,isolating:!1,defining:!1,parseDOM:[{tag:p,getAttrs:m.Y}],toDOM:e=>{if("undefined"!=typeof window)try{let t=document.createElement("div");return t.setAttribute("data-attrs",JSON.stringify(e.attrs)),t.setAttribute("data-component-name","RecipeToDOM"),t.className=p,(0,s.G5)((0,r.h)(o.k,{node:{attrs:{id:e.attrs.id}}}),t),t}catch(t){return console.error("Error rendering RecipeNode",t),(0,c.s)({msg:null,node:e,err:t,group:"block"})}return["div",{class:p,"data-attrs":JSON.stringify(e.attrs),"data-component-name":"RecipeToDOM"}]},toDOMStatic:e=>["div",{class:p,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},e.attrs)),"data-component-name":"RecipeToDomStatic"}],renderHTML(e){let{HTMLAttributes:t}=e;return["recipe",(0,i.P1)(this.options.HTMLAttributes,t)]},parseHTML:()=>[{tag:"recipe"}],addNodeView:()=>(0,l.fW)(d.C)},g=(0,u.S)({name:"recipe",nodeSpec:h,addCommands(){return{insertRecipe:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}})},66928:function(e,t,a){"use strict";a.d(t,{$:()=>i,b:()=>l});var n=a(60826),r=a(30548);let i={attrs:{name:{default:null},subdomain:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.referral-link",getAttrs:a(30837).Y}],toDOM:e=>{let t=e.attrs.name||"".concat(e.attrs.subdomain,".substack.com"),a=document.createElement("div");a.className="referral-link",a.setAttribute("data-attrs",JSON.stringify(e.attrs)),a.setAttribute("data-component-name","ReferralLinkToDOM");let r=document.createElement("h4");a.appendChild(r);let i=document.createElement("a");i.textContent=n.W.PRINTED_REFERRAL_URL,i.href="http://".concat(n.W.REFERRAL_URL),r.appendChild(i),i.addEventListener("click",e=>{if(i.href.endsWith("%%")){e.preventDefault();let t=window.open("/?referral_code=test&showWelcome=true","_blank");t&&t.focus&&t.focus()}});let l=document.createElement("a");return l.className="button primary",l.textContent="Share your referral link",l.href="mailto:?subject=".concat(encodeURIComponent("Check out ".concat(t)),"&body=").concat(encodeURIComponent("Subscribe using my link: "),"http://").concat(n.W.REFERRAL_URL),a.appendChild(l),a}},l=(0,r.S)({name:"referral_link",nodeSpec:i})},19805:function(e,t,a){"use strict";a.d(t,{$y:()=>d,ym:()=>c});var n=a(7409),r=a(6400),i=a(84881),l=a(10656),o=a(19520),s=a(30548);let d={attrs:{isEditorNode:{default:!1},numReferralsRequired:{default:null},rewardDescription:{default:null},pub:{default:{}},tierNumber:{default:null}},atom:!0,content:"",isolating:!1,defining:!1,group:"block",parseDOM:[{getAttrs:a(30837).Y,tag:".referrals-tier-card"}],toDOM:e=>{if("undefined"!=typeof window)try{let t=document.createElement("div");return t.className="referrals-tier-card",t.setAttribute("data-attrs",JSON.stringify(e.attrs)),(0,l.G5)((0,r.h)(i.y,{numReferralsRequired:e.attrs.numReferralsRequired,rewardDescription:e.attrs.rewardDescription,pub:m(e.attrs.pub),tierNumber:e.attrs.tierNumber}),t),t}catch(t){return console.error("Error rendering ReferralsTierCardComponent",t),(0,o.s)({msg:null,node:e,err:t,group:"block"})}return u(e)},toDOMStatic:e=>u(e)},c=(0,s.S)({name:"referralTier",nodeSpec:d}),u=e=>["div",{class:"referrals-tier-card","data-attrs":JSON.stringify(e.attrs),"data-component-name":"ReferralsTierCardPlaceholder"}],m=e=>{let t=(0,n._)({},e);return delete t.email_render_elements,t}},46393:function(e,t,a){"use strict";a.d(t,{$y:()=>o,SH:()=>d,kb:()=>u,uJ:()=>s});var n=a(7409),r=a(60308),i=a(15233),l=a(30548);let o={attrs:{url:{default:""},title:{default:""},description:{default:""},thumbnail_url:{default:""},author_name:{default:""},author_url:{default:""},targetUrl:{default:""}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.soundcloud-wrap",getAttrs:a(30837).Y}],toDOM:e=>["div",{class:"soundcloud-wrap","data-attrs":JSON.stringify(e.attrs),"data-component-name":"SoundcloudToDOM"},["iframe",{src:(0,r.rhs)("https://w.soundcloud.com/player/?auto_play=false&buying=false&liking=false&download=false&sharing=false&show_artwork=true&show_comments=false&show_playcount=false&show_user=true&hide_related=true&visual=false&start_track=0",{url:e.attrs.url}),frameborder:"0",gesture:"media",scrolling:"no",allowfullscreen:"true"}]],toDOMStatic:e=>{let{thumbnail_url:t,author_name:a,title:n,targetUrl:r}=e.attrs;return(0,i.L)(t,n,a,null,{targetUrl:r})}},s=(0,l.S)({name:"soundcloud",nodeSpec:o,addCommands(){return{insertSoundcloud:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),d=function(e){var t;let{customSchema:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a&&!a.nodes.soundcloud)return null;let n=/^.*(https?\:\/\/(www\.)?soundcloud.com\/[^\/]+\/[^\/]+(\/[^\/]+)?(\?[\#]*)?(\#.*)?).*$/.exec(e);return null!==(t=n&&n[1])&&void 0!==t?t:null},c=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default,r=(await t.get("/api/v1/soundcloud").query({url:e.trim()})).body;return(0,n._)({targetUrl:e.trim()},r)},u=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.soundcloud.create(await c(e))}},2107:function(e,t,a){"use strict";a.d(t,{$:()=>u,a:()=>m});var n=a(7409),r=a(6400),i=a(13693),l=a(10656),o=a(19520),s=a(30548),d=a(30837);let c="sponsorship-campaign-embed",u={attrs:{id:{default:null},pub:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:c,getAttrs:d.Y}],toDOM:e=>{if("undefined"!=typeof window){var t;let a=null===(t=window._preloads)||void 0===t?void 0:t.pub,n=null==a?void 0:a.sponsorshipCampaigns;if(!n)return["div",{class:c,"data-attrs":JSON.stringify(e.attrs),"data-component-name":"SponsorshipCampaignToDOM",text:"Sponsorship campaign not found"}];let s=n[e.attrs.id];if(!s)return["div",{class:c,"data-attrs":JSON.stringify(e.attrs),"data-component-name":"SponsorshipCampaignToDOM",text:"Sponsorship campaign not found"}];try{let t=document.createElement("div");return t.setAttribute("data-attrs",JSON.stringify(e.attrs)),t.className=c,(0,l.G5)((0,r.h)(i.V,{campaign:s,isEditor:!0,pub:a}),t),t}catch(t){return console.error("Error rendering SponsorshipCampaign",t),(0,o.s)({msg:null,node:e,err:t,group:"block"})}}return["div",{class:c,"data-attrs":JSON.stringify(e.attrs),"data-component-name":"SponsorshipCampaignToDOM"}]},toDOMStatic:e=>["div",{class:c,"data-attrs":JSON.stringify((0,n._)({isEmail:!0},e.attrs)),"data-component-name":"SponsorshipCampaignToDOMStatic"}]},m=(0,s.S)({name:"sponsorshipCampaign",nodeSpec:u,addCommands(){return{insertSponsorshipCampaign:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}})},99149:function(e,t,a){"use strict";a.d(t,{$:()=>i,H:()=>l});var n=a(60308),r=a(30548);let i={attrs:{image:{default:""},title:{default:""},subtitle:{default:""},description:{default:""},url:{default:""}},inline:!0,group:"inline",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,toDOM:e=>["iframe",{class:"spotify-wrap","data-attrs":JSON.stringify(e.attrs),src:"https://open.spotify.com/embed?uri=".concat(encodeURIComponent(e.attrs.url),"&view=coverart&theme=white"),frameborder:"0",gesture:"media",allowfullscreen:"true","data-component-name":"SpotifyToDOM"}],toDOMStatic:e=>["a",{class:"spotify-wrap",href:e.attrs.url,"data-component-name":"SpotifyToDOMStatic"},["img",{class:"cover",src:(0,n.zF4)("/img/spotify_play.png?v=1",156),style:"background-image:url(".concat(e.attrs.image,")")}],["span",{class:"content"},["img",{class:"logo",src:(0,n.zF4)("/img/spotify_logo.png",40)}],["span",{class:"title"},e.attrs.title],["span",{class:"subtitle"},e.attrs.subtitle],["span",{class:"description"},e.attrs.description]]]},l=(0,r.S)({name:"spotify",nodeSpec:i})},79592:function(e,t,a){"use strict";a.d(t,{$y:()=>i,JV:()=>l,W7:()=>d,qZ:()=>o});var n=a(15233),r=a(30548);let i={attrs:{image:{default:""},title:{default:""},subtitle:{default:""},description:{default:""},url:{default:""},belowTheFold:{default:!1},noScroll:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"iframe.spotify-wrap",getAttrs:a(30837).Y}],toDOM:e=>{let t="spotify-wrap",a=c(e.attrs.url).params;return(null==a?void 0:a.show)||(null==a?void 0:a.episode)?t+=" podcast":(null==a?void 0:a.playlist)?t+=" playlist":(null==a?void 0:a.album)?t+=" album":(null==a?void 0:a.artist)&&(t+=" artist"),["iframe",{class:t,"data-attrs":JSON.stringify(e.attrs),src:u(e.attrs.url),frameborder:"0",gesture:"media",allowfullscreen:"true",allow:"encrypted-media",loading:e.attrs.belowTheFold?"lazy":null,"data-component-name":"Spotify2ToDOM",scrolling:e.attrs.noScroll?"no":null}]},toDOMStatic:e=>{let{image:t,title:a,subtitle:r,description:i,url:l}=e.attrs;return(0,n.L)(t,a,r,i,{targetUrl:l})}},l=(0,r.S)({name:"spotify2",nodeSpec:i,addCommands(){return{insertSpotify:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),o=function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t&&!t.nodes.spotify2?null:c(e).url},s=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await t.get("/api/v1/spotify").query({url:e})).body},d=async(e,t)=>{let{customSchema:a}=t;return a.nodes.spotify2.create(await s(e))},c=e=>{var t,a,n,r;if(null==e?void 0:e.includes("anchor.fm")){let n=/((?:https?:\/\/(?:www\.)?anchor\.fm\/(?:embed\/)?|anchor:)([^"'\s\b?#()]*))/.exec(e);if(n)return{params:{show:"podcast"},url:null!==(t=n[1])&&void 0!==t?t:null,base:null!==(a=n[2])&&void 0!==a?a:null,platform:"anchor"}}let i=/((?:https?:\/\/(open|podcasters)\.spotify\.com\/(?:embed\/)?|spotify:)([^"'\s\b?#()]*)(?:[?#][\S]*)?)/.exec(e);if(!i)return{params:null,url:null,base:null,platform:null};let l=i[3].split(/[/:]/),o={};for(let e=1;e<l.length;e+=2)o[l[e-1]]=l[e];return{params:o,url:null!==(n=i[1])&&void 0!==n?n:null,base:null!==(r=i[2])&&void 0!==r?r:null,platform:"spotify"}},u=e=>{let{params:t,base:a,platform:n}=c(e),r=[];if(t){if("anchor"===n)return"https://anchor.fm/".concat(a);if("open"===a)t.user&&t.playlist?r.push("user",t.user,"playlist",t.playlist):t.playlist?r.push("playlist",t.playlist):t.album?r.push("album",t.album):t.track?r.push("track",t.track):t.artist?r.push("artist",t.artist):t.show?r.push("show",t.show):t.pod?r.push("pod",t.pod):(t.episode||t.episodes)&&r.push("episode",t.episode||t.episodes);else for(let[e,a]of Object.entries(t))a&&(r.push(e),r.push(a));return"https://".concat(a,".spotify.com/").concat("open"===a?"embed":"","/").concat(r.join("/"))}}},39111:function(e,t,a){"use strict";a.d(t,{$:()=>i,K:()=>l});var n=a(95068),r=a(30548);let i={content:"ctaCaption",attrs:{url:{default:null},text:{default:null},language:{default:"en"}},inline:!1,group:"block",draggable:!0,atom:!1,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.subscription-widget-wrap",getAttrs:a(30837).Y}],toDOM:e=>{let{text:t,language:a}=e.attrs,{iString:n}=I18N.i(a);return["div",{class:"subscription-widget-wrap-editor","data-attrs":JSON.stringify(e.attrs),"data-component-name":"SubscribeWidgetToDOM"},["div",{class:"subscription-widget show-subscribe"},["div",{class:"preamble"},0],["form",{class:"subscription-widget-subscribe"},["input",{type:"email",class:"email-input",name:"email",placeholder:n("Type your email…"),tabindex:-1}],["input",{type:"submit",class:"button primary",value:t}],["div",{class:"fake-input-wrapper"},["div",{class:"fake-input"}],["div",{class:"fake-button"}]]]]]},toDOMStatic:e=>["div",{class:"subscription-widget-wrap","data-component-name":"SubscribeWidgetToDOMStatic"},["div",{class:"subscription-widget show-subscribe"},["div",{class:"preamble"},0],(0,n.ax)(e)]]},l=(0,r.S)({name:"subscribeWidget",nodeSpec:i,addCommands(){return{insertSubscribeWidget:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}})},57950:function(e,t,a){"use strict";a.d(t,{$:()=>r,Z:()=>i});var n=a(30548);let r={content:"block+",group:"block",defining:!1,isolating:!1,attrs:{params:{default:""}},parseDOM:[{tag:"pre.template-comment"}],toDOM:()=>["pre",{class:"template-comment","data-component-name":"TemplateCommentToDOM"},["code",0]]},i=(0,n.S)({name:"templateComment",nodeSpec:r})},78483:function(e,t,a){"use strict";a.d(t,{$y:()=>o,Ml:()=>m,QZ:()=>b,du:()=>s,od:()=>c});var n=a(27412),r=a(60826),i=a(60308),l=a(30548);let o={attrs:{url:{default:""},title:{default:""},thumbnail_url:{default:""},author:{default:""},embed_url:{default:""},author_url:{default:""},belowTheFold:{default:!1}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDom:[{tag:"div.tiktok-wrap",getAttrs:a(30837).Y}],toDOM:e=>g(e),toDOMStatic:e=>h(e)},s=(0,l.S)({name:"tiktok",nodeSpec:o,addCommands(){return{insertTiktok:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),d=/^.*(https?\:\/\/(\S+)?(?:vt.tiktok.com\/|(.?tiktok.com\/.*\/video\/).*)).*$/,c=e=>{let t=d.exec(e);return t&&t[0]},u=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await t.get("/api/v1/tiktok").query({url:e.trim()})).body},m=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.tiktok.create(await u(e))},p=e=>"tiktok-".concat(null==e?void 0:e.split("/").slice(-1)[0]),h=function(e){var t,a,n,l;let{useTikTokUrl:o=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=document.createElement("div");s.className="tiktok-wrap static",s.setAttribute("data-component-name","TikTokCreateStaticTikTokEmbed");let d="".concat(o?e.attrs.url:"".concat(r.W.POST_URL,"/#tiktok-").concat(null===(t=e.attrs.embed_url)||void 0===t?void 0:t.split("/").slice(-1)[0])),c=document.createElement("a");c.href=d,c.setAttribute("target","_blank");let u=document.createElement("img");u.className="tiktok thumbnail",u.src=(0,i.zF4)(e.attrs.thumbnail_url,640),u.style.backgroundImage="url(".concat((0,i.zF4)(e.attrs.thumbnail_url),")"),e.attrs.belowTheFold&&u.setAttribute("loading","lazy"),c.append(u);let m=document.createElement("div");m.classList.add("content");let p=document.createElement("a");p.classList.add("author"),p.href=e.attrs.author_url,p.setAttribute("target","_blank"),p.appendChild(document.createTextNode((null===(l=e.attrs.author_url)||void 0===l?void 0:null===(n=l.split)||void 0===n?void 0:null===(a=n.call(l,"/").slice(-1))||void 0===a?void 0:a[0])||e.attrs.author));let h=document.createElement("a");return h.classList.add("title"),h.href=d,h.setAttribute("target","_blank"),h.appendChild(document.createTextNode(e.attrs.title)),m.appendChild(p),m.appendChild(h),s.appendChild(c),s.appendChild(m),s},g=e=>{var t;let a=e.attrs.embed_url,n=document.createElement("div");n.id=p(a),n.className="tiktok-wrap outer",n.dataset.attrs=JSON.stringify(e.attrs),n.setAttribute("data-component-name","TikTokCreateTikTokEmbed");let r=document.createElement("iframe");r.id="iframe-".concat(p(a)),r.className="tiktok-iframe",r.src=a,r.frameBorder="0",null===(t=r.setAttribute)||void 0===t||t.call(r,"allow","autoplay; fullscreen; encrypted-media"),r.allowFullscreen="true",r.allowautoplay="true",r.allowfullscreen="true",r.scrolling="no",e.attrs.belowTheFold&&r.setAttribute("loading","lazy"),n.appendChild(r);let l=document.createElement("iframe");l.src="https://team-hosted-public.s3.amazonaws.com/set-then-check-cookie.html",l.id="third-party-iframe-".concat(p(a)),l.className="third-party-cookie-check-iframe",l.style.display="none",e.attrs.belowTheFold&&l.setAttribute("loading","lazy"),n.append(l);let o=h(e,{useTikTokUrl:!0});n.appendChild(o);let s=document.createElement("div");s.classList.add("fallback-failure"),s.id="fallback-failure-".concat(p(a));let d=document.createElement("div");d.classList.add("error-content");let c=document.createElement("img");return c.classList.add("error-icon"),c.src=(0,i.aR6)("/img/alert-circle.svg"),e.attrs.belowTheFold&&c.setAttribute("loading","lazy"),d.appendChild(c),d.appendChild(document.createTextNode("Tiktok failed to load.")),d.appendChild(document.createElement("br")),d.appendChild(document.createElement("br")),d.appendChild(document.createTextNode("Enable 3rd party cookies or use another browser")),s.appendChild(d),n.appendChild(s),n};class b{constructor(e){(0,n._)(this,"dom",void 0);let t=g(e),a=t.querySelector(".tiktok-iframe"),r=document.createElement("div");r.className="tiktok-screen";let i=document.createElement("h1");i.className="instructions",i.innerText="Double click to interact",r.appendChild(i),r.addEventListener("dblclick",()=>{r.classList.add("sunken"),a.focus()}),a.addEventListener("blur",()=>{r.classList.remove("sunken")}),t.appendChild(r),this.dom=t}}},57881:function(e,t,a){"use strict";a.d(t,{$:()=>s,h:()=>d});var n=a(91036),r=a.n(n),i=a(90406),l=a(63651),o=a(30548);let s={attrs:{url:{default:""},html:{default:""},author:{default:""},author_name:{default:""},date:{default:""}},untrackedAttrs:["html"],inline:!0,group:"inline",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.tweet",getAttrs:function(e){try{let t=JSON.parse(e.getAttribute("data-attrs"));if("url"in t&&"html"in t&&"author"in t&&"author_name"in t&&"date"in t)return t;return!1}catch(e){return!1}}}],toDOM:e=>{let t=document.createElement("div");t.className="tweet",t.setAttribute("data-component-name","TwitterToDOM"),t.setAttribute("data-attrs",JSON.stringify(e.attrs)),t.innerHTML=r()(e.attrs.html,{allowedTags:r().defaults.allowedTags.concat(["img"]),allowedAttributes:Object.assign({},r().defaults.allowedAttributes,{"*":["href","style","id","data-*","itemprop","class","align","alt","center","bgcolor"]})});let a=document.createElement("a");a.className="tweet-header",a.href="https://twitter.com/".concat(e.attrs.author),t.insertBefore(a,t.childNodes[0]);let n=document.createElement("img");n.src="".concat(l.L4R,"/image/twitter_name/w_").concat(i.yK,"/").concat(e.attrs.author,".jpg"),a.appendChild(n);let o=document.createElement("span");o.className="tweet-author-name",o.textContent=e.attrs.author_name,a.appendChild(o);let s=document.createElement("span");s.className="tweet-author",s.textContent="@".concat(e.attrs.author),a.appendChild(s);let d=document.createElement("a");return d.className="tweet-date",d.textContent=e.attrs.date,d.href=e.attrs.url,t.appendChild(d),t.querySelectorAll&&Array.prototype.forEach.call(t.querySelectorAll("a"),e=>{e.target="_blank"}),t}},d=(0,o.S)({name:"twitter",nodeSpec:s})},84766:function(e,t,a){"use strict";a.d(t,{$y:()=>c,HU:()=>u,Pz:()=>m,qK:()=>h});var n=a(91036),r=a.n(n),i=a(90406),l=a(98012),o=a(63651),s=a(84864),d=a(30548);let c={attrs:{url:{default:""},full_text:{default:""},username:{default:""},name:{default:""},date:{default:""},photos:{default:[]},quoted_tweet:{default:{}},retweet_count:{default:0},like_count:{default:0},expanded_url:{default:null},video_url:{default:null},belowTheFold:{default:!1}},untrackedAttrs:["full_text","photos","quoted_tweet","expanded_url"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.tweet",getAttrs:a(30837).Y}],toDOMStatic:e=>f(e,!0),toDOM:e=>f(e,!1)},u=(0,d.S)({name:"twitter2",nodeSpec:c,addCommands(){return{insertTwitter:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),m=function(e){var t;let{customSchema:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a&&!a.nodes.twitter2)return null;let n=/(https?:\/\/(mobile\.twitter\.com|twitter\.com|t\.co)\/.*\/status\/[^\/\s]*)/.exec(e);return null!==(t=n&&n[1])&&void 0!==t?t:null},p=async e=>{let t=(await Promise.resolve().then(a.t.bind(a,80569,23))).default;return(await t.get("/api/v1/tweet").query({url:e})).body},h=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema.nodes.twitter2.create(await p(e))};function g(e,t){let{additionalClasses:a=[],belowTheFold:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=document.createElement("div");r.className="tweet-photo-wrapper ".concat(a.join(" "));let i=document.createElement("img");if(i.className="tweet-photo",i.setAttribute("src",(0,o.zF4)(e.img_url,600)),i.setAttribute("alt",e.alt_text||"Image"),n&&i.setAttribute("loading","lazy"),t)r.appendChild(i);else{let t=document.createElement("picture"),a=document.createElement("source");a.setAttribute("type","image/webp"),a.setAttribute("srcset",(0,o.zF4)(e.img_url,600,{format:"webp"})),t.appendChild(a),t.appendChild(i),r.appendChild(t)}return r}let b=function(e,t){let{belowTheFold:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=document.createElement("div");if(n.className="tweet-photos-container",1===e.length)n.appendChild(g(e[0],t,{belowTheFold:a})),n.className+=" one";else if(2===e.length)for(let r of(n.className+=" two",e)){let e=document.createElement("div");e.className="tweet-photos-column",e.appendChild(g(r,t,{belowTheFold:a})),n.appendChild(e)}else{let r=[document.createElement("div"),document.createElement("div")];if(r.forEach(e=>{n.appendChild(e),e.className="tweet-photos-column"}),3===e.length)for(let i of(n.className+=" three",r[0].appendChild(g(e[0],t,{belowTheFold:a})),e.slice(1)))r[1].appendChild(g(i,t,{additionalClasses:["half-height-container"],belowTheFold:a}));else n.className+=" four",e.slice(0,4).forEach((e,n)=>{r[n%2].appendChild(g(e,t,{additionalClasses:["half-height-container"],belowTheFold:a}))})}return n};function f(e,t){var a;let n=document.createElement("div"),d=t?"Twitter2ToDOMStatic":"Twitter2ToDOM";n.setAttribute("data-component-name",d),n.className="".concat(t?"tweet static":"tweet"),t||n.setAttribute("data-attrs",JSON.stringify(e.attrs));let c=document.createElement("a"),u=document.createElement("a");c.className="tweet-link-top",u.className="tweet-link-bottom",c.setAttribute("href",e.attrs.url),u.setAttribute("href",e.attrs.url);let m=document.createElement("div");if(m.className="tweet-text",c.setAttribute("target","_blank"),u.setAttribute("target","_blank"),m.innerHTML=r()(e.attrs.full_text,{allowedTags:r().defaults.allowedTags.concat(["img"]),allowedAttributes:Object.assign({},r().defaults.allowedAttributes,{"*":["href","style","id","data-*","itemprop","class","align","alt","center","bgcolor"]})}),n.appendChild(c),c.appendChild(m),e.attrs.video_url&&!t){let t=document.createElement("div");t.className="tweet-video-wrapper",n.appendChild(t);let a=document.createElement("video");a.className="tweet-video",a.setAttribute("controls","true"),a.setAttribute("src",(0,o.zF4)(e.attrs.video_url,600)),a.setAttribute("alt","Video"),e.attrs.belowTheFold&&a.setAttribute("loading","lazy"),t.appendChild(a)}else if((null==e?void 0:null===(a=e.attrs)||void 0===a?void 0:a.photos)&&e.attrs.photos.length>0){let a=b(e.attrs.photos,t,{belowTheFold:e.attrs.belowTheFold});c.appendChild(a)}if(e.attrs.quoted_tweet&&e.attrs.quoted_tweet.full_text){let t=document.createElement("div");t.className="quote-tweet",t.innerHTML=r()(e.attrs.quoted_tweet.full_text,{allowedTags:[]});let a=document.createElement("div");a.className="quote-tweet-header";let n=document.createElement("img");n.className="quote-tweet-header-avatar",n.src="".concat(o.L4R,"/image/twitter_name/w_40/").concat(e.attrs.quoted_tweet.username,".jpg"),n.setAttribute("alt","Twitter avatar".concat(e.attrs.quoted_tweet.username?" for @".concat(e.attrs.quoted_tweet.username):"")),e.attrs.belowTheFold&&n.setAttribute("loading","lazy"),a.appendChild(n);let i=document.createElement("div");i.className="quote-tweet-header-text";let l=document.createElement("span");l.className="quote-tweet-name",l.textContent="".concat(e.attrs.quoted_tweet.name||""," "),i.appendChild(l);let s=document.createElement("span");s.className="quote-tweet-username",s.textContent="@".concat(e.attrs.quoted_tweet.username),i.appendChild(s),a.appendChild(i),t.insertBefore(a,t.childNodes[0]),c.appendChild(t)}if(e.attrs.expanded_url&&e.attrs.expanded_url.title){let a=document.createElement("a");if(a.className="expanded-link",a.setAttribute("href",e.attrs.expanded_url.url),e.attrs.expanded_url.image){let t=e.attrs.expanded_url.image.url||e.attrs.expanded_url.image,n=document.createElement("img");n.setAttribute("src",(0,o.zF4)(t,600,{height:314,crop:"fill"})),n.className="expanded-link-img",e.attrs.belowTheFold&&n.setAttribute("loading","lazy"),a.appendChild(n)}let n=document.createElement("div");n.className="expanded-link-bottom";let r=document.createElement("span");r.className="expanded-link-domain",r.textContent=e.attrs.expanded_url.domain,n.appendChild(r);let i=document.createElement("span");i.className="expanded-link-title",i.textContent=(0,s.truncateText)(e.attrs.expanded_url.title,140),n.appendChild(i);let l=document.createElement("span");l.className="expanded-link-description",l.textContent=e.attrs.expanded_url.description?t?e.attrs.expanded_url.description.slice(0,135).concat("..."):e.attrs.expanded_url.description:"",n.appendChild(l),a.appendChild(n),c.appendChild(a)}let p=document.createElement("div");p.className="tweet-header",c.insertBefore(p,c.childNodes[0]);let h=document.createElement("img");h.className="tweet-header-avatar",h.src="".concat(o.L4R,"/image/twitter_name/w_").concat(2*i.yK,"/").concat(e.attrs.username,".jpg"),h.setAttribute("alt","Twitter avatar".concat(e.attrs.username?" for @".concat(e.attrs.username):"")),e.attrs.belowTheFold&&h.setAttribute("loading","lazy"),p.appendChild(h);let g=document.createElement("div");g.className="tweet-header-text",p.appendChild(g);let f=document.createElement("span");f.className="tweet-author-name",f.textContent="".concat(e.attrs.name||""," "),g.appendChild(f);let v=document.createElement("span");v.className="tweet-author-handle",v.textContent="@".concat(e.attrs.username),g.appendChild(v);let y=document.createElement("div");y.className="tweet-footer";let _=document.createElement("span");if(_.className="tweet-date",_.textContent=(0,l.Z)(e.attrs.date).format("h:mm A ∙ MMM D, YYYY"),y.appendChild(_),0!==e.attrs.retweet_count&&0!==e.attrs.like_count){let e=document.createElement("hr");y.appendChild(e)}if(0!==e.attrs.retweet_count&&0!==e.attrs.like_count){let t=document.createElement("div");if(t.className="tweet-ufi",e.attrs.like_count>0){let a=document.createElement("span"),n=document.createElement("span");a.setAttribute("href","".concat(e.attrs.url,"/likes")),a.className="likes",n.className="like-count",n.textContent=e.attrs.like_count.toLocaleString(),a.appendChild(n),a.append(e.attrs.like_count>1?"Likes":"Like"),t.appendChild(a)}if(e.attrs.retweet_count>0){let a=document.createElement("span"),n=document.createElement("span");a.setAttribute("href","".concat(e.attrs.url,"/retweets")),a.className="retweets",n.className="rt-count",n.textContent=e.attrs.retweet_count.toLocaleString(),a.appendChild(n),a.append(e.attrs.retweet_count>1?"Retweets":"Retweet"),t.appendChild(a)}y.appendChild(t)}return u.appendChild(y),n.appendChild(u),c.querySelectorAll&&Array.prototype.forEach.call(c.querySelectorAll("a"),e=>{e.target="_blank"}),u.querySelectorAll&&Array.prototype.forEach.call(u.querySelectorAll("a"),e=>{e.target="_blank"}),n}},60802:function(e,t,a){"use strict";a.d(t,{$:()=>c,v:()=>u});var n=a(6400),r=a(55679),i=a(84711),l=a(92314),o=a(10656),s=a(19520),d=a(30548);let c={attrs:{mediaUploadId:{default:null},duration:{default:null}},group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,toDOM:e=>{if("undefined"!=typeof window)try{let t=document.createElement("div");t.className="native-video-embed",t.setAttribute("data-attrs",JSON.stringify(e.attrs));let a={mediaUploadId:e.attrs.mediaUploadId,pub:null,post:null,isEditor:!0};return(0,o.G5)((0,n.h)(l.c,a),t),t}catch(t){return console.error("Error rendering VideoEmbedPlayer",t),(0,s.s)({msg:null,node:e,err:t,group:"block"})}return m(e)},toDOMStatic:e=>m(e)},u=(0,d.S)({name:"video",nodeSpec:c,addNodeView:()=>(0,r.fW)(i.d),addCommands(){return{insertVideo:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),m=e=>["div",{class:"native-video-embed","data-component-name":"VideoPlaceholder","data-attrs":JSON.stringify(e.attrs)}]},45913:function(e,t,a){"use strict";a.d(t,{$y:()=>i,Jn:()=>u,Oy:()=>c,qM:()=>l,vR:()=>s});var n=a(63651),r=a(30548);let i={attrs:{videoId:{default:""},videoKey:{default:""},belowTheFold:{default:!1}},untrackedAttrs:["videoKey"],inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.vimeo-wrap",getAttrs:a(30837).Y}],toDOM:e=>{var t;let a=o(e.attrs.videoId,e.attrs.videoKey);return["div",{id:(t=e.attrs.videoId,"vimeo-".concat(t)),class:"vimeo-wrap","data-attrs":JSON.stringify(e.attrs),"data-component-name":"VimeoToDOM"},["div",{class:"vimeo-inner"},["iframe",{src:a,frameborder:"0",gesture:"media",allow:"autoplay; fullscreen",allowautoplay:"true",allowfullscreen:"true",loading:e.attrs.belowTheFold?"lazy":null}]]]},toDOMStatic:e=>["a",{href:m(e.attrs.videoId,e.attrs.videoKey),target:"_blank",class:"vimeo-wrap","data-component-name":"VimeoToDOMStatic"},["img",{src:u(e.attrs.videoId,{maxWidth:550})}]]},l=(0,r.S)({name:"vimeo",nodeSpec:i,addCommands(){return{insertVimeo:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"https://player.vimeo.com/video/".concat(e,"?autoplay=0").concat(t?"&h=".concat(t):"")},s=function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t&&!t.nodes.vimeo?null:p(e)[2]},d=e=>{let[t,a]=p(e);return t?{videoId:t,videoKey:a}:null},c=async(e,t)=>{let{customSchema:a}=t,n=d(e);return n?a.nodes.vimeo.create(n):null},u=function(e){let{maxWidth:t=728,playButton:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(n.L4R,"/image/vimeo/w_").concat(t,",c_limit,d_video_placeholder.png").concat(a?"/l_youtube_play_qyqt8q,w_170":"","/").concat(e)},m=(e,t)=>"https://vimeo.com/".concat(e).concat(t?"/".concat(t):"");function p(e){let t=/(https?:\/\/[^\s]*vimeo.com\/(?:channels\/[^/]+\/|video\/)?(\d+)(\/([0-9a-f]+))?[^\s\"\'"]*)/.exec(e);return t?[t[2],t[4],t[1]]:[null,null,null]}},34612:function(e,t,a){"use strict";a.d(t,{$:()=>i,O:()=>l});var n=a(30548),r=a(32751);let i={attrs:{videoId:{default:""}},inline:!0,group:"inline",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,toDOM:e=>{let t="https://www.youtube.com/embed/".concat(e.attrs.videoId);return["div",{class:"youtube-wrap","data-component-name":"YoutubeToDOM","data-attrs":JSON.stringify(e.attrs)},["iframe",{src:t,frameborder:"0",gesture:"media",allowfullscreen:"true"}]]},toDOMStatic:e=>["a",{href:"https://www.youtube.com/watch?v=".concat(e.attrs.videoId),target:"_blank",class:"youtube-wrap","data-component-name":"YoutubeToDOMStatic"},["img",{src:(0,r.Jn)(e.attrs.videoId,{maxWidth:550})}]]},l=(0,n.S)({name:"youtube",nodeSpec:i})},32751:function(e,t,a){"use strict";a.d(t,{$y:()=>o,II:()=>s,Jn:()=>m,dQ:()=>f,gp:()=>d,o1:()=>c});var n=a(27412),r=a(69332),i=a(63651),l=a(30548);let o={attrs:{videoId:{default:""},startTime:{default:null},endTime:{default:null}},inline:!1,group:"block",draggable:!0,atom:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"div.youtube-wrap",getAttrs:a(30837).Y},{tag:"iframe",getAttrs:e=>{try{let t=e.src&&g(e.src)[0];if(t)return{videoId:t};return!1}catch(e){return!1}}},{tag:"object",getAttrs:e=>{try{let t=e.data&&g(e.data)[0];if(t)return{videoId:t};for(let t of e.querySelectorAll("param")){let e=t.value&&g(t.value)[0];if(e)return{videoId:e}}for(let t of e.querySelectorAll("embed")){let e=t.src&&g(t.src)[0];if(e)return{videoId:e}}return!1}catch(e){return!1}}}],toDOM:e=>{let t=h(e.attrs.videoId,{start:e.attrs.startTime,end:e.attrs.endTime});return["div",{id:b(e.attrs.videoId),class:"youtube-wrap","data-attrs":JSON.stringify(e.attrs),"data-component-name":"Youtube2ToDOM"},["div",{class:"youtube-inner"},["iframe",{src:t,frameborder:"0",loading:"lazy",gesture:"media",allow:"autoplay; fullscreen",allowautoplay:"true",allowfullscreen:"true",width:"728",height:"409"}]]]},toDOMStatic:e=>["a",{href:p(e.attrs),target:"_blank",class:"youtube-wrap","data-component-name":"Youtube2ToDOMStatic"},["img",{src:m(e.attrs.videoId,{maxWidth:728})}]]},s=(0,l.S)({name:"youtube2",nodeSpec:o,addCommands(){return{insertYoutube:e=>t=>{let{commands:a}=t;return a.insertContent({type:this.name,attrs:e})}}}}),d=function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t&&!t.nodes.youtube2?null:g(e)[1]},c=async function(e){let{customSchema:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t?{schema:t}:await Promise.resolve().then(a.bind(a,37175))).schema,r=u(e);return r?n.nodes.youtube2?n.nodes.youtube2.create(r):(console.error("Schema does not have a youtube2 node"),null):null},u=e=>{let t=g(e)[0];if(!t)return null;let a=function(e){let t=(0,r.m)(e);return{start:t.start||t.t,end:t.end}}(e);return{videoId:t,startTime:a.start,endTime:a.end}},m=function(e){let{maxWidth:t=728,playButton:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(i.L4R,"/image/youtube/w_").concat(t,",c_limit").concat(a?"/l_youtube_play_qyqt8q,w_120":"","/").concat(e)},p=e=>"https://www.youtube.com/watch?".concat((0,i.Y$Q)({v:e.videoId,start:e.startTime,end:e.endTime})),h=function(e){let{start:t,end:a,enableJsApi:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"https://www.youtube-nocookie.com/embed/".concat(e,"?").concat((0,i.Y$Q)({start:t,end:a,rel:0,autoplay:0,showinfo:0,enablejsapi:+!!n}))},g=e=>{var t,a,n;let i=/(https?\:\/\/(www\.|m\.)?youtube\.com\/(v\/)?watch\?[^\s]+)/.exec(e);if(i){let e=(0,r.m)(i[1]).v||null;if(e)return[e,null!==(t=i[1])&&void 0!==t?t:null]}let l=/(https?:\/\/(?:youtu\.be|www\.youtube\.com\/embed|www\.youtube-nocookie\.com\/embed|www\.youtube\.com\/v|www\.youtube\.com\/shorts|www\.youtube\.com\/live)\/([A-z0-9\-_]+)[^\s]*)/.exec(e);return l?[null!==(a=l[2])&&void 0!==a?a:null,null!==(n=l[1])&&void 0!==n?n:null]:[null,null]};function b(e){return"youtube2-".concat(e)}class f{constructor(e){(0,n._)(this,"dom",void 0);let t=h(e.attrs.videoId,{start:e.attrs.startTime,end:e.attrs.endTime,enableJsApi:!0}),a=document.createElement("div");a.id=b(e.attrs.videoId),a.className="youtube-wrap",a.dataset.attrs=JSON.stringify(e.attrs);let r=document.createElement("div");r.className="youtube-inner",a.appendChild(r);let i=document.createElement("iframe");i.src=t,i.frameBorder="0",i.gesture="media",i.allow="autoplay; fullscreen",i.allowautoplay="true",i.allowFullscreen=!0,i.style.backgroundImage="url(".concat(m(e.attrs.videoId,{maxWidth:728}),")"),r.appendChild(i);let l=document.createElement("div");l.className="youtube-overlay";let o=document.createElement("div");o.className="youtube-instructions",o.innerText="Double click to interact with video",l.appendChild(o),l.addEventListener("dblclick",()=>{l.classList.add("disabled"),i.classList.remove("disabled"),i.focus()}),i.addEventListener("blur",()=>{var e;l.classList.remove("hidden"),l.classList.remove("disabled"),i.classList.add("disabled"),null===(e=i.contentWindow)||void 0===e||e.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*")}),r.appendChild(l),this.dom=a}}}}]);