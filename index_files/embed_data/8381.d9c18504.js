"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8381"],{44430:function(e,t,n){n.d(t,{Z:()=>r});let r={divider:"divider-Ti4OTa",vertical:"vertical-jkeHTs"}},57391:function(e,t,n){n.d(t,{Vt:()=>_,f9:()=>b,gn:()=>h,jc:()=>S,kx:()=>y,ng:()=>w});var r,i=n(7409),o=n(99282),s=n(16584),a=n(6400),l=n(98661),u=n(30396),d=n(78718),p=n.n(d),v=n(35702),c=n(48980),f=n(8589);let m={variantOverrides:{},experimentFeatures:{},experimentExposures:{}};function h(){return"undefined"!=typeof window&&(0,i._)({variantOverrides:{},experimentFeatures:{},experimentExposures:{}},p()(window._preloads,["variantOverrides","experimentFeatures","experimentExposures","pubIdOverride"]))||m}let x=h(),g="undefined"!=typeof window?null===(r=window._preloads)||void 0===r?void 0:r.siteConfigs:{},w=(e,t)=>{let n=t=>{if(!t||!e)return null;let n=e[t];return void 0===n?null:n},r=e=>{if(!e)return null;let r=n(e);if((0,f.Dh)(r))return{intendedVariant:r,shouldLog:!1};if(t.variantOverrides&&e in t.variantOverrides)return{intendedVariant:t.variantOverrides[e],shouldLog:!1};let i=t.experimentExposures||{};if(i[e])return{intendedVariant:i[e],shouldLog:!1};let o=t.experimentFeatures||{};return o[e]?{intendedVariant:o[e],shouldLog:!0}:null},i=async(e,t,n)=>{if("undefined"!=typeof window){window._preloads.experimentExposures=window._preloads.experimentExposures||{};let r=window._preloads.experimentExposures;r[e]=t;try{await (0,c.rd)("/api/v1/experiment_exposure",{json:{experiment_name:e,variant_name:t,ignore_downsampling:!!n},method:"post"})}catch(t){delete r[e]}}};return{getExperimentVariant:e=>{let t=r(e);return t?t.intendedVariant:null},exposeExperiment:async function(e){let{ignoreDownsampling:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{intendedVariant:n,shouldLog:o}=r(e)||{};return!!o&&(await i(e,n,!!t),!0)},getExposedVariant:e=>{if(!e)return null;let r=n(e);if((0,f.Dh)(r))return r;if(t.variantOverrides&&e in t.variantOverrides)return t.variantOverrides[e];let i=t.experimentExposures||{};return i[e]?i[e]:null},refreshExperimentVariants:async function(){let e,{ignoreDownsampling:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&(e=new URLSearchParams({ignore_downsampling:"true"}));let n=await (0,c.rd)("/api/v1/experiment_features",{method:"get",query:e});(null==n?void 0:n.features)&&(0,v.a)({experimentFeatures:n.features})}}},y=(0,a.createContext)(w(g,x));function _(e){let{siteConfigs:t={},experimentInfo:n,children:r}=e,i=n||x,o=(0,u.Ye)(()=>w(t,i),[t,...Object.values(i)]);return(0,s.tZ)(y.Provider,{value:o,children:r})}function S(){return(0,u.qp)(y)}y.displayName="ExperimentsContext";let b=e=>{let t=(0,l.forwardRef)((t,n)=>{let r=S();return(0,s.tZ)(e,(0,o._)((0,i._)({},r,t),{ref:n}))});return t.displayName="withExperimentsContext(".concat(e.displayName||e.name||"Anonymous",")"),t}},37168:function(e,t,n){n.d(t,{WH:()=>h,ZN:()=>x,hO:()=>g});var r,i,o=n(7409),s=n(99282),a=n(16584),l=n(6400),u=n(98661),d=n(30396),p=n(57391),v=n(40647);let c=(0,p.gn)(),f="undefined"!=typeof window&&null!==(i=null===(r=window._preloads)||void 0===r?void 0:r.siteConfigs)&&void 0!==i?i:{},m=(e,t)=>(0,o._)({},(0,p.ng)(e,t),(0,v.Xz)(e)),h=(0,l.createContext)(m(f,c));function x(e){let{siteConfigs:t={},experimentInfo:n,children:r}=e,i=n||c,o=(0,d.Ye)(()=>m(t,i),[t,i]);return(0,a.tZ)(h.Provider,{value:o,children:r})}h.displayName="ExperimentsAndSiteConfigContext";let g=e=>{let t=(0,u.forwardRef)((t,n)=>{let r=(0,d.qp)(h);return(0,a.tZ)(e,(0,s._)((0,o._)({},r,t),{ref:n}))});return t.displayName="withExperimentsAndSiteConfigContext(".concat(e.displayName||e.name||"Anonymous",")"),t}},56629:function(e,t,n){n.d(t,{Iz:()=>h,So:()=>x,us:()=>m,vz:()=>f});var r,i,o=n(7409),s=n(99282),a=n(16584),l=n(6400),u=n(98661),d=n(30396),p=n(48980);let v="undefined"!=typeof window&&null!==(i=null===(r=window._preloads)||void 0===r?void 0:r.publicationSettings)&&void 0!==i?i:{};function c(e){return t=>{if(!t||!e)return null;let n=e[t];return void 0===n?null:n}}let f=(0,l.createContext)({getSettingFor:c(v),changeSetting:()=>Promise.resolve(void 0),preloadedPubSettings:v});f.displayName="PublicationSettingsContext";let m=e=>{let t=(0,u.forwardRef)((t,n)=>{let r=x();return(0,a.tZ)(e,(0,s._)((0,o._)({},r,t),{ref:n}))});return t.displayName="withPubSettingsContext(".concat(e.displayName||e.name||"Anonymous",")"),t};function h(e){let{settings:t={},children:n}=e,[r,i]=(0,d.eJ)(t),s=async e=>{i((0,o._)({},r,e));try{await (0,p.rd)("/api/v1/publication_settings",{method:"PUT",json:e})}catch(e){console.error(e)}},l=(0,d.Ye)(()=>({getSettingFor:c(r),changeSetting:s,preloadedPubSettings:r}),[r]);return(0,a.tZ)(f.Provider,{value:l,children:n})}function x(){return(0,d.qp)(f)}},60807:function(e,t,n){n.d(t,{Fl:()=>x,SE:()=>g,St:()=>f,aF:()=>h,dr:()=>m});var r,i,o,s,a=n(7409),l=n(99282),u=n(16584),d=n(98661),p=n(48980);let v="undefined"!=typeof window&&null!==(o=null===(r=window._preloads)||void 0===r?void 0:r.user)&&void 0!==o?o:null,c="undefined"!=typeof window&&null!==(s=null===(i=window._preloads)||void 0===i?void 0:i.userSettings)&&void 0!==s?s:{},f=(0,d.createContext)({user:v,setUser:()=>void 0,userSettings:c,changeSetting:()=>Promise.resolve()});function m(e){let{defaultValue:t,userSettings:n,children:r}=e,[i,o]=(0,d.useState)(t||v),[s,m]=(0,d.useState)(null!=n?n:c),h=async(e,t,n,r)=>{if(!i&&!(null==r?void 0:r.token))return;let o=s[e];m((0,l._)((0,a._)({},s),{[e]:t}));try{await (0,p.rd)("/api/v1/user-setting",{method:"PUT",json:{type:e,value_bool:"bool"!==n&&(n||"boolean"!=typeof t)?void 0:t,value_datetime:"datetime"!==n&&(n||"string"!=typeof t)?void 0:t,value_text:"text"===n?t:void 0,token:null==r?void 0:r.token}})}catch(t){if(t instanceof p.kp)alert(t.getMessage()),m(t=>(0,l._)((0,a._)({},t),{[e]:o}));else throw t}},x=(0,d.useMemo)(()=>({user:i,setUser:o,userSettings:s,changeSetting:h}),[i,s]);return(0,u.tZ)(f.Provider,{value:x,children:r})}function h(){return(0,d.useContext)(f).user}function x(){return(0,d.useContext)(f).userSettings}function g(){return(0,d.useContext)(f)}f.displayName="UserContext"},35934:function(e,t,n){n.d(t,{gz:()=>i});var r=n(27412);class i extends Error{constructor(e,t={},n=!1,i=null){let o,s;super(e),(0,r._)(this,"status",void 0),(0,r._)(this,"userVisible",void 0),(0,r._)(this,"messageHtml",void 0),(0,r._)(this,"response",void 0),(0,r._)(this,"type",void 0),(0,r._)(this,"metadata",void 0),this.name=this.constructor.name;let a=null,l=null,u=null;if("object"==typeof t){var d,p,v,c,f,m;o=null!==(d=t.status)&&void 0!==d?d:500,n=null!==(p=t.userVisible)&&void 0!==p&&p,i=null!==(v=t.messageHtml)&&void 0!==v?v:null,a=null!==(c=t.responseBody)&&void 0!==c?c:null,l=null!==(f=t.type)&&void 0!==f?f:null,u=null!==(m=t.metadata)&&void 0!==m?m:null}else o=t;this.status=o,this.userVisible=!!a||n,this.messageHtml=i,this.type=l,this.metadata=u,a?s=a:this.userVisible?i?s={errors:[{msg:e,msgHTML:i}],type:"list"}:(s={error:e,type:"single"},this.type&&(s.type=this.type),this.metadata&&(s.metadata=this.metadata)):s={error:""},this.response={body:s},Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}}}]);