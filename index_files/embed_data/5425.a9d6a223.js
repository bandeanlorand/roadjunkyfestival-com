/*! For license information please see 5425.a9d6a223.js.LICENSE.txt */
(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["5425"],{28657:function(e,t,n){"use strict";n.d(t,{Z:()=>i});let i={track:"track-e0UsGc",sm:"sm-NTA_dM",md:"md-t9_OLv",enabled:"enabled-z80ktY",checked:"checked-shaJTW",unchecked:"unchecked-xbnGJz",disabled:"disabled-HU7KbB",nub:"nub-sJTvJy",animate:"animate-HqAcLR",theme_accent:"theme_accent-jLc1V8",themeAccent:"theme_accent-jLc1V8",theme_success:"theme_success-OT7UOf",themeSuccess:"theme_success-OT7UOf",theme_error:"theme_error-iKFnqH",themeError:"theme_error-iKFnqH",theme_select:"theme_select-ZrBXM7",themeSelect:"theme_select-ZrBXM7"}},76201:function(e,t,n){"use strict";n.d(t,{Z:()=>i});let i={textEditor:"textEditor-tqxRQ1",isDragging:"isDragging-xLNam_",divider:"divider-ODsTIh",editorContent:"editorContent-EGQjBF",editorMenu:"editorMenu-DBTlov",editorMenuButton:"editorMenuButton-dkphLM",editorMenuButtonActive:"editorMenuButtonActive-EG6QVa",chatOverrides:"chatOverrides-loIrHB"}},47415:function(e,t,n){var i=n(29932);e.exports=function(e,t){return i(t,function(t){return e[t]})}},80059:function(e){e.exports=function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}},47037:function(e,t,n){var i=n(44239),o=n(1469),r=n(37005);e.exports=function(e){return"string"==typeof e||!o(e)&&r(e)&&"[object String]"==i(e)}},1581:function(e,t,n){var i=n(62705),o=n(278),r=n(64160),l=n(98612),a=n(47037),d=n(80059),s=n(68776),c=n(21814),u=n(83140),p=n(52628),m=i?i.iterator:void 0;e.exports=function(e){if(!e)return[];if(l(e))return a(e)?u(e):o(e);if(m&&e[m])return d(e[m]());var t=r(e);return("[object Map]"==t?s:"[object Set]"==t?c:p)(e)}},52628:function(e,t,n){var i=n(47415),o=n(3674);e.exports=function(e){return null==e?[]:i(e,o(e))}},24830:function(e,t,n){"use strict";n.d(t,{Z:()=>i});let i=(0,n(36150).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},96726:function(e,t,n){"use strict";n.d(t,{X:()=>d,h:()=>s});var i=n(16584),o=n(6400),r=n(98661),l=n(30396);let a=(0,o.createContext)(null);function d(e){let{root:t,children:n}=e,o=(0,l.sO)(t);return(0,i.BX)(a.Provider,{value:o,children:[n,!t&&(0,i.tZ)("div",{ref:o})]})}function s(e){let{children:t}=e,n=(0,l.qp)(a).current;return n?(0,r.createPortal)(t,n):null}},3258:function(e,t,n){"use strict";n.d(t,{O7:()=>b,ZP:()=>f,wg:()=>g});var i=n(7409),o=n(99282),r=n(16584),l=n(94184),a=n.n(l),d=n(80569),s=n.n(d),c=n(85685),u=n(85095),p=n(33017),m=n(63651),h=n(51885);let f=/^(3270|6673|7778)$/.test(n.j)?null:e=>{let{id:t,type:n,name:i,url:o,photo_url:l,uuid:d,mentionText:s,isStatic:f=!1,isEditorContext:v=!1}=e;return f?(0,r.tZ)("span",{className:a()(h.Z.mention,h.Z.mentionStatic),"data-component-name":"MentionStatic",children:(0,r.tZ)("a",{href:(0,m.gpq)(n,t,i,o),children:i||"Substack user"})}):"user"===n?(0,r.tZ)(u.am,{children:(0,r.tZ)(c.ProfileHoverCard,{subject:{id:t,name:i||"Substack user",photo_url:l},utmSource:"mention",children:(0,r.tZ)("a",{className:h.Z.mention,href:v?void 0:(0,m.gpq)(n,t,i,o),target:"_blank",rel:"noopener","data-attrs":JSON.stringify({name:i,id:t,type:n,url:o,photo_url:l,uuid:d}),onClick:e=>e.stopPropagation(),"data-component-name":"MentionUser",children:null!=s?s:i})})}):"pub"===n?(0,r.tZ)(p.Sm,{publication_id:t,utmSource:"mention",children:(0,r.tZ)("a",{className:h.Z.mention,href:o,target:"_blank",rel:"noopener","data-attrs":JSON.stringify({name:i,id:t,type:n,url:v?void 0:(0,m.gpq)(n,t,i,o),uuid:d}),onClick:e=>e.stopPropagation(),"data-component-name":"MentionPub",children:null!=s?s:i})}):(0,r.tZ)("a",{className:h.Z.mention,target:"_blank",rel:"noopener",href:(0,m.gpq)(n,t,i,o),"data-attrs":JSON.stringify({name:i,id:t,type:n,url:o,photo_url:l,uuid:d}),"data-component-name":"Mention",children:null!=s?s:i})},v={},g=async function(e){let{pathname:t="/api/v1/posts/mention"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(v[e])return v[e];let{profiles:n,publications:r}=(await s().get(t).query({query:e,include_unmentionables:!0})).body,l=new Map;return n&&n.length&&l.set("Writers",n.map(e=>(0,o._)((0,i._)({},e),{type:"user",disabledReason:e.is_mentionable?void 0:"unmentionable"}))),r&&r.length&&l.set("Publications",null==r?void 0:r.map(e=>(0,o._)((0,i._)({},e),{type:"pub",url:(0,m.HQ5)({subdomain:e.subdomain}),photo_url:e.logo_url}))),v[e]=l,l},y=2987==n.j?{}:null,b=async function(e){let{pathname:t="/api/v1/community/mention"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(t,"-").concat(e);if(y[n])return y[n];let i=(await s().get(t).query({query:e,include_unmentionables:!0})).body.results,o=new Map;return i&&o.set("Writers",i.map(e=>{var t,n,i;return{id:e.user_id,type:"user",name:e.name,photo_url:null!==(t=e.photo_url)&&void 0!==t?t:void 0,bestseller_tier:null!==(n=e.bestseller_tier)&&void 0!==n?n:0,handle:null!==(i=e.handle)&&void 0!==i?i:void 0,disabledReason:e.is_mentionable?void 0:"unmentionable"}})),y[n]=o,o}},43148:function(e,t,n){"use strict";n.d(t,{H:()=>u,o:()=>c});var i=n(16584),o=n(98661),r=n(30396),l=n(15771),a=n(19081),d=n(58175),s=n(12811);let c=(0,o.forwardRef)((e,t)=>{let{onClick:n,children:o,disabled:r=!1,size:a="md"}=e;return(0,i.tZ)(l.GI,{ref:t,rounded:!0,onClick:n,disabled:r,size:a,children:o})}),u=e=>{let{label:t,children:n}=e,[o,l]=(0,r.eJ)(!1);return(0,i.BX)(a.gq,{gap:8,justifyContent:"center",alignItems:"center",children:[t&&(0,i.tZ)(a.gq,{bg:"glass-inverted-medium",justifyContent:"center",alignItems:"center",radius:"sm",paddingY:6,paddingX:8,className:s.Z.verticalMenuLabel,style:{opacity:+!!o},children:(0,i.tZ)(d.xv.B4,{color:"white",children:t})}),(0,i.tZ)("div",{onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:n})]})}},62298:function(e,t,n){"use strict";n.d(t,{H:()=>a});var i=n(16584),o=n(30396),r=n(98961),l=n(15771);function a(e){let{mediaUpload:t,selectedFile:n,onInputChange:a}=e,d=(0,o.sO)();return t||n?null:(0,i.BX)(l.hU,{priority:"tertiary",size:"md",onClick:()=>{var e;null===(e=d.current)||void 0===e||e.click()},children:[(0,i.tZ)(r.Z,{size:20}),(0,i.tZ)("input",{type:"file",accept:"video/*",multiple:!0,onChange:a,ref:d,style:{display:"none"}})]})}},5817:function(e,t,n){"use strict";n.r(t),n.d(t,{NoteComposer:()=>e8});var i=n(7409),o=n(99282),r=n(16584),l=n(30396),a=n(88897),d=n(39693),s=n.n(d),c=n(23279),u=n.n(c),p=n(24350),m=n.n(p),h=n(24830),f=n(56743),v=n(98961),g=n(65445),y=n(71375),b=n(887),Z=n(86374),_=n(95441),w=n(40647),C=n(60807),k=n(92291),T=n(77338),S=n(5952),x=n(25991),P=n(62298),E=n(25642),N=n(2891),B=n(16451),I=n(7882),M=n(68733),U=n(76721),O=n(68833),A=n(39556),L=n(48980),X=n(59176),R=n(98914),z=n(94874),j=n(71068),F=n(15771),D=n(19081),H=n(8594),q=n(44424),J=n(6490),V=n(98248),G=n(96302),W=n(58175),Y=n(70379),K=n(1669),$=n(55722),Q=n(75795),ee=n(98848),et=n(51127),en=n(38621),ei=n(89290),eo=n(76405),er=n(55679),el=n(94184),ea=n.n(el),ed=n(74386),es=n(74032),ec=n(79692);let eu=(0,n(36150).Z)("CodeXml",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);var ep=n(28549),em=n(96592),eh=n(96726),ef=n(50515),ev=n(38664),eg=n(36349),ey=n(19512),eb=n(56070),eZ=n(18490),e_=n(24717),ew=n(56782),eC=n(43557),ek=n(75481),eT=n(61767),eS=n(55786),ex=n(32018),eP=n(91077),eE=n(87597),eN=n(55963),eB=n(22966);let eI=eC.Z.extend({addAttributes:()=>({schemaVersion:{default:"v1"}})}),eM=[eb.ZP,eZ.ZP,e_.ZP,ew.ZP,ek.ZP,eS.Z,ex.ZP,eP.Z,eE.ZP,eN.Z,eI,ey.ZP,eT.Z.configure({linkOnPaste:!1,openOnClick:!1,HTMLAttributes:{class:"note-link",rel:"nofollow ugc noopener",target:"_blank"}}),eB.T6];var eU=n(8357),eO=n(5749),eA=n(76201);function eL(e){let{defaultValue:t,onAddFiles:n,placeholder:o,disabled:a,onChange:d,isDragging:s,onDrop:c,onReturn:p,onEscape:m}=e,h=(0,l.Ye)(()=>u()(e=>{let{editor:t}=e,n=null;t&&!t.isEmpty&&(n=(0,eU.Z)(t.getJSON())),d(n)},100),[d]),f=(0,er.jE)({content:t,editable:!a,autofocus:"end",extensions:[...eM,ei.ZP,et.Z,en.Z.configure({placeholder:o})],onUpdate:h,editorProps:{attributes:(0,i._)({class:eO.Z.feedCommentBodyInner},ef.J),handlePaste:(e,t)=>!!(t.clipboardData&&(0,eg.d)(t.clipboardData))&&(n(Array.from(t.clipboardData.files)),!0),handleDrop:(e,t)=>(c(t),!!t.defaultPrevented),handleKeyDown:(e,t)=>"Escape"===t.key&&(m(),!0),transformPasted:e=>new eo.p2(function e(t){let n=t;return t.forEach((t,i,o)=>{let r=t.marks.find(e=>"link"===e.type.name),l=t;if(r){let{href:e}=r.attrs;e!==l.text&&(l=l.type.schema.text(e,t.marks))}else t.content&&(l=l.copy(e(t.content)));l!==t&&(n=n.replaceChild(o,l))}),n}(e.content),e.openStart,e.openEnd)}});return(0,r.BX)(D.tu,{className:eA.Z.textEditor,onClick:()=>{f&&!f.isFocused&&f.commands.focus()},children:[f&&(0,r.tZ)(eh.h,{children:(0,r.BX)(er.NM,{className:eA.Z.editorMenu,editor:f,tippyOptions:{duration:50},shouldShow:e=>{let{from:t,to:n}=e;return t!==n&&!f.isEmpty},children:[(0,r.tZ)(eX,{Icon:ed.Z,active:f.isActive("bold"),onClick:()=>f.chain().focus().toggleBold().run()}),(0,r.tZ)(eX,{Icon:es.Z,active:f.isActive("italic"),onClick:()=>f.chain().focus().toggleItalic().run()}),(0,r.tZ)(eX,{Icon:ec.Z,active:f.isActive("strike"),onClick:()=>f.chain().focus().toggleStrike().run()}),(0,r.tZ)(eX,{Icon:eu,active:f.isActive("code"),onClick:()=>f.chain().focus().toggleCode().run()}),(0,r.tZ)(D.hs,{flex:"grow",className:eA.Z.divider}),(0,r.tZ)(eX,{Icon:ep.Z,active:f.isActive("bulletList"),onClick:()=>f.chain().focus().toggleBulletList().run()}),(0,r.tZ)(eX,{Icon:em.Z,active:f.isActive("orderedList"),onClick:()=>f.chain().focus().toggleOrderedList().run()}),(0,r.tZ)(D.hs,{flex:"grow",className:eA.Z.divider}),(0,r.tZ)(eX,{Icon:ev.kn,active:f.isActive("blockquote"),onClick:()=>f.chain().focus().toggleBlockquote().run()}),(0,r.tZ)(eX,{Icon:ev.MM,active:f.isActive("codeBlock"),onClick:()=>f.chain().focus().toggleCodeBlock().run()})]})}),(0,r.tZ)(er.kg,{className:eA.Z.editorContent,editor:f,onKeyDown:e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&p()}}),(0,r.tZ)(Q.t,{visible:s})]})}function eX(e){var{Icon:t,active:n}=e,l=(0,ee._)(e,["Icon","active"]);return(0,r.tZ)(F.kG,(0,o._)((0,i._)({className:ea()(eA.Z.editorMenuButton,n&&eA.Z.editorMenuButtonActive),resetCss:!0},l),{children:(0,r.tZ)(t,{size:18})}))}var eR=n(78446),ez=n(91400),ej=n(64172),eF=n(9738),eD=n(93608),eH=n(50364),eq=n(73943),eJ=n(1581),eV=n.n(eJ),eG=n(20521),eW=n(5889),eY=n(19834);function eK(e){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:eM,i=(0,eY.Z)(e||""),o=i.split(/[\n\r]/g).filter(Boolean).map(e=>t(e,n));if(0===o.length||!o[0])return t(i,n);let r=o[0];if(r.content)for(let e of o.slice(1))e.content&&r.content.push(...e.content);return r}(e,a.AW)}var e$=n(33884),eQ=n(63651),e0=n(7083);let e1="unsent_composer_content_v3",e2={content:null,attachments:[]};function e8(e){var t,n,d,c,p,f,v,g,y,b,Z,k;let{onSuccess:T,onError:S,onClose:P,editComment:N,restackUrl:B,parentPostId:U,parentPubId:j,parentCommentId:F,initialText:H,initialFiles:q,tabId:J,surface:V,videoUploadId:G,mediaClipId:$,isPost:Q}=e,ee=(0,C.aF)(),et=function(){let e=(0,ej.Th)().result;if(!e)return!1;let{publicationUsers:t,publicationMap:n}=e;return t.some(e=>{var t;return null===(t=n.get(e.publication_id))||void 0===t?void 0:t.plans})}(),{iString:en}=(0,_.M1)(),ei={postId:null!==(d=null==N?void 0:N.post_id)&&void 0!==d?d:U,commentId:null!==(c=null==N?void 0:N.id)&&void 0!==c?c:F},eo=N||H?e2:function(){var e,t,n;let{postId:i,commentId:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=o?"c:".concat(o):i?"p:".concat(i):"default";return null!==(n=null===(e=(null!==(t=(0,X.mM)(e1))&&void 0!==t?t:[]).find(e=>{let[t]=e;return t===r}))||void 0===e?void 0:e[1])&&void 0!==n?n:e2}(ei),[er,el]=(0,l.eJ)(null!==(p=null==N?void 0:N.reply_minimum_role)&&void 0!==p?p:"everyone"),[ea,ed]=(0,l.eJ)(null!==(g=null!==(v=null!==(f=null==N?void 0:N.body_json)&&void 0!==f?f:(null==N?void 0:N.body)?eK(N.body):null)&&void 0!==v?v:H?eK(H):null)&&void 0!==g?g:eo.content),es=ea?(0,a._4)(ea,eM):"",[ec,eu]=(0,l.eJ)(q?[]:(null!==(y=null==N?void 0:N.attachments)&&void 0!==y?y:eo.attachments).filter(e=>"image"===e.type).map(e=>{let t={url:e.imageUrl,attachment:e};return t.promise=Promise.resolve(t),t})),[ep,em]=(0,l.eJ)(!1),[eh,ef]=(0,l.eJ)(!1),[ev,eg]=(0,l.eJ)(null!==(b=null==N?void 0:null===(t=N.attachments)||void 0===t?void 0:t.find(e=>"video"===e.type))&&void 0!==b?b:null),[ey,eb]=(0,l.eJ)(!1),[eZ,e_]=(0,l.eJ)(null),[ew,eC]=(0,l.eJ)(null),[ek,eT]=(0,l.eJ)(null),eS=(0,eF.h)({onComplete:e=>{let{mediaUpload:t}=e;(async e=>{let{mediaUpload:t}=e;try{let e=await (0,L.rd)("/api/v1/comment/attachment",{method:"POST",json:{mediaUploadId:t.id,type:"video"}});eg(e),eT(t)}catch(e){console.error(e)}})({mediaUpload:t})},onError:e=>{console.error("something went wrong",e),e4.popToast(t=>{var n;return(0,r.tZ)(Y.FN,(0,o._)((0,i._)({},t),{text:null!==(n=(0,R.zx)(e))&&void 0!==n?n:"Something went wrong. Please try again."}))})}}),ex=(0,eF.h)({onComplete:e=>{let{mediaUpload:t}=e;e_(e=>{var n,r;return e?(0,o._)((0,i._)({},e),{post:(0,o._)((0,i._)({},e.post),{videoUpload:t}),clipInfo:{startTime:0,duration:t.duration||5,isAutoSelected:!1},mediaClip:e.mediaClip?(0,o._)((0,i._)({},e.mediaClip),{assets:null==e?void 0:null===(r=e.mediaClip)||void 0===r?void 0:null===(n=r.assets)||void 0===n?void 0:n.map(e=>(0,o._)((0,i._)({},e),{mediaUpload:t}))}):null}):null}),eb(!1)},onError:()=>{eb(!1)}});(0,l.d4)(()=>{G&&(0,L.rd)("/api/v1/video/upload/".concat(G),{method:"GET"}).then(e=>{eT(e),eS.startPolling({mediaUpload:e})})},[G]);let eP=(0,l.I4)(e=>{ed(e)},[ei.postId,ei.commentId]),eE=eH.Zu,eN=eV()(es).length,eB=eN>eE,eI=e=>{let t=e.filter(e=>e.type.startsWith("image/"));if((null==t?void 0:t.length)>0){let e=6-ec.length;if(ec.length>0&&e<1){e4.popToast(e=>(0,r.tZ)(Y.FN,(0,o._)((0,i._)({},e),{text:"Notes cannot include more than ".concat(6," images."),Icon:h.Z})));return}let n=[...t].slice(0,e).map(e=>{let t={file:e,url:URL.createObjectURL(e)};return t.promise=tc(e).then(e=>(0,o._)((0,i._)({},t),{attachment:e})).catch(e=>(0,o._)((0,i._)({},t),{error:e})).then(e=>(eu(n=>n.map(n=>n===t?e:n)),e)),t});eu(e=>[...e,...n].slice(0,6))}};(0,l.d4)(()=>{(0,O.j)(O.FP.FEED_COMPOSER_SCREEN_VIEWED,{parent_post_id:U,parent_comment_id:F,edit_comment_id:null==N?void 0:N.id,restack_url:B,media_clip_id:$})},[]),(0,l.d4)(()=>{q&&eI(q)},[q]);let eU=async e=>{let t=await (0,A.O)(e.url,{trackingProps:{surface:"note"}}),n=tc(t).then(e=>(0,o._)((0,i._)({},r),{attachment:e}),e=>(0,o._)((0,i._)({},r),{error:e})).then(e=>(eu(t=>t.map(t=>t.promise===n?e:t)),e)),r=(0,o._)((0,i._)({},e),{url:URL.createObjectURL(t),promise:n});eu(t=>t.map(t=>t===e?r:t))},eO=(null!==(Z=null==N?void 0:N.attachments)&&void 0!==Z?Z:eo.attachments).find(e=>!["missing","image"].includes(e.type)),eA=(0,I.ib)({pathname:"/api/v1/comment/attachment",method:"POST",initialResult:eO,deps:[]}),eX=null!=B?B:null===(n=(0,eW.gg)(es))||void 0===n?void 0:n.href;(0,l.d4)(()=>{$&&(0,L.rd)("/api/v1/comment/attachment",{method:"POST",json:{mediaClipId:$,type:"post"}}).then(e=>{var t,n,i,o,r;e_(e);let l=(null==e?void 0:e.type)==="post"&&!!(null===(n=e.mediaClip)||void 0===n?void 0:null===(t=n.assets)||void 0===t?void 0:t.find(e=>{var t;return(null===(t=e.mediaUpload)||void 0===t?void 0:t.state)!=="transcoded"}));if(eb(l),l){let t=null===(r=e.mediaClip)||void 0===r?void 0:null===(o=r.assets)||void 0===o?void 0:null===(i=o.find(e=>{var t;return(null===(t=e.mediaUpload)||void 0===t?void 0:t.state)!=="transcoded"}))||void 0===i?void 0:i.mediaUpload;t?ex.startPolling({mediaUpload:t}):eb(!1)}})},[$]);let ez=(0,l.Ye)(()=>{let e=null,t=eO?Promise.resolve(eO):null;return n=>(n!==e&&(e=n,n&&(t=eA.refetch({json:{url:n,type:"link",mediaClipId:n===B?$:void 0}}))),t)},[]),eD=(0,l.Ye)(()=>u()(ez,500),[ez]);(0,l.d4)(()=>{N&&eA.result||eD(null!=eX?eX:null)},[eX]);let eq=eA.result,eJ=(null==eq?void 0:eq.type)==="post"&&eq.postSelection?eq:null,{preferredTheme:eY}=(0,E.P$)(),[eQ,e8]=(0,l.eJ)(null!==(k=null==eJ?void 0:eJ.postSelectionTheme)&&void 0!==k?k:eY);(0,l.d4)(()=>{let e=[];for(let t of ec)t.attachment&&e.push(t.attachment);eq&&e.push(eq),tr({content:ea,attachments:e},ei)},[ea,ec,eq]);let e4=(0,Y.pm)(),{create:e5,isLoading:e7,error:e9}=function(){let{editComment:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,I.ib)({pathname:e?"/api/v1/feed/comment/".concat(e.id):"/api/v1/comment/feed"});return{create:async n=>{let{bodyJson:i,parentPostId:o,parentPubId:r,parent_id:l,attachmentIds:a,tabId:d,surface:s,replyMinimumRole:c,notifySubscribersPubId:u,isPost:p,videoUploadId:m}=n;return p?await t.refetch({pathname:"/api/v1/publish/posts",method:"POST",json:{title:"Test Post",body:i,audience:"everyone",should_send_email:!1,video_upload_id:m}}):await t.refetch({pathname:e?"/api/v1/feed/comment/".concat(e.id):o?"/api/v1/post/".concat(o,"/comment"):"/api/v1/comment/feed",method:e?"PATCH":"POST",json:{bodyJson:i,parent_id:l,publication_id:r,attachmentIds:a,tabId:d,surface:s,replyMinimumRole:c,notifySubscribersPubId:u}})},error:t.error,isLoading:t.isLoading}}({editComment:N}),e3=F||U,te=!ev&&!!(ew||ek),tt=ep||eB||e7||te||!(es||ec.length>0||eq||ev||eZ),ti=(0,eR.N4)(),ta=function(){var e;let t=(0,ej.Th)().result;if(!t||!(null===(e=t.publicationUsers)||void 0===e?void 0:e.length))return[];let n=m()(t.publications,"id"),i=(0,eG.x)(t.publicationUsers.filter(e=>{let{role:t}=e;return["admin","contributor"].includes(t)}));return s()(i.map(e=>{let{publication_id:t}=e;return n[t]}))}(),{getConfigFor:tp}=(0,w.xR)(),tm=tp("enable_author_note_email_toggle"),tf=!tt&&tm&&ta.length>0&&!N&&!e3&&(!eq||"post"!==eq.type),tv=async()=>{if(tt)return;let e=null;if(tm&&eh&&!(e=await ti.confirm()))return;em(!0);let t=eA.result||eA.isLoading?await ez(null!=eX?eX:null):null,n=t instanceof Error?null:t,l=await Promise.all(ec.map(e=>e.promise)),a=[];for(let e of l)if(e){let{attachment:t}=e;t&&"missing"!==t.type&&a.push(t.id)}if(ev&&a.push(ev.id),eZ&&a.push(eZ.id),n&&"missing"!==n.type&&n.id!==(null==ev?void 0:ev.id)&&a.push(n.id),(null==n?void 0:n.type)==="post"&&n.postSelection&&eQ)try{await (0,L.rd)("/api/v1/comment/attachment/".concat(n.id,"/post_selection_theme"),{method:"PATCH",json:{theme_name:eQ.name,theme_alignment:eQ.alignment}})}catch(e){console.error(e),console.warn("Failed to update theme. Skipping.")}let d=await e5({bodyJson:ea,parentPostId:U,parentPubId:j,parent_id:F,attachmentIds:a.length>0?a:void 0,tabId:J,surface:V,replyMinimumRole:er,notifySubscribersPubId:null!=e?e:void 0,isPost:Q,videoUploadId:null==ev?void 0:ev.media_upload_id});d instanceof Error?(e4.popToast(e=>(0,r.tZ)(Y.FN,(0,o._)((0,i._)({},e),{text:"Failed to share"}))),console.error(d),S&&S(d)):(tr(null,ei),e4.popToast(e=>(0,r.tZ)(Y.FN,(0,o._)((0,i._)({},e),{text:N?"Note edited":e3?"Reply sent":B?"Restacked":"Note sent",cta:"View",href:(0,e$.Sg)(d)}))),T(d)),em(!1)},tg=(0,M.uk)({onAddFiles:e=>{let t=e.filter(e=>(0,M.zN)({fileType:e.type}));t.length>0&&t[0]&&eC(t[0]),eI(e)},acceptFile:e=>{let{fileType:t}=e;return(0,M.N1)({fileType:t})||!!(0,M.zN)({fileType:t})}});return ee?(0,r.BX)(e6,{onClose:e=>{e.stopPropagation(),P()},title:N?"Edit":e3?"Reply":B?"Restack":"New note",postLabel:N?"Save":eh?"Continue":"Post",hasImageAttachment:ec.length>0,onSubmit:e=>{e.preventDefault(),tv()},disabled:tt,onImageChange:e=>{if(ep)return;let{files:t}=e.currentTarget;eI(Array.from(t))},isDragging:tg.isDragging,videoUploadProps:{onVideoFileSelected:e=>{let t=()=>{e4.popToast(e=>(0,r.tZ)(Y.FN,(0,o._)((0,i._)({},e),{text:en("Something went wrong. Please try again.")})))};if(!e.currentTarget){console.warn("input change event had no currentTarget"),t();return}if(!(e.currentTarget instanceof HTMLInputElement)){console.warn("input change event currentTarget was not an input"),t();return}let n=e.currentTarget,{files:l}=n;if(!l){console.warn("input change event had no files"),t();return}if(l.length>1&&console.error("selected multiple files, at most 1 file allowed"),0===l.length){console.error("must select exactly one file"),t();return}eC(l[0]),n.value=""},mediaUpload:ek,selectedVideoFile:ew},menu:!et||F||U||(null==N?void 0:N.ancestor_path)?null:(0,r.tZ)(td,{value:er,onChange:el}),composerFooterRow:tf?(0,r.tZ)(tn,{checked:eh,onChange:ef}):null,parentPostId:U,children:[(0,r.tZ)(ts,{modal:ti,userPubs:ta,initialSelectedPubId:1===ta.length&&ta[0]?ta[0].id:null}),(0,r.BX)(D.tu,{flex:"grow",children:[F&&(0,r.tZ)(tl,{commentId:F}),(0,r.BX)(D.hs,{gap:12,minWidth:0,children:[(0,r.tZ)(z.qE,{size:36,user:ee}),(0,r.BX)(D.tu,{gap:8,flex:"grow",className:e0.Z.editorContainer,minWidth:0,children:[(0,r.BX)(D.tu,{gap:2,flex:"fill",children:[(0,r.tZ)(x.Et,{user:ee}),(0,r.tZ)(eL,{defaultValue:ea,placeholder:e3?"Leave a reply...":B?"Write something...":"What's on your mind?",onChange:eP,onReturn:tv,onEscape:P,onDrop:tg.props.onDrop,onAddFiles:eI,disabled:ep})]}),(0,r.tZ)(to,{files:ec,handleImageRemove:e=>{eu(t=>t.filter(t=>t!==e))},handleImageEdit:eU,onReorder:eu}),(0,r.tZ)(tu,{selectedVideoFile:ew,initialMediaUpload:ek,setSelectedVideoFile:eC,setVideoAttachment:eg,setInitialMediaUpload:eT}),(0,r.tZ)(th,{attachment:eZ,isLoading:ey,onRemove:()=>e_(null)}),(0,r.tZ)(th,{attachment:eq,isLoading:eA.isLoading,onRemove:()=>eA.setResult(null),onQuoteThemeChange:e8})]})]})]}),(eB||e9)&&(0,r.BX)(D.gq,{direction:"row-reverse",justifyContent:"space-between",paddingY:16,children:[eB&&(0,r.tZ)(W.xv.Meta,{color:eB?"error":void 0,children:eE-eN}),e9&&(0,r.tZ)(K.o,{error:e9})]})]}):null}function e6(e){let{title:t,postLabel:n,disabled:i,onImageChange:o,videoUploadProps:l,isDragging:a,onSubmit:d,onClose:s,children:c,menu:u,composerFooterRow:p,hasImageAttachment:m,parentPostId:h}=e,f=!!l.selectedVideoFile&&!l.mediaUpload||!!l.mediaUpload;return(0,r.BX)(N.T,{children:[(0,r.BX)(D.tu,{className:e0.Z.modalColumn,gap:16,paddingY:16,children:[(0,r.tZ)(e4,{title:t,postLabel:n,disabled:i,onClose:s,onSubmit:d}),(0,r.tZ)(e7,{children:u}),(0,r.tZ)(e9,{children:c}),null!=p?p:null,(0,r.tZ)(e3,{parentPostId:h,onImageChange:o,hasVideoFile:f,hasImageAttachment:m,videoUploadProps:l,disabled:i,postLabel:n,onClose:s,onSubmit:d})]}),(0,r.tZ)(Q.t,{visible:a})]})}function e4(e){return(0,ez.XA)()?(0,r.tZ)(e5,(0,i._)({},e)):null}function e5(e){let{title:t,postLabel:n,disabled:i,onClose:o,onSubmit:l}=e;return(0,r.BX)(D.gq,{borderBottom:"detail",alignItems:"center",paddingBottom:12,paddingX:16,gap:12,justifyContent:"space-between",children:[(0,r.tZ)(F.hU,{"aria-label":"Back",priority:"secondary",size:"sm",onClick:o,children:(0,r.tZ)(f.Z,{size:20})}),(0,r.tZ)(W.xv.H4,{flex:"grow",children:t}),(0,r.tZ)(F.zx,{disabled:i,size:"sm",onClick:l,children:n})]})}function e7(e){let{children:t}=e;return t?(0,r.tZ)(D.hs,{padding:16,paddingY:0,children:t}):null}function e9(e){let{children:t}=e;return(0,r.tZ)(D.tu,{paddingX:16,paddingBottom:0,style:{flex:"1 1 auto",flexDirection:"column",maxHeight:"80vh"},gap:12,overflowY:"auto",scrollBar:"hidden",children:t})}function e3(e){return(0,ez.XA)()?(0,r.tZ)(te,(0,i._)({},e)):(0,r.tZ)(tt,(0,i._)({},e))}function te(e){let{parentPostId:t,onImageChange:n,hasVideoFile:i,hasImageAttachment:o,videoUploadProps:l}=e;return t?null:(0,r.tZ)(D.tu,{paddingX:16,style:{flex:"0 0 auto"},minHeight:0,children:(0,r.BX)(D.gq,{alignItems:"start",justifyContent:"start",paddingX:4,paddingY:12,borderTop:"detail",sizing:"border-box",children:[n&&!i&&(0,r.tZ)(ti,{onChange:n}),!o&&(0,r.tZ)(P.H,{mediaUpload:l.mediaUpload,selectedFile:l.selectedVideoFile,onInputChange:l.onVideoFileSelected})]})})}function tt(e){let{parentPostId:t,onImageChange:n,hasVideoFile:i,hasImageAttachment:o,videoUploadProps:l,disabled:a,postLabel:d,onClose:s,onSubmit:c}=e,{iString:u}=(0,_.M1)();return(0,r.BX)(D.gq,{justifyContent:"space-between",paddingX:16,children:[(0,r.BX)(D.gq,{gap:4,children:[!t&&n&&!i&&(0,r.tZ)(ti,{onChange:n}),!t&&!o&&(0,r.tZ)(P.H,{mediaUpload:l.mediaUpload,selectedFile:l.selectedVideoFile,onInputChange:l.onVideoFileSelected})]}),(0,r.BX)(D.gq,{gap:12,children:[(0,r.tZ)(F.zx,{priority:"secondary",onClick:s,children:u("Cancel")}),(0,r.tZ)(F.zx,{disabled:a,onClick:c,children:d})]})]})}function tn(e){let{checked:t,onChange:n}=e,{iString:i}=(0,_.M1)();return(0,r.tZ)(D.tu,{paddingX:16,paddingTop:12,children:(0,r.BX)(D.hs,{gap:8,alignItems:"center",justifyContent:"space-between",bg:"secondary",flex:"grow",padding:12,radius:"sm",children:[(0,r.tZ)(W.xv.B4,{weight:"semibold",children:i("Also send as email")}),(0,r.tZ)(G.rs,{checked:t,onChange:e=>{(0,O.j)(O.FP.SEND_NOTE_AS_EMAIL_TOGGLE_CLICKED,{checked:e}),n(e)}})]})})}function ti(e){let{onChange:t,useVideo:n=!1}=e,i=(0,l.sO)();return(0,r.BX)(F.hU,{priority:"tertiary",onClick:()=>{var e;null===(e=i.current)||void 0===e||e.click()},children:[n?(0,r.tZ)(v.Z,{size:20}):(0,r.tZ)(g.Z,{size:20}),(0,r.tZ)("input",{type:"file",accept:"image/*,.heic",multiple:!0,onChange:e=>{t(e),i.current.value=""},ref:i,style:{display:"none"}})]})}function to(e){let{files:t,handleImageRemove:n,handleImageEdit:l,onReorder:a}=e,d=t.map(e=>e.url);return 0===t.length?null:(0,r.tZ)(H.A,{items:d,onReorder:e=>{a(e.map(e=>t.find(t=>t.url===e)))},children:(0,r.tZ)(D.gq,{gap:8,wrap:"wrap",children:t.map((e,t)=>(0,r.tZ)(H.L,{item:e.url,index:t,children:t=>{var a,d;let{listeners:s}=t;return(0,r.BX)(D.hs,(0,o._)((0,i._)({className:e0.Z.imageContainer,position:"relative",outline:"detail",radius:"sm",overflow:"hidden",flex:"auto",cursor:"grab"},s),{children:[(null===(a=e.attachment)||void 0===a?void 0:a.type)==="image"&&e.attachment.imageUrl.endsWith(".heic")?(0,r.tZ)("img",{src:(0,eQ.zF4)(e.attachment.imageUrl)}):(null===(d=e.file)||void 0===d?void 0:d.type)==="image/heic"?null:(0,r.tZ)("img",{src:e.url}),(0,r.BX)(D.tu,{position:"absolute",alignItems:"end",gap:8,className:e0.Z.imageActions,children:[(0,r.tZ)(F.GI,{size:"sm",onClick:()=>n(e),children:(0,r.tZ)(y.Z,{size:20})}),(0,r.tZ)(F.GI,{size:"sm",onClick:()=>l(e),children:(0,r.tZ)(b.Z,{size:18})})]})]}))}},e.url))})})}function tr(e){var t;let{postId:n,commentId:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i?"c:".concat(i):n?"p:".concat(n):"default",r=null!==(t=(0,X.mM)(e1))&&void 0!==t?t:[],l=r.findIndex(e=>{let[t]=e;return t===o});l>=0&&r.splice(l,1),e&&(r.unshift([o,e]),r.splice(10)),(0,X.ex)(e1,r)}function tl(e){let{commentId:t}=e,{result:n}=(0,I.ib)({pathname:"/api/v1/reader/comment/".concat(t),deps:[t],auto:!0});return n?(0,r.tZ)(ta,{comment:n.item.comment,parentComments:n.item.parentComments}):null}function ta(e){let{comment:t,parentComments:n}=e,{truncatedBodyJson:i}=(0,U.Z)(t),o=n[n.length-1];return(0,r.BX)(D.hs,{className:eO.Z.replyUnit,gap:12,paddingBottom:20,children:[(0,r.tZ)(B.Zb,{user:t}),(0,r.BX)(D.tu,{minWidth:0,gap:16,flex:"grow",children:[(0,r.BX)(D.tu,{children:[(0,r.BX)(x.KF,{children:[(0,r.tZ)(W.xv,{as:"span",weight:"medium",children:t.name}),(0,r.tZ)($.o,{tier:t.user_bestseller_tier}),(0,r.tZ)(B.Ku,{timestamp:t.date})]}),o&&(0,r.BX)(W.xv.B5,{color:"secondary",children:["Replying to ",o.name]}),(0,r.tZ)(B.sP,{children:i&&(0,r.tZ)(T.x,{content:i,attachedLinks:(0,S.Bk)(t)})})]}),t.attachments&&(0,r.tZ)(k.yd,{readOnly:!0,attachments:t.attachments})]})]})}function td(e){let{value:t,onChange:n}=e,{iString:i}=(0,_.M1)();return(0,r.BX)(q.v2,{layerOptions:{placement:"bottom-start"},trigger:(0,r.tZ)(F.zx,{priority:"secondary",size:"sm",trailing:(0,r.tZ)(Z.Z,{}),children:"everyone"===t?"Anyone can reply":"free_subscriber"===t?"Subscriber replies":"Paid replies only"}),children:[(0,r.tZ)(q.yU,{children:i("Who can reply to this note?")}),(0,r.tZ)(q.sN,{onClick:()=>n("everyone"),children:i("Anyone")}),(0,r.tZ)(q.sN,{onClick:()=>n("paid_subscriber"),children:i("Only paid subscribers")})]})}function ts(e){var t;let{modal:n,userPubs:i,initialSelectedPubId:o}=e,[a,d]=(0,l.eJ)(o),s=(0,ez.XA)();return(0,r.tZ)(J.u_,{onClose:()=>n.handleCancel(null),isOpen:n.isConfirming,children:(0,r.BX)(D.tu,{padding:24,gap:24,children:[(0,r.BX)(D.tu,{gap:12,children:[(0,r.tZ)(W.xv.H3,{children:"Are you sure you want to notify your subscribers via email?"}),(0,r.BX)(W.xv.B3,{children:[1===i.length&&i[0]?"This note will be emailed to subscribers of ".concat(null!==(t=i[0].name)&&void 0!==t?t:"your publication","."):"Select which subscriber list to email this note to."," ","Only readers who opted into note notifications will receive it:"]}),1===i.length?void 0:(0,r.tZ)(D.tu,{padding:4,border:"detail",radius:"md",overflowY:"auto",style:{maxHeight:s?200:500},children:i.map(e=>(0,r.BX)(D.gq,{className:e0.Z.notifyConformModalPubRow,gap:12,alignItems:"center",flex:"fill",onClick:()=>{(0,O.j)(O.FP.SEND_NOTE_AS_EMAIL_PUBLICATION_SELECTED,{publication_id:e.id}),d(e.id)},padding:6,radius:"sm",cursor:"pointer",children:[(0,r.tZ)("input",{type:"radio",name:"selectedEmailPubId",checked:a===e.id,value:e.id}),(0,r.tZ)("img",{width:32,src:(0,eQ.zF4)(e.logo_url||"/img/substack-nomargin.png",32),className:(0,j.oB)({radius:"sm"})}),(0,r.tZ)(W.xv.B4,{overflow:"hidden",ellipsis:!0,children:e.name})]},e.id))})]}),(0,r.BX)(D.hs,{justifyContent:"end",gap:12,children:[(0,r.tZ)(F.zx,{priority:"secondary",onClick:()=>{(0,O.j)(O.FP.SEND_NOTE_AS_EMAIL_CONFIRMATION_REJECTED),n.handleCancel(null)},rounded:!0,children:"Cancel"}),(0,r.tZ)(F.zx,{disabled:null===a,onClick:()=>{a&&((0,O.j)(O.FP.SEND_NOTE_AS_EMAIL_CONFIRMATION_REJECTED,{publication_id:a}),n.handleConfirm(a))},rounded:!0,children:"Post"})]})]})})}async function tc(e){let t=await (0,R.Zk)(e),n=await (0,L.rd)("/api/v1/image",{method:"POST",json:{image:t}});return await (0,L.rd)("/api/v1/comment/attachment",{method:"POST",json:{url:n.url,type:"image"}})}function tu(e){let{selectedVideoFile:t,initialMediaUpload:n,setSelectedVideoFile:i,setVideoAttachment:o,setInitialMediaUpload:l}=e,{getConfigFor:a}=(0,w.xR)();if(!t&&!n)return null;let d=()=>{i(null),o(null),l(null)},s=async e=>{let{mediaUpload:t}=e;if(t)try{let e=await (0,L.rd)("/api/v1/comment/attachment",{method:"POST",json:{mediaUploadId:t.id,type:"video"}});o(e)}catch(e){console.error(e)}};return(0,r.tZ)(eD._,{file:t,initialMediaUpload:n,maxVideoDurationSeconds:a("ignore_video_in_notes_length_limit")?Number.MAX_SAFE_INTEGER:eq.u,onCancel:d,onRemoveVideo:d,onComplete:s,videoPlayerProps:{surface:"feed",contentType:"comment",entityType:"comment",entityKey:"unknown"}})}function tp(){return(0,r.tZ)(D.hs,{className:e0.Z.postAttachment,height:120,bg:"secondary",border:"detail",radius:"md",alignItems:"center",justifyContent:"center",children:(0,r.tZ)(V.$j,{})})}function tm(e){let{onRemove:t,children:n}=e;return(0,r.BX)(D.tu,{position:"relative",children:[n,(0,r.tZ)(F.GI,{className:e0.Z.removeAttachment,position:"absolute",size:"sm",rounded:!0,onClick:t,zIndex:1,children:(0,r.tZ)(y.Z,{size:20})})]})}function th(e){let{attachment:t,isLoading:n,onRemove:i,onQuoteThemeChange:o}=e;return t||n?n?(0,r.tZ)(tp,{}):t?(0,r.tZ)(tm,{onRemove:i,children:(0,r.tZ)(k.yd,{attachments:[t],readOnly:!0,isComposing:!0,onQuoteThemeChange:o})}):null:null}},2891:function(e,t,n){"use strict";n.d(t,{T:()=>r});var i=n(16584),o=n(5749);function r(e){let{children:t}=e;return(0,i.tZ)("div",{className:o.Z.variables,children:t})}},36349:function(e,t,n){"use strict";function i(e){return Array.from(e.items).filter(e=>"file"===e.kind&&e.type.startsWith("image/")).length>0}n.d(t,{d:()=>i})},39556:function(e,t,n){"use strict";async function i(e,t){let{editImage:i}=await Promise.all([n.e("6666"),n.e("4769")]).then(n.bind(n,71682));return i(e,t)}async function o(e,t){let{editImageAndRehost:i}=await Promise.all([n.e("6666"),n.e("4769")]).then(n.bind(n,71682));return i(e,t)}n.d(t,{N:()=>o,O:()=>i})},10656:function(e,t,n){"use strict";n.d(t,{G5:()=>d,Iw:()=>u,Nm:()=>p,tS:()=>c,z_:()=>s});var i=n(16584),o=n(6400),r=n(95441),l=n(31582),a=n(84864);let d=(e,t)=>{var n,i,l;let a="undefined"!=typeof window&&null!==(l=null===(i=window._preloads)||void 0===i?void 0:null===(n=i.pub)||void 0===n?void 0:n.language)&&void 0!==l?l:"en";(0,o.render)((0,o.h)(r._7,{language:a,children:e}),t)},s=e=>e.podcast_url&&e.podcast_duration>0?"podcast":e.videoUpload&&e.videoUpload.duration&&e.videoUpload.duration>0?"video":"thread"===e.type?"thread":"newsletter",c=function(e){let t,n,o,r,d,{currency:s,totalAmount:c,discount:u,quantity:p=1,trial_end_override:m,noTrial:h=!1,recurring:f=!0,isGroupSubscription:v=!1,isUnlimitedGroupSubscription:g=!1,language:y="en"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{iString:b,iPlural:Z}=I18N.i(y);if(s||(s=e.currency),void 0!==c)t=c;else{let n=(0,l.$e)(e,s);if(void 0===n){var _;s=e.currency,n=null!==(_=e.amount)&&void 0!==_?_:0}t=n*p}let w=(0,a.centsToPriceString)(t,s);if(u&&!u.loading&&!u.error&&(u.percent_off||u.amount_off)){let e;u.percent_off?e=Math.round(t*(1-(u.percent_off_precise||u.percent_off)/100)):u.amount_off&&(e=Math.max(0,t-u.amount_off)),n=(0,a.centsToPriceString)(e,s)}let C=n||w;e.is_bitcoin?("month"===e.interval&&(o=Z("%2/1 month","%2/%1 months",e.interval_count,C)),"week"===e.interval&&(o=Z("%2/1 week","%2/%1 weeks",e.interval_count,C)),"day"===e.interval&&(o=Z("%2/1 day","%2/%1 days",e.interval_count,C)),"year"===e.interval&&(o=Z("%2/1 year","%2/%1 years",e.interval_count,C))):e&&f&&!v&&!g?("month"===e.interval&&(o=Z("%2 per month","%2 per %1 months",e.interval_count,C)),"week"===e.interval&&(o=Z("%2 per week","%2 per %1 weeks",e.interval_count,C)),"day"===e.interval&&(o=Z("%2 per day","%2 per %1 days",e.interval_count,C)),"year"===e.interval&&(o=Z("%2 per year","%2 per %1 years",e.interval_count,C))):!e||f||v||g?e&&f&&v&&!g?("month"===e.interval&&(o=Z("%2 for one month per person","%2 for %1 months per person",e.interval_count,C)),"week"===e.interval&&(o=Z("%2 for one week per person","%2 for %1 weeks per person",e.interval_count,C)),"day"===e.interval&&(o=Z("%2 for one day per person","%2 for %1 days per person",e.interval_count,C)),"year"===e.interval&&(o=Z("%2 for one year per person","%2 for %1 years per person",e.interval_count,C))):e&&f&&v&&g&&("month"===e.interval&&(o=Z("%2 for one month for unlimited seats","%2 for %1 months for unlimited seats",e.interval_count,C)),"week"===e.interval&&(o=Z("%2 for one week for unlimited seats","%2 for %1 weeks for unlimited seats",e.interval_count,C)),"day"===e.interval&&(o=Z("%2 for one day for unlimited seats","%2 for %1 days for unlimited seats",e.interval_count,C)),"year"===e.interval&&(o=Z("%2 for one year for unlimited seats","%2 for %1 years for unlimited seats",e.interval_count,C))):("month"===e.interval&&(o=Z("%2 for one month","%2 for %1 months",e.interval_count,C)),"week"===e.interval&&(o=Z("%2 for one week","%2 for %1 weeks",e.interval_count,C)),"day"===e.interval&&(o=Z("%2 for one day","%2 for %1 days",e.interval_count,C)),"year"===e.interval&&(o=Z("%2 for one year","%2 for %1 years",e.interval_count,C)));let k=Math.max(0,"trial_period_days"in e&&e.trial_period_days||0,u&&u.trial_period_days||0,m?Math.ceil((m-Date.now()/1e3)/60/60/24):0);if(!h&&k>0&&(r=Z("1 day free trial","%1 day free trial",k)),u&&n&&f&&"forever"!==u.duration){let t="once"===u.duration?1:u.duration_in_months/("year"===e.interval?12:1)*e.interval_count;"month"===e.interval&&(d=Z("for first month","for first %1 months",t)),"week"===e.interval&&(d=Z("for first week","for first %1 weeks",t)),"day"===e.interval&&(d=Z("for first day","for first %1 days",t)),"year"===e.interval&&(d=Z("for first year","for first %1 years",t))}return u&&u.loading?(0,i.BX)(i.HY,{children:[o," ",(0,i.BX)("span",{className:"discount-price",children:[" (",b("coupon loading"),")"]})]}):u&&u.error?(0,i.BX)(i.HY,{children:[o," ",(0,i.BX)("span",{className:"discount-price error",children:[" (",b("coupon invalid or expired"),")"]})]}):n?(0,i.BX)(i.HY,{children:[(0,i.tZ)("span",{className:"crossed-out",children:w})," ",(0,i.BX)("span",{className:"discount-price",children:[o," ",d?"(".concat(d,") "):"",r]})]}):(0,i.BX)(i.HY,{children:[o," ",r]})};async function u(e){let{timeout:t=5e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement("video");n.volume=0;let i=!1,o=Promise.race([new Promise(e=>{n.onloadedmetadata=()=>{n.onloadedmetadata=null,n.duration===1/0?(n.currentTime=Number.MAX_SAFE_INTEGER,n.ontimeupdate=()=>{n.ontimeupdate=null,i=!0,e(n.duration),n.currentTime=0}):e(n.duration)},n.onerror=t=>{i=!0;let n=null;"string"==typeof t?n=t:t.target&&"error"in t.target&&(n=t.target.error),e({is_error:!0,err:n})}}),new Promise(e=>{setTimeout(()=>{i||e({is_error:!0,err:Error("Blob duration fetching timed out")})},t)})]);try{n.src="string"==typeof e||"string"==typeof e?e:window.URL.createObjectURL(e)}catch(e){return{is_error:!0,err:e}}return o}let p=(e,t)=>{let{decimals:n=0}=t||{};return Math.round(e*Math.pow(10,n))/Math.pow(10,n)}},70717:function(e,t,n){"use strict";n.d(t,{w:()=>a});var i=n(16584),o=n(19081),r=n(58175),l=n(84864);let a=e=>{let{duration:t,icon:n,position:a="bottom-left",previewDuration:d}=e;return(0,i.BX)(o.gq,{alignItems:"center",bg:"glass-inverted-medium",gap:6,paddingX:8,paddingY:2,position:"absolute",radius:"sm",style:"bottom-left"===a?{left:8,bottom:8}:{right:8,bottom:8},children:[n,(0,i.tZ)(r.xv.Meta,{color:"white",lineHeight:20,children:d?"".concat((0,l.secondsToHHMMSS)(d)," / ").concat((0,l.secondsToHHMMSS)(null!=t?t:0)):(0,l.secondsToHHMMSS)(null!=t?t:0)})]})}},75795:function(e,t,n){"use strict";n.d(t,{t:()=>c});var i=n(16584),o=n(94184),r=n.n(o);let l=(0,n(36150).Z)("CircleArrowDown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);var a=n(19081),d=n(58175);let s={outer:"outer-cgmpdg",blur:"blur-gBxOTe",visible:"visible-noUyc6",icon:"icon-mx19LD"};function c(e){let{visible:t=!1,label:n="Drop file here to upload",blur:o=!0,className:c}=e;return(0,i.BX)(a.tu,{className:r()(t&&s.visible,o&&s.blur,s.outer,c),alignItems:"center",justifyContent:"center",gap:12,children:[(0,i.tZ)(l,{size:32,stroke:"var(--color-utility-white)",className:r()(t&&s.visible,s.icon)}),n&&(0,i.tZ)(d.xv.B3,{weight:"regular",color:"white",children:n})]})}},78446:function(e,t,n){"use strict";n.d(t,{N4:()=>a,sm:()=>d});var i=n(16584),o=n(30396),r=n(15771),l=n(15562);function a(){let[e,t]=(0,o.eJ)(null);return{confirm:()=>new Promise((n,i)=>{e&&i(Error("Already confirming.")),t({resolve:n,reject:i})}),isConfirming:!!e,handleConfirm:n=>{t(null),null==e||e.resolve(n)},handleCancel:n=>{t(null),null==e||e.resolve(n)}}}function d(e){let{title:t,body:n,cancelLabel:o="Cancel",confirmLabel:a="Confirm",modal:d}=e;return(0,i.tZ)(l.W,{isOpen:d.isConfirming,onClose:()=>d.handleCancel(!1),title:t,description:n,primaryButton:(0,i.tZ)(r.zx,{priority:"destructive",onClick:()=>d.handleConfirm(!0),children:a}),secondaryButton:(0,i.tZ)(r.zx,{priority:"secondary",onClick:()=>d.handleCancel(!1),children:o})})}},93608:function(e,t,n){"use strict";n.d(t,{_:()=>g});var i=n(7409),o=n(99282),r=n(16584),l=n(30396),a=n(71375),d=n(82061),s=n(98914),c=n(98422),u=n(80026),p=n(98248),m=n(70379),h=n(76820),f=n(9738);let v={videoPlaceholder:"videoPlaceholder-Z0QT3t",remove:"remove-Gneeir",loader:"loader-R9PbTT"};function g(e){let{file:t,initialMediaUpload:n,onCancel:g,onRemoveVideo:b,onComplete:Z,maxVideoDurationSeconds:_,videoPlayerProps:w}=e,C=(0,l.sO)(null),{isMobile:k}=(0,c.v9)(),[T,S]=(0,l.eJ)(!1),[x,P]=(0,l.eJ)(null!=n?n:null),[E,N]=(0,l.eJ)(null),B=(0,m.pm)(),I=()=>{P(null),S(!1),N(null)},M=(0,f.h)({onComplete:e=>{let{mediaUpload:t}=e;P(t),Z({mediaUpload:t})},onError:e=>{console.error("something went wrong",e),I(),B.popToast(t=>{var n;return(0,r.tZ)(m.FN,(0,o._)((0,i._)({},t),{text:null!==(n=(0,s.zx)(e))&&void 0!==n?n:"Something went wrong. Please try again."}))})}});if((0,l.d4)(()=>{if(!t)return;let e=C.current;if(!e){console.error("Video not found");return}return e.src=URL.createObjectURL(t),()=>{URL.revokeObjectURL(e.src)}},[t]),(0,l.d4)(()=>{P(n)},[n]),!t&&!x)return null;let U=()=>{M.cancel(),P(null),S(!1),N(null),g()};if(!t&&x&&"uploaded"===x.state)return(0,r.tZ)(y,{mediaUpload:x});if(x&&"transcoded"===x.state)return(0,r.tZ)(u.gq,{wrap:"wrap",children:(0,r.BX)(u.gq,{position:"relative",children:[(0,r.tZ)(h.Jl,{mediaUpload:x,videoPlayerProps:w,composing:!0}),(0,r.tZ)(u.GI,{onClick:()=>{M.cancel(),P(null),S(!1),N(null),b()},priority:"primary",position:"absolute",className:v.remove,rounded:!0,size:"sm",children:(0,r.tZ)(a.Z,{size:"20"})})]})});let O=k?h.YQ:h.PJ;return(0,r.BX)(u.gq,{wrap:"wrap",position:"relative",children:[(0,r.tZ)(d.nP,{initialFile:t,maxVideoDurationSeconds:_,onVideoTooLong:()=>{B.popToast(e=>(0,r.tZ)(m.FN,(0,o._)((0,i._)({},e),{text:"Video is too long. Maximum duration is ".concat(_," seconds.")}))),U()},videoFeature:"hero",mediaType:"video",onProgress:e=>{let{percentComplete:t}=e;N(t)},onUpload:e=>{S(!0);let t=e.mediaUpload;P(t),M.startPolling({mediaUpload:t})},setPostId:null,onUploadCanceled:()=>{U()}}),(0,r.BX)(u.gq,{position:"relative",radius:"md",outline:"detail",bg:"secondary",overflow:"hidden",children:[(0,r.tZ)("video",{ref:C,className:v.videoPlaceholder,style:{maxHeight:"".concat(O,"px"),maxWidth:"".concat(O,"px")}}),(0,r.BX)(u.tu,{position:"absolute",inset:0,justifyContent:"center",alignItems:"center",children:[(0,r.tZ)(u.GI,{priority:"primary",rounded:!0,size:"lg",onClick:()=>{U()},children:(0,r.tZ)(a.Z,{size:20})}),(0,r.tZ)(u.xu,{position:"absolute",style:{pointerEvents:"none"},children:T||E&&E>=1?(0,r.tZ)(p.$j,{size:40,media:!0}):(0,r.tZ)(p.Hl,{percent:null!=E?E:0,size:40,media:!0,className:v.loader})})]})]})]})}let y=e=>{var t,n;let{mediaUpload:o}=e,l=null!==(t=o.width)&&void 0!==t?t:640,d=null!==(n=o.height)&&void 0!==n?n:360,s=d>l;return(0,r.BX)(u.gq,{alignItems:"center",bg:"secondary",justifyContent:"center",radius:"md",position:"relative",style:(0,i._)({aspectRatio:"".concat(l," / ").concat(d)},s?{height:400,alignSelf:"flex-start"}:{width:"100%"}),children:[(0,r.tZ)(u.GI,{priority:"primary",rounded:!0,size:"lg",disabled:!0,children:(0,r.tZ)(a.Z,{size:20})}),(0,r.tZ)(u.xu,{position:"absolute",style:{pointerEvents:"none"},children:(0,r.tZ)(p.$j,{size:40,media:!0})})]})}},9738:function(e,t,n){"use strict";n.d(t,{h:()=>r});var i=n(30396),o=n(48980);function r(e){let{onComplete:t,onError:n}=e,[r,l]=(0,i.eJ)({mediaState:"waitingForUpload",mediaUpload:null}),a=(0,i.I4)(async()=>{"polling"===r.mediaState&&r.pollTranscodeTimer&&clearTimeout(r.pollTranscodeTimer)},[r]),d=async()=>{if("polling"!==r.mediaState){console.warn("pollForCompletion called, state must be uploaded|polling but was",r.mediaState);let e=Error("pollForCompletion called, state must be uploaded|polling but was [".concat(r.mediaState,"]"));l({mediaState:"error",mediaUpload:r.mediaUpload,error:e}),n({err:e});return}try{let e=await (0,o.rd)("/api/v1/video/upload/".concat(r.mediaUpload.id),{method:"GET"});switch(e.state){case"error":{let t=Error("media upload was in error state");l({mediaState:"error",mediaUpload:e,error:t}),n({err:t});break}case"cancelled":{let t=Error("media upload was in canceled state");l({mediaState:"error",mediaUpload:e,error:t}),n({err:t});break}case"transcoded":l({mediaState:"complete",mediaUpload:e}),t({mediaUpload:e});break;case"created":case"uploaded":{let e=window.setTimeout(()=>{d()},5e3);l(t=>"polling"!==t.mediaState?(console.warn("in pollForCompletion, prev.mediaState should be polling but was ",t.mediaState),t):{mediaState:"polling",mediaUpload:t.mediaUpload,pollTranscodeTimer:e});break}default:console.error("unhandled state for media upload",e)}}catch(e){console.error("Failed to load media upload:",e),l({mediaState:"error",error:e,mediaUpload:r.mediaUpload}),n({err:e})}};return(0,i.d4)(()=>("polling"===r.mediaState&&null===r.pollTranscodeTimer&&d(),()=>{"polling"===r.mediaState&&r.pollTranscodeTimer&&clearTimeout(r.pollTranscodeTimer)}),[r]),{mediaUpload:r.mediaUpload,mediaState:r.mediaState,cancel:a,startPolling:e=>{let{mediaUpload:t}=e;"uploaded"!==t.state&&console.warn("startPolling called, but mediaUpload was not in state uploaded, was [".concat(t.state,"]")),l({mediaState:"polling",mediaUpload:t,pollTranscodeTimer:null})}}}},22966:function(e,t,n){"use strict";let i;n.d(t,{T6:()=>Z,d0:()=>b,oJ:()=>y});var o=n(58865),r=n(6400),l=n(88897),a=n(59981),d=n(92007),s=n(55679),c=n(42441),u=n.n(c),p=n(45088),m=n(70075),h=n(3258),f=n(63651);function v(){let e=(0,o._)(["No results for ",""]);return v=function(){return e},e}let g=a.ZP.extend({name:"substack_mention",addAttributes:()=>({id:w("id"),label:w("label"),mentionType:w("mentionType"),url:w("url")}),renderHTML(e){let{node:t,HTMLAttributes:n}=e;return["substack-mention",(0,l.P1)({class:"substack-mention","data-type":this.name},this.options.HTMLAttributes,n),this.options.renderLabel({options:this.options,node:t})]},addNodeView:()=>(0,s.fW)(_)}),y=e=>async t=>{let{query:n}=t;return n.length<2?[]:await (0,h.O7)(n,{pathname:e})},b=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"user",{onActive:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return()=>{let n,i;let o=u().prototype.stopCallback,r=function(t){var n,i;let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="undefined"!=typeof window&&(null===(i=window._preloads)||void 0===i?void 0:null===(n=i.pub)||void 0===n?void 0:n.language)||"en",{iString:l,iTemplate:a}=I18N.i(r);return{items:t.items,query:t.query,isLoading:o,selectItem:e=>{e&&!e.disabledReason&&t.command({id:e.id,label:e.name,mentionType:e.type,url:e.url})},placeholderText:l("user"===e?"Search for a person":"Search for a person or publication"),noResultsText:a(v(),t.query),minQueryLength:2,language:r}};return{onStart:e=>{n=new s.M_(m.c,{props:r(e),editor:e.editor}),i=(0,p.ZP)("body",{getReferenceClientRect:e.clientRect,appendTo:()=>document.body,content:n.element,popperOptions:{strategy:"absolute",modifiers:[{options:{altAxis:!0}}]},showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}),u().prototype.stopCallback=function(e,t,n){return"esc"===n||o(e,t,n)},null==t||t(!0)},onBeforeUpdate(e){i&&i[0].show(),n&&n.updateProps(r(e,!0)),e.clientRect&&i&&i[0].setProps({getReferenceClientRect:e.clientRect})},onUpdate(e){n&&n.updateProps(r(e,!1)),i&&i[0].setProps({getReferenceClientRect:e.clientRect})},onKeyDown(e){var r;return"Escape"===e.event.key?(i&&i[0]&&i[0].destroy(),i=null,n&&n.destroy(),n=null,setTimeout(()=>{u().prototype.stopCallback=o},0),null==t||t(!1),!0):null==n?void 0:null===(r=n.ref)||void 0===r?void 0:r.onKeyDown(e)},onExit(){u().prototype.stopCallback=o,i&&i[0]&&i[0].destroy(),i=null,n&&n.destroy(),n=null,null==t||t(!1)}}}},Z=g.configure({HTMLAttributes:{class:"substack-mention"},suggestion:{char:"@",pluginKey:new d.H$("substack_mention"),decorationClass:"substack-mention",allowSpaces:!0,startOfLine:!1,items:(i="/api/v1/reader/comments/mention",async e=>{let{query:t}=e;return t.length<1?[]:await (0,h.wg)(t,{pathname:i})}),render:b("user")}});function _(e){let{node:{attrs:{id:t,label:n,mentionType:i,url:o}}}=e;return(0,r.h)(s.T5,{as:"a",href:"pub"===i?o:(0,f.GR3)(t,n),className:"substack-mention",target:"_blank"},[n])}function w(e){return{default:null,parseHTML:t=>t.getAttribute("data-".concat(e)),renderHTML:t=>t[e]?{["data-".concat(e)]:t[e]}:{}}}},5889:function(e,t,n){"use strict";n.d(t,{gg:()=>o,m:()=>r});var i=n(25235);function o(e){return e&&r(e).pop()||null}function r(e){return(0,i.find)(e).filter(e=>"url"===e.type&&e.href.startsWith("http"))}},8357:function(e,t,n){"use strict";n.d(t,{Z:()=>function e(t){var n,l,a;let{left:d=!0,right:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(null==t?void 0:null===(n=t.content)||void 0===n?void 0:n.length)){if(!t||r(t))t=null;else if("text"===t.type){let e=t.text;d&&(e=null==e?void 0:e.trimStart()),s&&(e=null==e?void 0:e.trimEnd()),t=(0,o._)((0,i._)({},t),{text:e})}return t}let c=t.content.length,u=0;if(d)for(;u<c&&r(t.content[u]);)u++;let p=c-1;if(s)for(;(u<p||!d&&u===p)&&r(t.content[p]);)p--;if(u<=p){let n=t.content.slice(0);if(d){let i=function e(t){if(!t.content)return t;for(let n of t.content){let t=e(n);if(t)return t}}(t.content[u]);if((null==i?void 0:i.type)==="text"&&(i.text=(null!==(l=null==i?void 0:i.text)&&void 0!==l?l:"").trimStart(),!i.text)){let t=e(n[u],{right:!1});t&&(n[u]=t)}}if(s){let i=function e(t){if(!t.content)return t;for(let n of t.content.slice().reverse()){let t=e(n);if(t)return t}}(t.content[p]);if((null==i?void 0:i.type)==="text"&&(i.text=(null!==(a=null==i?void 0:i.text)&&void 0!==a?a:"").trimEnd(),!i.text)){let t=e(n[p],{left:!1});t&&(n[p]=t)}}t=(0,o._)((0,i._)({},t),{content:n.slice(u,p+1)})}else t=null;return t}});var i=n(7409),o=n(99282);function r(e){var t;if("text"===e.type&&(null===(t=e.text)||void 0===t?void 0:t.trim())||"substack_mention"===e.type)return!1;if(e.content){for(let t of e.content)if(!r(t))return!1}return!0}},59278:function(e,t,n){"use strict";n.d(t,{r:()=>_});var i=n(98661),o=n(57319),r=n(28842),l=n(76396),a=n(16457),d=n(45514),s=n(16653),c=n(57820),u=n(17714),p=n(42800),m=n(4470),h=n(76576),f=n(35521),v=n(98790);let g=(0,i.createContext)(null),y=Object.assign((0,m.yV)(function(e,t){let n=(0,a.M)(),{id:o=`headlessui-label-${n}`,passive:r=!1,...l}=e,d=function e(){let t=(0,i.useContext)(g);if(null===t){let t=Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,e),t}return t}(),c=(0,s.T)(t);(0,v.e)(()=>d.register(o),[o,d.register]);let u={ref:c,...d.props,id:o};return r&&("onClick"in u&&(delete u.htmlFor,delete u.onClick),"onClick"in l&&delete l.onClick),(0,m.sY)({ourProps:u,theirProps:l,slot:d.slot||{},defaultTag:"label",name:d.name||"Label"})}),{}),b=(0,i.createContext)(null);b.displayName="GroupContext";let Z=i.Fragment,_=Object.assign((0,m.yV)(function(e,t){var n;let h=(0,a.M)(),{id:v=`headlessui-switch-${h}`,checked:g,defaultChecked:y=!1,onChange:Z,disabled:_=!1,name:w,value:C,form:k,...T}=e,S=(0,i.useContext)(b),x=(0,i.useRef)(null),P=(0,s.T)(x,t,null===S?null:S.setSwitch),[E,N]=(0,o.q)(g,Z,y),B=(0,l.z)(()=>null==N?void 0:N(!E)),I=(0,l.z)(e=>{if((0,u.P)(e.currentTarget))return e.preventDefault();e.preventDefault(),B()}),M=(0,l.z)(e=>{e.key===f.R.Space?(e.preventDefault(),B()):e.key===f.R.Enter&&(0,p.g)(e.currentTarget)}),U=(0,l.z)(e=>e.preventDefault()),O=(0,i.useMemo)(()=>({checked:E}),[E]),A={id:v,ref:P,role:"switch",type:(0,d.f)(e,x),tabIndex:-1===e.tabIndex?0:null!=(n=e.tabIndex)?n:0,"aria-checked":E,"aria-labelledby":null==S?void 0:S.labelledby,"aria-describedby":null==S?void 0:S.describedby,disabled:_,onClick:I,onKeyUp:M,onKeyPress:U},L=(0,r.G)();return(0,i.useEffect)(()=>{var e;let t=null==(e=x.current)?void 0:e.closest("form");t&&void 0!==y&&L.addEventListener(t,"reset",()=>{N(y)})},[x,N]),i.default.createElement(i.default.Fragment,null,null!=w&&E&&i.default.createElement(c._,{features:c.A.Hidden,...(0,m.oA)({as:"input",type:"checkbox",hidden:!0,readOnly:!0,disabled:_,form:k,checked:E,name:w,value:C})}),(0,m.sY)({ourProps:A,theirProps:T,slot:O,defaultTag:"button",name:"Switch"}))}),{Group:function(e){var t;let[n,o]=(0,i.useState)(null),[r,a]=function(){let[e,t]=(0,i.useState)([]);return[e.length>0?e.join(" "):void 0,(0,i.useMemo)(()=>function(e){let n=(0,l.z)(e=>(t(t=>[...t,e]),()=>t(t=>{let n=t.slice(),i=n.indexOf(e);return -1!==i&&n.splice(i,1),n}))),o=(0,i.useMemo)(()=>({register:n,slot:e.slot,name:e.name,props:e.props}),[n,e.slot,e.name,e.props]);return i.default.createElement(g.Provider,{value:o},e.children)},[t])]}(),[d,s]=(0,h.f)(),c=(0,i.useMemo)(()=>({switch:n,setSwitch:o,labelledby:r,describedby:d}),[n,o,r,d]);return i.default.createElement(s,{name:"Switch.Description"},i.default.createElement(a,{name:"Switch.Label",props:{htmlFor:null==(t=c.switch)?void 0:t.id,onClick(e){n&&("LABEL"===e.currentTarget.tagName&&e.preventDefault(),n.click(),n.focus({preventScroll:!0}))}}},i.default.createElement(b.Provider,{value:c},(0,m.sY)({ourProps:{},theirProps:e,defaultTag:Z,name:"Switch.Group"}))))},Label:y,Description:h.d})},57319:function(e,t,n){"use strict";n.d(t,{q:()=>r});var i=n(98661),o=n(76396);function r(e,t,n){let[r,l]=(0,i.useState)(n),a=void 0!==e,d=(0,i.useRef)(a),s=(0,i.useRef)(!1),c=(0,i.useRef)(!1);return!a||d.current||s.current?a||!d.current||c.current||(c.current=!0,d.current=a,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")):(s.current=!0,d.current=a,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")),[a?e:r,(0,o.z)(e=>(a||l(e),null==t?void 0:t(e)))]}},45514:function(e,t,n){"use strict";n.d(t,{f:()=>l});var i=n(98661),o=n(98790);function r(e){var t;if(e.type)return e.type;let n=null!=(t=e.as)?t:"button";if("string"==typeof n&&"button"===n.toLowerCase())return"button"}function l(e,t){let[n,l]=(0,i.useState)(()=>r(e));return(0,o.e)(()=>{l(r(e))},[e.type,e.as]),(0,o.e)(()=>{n||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&l("button")},[n,t]),n}},42800:function(e,t,n){"use strict";function i(e,t){return e?e+"["+t+"]":t}function o(e){var t,n;let i=null!=(t=null==e?void 0:e.form)?t:e.closest("form");if(i){for(let t of i.elements)if(t!==e&&("INPUT"===t.tagName&&"submit"===t.type||"BUTTON"===t.tagName&&"submit"===t.type||"INPUT"===t.nodeName&&"image"===t.type)){t.click();return}null==(n=i.requestSubmit)||n.call(i)}}n.d(t,{g:()=>o,t:()=>function e(t={},n=null,o=[]){for(let[r,l]of Object.entries(t))!function t(n,o,r){if(Array.isArray(r))for(let[e,l]of r.entries())t(n,i(o,e.toString()),l);else r instanceof Date?n.push([o,r.toISOString()]):"boolean"==typeof r?n.push([o,r?"1":"0"]):"string"==typeof r?n.push([o,r]):"number"==typeof r?n.push([o,`${r}`]):null==r?n.push([o,""]):e(r,o,n)}(o,i(n,r),l);return o}})},92002:function(e,t,n){"use strict";function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}n.d(t,{_:()=>i})},73580:function(e,t,n){"use strict";function i(e){if(null==e)throw TypeError("Cannot destructure "+e);return e}n.d(t,{_:()=>i})},38621:function(e,t,n){"use strict";n.d(t,{Z:()=>l});var i=n(88897),o=n(92007),r=n(45901);let l=i.hj.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new o.Sy({key:new o.H$("placeholder"),props:{decorations:({doc:e,selection:t})=>{let n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=t,o=[];if(!n)return null;let l=e.type.createAndFill(),a=(null==l?void 0:l.sameMarkup(e))&&null===l.content.findDiffStart(e.content);return e.descendants((e,t)=>{let n=i>=t&&i<=t+e.nodeSize,l=!e.isLeaf&&!e.childCount;if((n||!this.options.showOnlyCurrent)&&l){let i=[this.options.emptyNodeClass];a&&i.push(this.options.emptyEditorClass);let l=r.p.node(t,t+e.nodeSize,{class:i.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:n}):this.options.placeholder});o.push(l)}return this.options.includeChildren}),r.EH.create(e,o)}}})]}})}}]);