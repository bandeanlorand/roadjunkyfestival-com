"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8578"],{79075:function(t,e,i){i.r(e),i.d(e,{MiniNotificationsStack:()=>S,MiniNotificationsViewer:()=>C});var n=i(16584),a=i(30396),r=i(94184),l=i.n(r),c=i(78796),o=i(48493),s=i(95441),d=i(36518),h=i(42375),u=i(68833),p=i(15771),y=i(61254),m=i(19081),f=i(58175),v=i(74949),Z=i(35449),g=i(27744),I=i(65575),w=i(98012),k=i(63651),b=i(21694);function C(t){var e;let{resource:i,bellCount:r}=t,{iString:d}=(0,s.M1)(),{result:v,error:w}=i,C="".concat((0,k.SVA)(),"/activity"),[_,x]=(0,g.d6)();(0,a.d4)(()=>{v&&x({type:"update_paused_notifications",payload:v.feedItemComments.filter(t=>t.isMuted)})},[v,x]);let A=null==v?void 0:null===(e=v.activityItems[0])||void 0===e?void 0:e.id;return(0,a.d4)(()=>{v&&(0,u.j)(u.FP.NOTIFICATIONS_DROPDOWN_VIEWED,{count:v.activityItems.length,bellCount:r})},[A]),(0,n.tZ)(h.$U,{surface:"mini-notifications-viewer",dispatch:x,state:_,children:(0,n.BX)(m.tu,{className:l()("notifications-root",b.Z.root),color:"primary",style:{width:"360px",maxHeight:"80vh"},children:[(0,n.BX)(m.hs,{padding:16,gap:8,alignItems:"center",children:[(0,n.tZ)(m.hs,{flex:"grow",children:(0,n.tZ)(f.xv.H3,{weight:"heavy",children:(0,n.tZ)(I.EU,{href:C,children:d("Activity")})})}),(0,n.tZ)(p.hU,{"aria-label":"Settings",size:"md",href:"".concat((0,k.SVA)(),"/settings"),priority:"tertiary",newTab:!0,children:(0,n.tZ)(c.Z,{size:20,"aria-hidden":!0})})]}),(0,n.tZ)(y.iz,{}),(0,n.tZ)(m.tu,{overflowY:"auto",children:w?"Error":v?v.activityItems.length>0?(0,n.tZ)(I.pe,{gap:0,children:(0,n.tZ)(S,{result:v})}):(0,n.tZ)(m.tu,{style:{minHeight:"240px"},paddingBottom:32,justifyContent:"center",children:(0,n.tZ)(I._Y,{icon:(0,n.tZ)(o.Z,{}),title:"You donâ€™t have any activity yet.",text:"Likes and replies will appear here."})}):(0,n.tZ)(Z.f,{})}),(0,n.tZ)(m.X2,{borderTop:"detail",height:48,alignItems:"center",justifyContent:"center",children:(0,n.tZ)(p.zx,{priority:"tertiary",href:C,newTab:!0,localNavigation:!1,justifyContent:"center",children:"See all"})})]})})}function S(t){let{result:e,isReadOnly:i=!1}=t,r=(0,d.lR)(),l=(0,a.Ye)(()=>{var t;return null!==(t=r.lastViewedAt)&&void 0!==t?t:new Date(0).toISOString()},[]);(0,a.d4)(()=>{i||r.markAllAsRead()},[]);let c=(0,g.I0)(),o=(0,g.kc)(),s=(0,v.IC)(e);return(0,a.d4)(()=>{c({type:"comments_load",payload:{comments:(null==e?void 0:e.comments)||[]}})},[c,e]),(0,n.tZ)(n.HY,{children:e.activityItems.filter(t=>v.gG.has(t.type)).map((t,a)=>(0,n.tZ)(v.P_,{item:(0,v.Xn)({activityResult:e,activityResultMaps:s,feedState:o,item:t,idx:a}),isUnread:null==l||(0,w.Z)(l).isBefore(t.updated_at),readOnly:i},a))})}}}]);