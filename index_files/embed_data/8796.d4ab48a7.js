"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8796"],{32440:function(t,e,r){r.d(e,{Z:()=>i});let i={bubbleStack:"bubbleStack-umAMnU",bubble:"bubble-LfInju",linkBubble:"linkBubble-t8SyEH",paywallBubble:"paywallBubble-HIFC1C",imageGroup:"imageGroup-hmX9Za",hasFooter:"hasFooter-knDZrK",body:"body-SxXE9l",authorName:"authorName-RUTp3m",facepileAvatar:"facepileAvatar-F_BcFw",outgoing:"outgoing-zRoPvi",facepile:"facepile-_l_hyN",readMore:"readMore-OS5vSy",pixels:"pixels-dEQTfm",textLink:"textLink-TnmBfo",linkImg:"linkImg-kNOnWu",linkUrl:"linkUrl-LW11wp",linkTitle:"linkTitle-oVSOfX",reactionsWrapper:"reactionsWrapper-ls9Csz",actions:"actions-QkU3dI",avatarContainer:"avatarContainer-QgIACu",highlight:"highlight-pSh3e7","highlight-animation":"highlight-animation-kGdFb4",highlightAnimation:"highlight-animation-kGdFb4",isLast:"isLast-UDCLfj",quoteBox:"quoteBox-Dcal5K",quote:"quote-IkMApN",incoming:"incoming-yrKQPL",notFirst:"notFirst-MmF7_s",author:"author-naTBRq",hasUnread:"hasUnread-p_1CFW",noUnread:"noUnread-aWF1i8",paywallReplyTag:"paywallReplyTag-AnU7qK",media:"media-H8ykdm",center:"center-F91XRK",right:"right-dRUlyN",iconOnly:"iconOnly-pLEdW7",paywallFade:"paywallFade-jjuRAC",paywallBlur:"paywallBlur-yZ2js3",paywallText:"paywallText-s4FRye"}},77859:function(t,e,r){r.d(e,{Z:()=>i});let i={messageBubbleGroup:"messageBubbleGroup-R4lEWb",bubble:"bubble-JnQPTp",isFirst:"isFirst-cID827",isLast:"isLast-YVpa0l",quote:"quote-NJ4bEy",paywallReplyTag:"paywallReplyTag-_3sIGO",outgoing:"outgoing-hqKZeu",forceIncomingTheme:"forceIncomingTheme-fBbXPp",body:"body-obaIpu",author:"author-M_vI8F","reactions-1":"reactions-1-O8o884",reactions1:"reactions-1-O8o884","reactions-2":"reactions-2-NrnldS",reactions2:"reactions-2-NrnldS","reactions-3":"reactions-3-iPVLb0",reactions3:"reactions-3-iPVLb0",youtubeIframe:"youtubeIframe-rlkjkW",highlight:"highlight-u2yyKp","highlight-animation":"highlight-animation-rBjpTz",highlightAnimation:"highlight-animation-rBjpTz",imageGroup:"imageGroup-KAnMHU bubble-JnQPTp",incoming:"incoming-jCFnDy",postImage:"postImage-eO7gd7",b4:"b4-xXB4IY",bubbs:"bubbs-qLKn32",bubb:"bubb-yci1Gp",isLink:"isLink-NGEdg6",linkImage:"linkImage-FDEYzZ",small:"small-PzwGAf",actions:"actions-utvBvN",actionsWrapper:"actionsWrapper-CEt9E2",dots:"dots-_BmXB7",dot:"dot-XjG0Z6",typing:"typing-vNx1zN",flip:"flip-OUTl4B"}},96726:function(t,e,r){r.d(e,{X:()=>s,h:()=>d});var i=r(16584),l=r(6400),a=r(98661),n=r(30396);let o=(0,l.createContext)(null);function s(t){let{root:e,children:r}=t,l=(0,n.sO)(e);return(0,i.BX)(o.Provider,{value:l,children:[r,!e&&(0,i.tZ)("div",{ref:l})]})}function d(t){let{children:e}=t,r=(0,n.qp)(o).current;return r?(0,a.createPortal)(e,r):null}},16564:function(t,e,r){r.d(e,{KH:()=>$,MR:()=>x,YX:()=>T,_g:()=>_,cM:()=>C,ko:()=>N,nO:()=>z});var i,l,a=r(7409),n=r(99282),o=r(58865),s=r(16584),d=r(94184),u=r.n(d),c=r(1852),m=r(86657);r(36081),r(36813);var p=r(99987),h=r(1055),g=r(72708),f=r(95441);r(68833);var v=r(15771),w=r(6490),b=r(84864),y=r(72925);function k(){let t=(0,o._)(["Playback rate ",""]);return k=function(){return t},t}var x=((i={}).Embed="Embed audio",i.Voiceover="Add voiceover",i.Podcast="Audio",i.PodcastPreview="Podcast free version",i.VideoPodcast="Video",i.ShareQuote="Share quote",i),_=((l={})[l.PubAccent=0]="PubAccent",l[l.PubFull=1]="PubFull",l[l.Substack=2]="Substack",l);let N=t=>{let{containerRef:e,currentTime:r,remainingTime:i,progress:l,onMouseDown:a,shouldCollapseOnMobile:n=!1,theme:o=1}=t;return(0,s.BX)("div",{className:"tw-flex tw-grow tw-items-center tw-gap-3 tw-font-meta tw-text-sm tw-text-substack-primary sm:tw-gap-3","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":100*l,children:[(0,s.tZ)("div",{className:u()("tw-min-w-[40px] tw-text-right",{"tw-hidden sm:tw-block":n}),children:r}),(0,s.BX)("div",{ref:e,className:u()("tw-relative tw-h-5 tw-grow ",{"tw-ml-2 sm:tw-ml-0":n}),onMouseDown:a,children:[(0,s.tZ)("div",{className:u()("audio-progress-bar tw-absolute tw-top-2 tw-right-0 tw-left-0 tw-h-1 tw-rounded",{"tw-bg-pub-detail":1===o,"tw-bg-substack-detail":1!==o})}),(0,s.tZ)("div",{className:u()("tw-absolute tw-top-2 tw-left-0 tw-h-1 tw-rounded-l-full",{"tw-bg-pub-accent":2!==o,"tw-bg-substack-accent":2===o}),style:{width:"".concat(100*l,"%")}}),(0,s.tZ)("div",{className:u()("audio-playhead tw-absolute tw-ml-[-10px] tw-h-4 tw-w-4 tw-rounded-full tw-border-2 tw-border-solid ",{"tw-border-pub-background":1===o,"tw-border-substack-bg":1!==o,"tw-bg-substack-accent":2===o,"tw-bg-pub-accent":2!==o}),style:{left:"".concat(100*l,"%")}})]}),(0,s.tZ)("div",{className:"tw-min-w-[40px]",children:i})]})},Z=[{value:1,display:"1"},{value:1.25,display:"1.25"},{value:1.5,display:"1.5"},{value:1.75,display:"1.75"},{value:2,display:"2"}],S=t=>{var e;let{onSetPlaybackRate:r,playbackRate:i,className:l}=t,a=Z.findIndex(t=>{let{value:e}=t;return e===i}),{iTemplate:n}=(0,f.M1)(),o=(null==Z?void 0:null===(e=Z[a])||void 0===e?void 0:e.display)?"".concat(null==Z?void 0:Z[a].display,"x"):"";return(0,s.BX)("div",{onClick:()=>{let t=(a+1)%Z.length;r(Z[t].value)},className:l,"aria-label":n(k(),o),children:[Z[a].display,"\xd7"]})},C=t=>{let{iString:e}=(0,f.M1)();return(0,s.tZ)(m.Z,(0,n._)((0,a._)({},t),{metricsPost:t.post,feature:"Embed audio",render:r=>{let{currentTime:i,isPlaying:l,progress:a,progressBarRef:n,progressBarOnMouseDown:o,remainingTime:d,playbackRate:u,setPlaybackRate:c,togglePlayback:m}=r;return(0,s.BX)("div",{"data-component-name":"AudioEmbedPlayer","data-drag-handle":"",className:"audio-embed tw-my-4 tw-box-border tw-flex tw-w-full tw-select-none tw-items-center tw-gap-4 tw-space-y-0 tw-rounded-full tw-bg-pub-wash tw-p-4 tw-font-sans sm:tw-gap-5",role:"region","aria-label":e("Audio embed player"),children:[(0,s.tZ)(S,{onSetPlaybackRate:c,playbackRate:u,className:"audio-button tw-w-12 tw-cursor-pointer tw-rounded-full tw-border tw-border-solid tw-border-pub-detail-light tw-py-1 tw-text-center tw-font-meta tw-text-sm tw-font-semibold tw-leading-none tw-text-pub-secondary-text hover:tw-border-pub-detail"}),(0,s.BX)("div",{className:"tw-flex tw-w-full tw-flex-wrap",children:[t.label&&(0,s.tZ)("div",{className:"tw-basis-full tw-pb-2 tw-text-ssm tw-font-semibold tw-text-pub-primary-text",children:t.label}),(0,s.tZ)("div",{className:"tw-flex tw-w-full tw-items-center tw-justify-between tw-gap-2 sm:tw-gap-4",children:(0,s.tZ)(N,{currentTime:i,remainingTime:d,containerRef:n,progress:a,onMouseDown:o})})]}),(0,s.tZ)("div",{className:"audio-embed-play-button tw-relative tw-flex tw-h-12 tw-w-12 tw-shrink-0 tw-cursor-pointer tw-items-center tw-justify-center tw-rounded-full tw-border-2 tw-border-solid tw-border-pub-detail tw-bg-pub-background tw-transition-transform hover:tw-scale-105",onClick:m,role:"button","aria-label":e("Play/pause"),children:l?(0,s.BX)("div",{className:"tw-flex tw-h-5 tw-w-4 tw-justify-between",children:[(0,s.tZ)("div",{className:"pause-icon tw-h-full tw-w-1/3 tw-rounded-sm tw-bg-pub-accent"}),(0,s.tZ)("div",{className:"pause-icon tw-h-full tw-w-1/3 tw-rounded-sm tw-bg-pub-accent"})]}):(0,s.tZ)(h.Z,{className:"tw-relative tw-left-[.1rem] tw-fill-pub-accent",stroke:"none",height:18})})]})}}))},z=t=>{var e;let{pub:r,post:i,duration:l,label:a}=t,{iString:n}=(0,f.M1)();return(0,s.tZ)("table",{"data-component-name":"AudioEmbedPlayerStatic",className:"tw-w-full tw-rounded-full tw-bg-substack-wash",children:(0,s.tZ)("tr",{children:(0,s.tZ)("td",{className:"tw-text-center tw-font-meta tw-text-ssm tw-uppercase tw-text-substack-primary",children:(0,s.BX)("a",{href:null==i?void 0:i.canonical_url,className:u()("tw-block tw-w-full tw-p-4 tw-text-substack-primary",y.Z.noUnderline),children:[(0,s.tZ)(p.Z,{className:"tw-w-max-4 tw-mr-2 tw-inline-block tw-w-4 tw-align-middle",stroke:null===(e=r.theme)||void 0===e?void 0:e.background_pop_color,isStatic:!0}),(0,s.BX)("span",{className:"tw-align-middle",children:[(0,b.truncateText)(a,10)||n("Listen now")," \xb7 ",(0,b.secondsToHHMMSS)(l||0)]})]})})})})},$=t=>{let e=(0,c.useMediaQuery)({maxWidth:631}),r="/api/v1/audio/upload/".concat(t.mediaUploadId,"/src"),{iString:i}=(0,f.M1)();return(0,s.tZ)(m.Z,(0,n._)((0,a._)({},t),{src:r,feature:"Add voiceover",metricsPost:t.post,render:t=>{let{isPaywalled:r,currentTime:l,isPlaying:a,progress:n,progressBarRef:o,progressBarOnMouseDown:d,remainingTime:u,playbackRate:c,setPlaybackRate:m,togglePlayback:p}=t;return(0,s.BX)("div",{className:"tw-mb-6 tw-flex sm:tw-gap-1",children:[(0,s.tZ)("div",{className:"tw-hidden tw-h-20 tw-shrink-0 tw-basis-20 tw-items-center tw-justify-center tw-rounded-md tw-bg-pub-wash tw-fill-pub-primary-text tw-text-pub-primary-text sm:tw-flex",children:(0,s.tZ)(g.Z,{className:"tw-stroke-pub-secondary-text"})}),(0,s.BX)("div",{className:"tw-box-border tw-flex tw-h-20 tw-w-full tw-select-none tw-items-center tw-gap-3 tw-space-y-0 tw-rounded-l-md tw-rounded-r-[64px] tw-bg-pub-wash  tw-p-4 tw-font-sans",children:[r?(0,s.tZ)("div",{className:"tw-flex tw-w-full tw-flex-wrap tw-justify-center tw-text-ssm tw-text-pub-secondary-text sm:tw-text-sm",children:i("Upgrade to paid to play voiceover")}):(0,s.BX)("div",{className:"tw-flex tw-w-full tw-flex-wrap",children:[(0,s.tZ)("div",{className:"tw-basis-full tw-pb-2 tw-text-ssm tw-font-semibold tw-uppercase tw-text-pub-secondary-text",children:i("Article voiceover")}),(0,s.BX)("div",{className:"tw-flex tw-w-full tw-items-center tw-justify-between tw-gap-2 ",children:[(0,s.tZ)(S,{onSetPlaybackRate:m,playbackRate:c,className:"tw-w-12 tw-cursor-pointer tw-rounded-full tw-border tw-border-solid tw-border-pub-detail-light tw-py-1 tw-text-center tw-font-meta tw-text-sm tw-font-semibold tw-leading-none tw-text-pub-secondary-text hover:tw-border-pub-detail"}),(0,s.tZ)(N,{currentTime:l,remainingTime:u,containerRef:o,progress:n,onMouseDown:d,shouldCollapseOnMobile:!0})]})]}),r?(0,s.tZ)("div",{className:"tw-relative tw-flex tw-h-14 tw-w-14 tw-shrink-0 tw-cursor-not-allowed tw-items-center tw-justify-center tw-rounded-full tw-border-2 tw-border-solid tw-border-pub-detail tw-bg-pub-background tw-transition-transform",children:(0,s.tZ)(h.Z,{className:"tw-relative tw-left-[.15rem] tw-fill-pub-detail",stroke:"none",height:e?20:24})}):(0,s.tZ)("div",{className:"tw-relative tw-flex tw-h-14 tw-w-14 tw-shrink-0 tw-cursor-pointer tw-items-center tw-justify-center tw-rounded-full tw-border-2 tw-border-solid  tw-border-pub-detail tw-bg-pub-background tw-transition-transform hover:tw-scale-105",onClick:p,role:"button",children:a?(0,s.BX)("div",{className:"tw-flex tw-h-5 tw-w-5 tw-justify-between",children:[(0,s.tZ)("div",{className:"tw-h-full tw-w-1/3 tw-rounded-sm tw-bg-pub-accent"}),(0,s.tZ)("div",{className:"tw-h-full tw-w-1/3 tw-rounded-sm tw-bg-pub-accent"})]}):(0,s.tZ)(h.Z,{className:"tw-relative tw-left-[.15rem] tw-fill-pub-accent",stroke:"none",height:20})})]})]})}}))},T=t=>{let{isOpen:e,onDismiss:r}=t,{iString:i}=(0,f.M1)();return(0,s.BX)(w.u_,{isOpen:e,onClose:r,children:[(0,s.tZ)(w.xB,{showClose:!1,title:i("Something went wrong...")}),(0,s.tZ)(w.fe,{children:i("Unfortunately, there was a problem with your audio file upload. We'll investigate, but in the meantime, please try again, and we apologize for the inconvenience.")}),(0,s.tZ)(w.mz,{showDivider:!1,direction:"row",primaryButton:(0,s.tZ)(v.zx,{onClick:r,priority:"primary",children:i("Got it")})})]})}},26522:function(t,e,r){r.d(e,{Y:()=>f,c:()=>g});var i=r(16584),l=r(94184),a=r.n(l),n=r(19691),o=r(13723),s=r(57336),d=r(20888),u=r(90099),c=r(71068),m=r(19081),p=r(58175),h=r(71075);let g=t=>{var e,r,l;let{disableLinks:u,isEditingCaption:g,post:f,caption:v,onEditCaption:w,onSaveCaption:b,onCancelCaption:y}=t,{publishedBylines:k,title:x,canonical_url:_,post_date:N,section_name:Z,cover_image:S,cover_image_alt:C}=f;return(0,i.BX)(m.tu,{children:[Z&&(0,i.tZ)("a",{className:a()({[null!==(e=h.Z.disableLink)&&void 0!==e?e:""]:u}),href:_,rel:"noopener",target:"_blank",children:(0,i.tZ)(p.xv.Meta,{color:"pub-primary-text",paddingBottom:8,children:Z})}),(0,i.tZ)("a",{className:a()({[null!==(r=h.Z.disableLink)&&void 0!==r?r:""]:u}),href:_,rel:"noopener",target:"_blank",children:(0,i.tZ)(p.xv.H2,{color:"pub-primary-text",children:x})}),(0,i.tZ)(s.h,{bylines:k,date:N,disableLinks:u}),S&&(0,i.tZ)(c.xu,{paddingTop:24,children:(0,i.tZ)("a",{className:a()({[null!==(l=h.Z.disableLink)&&void 0!==l?l:""]:u}),href:_,rel:"noopener",target:"_blank",children:(0,i.tZ)(d.e,{alt:null!=C?C:x,className:h.Z.fullWidth,imageProps:{height:Math.round(650),smartCrop:!0},maxWidth:1300,src:S})})}),(0,i.tZ)(m.hs,{flex:"grow",paddingTop:16,children:g&&b&&y?(0,i.tZ)(n.Z,{initialCaption:v,onCancel:y,onSave:b}):(0,i.tZ)("p",{className:h.Z.caption,dangerouslySetInnerHTML:{__html:v},onClick:w||void 0})}),(0,i.tZ)(o.$,{disableLinks:u,href:_,includeUfi:!1,post:f})]})},f=t=>{let{post:e,children:r}=t,{publishedBylines:l,title:a,canonical_url:n,post_date:m,section_name:g,cover_image:f,cover_image_alt:v}=e;return(0,i.BX)(u.i$,{children:[g&&(0,i.tZ)("a",{href:n,children:(0,i.tZ)(p.xv.Meta,{color:"pub-primary-text",paddingBottom:8,children:g})}),(0,i.tZ)("a",{href:n,children:(0,i.tZ)(p.xv.H2,{color:"pub-primary-text",children:a})}),(0,i.tZ)(s.I,{bylines:l,date:m}),f&&(0,i.tZ)(c.xu,{paddingTop:24,children:(0,i.tZ)("a",{href:n,children:(0,i.tZ)(d.e,{alt:null!=v?v:a,className:h.Z.fullWidth,imageProps:{height:Math.round(650),smartCrop:!0},maxWidth:1300,src:f})})}),(0,i.tZ)("a",{href:n,children:(0,i.tZ)(c.xu,{as:"p",children:r})}),(0,i.tZ)(o.c,{href:n})]})}},36412:function(t,e,r){r.d(e,{Z:()=>s});var i=r(7409),l=r(99282),a=r(16584),n=r(84146),o=r(64515);let s=t=>(0,a.tZ)(o.l,(0,l._)((0,i._)({},t),{name:"LucideCornerDownRight",svgParams:{height:24,width:24,fill:"#000000",strokeWidth:0},children:(0,a.tZ)(n.Z,{height:24,stroke:t.stroke,fill:t.fill,strokeWidth:t.strokeWidth})}))},51534:function(t,e,r){r.d(e,{Z:()=>s});var i=r(7409),l=r(99282),a=r(98848),n=r(16584),o=r(64515);let s=t=>{var{size:e=24,color:r="var(--color-fg-primary)",className:s}=t,d=(0,a._)(t,["size","color","className"]);return(0,n.tZ)(o.l,(0,l._)((0,i._)({},d),{name:"SkinnyLockIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:e,height:e,fill:r,className:s,children:(0,n.tZ)("path",{d:"M6.63672 23.4922H17.3594C19.082 23.4922 19.9961 22.5547 19.9961 20.7031V12.6289C19.9961 10.7773 19.082 9.85156 17.3594 9.85156H6.63672C4.91406 9.85156 4 10.7773 4 12.6289V20.7031C4 22.5547 4.91406 23.4922 6.63672 23.4922ZM6.05078 10.7539H7.91406V6.79297C7.91406 3.83984 9.80078 2.26953 11.9922 2.26953C14.1836 2.26953 16.0938 3.83984 16.0938 6.79297V10.7539H17.9453V7.05078C17.9453 2.64453 15.0625 0.5 11.9922 0.5C8.93359 0.5 6.05078 2.64453 6.05078 7.05078V10.7539Z",stroke:"none"})}))}},45530:function(t,e,r){r.d(e,{Z:()=>s});var i=r(7409),l=r(99282),a=r(98848),n=r(16584),o=r(64515);let s=t=>{var{size:e=24,color:r="var(--color-fg-primary)",className:s}=t,d=(0,a._)(t,["size","color","className"]);return(0,n.tZ)(o.l,(0,l._)((0,i._)({},d),{name:"SkinnyUnlockIcon",svgParams:{viewBox:"0 0 24 24"},stroke:"none",width:e,height:e,fill:r,className:s,children:(0,n.tZ)("path",{d:"M2.5862 23.8914H13.1034C14.793 23.8914 15.6896 22.9366 15.6896 21.051V12.8282C15.6896 10.9545 14.793 9.99975 13.1034 9.99975H2.5862C0.896549 9.99975 0 10.9545 0 12.8282V21.051C0 22.9366 0.896549 23.8914 2.5862 23.8914ZM11.9885 10.9306H13.8046V6.90875C13.8046 3.88935 15.6667 2.30209 17.8161 2.30209C19.9655 2.30209 21.8275 3.88935 21.8275 6.90875V9.55818C21.8275 10.2623 22.2299 10.6203 22.7471 10.6203C23.2413 10.6203 23.6551 10.2981 23.6551 9.55818V7.15937C23.6551 2.67205 20.8161 0.5 17.8161 0.5C14.8046 0.5 11.9885 2.67205 11.9885 7.15937V10.9306Z"})}))}},67348:function(t,e,r){r.d(e,{p:()=>c});var i=r(16584),l=r(94184),a=r.n(l),n=r(85685),o=r(60807),s=r(33017),d=r(36186),u=r(22402);function c(t){let{id:e,label:r,type:l,url:a,unstyled:n}=t;return(0,i.tZ)("span",{className:"node-substack_mention",children:"pub"===l?(0,i.tZ)(p,{id:e,url:a,label:r,unstyled:n}):(0,i.tZ)(m,{id:e,label:r,unstyled:n})})}function m(t){let{id:e,label:r,unstyled:l}=t,s=(0,o.aF)(),c=s&&s.id===e;return(0,i.tZ)(n.ProfileHoverCard,{inline:!0,subject:{id:e,name:r},children:(0,i.tZ)("a",{className:a()(u.Z.mention,c&&u.Z.self,l&&u.Z.unstyled),href:(0,d.GR)(e,r),children:r})})}function p(t){let{id:e,url:r,label:l,unstyled:n}=t,d=(0,o.aF)(),c=d&&d.id===e;return(0,i.tZ)(s.Sm,{publication_id:e,inline:!0,children:(0,i.tZ)("a",{className:a()(u.Z.mention,c&&u.Z.self,n&&u.Z.unstyled),href:r,children:l})})}},12799:function(t,e,r){r.d(e,{g:()=>d});var i=r(7409),l=r(99282),a=r(16584),n=r(99869),o=r(98914),s=r(70379);function d(){let t=(0,s.pm)();return function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"link";(0,o.vQ)(e),t.popToast(t=>(0,a.tZ)(s.FN,(0,l._)((0,i._)({},t),{text:"Copied ".concat(r," to clipboard"),Icon:n.Z})))}}},57639:function(t,e,r){r.d(e,{$y:()=>h,MQ:()=>y,N9:()=>w,Nh:()=>f,RK:()=>g});var i=r(7409),l=r(94184),a=r.n(l),n=r(98661),o=r(26445),s=r(98914),d=r(60308),u=r(63651),c=r(19520),m=r(30548);let p=t=>t.attrs.fullscreen?"full":t.attrs.imageSize||"normal",h={attrs:{src:{default:""},srcNoWatermark:{default:null},fullscreen:{default:null},imageSize:{default:null},height:{default:null},width:{default:null},resizeWidth:{default:null},bytes:{default:null},alt:{default:null},title:{default:null},type:{default:null},href:{default:null},belowTheFold:{default:!1},topImage:{default:!1},internalRedirect:{default:null},isProcessing:{default:!1},align:{default:null},offset:{default:!1}},inline:!1,atom:!0,group:"block",draggable:!0,selectable:!0,isolating:!0,defining:!0,parseDOM:[{tag:"p",priority:100,getAttrs:t=>{if(t.textContent.trim())return!1;let[e]=t.getElementsByTagName("img");return!!e&&f(e)}},{tag:"img[src]",getAttrs:t=>!(t.getAttribute("height")&&1>=Number(t.getAttribute("height"))||t.getAttribute("width")&&1>=Number(t.getAttribute("width")))&&f(t)}],toDOM:t=>{let{ImageActions:e}=r(55918);try{let r,i,l;let s=v(t),c=p(t),m=d.s2v.map(e=>({width:e,imageSrc:v(t,{maxWidth:e})})),h=d.s2v.map(e=>({width:e,imageSrc:v(t,{maxWidth:e,imageProps:{format:"webp"}})})),{isProcessing:g}=t.attrs;t.attrs.height&&t.attrs.width&&(r=t.attrs.height,i=t.attrs.width,t.attrs.resizeWidth?(r=t.attrs.resizeWidth*r/i,i=t.attrs.resizeWidth):x(t.attrs)&&i<d.kPM&&(r*=d.kPM/i,i=d.kPM),"full"===c&&(i=Math.min(i,d.qN9)));let f=t.attrs.width/t.attrs.height,w=t.attrs.resizeWidth?t.attrs.resizeWidth/f:t.attrs.height,b=t.attrs.resizeWidth?t.attrs.resizeWidth/w:f,y=!(t.attrs.href&&t.attrs.href!=t.attrs.src);y=(y=y&&t.attrs.height>240&&w>240)&&f<4&&b<4;let k="undefined"==typeof window;l=t.attrs.href?(0,u.chL)(t.attrs.href)?(0,d.zF4)(t.attrs.href):t.attrs.href:(0,d.zF4)(t.attrs.src);let _=document.createElement("div");if(y&&k){_.className="image-link-expand";try{_.innerHTML=(0,o.Dq)((0,n.createElement)(e,{size:20}))}catch(t){console.error("Error rendering ImageActions",t)}}return["a",{class:a()("image-link image2","left"===t.attrs.align&&"image2-align-left","right"===t.attrs.align&&"image2-align-right",t.attrs.offset&&"left"===t.attrs.align&&"image2-offset-left",t.attrs.offset&&"right"===t.attrs.align&&"image2-offset-right",y&&"is-viewable-img",g&&"processing"),target:"_blank",href:l,"data-component-name":"Image2ToDOM"},["div",{class:"image2-inset".concat("full"===c?" image2-full-screen":"")},["picture",{},["source",{type:"image/webp",srcset:h.map(t=>"".concat(t.imageSrc," ").concat(t.width,"w")).join(", "),sizes:"100vw"}],["img",{src:s,width:"full"===c?void 0:i,height:"full"===c?void 0:r,"data-attrs":JSON.stringify(t.attrs),class:"full"===c?"sizing-fullscreen":"large"===c?"sizing-large":"sizing-normal",alt:t.attrs.alt||"",title:t.attrs.title||t.attrs.alt,srcset:m.map(t=>"".concat(t.imageSrc," ").concat(t.width,"w")).join(", "),sizes:"100vw",loading:t.attrs.belowTheFold?"lazy":null,fetchpriority:t.attrs.topImage?"high":null}]],_]]}catch(e){return console.error("Error rendering Maximize2",e),(0,c.s)({msg:null,node:t,err:e,group:"block"})}},toDOMStatic:t=>{var e,r;let i=p(t),l=t.attrs.href||t.attrs.internalRedirect||(0,d.zF4)(t.attrs.src,void 0,{quality:"normal"===i?"auto:good":"auto:best"});if(t.attrs.height&&t.attrs.width&&"full"!==i){let{width:e,height:r}=t.attrs,i=e;t.attrs.resizeWidth?i=t.attrs.resizeWidth:x(t.attrs)&&(i=Math.min(Math.max(e,d.kPM),d.JWy));let a=Math.min(i,d.bxL),n=r*a/e,o=i>d.bxL,s={"data-attrs":JSON.stringify(t.attrs),alt:t.attrs.alt||"",title:t.attrs.title||t.attrs.alt,width:a,height:n,class:o?"wide-image":"",src:(0,d.zF4)(t.attrs.src,Math.min(!x(t.attrs)&&o?2*i:i,2*d.bxL),{lossy:k(t.attrs)})};return["table",{class:"image-wrapper",width:"100%",border:"0",cellSpacing:"0",cellPadding:"0","data-component-name":"Image2ToDOMStatic"},["tr",{},["td"],["td",{align:"left",class:"content",width:i},["a",{class:"image-link",target:"_blank",href:l},["img",s]]],["td"]]]}return"full"===i?["a",{class:"image-link",target:"_blank",href:l},["img",{src:(0,d.zF4)(t.attrs.src,2*d.bxL,{lossy:k(t.attrs),crop:"limit",aspect:"full"===i?"1":void 0}),"data-attrs":JSON.stringify(t.attrs),alt:t.attrs.alt||"",title:t.attrs.title||t.attrs.alt,height:t.attrs.height,width:t.attrs.width}]]:["a",{class:"image-link",target:"_blank",href:l},["img",{src:(0,d.zF4)(t.attrs.src,2*d.bxL,{lossy:k(t.attrs)}),"data-attrs":JSON.stringify(t.attrs),alt:t.attrs.alt||"",title:t.attrs.title||t.attrs.alt,width:t.attrs.resizeWidth||t.attrs.width,height:t.attrs.resizeWidth?(e=t.attrs.width,r=t.attrs.height,r*t.attrs.resizeWidth/e):t.attrs.height}]]}},g=(0,m.S)({name:"image2",nodeSpec:h}),f=function(t,e){let r,i,l,{bytes:a,internalRedirect:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.getAttribute("data-attrs");if(o)try{return JSON.parse(o)}catch(t){}t.getAttribute("imageSize")&&(r=t.getAttribute("imageSize"));let s=t.getAttribute("style");if(s){let t=/max-height:\s*(\d+)px/.exec(s);t&&(i=Number(t[1]));let e=/max-width:\s*(\d+)px/.exec(s);e&&(l=Number(e[1]))}else t.getAttribute("width")&&t.getAttribute("height")&&(i=Number(t.getAttribute("height")),l=Number(t.getAttribute("width")));return t.complete&&t.naturalHeight&&t.naturalWidth&&(i=t.naturalHeight,l=t.naturalWidth),{src:(0,d.UH4)(t.getAttribute("data-medium-file")||t.getAttribute("src")),type:e,title:t.getAttribute("title"),alt:t.getAttribute("alt"),height:i,width:l,bytes:a,internalRedirect:n,imageSize:r,href:t.getAttribute("href"),align:t.getAttribute("align"),offset:"true"===t.getAttribute("offset")}},v=function(t){let{maxWidth:e=null,imageProps:r={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=p(t),a="full"===l?2*d.hI6:"large"===l?2*d.urw:2*d.qN9;return e&&(a=Math.min(e,a)),(0,d.zF4)(t.attrs.src,a,(0,i._)({lossy:k(t.attrs)},r))},w=function(t){var e;let{customSchema:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r&&!r.nodes.image2)return null;let i=/(https?:\/\/(giphy\.com\/gifs|gph.is\/g|media\d*\.giphy\.com\/media)\/[^\s]+)/.exec(t);return null!==(e=i&&i[1])&&void 0!==e?e:null},b=async t=>{let e=(await Promise.resolve().then(r.t.bind(r,80569,23))).default,i="image/gif",l=await e.get("/api/v1/giphy").query({url:t});return f(await new Promise(t=>(0,s.pt)(v({attrs:{type:i,src:l.body.url}}),t)),i,{bytes:l.body.bytes})},y=async function(t){let{customSchema:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e?{schema:e}:await Promise.resolve().then(r.bind(r,37175))).schema.nodes.image2.create(await b(t))};function k(t){return x(t)&&(!t.bytes||t.bytes>5e6)}function x(t){return!!(t.type&&"image/gif"===t.type||t.src&&t.src.split("?")[0].split("#")[0].endsWith(".gif"))}},37175:function(t,e,r){r.r(e),r.d(e,{EMPTY_DOC:()=>em,HEADER_IMAGE_ATTRS_FROM_NODE_TYPE:()=>ep,addIdsToHeaders:()=>eI,checkForUnpublishableComments:()=>e1,checkForUnsafeLinks:()=>e2,createStringDoc:()=>e3,customMediaNodes:()=>eg,extractTags:()=>eL,fromHtml:()=>eD,getCoverImage:()=>ej,getCoverImages:()=>eK,getDefaultPodcastDescriptionWithoutFeedCTAs:()=>e8,getDescription:()=>eR,getDimensionsFromImageUrl:()=>ec,getFirstImageFromBody:()=>eJ,getHeaderImageFromBody:()=>eX,getImageUrlsFromPostBody:()=>eG,getImagesFromBody:()=>eq,getLinks:()=>e0,getPreviewImageUrl:()=>eY,hasExplicitPaywall:()=>e6,migrateMarkdown:()=>eU,migratePost:()=>eH,migrateProsemirrorToTiptap:()=>e$,migratePublication:()=>eV,migrateTiptapToProsemirror:()=>eT,nodeToHtml:()=>eB,normalizeDbPodcastDescriptionToHtmlString:()=>e5,purgeUnsafeLinks:()=>e9,schema:()=>eb,schemaStatic:()=>ey,serializeDoc:()=>eA,serializedToPodcastDescription:()=>eE,setBelowTheFoldAttribute:()=>e4,setButtonActions:()=>eQ,tipTapNodes:()=>eZ,tipTapSchema:()=>eS,toHtml:()=>eO,toText:()=>eW,trackedCustomNodes:()=>ev,unserializeDoc:()=>eF,unserializeDocAsync:()=>eP,unserializeJson:()=>eM});var i=r(7409),l=r(99282),a=r(88897),n=r(19512),o=r(56070),s=r(18490),d=r(24717),u=r(56782),c=r(43557),m=r(99961),p=r(18e3),h=r(51127),g=r(67338),f=r(75481),v=r(55786),w=r(32018),b=r(91077),y=r(87597),k=r(94886),x=r(99218),_=r(55963),N=r(21803),Z=r(76405),S=r(39693),C=r.n(S),z=r(14293),$=r.n(z),T=r(44908),M=r.n(T),F=r(60826),P=r(24791),A=r(40121),B=r(5889),I=r(60308),O=r(84864),W=r(5835),E=r(26603),L=r(57937),D=r(55633),U=r(1451),H=r(44262),V=r(41676),R=r(82032),j=r(95068),q=r(12568),J=r(65626),X=r(37622),G=r(36621),K=r(31188),Y=r(71993),Q=r(88954),tt=r(13991),te=r(36122),tr=r(72270),ti=r(82167),tl=r(47456),ta=r(32978),tn=r(40924),to=r(86725),ts=r(59383),td=r(5660),tu=r(1415),tc=r(98616),tm=r(82708),tp=r(73984),th=r(11105),tg=r(10218),tf=r(98738),tv=r(81519),tw=r(59662),tb=r(60511),ty=r(75837),tk=r(29961),tx=r(24653),t_=r(80334),tN=r(94413),tZ=r(75970),tS=r(715),tC=r(87113),tz=r(98450),t$=r(87413),tT=r(69323),tM=r(61601),tF=r(57639),tP=r(54793),tA=r(29511),tB=r(49640),tI=r(99975),tO=r(41128),tW=r(23431),tE=r(73078),tL=r(85197),tD=r(53797),tU=r(99741),tH=r(3185),tV=r(8220),tR=r(18119),tj=r(44288),tq=r(13938),tJ=r(54757),tX=r(11006),tG=r(11470),tK=r(66928),tY=r(19805),tQ=r(46393),t0=r(2107),t1=r(99149),t2=r(79592),t9=r(62645),t4=r(39111),t5=r(42034),t8=r(41505),t3=r(57950),t6=r(78483),t7=r(57881),et=r(84766),ee=r(62092),er=r(68303),ei=r(88956),el=r(22498),ea=r(22365),en=r(60802),eo=r(45913),es=r(12076),ed=r(34612),eu=r(32751);let ec=t=>{var e,r,i,l;let[a,n]=((null===(l=t.split("_"))||void 0===l?void 0:null===(i=l[1])||void 0===i?void 0:null===(r=i.split("."))||void 0===r?void 0:null===(e=r[0])||void 0===e?void 0:e.split("x"))||[0,0]).map(Number);return{width:a||0,height:n||0}},em={type:"doc",content:[{type:"paragraph"}]},ep={captionedImage:t=>{var e,r,i,l;let a=null===(e=t.content)||void 0===e?void 0:e.find(t=>{var e,r;return"image2"===t.type&&(null===(e=t.attrs)||void 0===e?void 0:e.width)>=300&&(null==t?void 0:null===(r=t.attrs)||void 0===r?void 0:r.height)>=300});if(!a)return{url:null,caption:void 0,alt:void 0};let n=null==t?void 0:null===(r=t.content)||void 0===r?void 0:r.find(t=>"caption"===t.type);return{url:null==a?void 0:null===(i=a.attrs)||void 0===i?void 0:i.src,caption:n,alt:null==a?void 0:null===(l=a.attrs)||void 0===l?void 0:l.alt}},image2:t=>{var e,r,i,l;return"number"!=typeof(null===(e=t.attrs)||void 0===e?void 0:e.width)&&"number"!=typeof(null===(r=t.attrs)||void 0===r?void 0:r.height)||t.attrs.width>=300&&t.attrs.height>=300?{url:null==t?void 0:null===(i=t.attrs)||void 0===i?void 0:i.src,alt:null==t?void 0:null===(l=t.attrs)||void 0===l?void 0:l.alt}:{url:null,caption:void 0,alt:void 0}},image3:t=>{var e,r,i,l,a;let n=ec(null===(e=t.attrs)||void 0===e?void 0:e.src);return"number"!=typeof(null===(r=t.attrs)||void 0===r?void 0:r.width)&&"number"!=typeof(null===(i=t.attrs)||void 0===i?void 0:i.height)||t.attrs.width>=300&&t.attrs.height>=300||n.width>=300&&n.height>=300?{url:null===(l=t.attrs)||void 0===l?void 0:l.src,caption:t.content,alt:null===(a=t.attrs)||void 0===a?void 0:a.alt}:{url:null,caption:void 0,alt:void 0}}},eh={image:t=>{var e;return eY(null===(e=t.attrs)||void 0===e?void 0:e.src)},image2:t=>{var e,r,i;return"number"!=typeof(null===(e=t.attrs)||void 0===e?void 0:e.width)&&"number"!=typeof(null===(r=t.attrs)||void 0===r?void 0:r.height)||t.attrs.width>=300&&t.attrs.height>=300?eY(null===(i=t.attrs)||void 0===i?void 0:i.src):null},image3:t=>{var e,r,i,l;let a=ec(null===(e=t.attrs)||void 0===e?void 0:e.src);return"number"!=typeof(null===(r=t.attrs)||void 0===r?void 0:r.width)&&"number"!=typeof(null===(i=t.attrs)||void 0===i?void 0:i.height)||t.attrs.width>=300&&t.attrs.height>=300||a.width>=300&&a.height>=300?eY(null===(l=t.attrs)||void 0===l?void 0:l.src):null},imageGallery:t=>{var e,r,i;return eY(null===(i=t.attrs)||void 0===i?void 0:null===(r=i.gallery.images)||void 0===r?void 0:null===(e=r[0])||void 0===e?void 0:e.src)},spotify:t=>{var e;return eY(null===(e=t.attrs)||void 0===e?void 0:e.image)},spotify2:t=>{var e;return eY(null===(e=t.attrs)||void 0===e?void 0:e.image)},opensea:t=>{var e;return eY(null===(e=t.attrs)||void 0===e?void 0:e.image)},twitter2:t=>{var e,r;if(null===(e=t.attrs)||void 0===e?void 0:e.photos){for(let e of t.attrs.photos)if(e.img_url)return eY(e.img_url)}return(null===(r=t.attrs)||void 0===r?void 0:r.expanded_url)&&t.attrs.expanded_url.image?t.attrs.expanded_url.image.url?eY(t.attrs.expanded_url.image.url):eY(t.attrs.expanded_url.image):null},vimeo:t=>{var e;return eo.Jn(null===(e=t.attrs)||void 0===e?void 0:e.videoId,{playButton:!1})},youtube:t=>{var e;return eu.Jn(null===(e=t.attrs)||void 0===e?void 0:e.videoId,{playButton:!1})},youtube2:t=>{var e;return eu.Jn(null===(e=t.attrs)||void 0===e?void 0:e.videoId,{playButton:!1})},kindle:t=>{var e;return(0,I.zF4)(null===(e=t.attrs)||void 0===e?void 0:e.imageUrl)},applePodcast:t=>{var e;return(0,I.zF4)(null===(e=t.attrs)||void 0===e?void 0:e.imageUrl)},tiktok:t=>{var e;return(0,I.zF4)(null===(e=t.attrs)||void 0===e?void 0:e.thumbnail_url)},prediction_market:t=>{var e;return(0,I.zF4)(null===(e=t.attrs)||void 0===e?void 0:e.thumbnail_url)},manifold:t=>{var e;return(0,I.zF4)(null===(e=t.attrs)||void 0===e?void 0:e.thumbnail_url)},lichess:t=>{var e;return(0,I.zF4)(null===(e=t.attrs)||void 0===e?void 0:e.thumbnail_url)},datawrapper:t=>{var e;return(0,I.zF4)(null===(e=t.attrs)||void 0===e?void 0:e.thumbnail_url)},pinterest:t=>{var e;return eY(null===(e=t.attrs)||void 0===e?void 0:e.image)}},eg={augmentation_placeholder:U.$,youtube2:eu.$y,youtube:ed.$,vimeo:eo.$y,install_substack_app:tB.$,preview_in_substack_app:tJ.$,opensea:tD.$y,twitter2:et.$y,twitter:t7.$,communityChat:Q.$y,communityPost:tt.$y,comment:Y.$y,spotify2:t2.$y,spotify:t1.$,soundcloud:tQ.$y,instagram:tA.$y,image2:tF.$y,image:tT.$,button:j.$y,comic:K.Z.nodeSpec,file:K.Z.nodeSpec,pdf:tH.Z.nodeSpec,xlsx:es.Z.nodeSpec,ebook:ta.Z.nodeSpec,referral_link:tK.$,bandcamp:H.$y,kindle:tI.$y,gitgist:t$.$y,embeddedPost:tn.$y,embeddedPublication:to.$y,applePodcast:W.$y,audio:L.$y,video:en.$,audioUrl:D.$y,tiktok:t6.$y,bluesky:R.$y,poll:tR.$,sponsorshipCampaign:t0.$,imageGallery:tM.$y,image3:tP.$y,cashtag:G.$,substack_mentions:tL.$,prediction_market:tj.$y,manifold:tj.$y,lichess:tW.$y,datawrapper:tr.$y,digestPostEmbed:ti.$y,assetError:E.$,directMessage:tl.$y,recipe:tG.$,pinterest:tV.$y},ef=(0,l._)((0,i._)({},eg),{blockquote:V.$,fragmentNode:tz.$,captionedImage:X.$,caption:q.$,ctaCaption:te.$,footnote:tS.$,footnoteAnchor:tC.$,latex_block:tO.$y,paywall:tU.$,preformatted_text_block:tq.$,pullquote:tX.$,subscribeWidget:t4.$,captionedShareButton:(0,J.$y)({url:F.W.SHARE_URL}),captionedWriterReferralButton:(0,J.$y)({hasDynamicSubstitutions:!1}),templateComment:t3.$,meeting:tE.$,referralTier:tY.$y}),ev=(0,l._)((0,i._)({},eg),{subscribeWidget:t4.$,paywall:tU.$,templateComment:t3.$}),ew={strikethrough:t9.J,superscript:t8.O,subscript:t5.l},eb=new Z.V_({nodes:eC(),marks:ez()}),ey=new Z.V_({nodes:eC({isStatic:!0}),marks:ez({isStatic:!0})}),ek=Object.keys(ef).filter(t=>!["blockquote","pullquote"].includes(t)).map(t=>{let e=(0,er.Co)(t,ef[t]),r=(0,i._)({},ef[t],e);return"youtube2"===t?r.addNodeView=()=>t=>{let{node:e}=t;return new eu.dQ(e)}:"tiktok"===t?r.addNodeView=()=>t=>{let{node:e}=t;return new t6.QZ(e)}:"lichess"===t?r.addNodeView=()=>t=>{let{node:e}=t;return new tW.$1(e)}:"datawrapper"===t?r.addNodeView=()=>t=>{let{node:e}=t;return new tr.s3(e)}:"prediction_market"===t||"manifold"===t?r.addNodeView=()=>t=>{let{node:e}=t;return new tj.eC(e)}:"paywall"===t?r.addNodeView=()=>t=>new tU.b:"latex_block"===t?r.addNodeView=()=>t=>{let{node:e}=t;return new tO.Jd(e)}:"comic"===t?r.addNodeView=()=>t=>{let{node:e,editor:r,getPos:i}=t;return K.Z.getNodeView({node:e,editor:r,getPos:i})}:"pdf"===t?r.addNodeView=()=>t=>{let{node:e,editor:r,getPos:i}=t;return tH.Z.getNodeView({node:e,editor:r,getPos:i})}:"xlsx"===t?r.addNodeView=()=>t=>{let{node:e,editor:r,getPos:i}=t;return es.Z.getNodeView({node:e,editor:r,getPos:i})}:"ebook"===t&&(r.addNodeView=()=>t=>{let{node:e,editor:r,getPos:i}=t;return ta.Z.getNodeView({node:e,editor:r,getPos:i})}),a.NB.create(r)}),ex=n.V6.extend({addCommands(){return{toggleBlockquote:()=>t=>{let{state:e,commands:r}=t;return!(!(0,a.Ig)(e,"paragraph")||(0,a.Ig)(e,"pullquote"))&&r.toggleWrap(this.name)}}},parseHTML:()=>V.$.parseDOM}),e_=g.b.extend({addCommands:()=>({insertHorizontalRule:()=>t=>{let{state:e,dispatch:r}=t;return r&&e.schema.nodes.horizontalRule&&r((0,er.o4)(e,e.schema.nodes.horizontalRule.create())),!0},setHorizontalRule:()=>t=>{let{state:e,dispatch:r}=t;if(r){if(!e.schema.nodes.horizontalRule)return console.error("horizontalRule is missing"),!1;r((0,er.o4)(e,e.schema.nodes.horizontalRule.create()))}return!0}})}),eN=u.dn.extend({marks:"_"}),eZ=[ex,o.d8,s.DY,td.z,d.EK,eN,tc.l,c.B,tp.w,m.U,p.X,h.A,e_,ts.M,tZ.f,tg._,tv.r,ty.q,t_.a,tk.R,tb.q,th.y,f.Tx,tf.d,v.H,w.GS,b.n,tw.f,tX.z,y.Re,k.a,x.$,_.x,tu.n,tN.T,tm.k,tl.e1,...ek],eS=(0,a.J1)(eZ);function eC(){let{isStatic:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=N.fK.spec.nodes;for(let r of Object.keys(ef)){let i=Object.assign({},ef[r]);t&&i.toDOMStatic&&(i.toDOM=i.toDOMStatic),delete i.toDOMStatic,e=e.get(r)?e.update(r,i):e.addToEnd(r,i)}return e}function ez(){let{isStatic:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=N.fK.spec.marks;for(let r of Object.keys(ew)){let i=Object.assign({},ew[r]);t&&i.toDOMStatic&&(i.toDOM=i.toDOMStatic),delete i.toDOMStatic,e=e.get(r)?e.update(r,i):e.addToEnd(r,i)}return e}function e$(t){let{postId:e,pubId:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t;return"string"==typeof i&&(i=eM(i,{postId:e,pubId:r})),(0,er.cb)(i,t=>{let e=er.qj.find(e=>e[0]===t.type);return e&&(t.type=e[1],t.attrs&&"orderedList"===e[1]&&(t.attrs.start=t.attrs.order)),t.marks&&t.marks.forEach(t=>{let e=er.PH.find(e=>e[0]===t.type);e&&(t.type=e[1])}),t}),i}function eT(t){let{postId:e,pubId:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t;return"string"==typeof i&&(i=eM(i,{postId:e,pubId:r})),(0,er.cb)(i,t=>{let e=er.qj.find(e=>e[1]===t.type);return e&&(t.type=e[0],t.attrs&&"ordered_list"===e[0]&&(t.attrs.order=t.attrs.start)),t.marks&&t.marks.forEach(t=>{let e=er.PH.find(e=>e[1]===t.type);e&&(t.type=e[0])}),t}),i}function eM(t){let e,{postId:r,pubId:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&(t=(t=t.replace("http://substack-post-media","https://substack-post-media")).replace("http://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984","https://bucketeer-e05bbc84-baa3-437e-9518-adb32be77984")),t=eU(t))try{e=JSON.parse(t)}catch(e){console.error("unserializeJson for post [".concat(r,"], pubId [").concat(i,"], could not parse serialized:"),t,e)}return null!=e?e:void 0}function eF(t){let{customSchema:e,useTiptap:r,mutateJson:i,shouldSetBelowTheFoldAttribute:l=!1,shouldThrowOnInvalid:a,postId:n,pubId:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=eM(t,{postId:n,pubId:o})||em;i&&i(a);let s=e9(a);if(!s)throw Error("could not purgeUnsafeLinks");let d=s;return l&&(d=e4(d)),d=r?e$(d,{postId:n,pubId:o}):eT(d,{postId:n,pubId:o}),(e||eb).nodeFromJSON(d)}catch(r){if(console.error("Failed to parse JSON for post [".concat(n,"], serialized:"),t,r),a)throw Error("Failed to parse JSON:  ".concat(r.message));return(e||eb).nodeFromJSON(em)}}async function eP(t){let{customSchema:e,useTiptap:r,mutateJson:i,shouldSetBelowTheFoldAttribute:l=!1,shouldThrowOnInvalid:a,postId:n,pubId:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=eM(t,{postId:n,pubId:o})||em;i&&await i(a);let s=e9(a);if(!s)throw Error("could not purgeUnsafeLinks");let d=s;return l&&(d=e4(d)),d=r?e$(d,{postId:n,pubId:o}):eT(d,{postId:n,pubId:o}),(e||eb).nodeFromJSON(d)}catch(r){if(console.error("Failed to parse JSON for post [".concat(n,"], serialized:"),t,r),a)throw Error("Failed to parse JSON:  ".concat(r.message));return(e||eb).nodeFromJSON(em)}}function eA(t){let{runMigrations:e=!1,postId:r,pubId:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=t.toJSON();return e&&(l=eT(l=e9(l=function(t){let{postId:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="string"==typeof t?eM(t,{postId:e}):t;return(0,er.cb)(r,t=>{t.text&&(t.text=(0,O.stripInvalidBytes)(t.text))},{nodeTypes:["text"]}),r}(l)),{postId:r,pubId:i})),JSON.stringify(l)}function eB(t,e){let r=document.createElement("div");return r.appendChild(Z.PW.fromSchema(e?ey:eb).serializeFragment(Z.HY.fromArray([t]),{document})),r}function eI(t){Array.from(t.querySelectorAll("h2, h3, h4, h5, h6")).forEach(t=>{if(!t.getAttribute("id")){var e,r;let i=(r=t.textContent||"",(0,A.Hm)((0,O.truncateText)(r,500,{ellipsis:""}),{allowUnicode:!0})),l=document.createElement("div");l.setAttribute("id",i),l.setAttribute("class","anchor-target"),null===(e=t.parentNode)||void 0===e||e.insertBefore(l,t);let a=document.createElement("a");for(a.setAttribute("href","#".concat(i));t.firstChild;)a.appendChild(t.firstChild);t.appendChild(a)}})}function eO(t,e){let{isAmp:r,transform:i,useTipTap:l,pubId:a,postId:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(l){let r=e$(eM(t,{postId:n,pubId:a}),{postId:n,pubId:a});if(!r)throw Error("could not serialize json doc");return(0,ea.e)({doc:r,extensions:(0,tx.p)({isStatic:null!=e&&e}),customDocument:document})}let o=eF(t,{shouldSetBelowTheFoldAttribute:!0,postId:n,pubId:a}),s=Z.PW.fromSchema(e?ey:eb),d=document.createElement("div");try{s.serializeFragment(o.content,{document},d)}catch(t){return console.error("could not serialize fragment, for pubId [".concat(a,"], postId [").concat(n,"]"),t),d.innerHTML}return i&&i(d),r&&function(t){Array.from(t.querySelectorAll("img")).forEach(t=>{let e=document.createElement("amp-img");e.setAttribute("layout","intrinsic"),t.getAttributeNames().forEach(r=>{var i;"srcset"!==r&&e.setAttribute(r,null!==(i=t.getAttribute(r))&&void 0!==i?i:"null")}),t.replaceWith(e)})}(d),d.innerHTML}function eW(t,e){let{postId:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,er.lr)(eF(t,{postId:r}),e)}function eE(t){let{postId:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,er.fX)(eF(t,{postId:e}))}function eL(t){let{postId:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,er.E5)(eF(t,{postId:e}))}function eD(t){let{stripEmptyParagraphs:e,postId:r,pubId:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=Z.aw.fromSchema(eb).parse(new DOMParser().parseFromString(t,"text/html"));return(e&&(l=(0,ei.Y)(l,t=>!t.type||"paragraph"!==t.type.name||!!(0,er.lr)(t))),l)?eA(l,{postId:r,pubId:i}):null}function eU(t){return t&&"{"!==t[0]&&"null"!==t?eA(N.EU.parse(t)):t}function eH(t){var e,r;return t.body=null!==(e=eU(t.body))&&void 0!==e?e:null,t.draft_body=null!==(r=eU(t.draft_body))&&void 0!==r?r:null,t}function eV(t){var e,r,i,l,a;return t.subscribe_content=null!==(e=eU(t.subscribe_content))&&void 0!==e?e:null,t.welcome_email_content=null!==(r=eU(t.welcome_email_content))&&void 0!==r?r:null,t.tos_content=null!==(i=eU(t.tos_content))&&void 0!==i?i:null,t.privacy_content=null!==(l=eU(t.privacy_content))&&void 0!==l?l:null,t.disclosures_content=null!==(a=eU(t.disclosures_content))&&void 0!==a?a:null,t}function eR(t,e){let{post:r=null,pubId:i,minCharacters:l=6,maxStopAfter:a=null,singleSentence:n=!0,language:o="en",excludeMediaPrefix:s=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{iString:d}=I18N.i(o),u=(null==r?void 0:r.type)==="thread"?145:250;(a||0===a)&&(u=Math.min(a,u));let c=(null==r?void 0:r.type)==="thread",m="";if(e)m+=e;else if(0!==u){var p;let e={paragraph:!0,blockquote:!0,list_item:!0,listItem:!0,heading:!0,code_block:!0,codeBlock:!0,hardbreak:!0,hard_break:!0,hardBreak:!0},a={caption:!0,footnote:!0};(0,er.cb)("string"==typeof t?eM(t,{postId:null!==(p=null==r?void 0:r.id)&&void 0!==p?p:null,pubId:i}):t,t=>{if(u&&m.length>=u||t.type&&a[t.type])return!1;if("text"===t.type){let{text:e}=t;if(e){let t=e.match(/[.?!] /);if(n&&(null==t?void 0:t.index))return m+=e.slice(0,t.index+1),el.aT;m+=e}}else if(t.type&&e[t.type]&&m){if(m.length>l)return el.aT;" "!==m[m.length-1]&&(m+=" ")}else if("substack_mentions"===t.type){var r,i;m+=null!==(i=null===(r=t.attrs)||void 0===r?void 0:r.name)&&void 0!==i?i:""}})}if(m=m.replace(/\s+/g," ").trim(),c&&u&&m.length>=u&&(m=(0,O.truncateText)(m,u)),((null==r?void 0:r.type)==="podcast"||(null==r?void 0:r.type)==="video")&&!s){let t=(0,P.XV)(r);m="".concat(d((null==r?void 0:r.type)==="video"||(null==r?void 0:r.videoUpload)?"Watch now":"Listen now")," ").concat(t?"(".concat((0,O.secondsToLargestUnit)(t,{minutesCutoff:10800,language:o}),") "):"","| ").concat(m)}return m}function ej(t,e){var r;return null!==(r=eK(t,e)[0])&&void 0!==r?r:null}function eq(t){let{postId:e,pubId:r,width:i,height:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=eM(t,{postId:e,pubId:r});return a?M()(C()((0,er.fp)(a,t=>{var e;return!!eh[null!==(e=t.type)&&void 0!==e?e:""]}).map(t=>{var e,r;let a=null===(e=eh[null!==(r=t.type)&&void 0!==r?r:""])||void 0===e?void 0:e.call(eh,t);return a?(0,I.zF4)(a,i,{height:l}):null}))):[]}function eJ(t){let{postId:e,pubId:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=eq(t,{postId:e,pubId:r});return i.length>0&&!$()(i[0])?i[0]:null}function eX(t){let{body:e}=t,r=eM(e);if(r)return(0,er.fp)(r,t=>{var e;return!!ep[null!==(e=t.type)&&void 0!==e?e:""]}).map(t=>{var e,r;return null===(e=ep[null!==(r=t.type)&&void 0!==r?r:""])||void 0===e?void 0:e.call(ep,t)})[0]}async function eG(t){let{body:e,postId:r}=t,i=eF(e,{postId:r}),l=[];return(0,er.je)(i,t=>{switch(t.type.name){case"image":case"image2":t.attrs.src&&l.push(t.attrs.src);break;case"imageGallery":var e;null===(e=t.attrs.gallery.images)||void 0===e||e.map(t=>{t.src&&l.push(t.src)})}}),l}function eK(t,e){var r;let i=[];"podcast_episode_image_info"in e&&e.podcast_episode_image_info&&!e.podcast_episode_image_info.isDefaultArt&&i.unshift(e.podcast_episode_image_info.url),i.unshift(...eq(t,{postId:e.id}));let l="podcastUpload"in e&&e.podcastUpload||"draftPodcastUpload"in e&&e.draftPodcastUpload||void 0;if((null==l?void 0:l.state)==="transcoded"&&(null!==(r=null==l?void 0:l.thumbnail_id)&&void 0!==r?r:1)>1){let t=(0,I.ow1)(l);t&&i.unshift(t)}let a="videoUpload"in e&&e.videoUpload||"draftVideoUpload"in e&&e.draftVideoUpload||void 0;if((null==a?void 0:a.state)==="transcoded"){let t=(0,I.ow1)(a);t&&i.unshift(t)}return"podcast_art_url"in e&&e.podcast_art_url&&i.unshift(e.podcast_art_url),i}function eY(t){return"string"!=typeof t?null:(t=t.replace(/\/l_twitter_play_button_rvaygk[^/]+/g,""),(0,I.zF4)(t,void 0,{height:600}))}function eQ(t){(0,er.cb)(t,t=>{var e;return"button"===t.type&&((null===(e=t.attrs)||void 0===e?void 0:e.url)&&"string"==typeof t.attrs.url&&t.attrs.url.startsWith("%%")&&(t.attrs.action=t.attrs.url.replace(/%%/g,"")),!0)},{nodeTypes:"button"})}function e0(t){let{postId:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t;if("string"==typeof r){let t=eM(r,{postId:e});if(!t)return[];r=t}eQ(r);let i=[];return(0,er.cb)(r,t=>{var e,r,l;if("button"===t.type&&(null===(e=t.attrs)||void 0===e?void 0:e.url)&&!t.attrs.action)i.push({text:t.attrs.text,url:t.attrs.url});else if("image2"===t.type&&(null===(r=t.attrs)||void 0===r?void 0:r.href))i.push({text:t.attrs.href,url:t.attrs.href});else if(t.marks){for(let e of t.marks)if("link"===e.type&&(null===(l=e.attrs)||void 0===l?void 0:l.href)){i.push({text:t.text,url:e.attrs.href});break}}}),i}function e1(t){let{postId:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return!1;let r=t;if("string"==typeof r){let t=eM(r,{postId:e});if(!t)return!1;r=t}return!!(0,er.DY)(r,t=>"templateComment"===t.type)}function e2(t){let{postId:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return!1;let r=t;if("string"==typeof r){let t=eM(r,{postId:e});if(!t)return!1;r=t}return!!(0,er.DY)(r,t=>{for(let o of["href","src","url"]){var e,r,i,l,a,n;if((null==t?void 0:null===(l=t.attrs)||void 0===l?void 0:null===(i=l[o])||void 0===i?void 0:null===(r=i.trim)||void 0===r?void 0:null===(e=(a=r.call(i)).toLowerCase)||void 0===e?void 0:e.call(a).startsWith("javascript:"))||(null==t?void 0:null===(n=t.marks)||void 0===n?void 0:n.find(t=>{var e,r,i,l,a;return null===(l=t.attrs)||void 0===l?void 0:null===(i=l[o])||void 0===i?void 0:null===(r=i.trim)||void 0===r?void 0:null===(e=(a=r.call(i)).toLowerCase)||void 0===e?void 0:e.call(a).startsWith("javascript:")})))return!0}return!1})}function e9(t){let e,{postId:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof t){let i=eM(t,{postId:r});if(!i)return null;e=i}else e=t;return(0,ee.f5)(e)?(0,ei.Y)(e,t=>{for(let o of["href","src","url"]){var e,r,i,l,a,n;if((null==t?void 0:null===(l=t.attrs)||void 0===l?void 0:null===(i=l[o])||void 0===i?void 0:null===(r=i.trim)||void 0===r?void 0:null===(e=(a=r.call(i)).toLowerCase)||void 0===e?void 0:e.call(a).startsWith("javascript:"))||(null==t?void 0:null===(n=t.marks)||void 0===n?void 0:n.find(t=>{var e,r,i,l,a;return null===(l=t.attrs)||void 0===l?void 0:null===(i=l[o])||void 0===i?void 0:null===(r=i.trim)||void 0===r?void 0:null===(e=(a=r.call(i)).toLowerCase)||void 0===e?void 0:e.call(a).startsWith("javascript:")})))return!1}return!0}):(0,ei.Y)(e,t=>{for(let o of["href","src","url"]){var e,r,i,l,a,n;if((null==t?void 0:null===(l=t.attrs)||void 0===l?void 0:null===(i=l[o])||void 0===i?void 0:null===(r=i.trim)||void 0===r?void 0:null===(e=(a=r.call(i)).toLowerCase)||void 0===e?void 0:e.call(a).startsWith("javascript:"))||(null==t?void 0:null===(n=t.marks)||void 0===n?void 0:n.find(t=>{var e,r,i,l,a;return null===(l=t.attrs)||void 0===l?void 0:null===(i=l[o])||void 0===i?void 0:null===(r=i.trim)||void 0===r?void 0:null===(e=(a=r.call(i)).toLowerCase)||void 0===e?void 0:e.call(a).startsWith("javascript:")})))return!1}return!0})}function e4(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,{postId:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="string"==typeof t?eM(t,{postId:r}):t;if(!i)return;let l=!1;return"doc"===i.type&&i.content&&i.content.map((t,r)=>{r>e?(0,er.cb)(t,t=>{!t.content&&t.attrs&&(t.attrs.belowTheFold=!0)}):l||(0,er.cb)(t,t=>{!t.content&&(null==t?void 0:t.type)=="image2"&&t.attrs&&(t.attrs.topImage=!0,l=!0)})}),i}function e5(t){let{postId:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return JSON.parse(t),eE(t,{postId:e})}catch(e){return t}}function e8(t,e){let{body:r,hasPodcastPreview:i}=e;if(!t||!r)return null;let l=r;return i&&(l=JSON.stringify((0,er.N5)(eM(r,{postId:t.id}),{maxLength:"post_preview_limit"in t&&t.post_preview_limit&&"number"==typeof t.post_preview_limit?t.post_preview_limit:356}))),eE(l,{postId:t.id})}function e3(t){return eA(eb.node("doc",null,t.split("\n").map(t=>t.trim()).filter(t=>t.length>0).map(t=>{let e=[],r=(0,B.m)(t);if(r.length>0){let i=t;for(;;){let t=r.map(t=>[i.indexOf(t.value),t.value]).sort().find(t=>{let[e]=t;return e>=0});if(!t)break;let[l,a]=t;if(l>0&&e.push(eb.text(i.substring(0,l))),!eb.marks.link){console.error("link is missing from schema");continue}e.push(eb.text(a,[eb.marks.link.create({title:a,href:a,target:"_blank"})])),i=i.substring(l+a.length)}i&&e.push(eb.text(i))}else e.push(eb.text(t));return eb.node("paragraph",null,e)})))}function e6(t){let{postId:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return!1;let r=t;if("string"==typeof t){let i=eM(t,{postId:e});if(!i)return!1;r=i}else r=t;return(0,er.C4)(r)}Object.entries(eS.nodes).forEach(t=>{let[e,r]=t;void 0!==ef[e]&&(r.spec=(0,i._)({},ef[e],r.spec))})}}]);