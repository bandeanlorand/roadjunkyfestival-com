"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["6627"],{64473:function(e,t,n){n.d(t,{Z:()=>i});let i={iframe:"iframe-_GPXZ7",codeInput:"codeInput-elXe0s"}},8108:function(e,t,n){n.d(t,{Z:()=>i});let i={dropdownMenu:"dropdownMenu-ASlbF5",textInput:"textInput-kYr7wC"}},61649:function(e,t,n){n.d(t,{AO:()=>I,AT:()=>k,BY:()=>b,MZ:()=>_,Sr:()=>M,Zl:()=>Z,ar:()=>g,eD:()=>w,l7:()=>x,ss:()=>S});var i=n(7409),r=n(16584),o=n(6400),l=n(30396),s=n(74691),a=n.n(s),c=n(7654),d=n.n(c),u=n(14293),h=n.n(u),v=n(5463),f=n(32224),p=n(36671),m=n(68833),C=n(15771),y=n(19081);let k=5,g=300,w=600,Z=60,S=30,I=e=>{let t=a()(e,1,16),n=w-Z;return a()(w-(t-1)/15*n,Z,w)},_=e=>{for(let t=16;t>=1;t--)if(I(t)>=2*e)return a()(t,1,16);return 1},T=(0,o.createContext)({clipTimes:null,isClipping:!1,setClipEnd:()=>void 0,setClipStart:()=>void 0,setClipTitle:()=>void 0,virtualizedListRef:{current:null},onCancelClipping:()=>void 0,onStartClipping:()=>void 0,clipTitle:null,zoom:0,setZoom:()=>void 0}),b=e=>{let{children:t,postId:n,videoPlayerRef:o,virtualizedListRef:s}=e,[c,u]=(0,l.eJ)(!1),[v,f]=(0,l.eJ)(),[p,C]=(0,l.eJ)(),[y,w]=(0,l.eJ)(null),[Z,I]=(0,l.eJ)(1),b=(0,l.sO)(!1),M=(0,l.Ye)(()=>h()(v)||h()(p)?null:{start:v,end:p},[p,v]);(0,l.d4)(()=>{b.current||void 0==v||void 0==p||(I(_(p-v)),b.current=!0)},[v,p]);let x=(0,l.I4)(e=>{var t,r,l,s,c,v,p,y,Z;let{start:I,end:_,source:T,title:b}=e,M=null!==(p=null==o?void 0:null===(r=o.current)||void 0===r?void 0:null===(t=r.player)||void 0===t?void 0:t.duration)&&void 0!==p?p:300;d()(M)&&(M=300);let x=h()(I)||h()(_)?null:{start:I,end:Math.min(_,I+g)},E=null!=x?x:{start:Math.max(0,null!==(y=null==o?void 0:null===(s=o.current)||void 0===s?void 0:null===(l=s.player)||void 0===l?void 0:l.currentTime)&&void 0!==y?y:0),end:Math.min(null!=M?M:k,(null!==(Z=null==o?void 0:null===(v=o.current)||void 0===v?void 0:null===(c=v.player)||void 0===c?void 0:c.currentTime)&&void 0!==Z?Z:0)+S)};if(x?E.end=Math.max(E.start+k,E.end):(E.start=a()(E.start,0,M-k),E.end=a()(E.end,E.start+k,Math.min(E.start+g,M))),f(E.start),C(E.end),u(!0),b&&w(b),(0,m.j)(m.FP.VIDEO_CLIP_INITIATED,(0,i._)({post_id:n,source:T},x)),!x&&!(null==o?void 0:o.current)){let e=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;setTimeout(()=>{var n,i;(null==o?void 0:null===(i=o.current)||void 0===i?void 0:null===(n=i.player)||void 0===n?void 0:n.readyState)!==4?t<10&&e(t+1):(f(0),C(Math.min(o.current.player.duration,S)))},100)};e()}},[n,o]),E=(0,l.I4)(e=>{var t,n,i;let r=null!==(i=null==o?void 0:null===(n=o.current)||void 0===n?void 0:null===(t=n.player)||void 0===t?void 0:t.duration)&&void 0!==i?i:0,l=a()(e,k,r);C(l),f(e=>a()(null!=e?e:0,Math.max(l-g,0),l-k))},[o]),V=(0,l.I4)(e=>{var t,n,i;let r=null!==(i=null==o?void 0:null===(n=o.current)||void 0===n?void 0:null===(t=n.player)||void 0===t?void 0:t.duration)&&void 0!==i?i:0,l=a()(e,0,r-k);f(l),C(e=>a()(null!=e?e:0,l+k,Math.min(l+g,r)))},[o]),z=(0,l.I4)(()=>{u(!1)},[]);return(0,r.tZ)(T.Provider,{value:{clipTimes:M,isClipping:c,setClipEnd:E,setClipStart:V,setClipTitle:w,virtualizedListRef:s,onCancelClipping:z,onStartClipping:x,clipTitle:y,zoom:Z,setZoom:I},children:t})},M=()=>(0,l.qp)(T),x=()=>{let{zoom:e,setZoom:t}=M();return(0,r.BX)(y.gq,{gap:12,justifyContent:"center",alignItems:"center",children:[(0,r.tZ)(C.hU,{priority:"secondary-outline",size:"sm",onClick:()=>t(Math.max(1,e-1)),children:(0,r.tZ)(v.Z,{size:20})}),(0,r.tZ)(p.Z,{min:1,max:16,step:1,value:e,onChange:t}),(0,r.tZ)(C.hU,{priority:"secondary-outline",size:"sm",onClick:()=>t(Math.min(16,e+1)),children:(0,r.tZ)(f.Z,{size:20})})]})}},59154:function(e,t,n){n.d(t,{Z:()=>a});var i=n(7409),r=n(99282),o=n(98848),l=n(16584),s=n(64515);let a=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,a=(0,o._)(e,["size","fill"]);return(0,l.tZ)(s.l,(0,r._)((0,i._)({},a),{name:"BlueskyIcon",svgParams:{viewBox:"0 0 600 600"},width:t,height:t,fill:n,stroke:"none",children:(0,l.tZ)("path",{stroke:"none",d:"m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z"})}))}},79138:function(e,t,n){n.d(t,{Z:()=>a});var i=n(7409),r=n(99282),o=n(98848),l=n(16584),s=n(64515);let a=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,a=(0,o._)(e,["size","fill"]);return(0,l.tZ)(s.l,(0,r._)((0,i._)({},a),{name:"FacebookIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,stroke:"none",children:(0,l.tZ)("path",{stroke:"none",d:"M20 10C20 4.47715 15.5229 0 10 0C4.47715 0 0 4.47715 0 10C0 14.9912 3.65684 19.1283 8.4375 19.8785V12.8906H5.89844V10H8.4375V7.79688C8.4375 5.29063 9.93047 3.90625 12.2146 3.90625C13.3084 3.90625 14.4531 4.10156 14.4531 4.10156V6.5625H13.1922C11.95 6.5625 11.5625 7.3334 11.5625 8.125V10H14.3359L13.8926 12.8906H11.5625V19.8785C16.3432 19.1283 20 14.9912 20 10Z"})}))}},37632:function(e,t,n){n.d(t,{Z:()=>a});var i=n(7409),r=n(99282),o=n(98848),l=n(16584),s=n(64515);let a=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,a=(0,o._)(e,["size","fill"]);return(0,l.tZ)(s.l,(0,r._)((0,i._)({},a),{name:"LinkedInIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,stroke:"none",children:(0,l.tZ)("path",{stroke:"none",d:"M18.5195 0H1.47656C0.660156 0 0 0.644531 0 1.44141V18.5547C0 19.3516 0.660156 20 1.47656 20H18.5195C19.3359 20 20 19.3516 20 18.5586V1.44141C20 0.644531 19.3359 0 18.5195 0ZM5.93359 17.043H2.96484V7.49609H5.93359V17.043ZM4.44922 6.19531C3.49609 6.19531 2.72656 5.42578 2.72656 4.47656C2.72656 3.52734 3.49609 2.75781 4.44922 2.75781C5.39844 2.75781 6.16797 3.52734 6.16797 4.47656C6.16797 5.42188 5.39844 6.19531 4.44922 6.19531ZM17.043 17.043H14.0781V12.4023C14.0781 11.2969 14.0586 9.87109 12.5352 9.87109C10.9922 9.87109 10.7578 11.0781 10.7578 12.3242V17.043H7.79688V7.49609H10.6406V8.80078H10.6797C11.0742 8.05078 12.043 7.25781 13.4844 7.25781C16.4883 7.25781 17.043 9.23438 17.043 11.8047V17.043Z"})}))}},8796:function(e,t,n){n.d(t,{Z:()=>a});var i=n(7409),r=n(99282),o=n(98848),l=n(16584),s=n(64515);let a=e=>{var{size:t=24,fill:n="var(--color-fg-primary)"}=e,a=(0,o._)(e,["size","fill"]);return(0,l.tZ)(s.l,(0,r._)((0,i._)({},a),{name:"TikTokIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,fill:n,stroke:"none",children:(0,l.tZ)("path",{stroke:"none",d:"M14.2272 0H10.8566V13.6232C10.8566 15.2464 9.56024 16.5797 7.94697 16.5797C6.33369 16.5797 5.03732 15.2464 5.03732 13.6232C5.03732 12.029 6.30489 10.7246 7.86056 10.6667V7.24639C4.43235 7.30433 1.66675 10.1159 1.66675 13.6232C1.66675 17.1594 4.48996 20 7.97579 20C11.4616 20 14.2848 17.1304 14.2848 13.6232V6.63767C15.5524 7.56522 17.108 8.11594 18.7501 8.14495V4.72464C16.215 4.63768 14.2272 2.55072 14.2272 0Z"})}))}},20730:function(e,t,n){n.d(t,{A:()=>d});var i=n(16584),r=n(94184),o=n.n(r),l=n(98661),s=n(80026),a=n(63474);let c={chip:"chip-lJKwY5",textOnly:"textOnly-SPwDNp",leading:"leading-TvXpau",trailing:"trailing-lhDVKn",clickable:"clickable-IxUlBk",fillIcon:"fillIcon-jYnt2U"},d=(0,l.forwardRef)((e,t)=>{let{children:n,trailing:r,leading:l,href:d,onClick:u,fillIcon:h,newTab:v,className:f}=e,p=d||u,m=!l&&!r;return(0,i.BX)(s.kG,{resetCss:!0,ref:t,className:o()(c.chip,h&&c.fillIcon,p&&c.clickable,m&&c.textOnly,f),href:d,onClick:u,pressable:p?"sm":void 0,newTab:v,children:[l&&(0,i.tZ)(a.M5,{className:c.leading,children:l}),(0,i.tZ)(s.xv.B4,{color:"primary",userSelect:"none",ellipsis:!0,children:n}),r&&(0,i.tZ)(a.M5,{className:c.trailing,children:r})]})})},92039:function(e,t,n){n.d(t,{m:()=>p,rG:()=>f,rw:()=>v});var i=n(27412),r=n(7409),o=n(99282),l=n(16584),s=n(98661),a=n(30396),c=n(48980),d=n(12120);class u{async connect(){try{if(!this.host)throw Error("Attempted to connect without a token");this.ws=new WebSocket(this.host),this.ws.addEventListener("open",()=>{for(let[e,t]of this.channels)t.size>0&&this.send({action:"subscribe",channel:e})}),this.ws.addEventListener("error",e=>{console.error(e),"closed"!==this.connectivityState&&(this.error=Error("Generic error"),this.handleError())}),this.ws.addEventListener("close",e=>{"closed"!==this.connectivityState&&(this.error={code:e.code,reason:e.reason,wasClean:e.wasClean},this.handleError())}),this.ws.addEventListener("message",e=>{"open"!==this.connectivityState&&(this.connectivityState="open",clearTimeout(this.timeoutId),this.reconnectInterval=900,this.notifyConnectivityChange());let t=JSON.parse(e.data),n=(0,o._)((0,r._)({},t),{data:t.data?(0,o._)((0,r._)({},t.data),{message:"string"==typeof t.data.message?JSON.parse(t.data.message):null}):null});if(n.data){var i;for(let e of null!==(i=this.channels.get(n.data.channel))&&void 0!==i?i:[])e(n)}}),clearTimeout(this.timeoutId);let e=this.ws;this.timeoutId=setTimeout(()=>{"connecting"===this.connectivityState&&(this.error=Error("Timeout"),e.close(),this.handleError())},3e4)}catch(e){this.error=e instanceof Error?e:Error(String(e)),this.handleError()}}async refreshToken(){let e;this.channels.size>0&&(e=Array.from(this.channels.keys()).join(","));let t=await (0,c.rd)("/api/v1/realtime/token",{query:{channels:e}});return this.token=t.token,this.expiry=t.expiry,this.host=t.endpoint,this.ws||this.connect(),t}send(e){let{ws:t}=this;if(!t)throw Error("Cannot send without a connection.");t.send(JSON.stringify((0,r._)({token:this.token},e)))}publish(e,t){this.send({action:"publish",channel:e,message:JSON.stringify(t)})}listen(e){let t=[],n=new Set(this.channels.keys());return this.subscriptionQueue=this.subscriptionQueue.then(async()=>{for(let[n,i]of Object.entries(e)){let e=this.channels.get(n);e||(e=new Set,this.channels.set(n,e)),e.add(i),t.push(()=>{var e;let t=this.channels.get(n);null==t||t.delete(i),(null==t?void 0:t.size)===0&&(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN&&(this.send({action:"unsubscribe",channel:n}),this.channels.delete(n))})}let i=(0,d.e5)(new Set(this.channels.keys()),n);if(i.size>0){var r;if(await this.refreshToken(),(null===(r=this.ws)||void 0===r?void 0:r.readyState)===WebSocket.OPEN)for(let e of i)this.send({action:"subscribe",channel:e})}}),()=>{let e=new Set(this.channels.keys());for(let e of t)e();(0,d.e5)(e,new Set(this.channels.keys())).size>0&&this.refreshToken()}}onConnectivityChange(e){return this.connectivityHandlers.add(e),()=>{this.connectivityHandlers.delete(e)}}destroy(){var e;this.channels.clear(),this.connectivityHandlers.clear(),this.connectivityState="closed",null===(e=this.ws)||void 0===e||e.close(),clearTimeout(this.reconnectTimeoutId),clearTimeout(this.timeoutId)}notifyConnectivityChange(){for(let e of this.connectivityHandlers)e(this.connectivityState)}handleError(){console.info("ZyncSocket: Connection closed"),clearTimeout(this.timeoutId),"closed"!==this.connectivityState&&(this.connectivityState="closed",this.notifyConnectivityChange()),0===this.reconnectTimeoutId&&(console.info("ZyncSocket: Attempting to reconnect..."),this.reconnectTimeoutId=setTimeout(()=>{this.reconnectTimeoutId=0,this.reconnectInterval=Math.min(2*this.reconnectInterval,6e4),this.connect()},this.reconnectInterval+.2*this.reconnectInterval))}constructor(){(0,i._)(this,"token",void 0),(0,i._)(this,"expiry",void 0),(0,i._)(this,"host",void 0),(0,i._)(this,"ws",void 0),(0,i._)(this,"connectivityState","closed"),(0,i._)(this,"error",void 0),(0,i._)(this,"reconnectInterval",900),(0,i._)(this,"reconnectTimeoutId",0),(0,i._)(this,"channels",new Map),(0,i._)(this,"connectivityHandlers",new Set),(0,i._)(this,"timeoutId",0),(0,i._)(this,"subscriptionQueue",Promise.resolve())}}let h=(0,s.createContext)(null);function v(e){let{children:t}=e,[n,i]=(0,a.eJ)(null);return(0,a.d4)(()=>{null==n||n.destroy();let e=new u;return i(e),()=>{e.destroy()}},[]),(0,l.tZ)(h.Provider,{value:n,children:t})}function f(){return(0,a.qp)(h)}function p(){var e;let t=f(),[n,i]=(0,a.eJ)(null!==(e=null==t?void 0:t.connectivityState)&&void 0!==e?e:"closed");return(0,a.d4)(()=>null==t?void 0:t.onConnectivityChange(i),[t]),n}},97434:function(e,t,n){n.d(t,{B:()=>v,c:()=>h});var i=n(7409),r=n(99282),o=n(98848),l=n(16584),s=n(6400),a=n(30396),c=n(6490),d=n(74312);let u=(0,s.createContext)({open:()=>void 0});function h(e){var t;let{children:n}=e,[o,s]=(0,a.eJ)(null),c=(0,a.Ye)(()=>({open:e=>s(e)}),[]);return(0,l.BX)(u.Provider,{value:c,children:[n,(0,l.tZ)(f,(0,r._)((0,i._)({},o),{source:null!==(t=null==o?void 0:o.source)&&void 0!==t?t:"substack",isOpen:!!o,onClose:()=>s(null)}))]})}function v(){return(0,a.qp)(u)}function f(e){var{isOpen:t,onClose:s}=e,a=(0,o._)(e,["isOpen","onClose"]);return(0,l.tZ)(c.u_,{isOpen:t,onClose:s,children:(0,l.tZ)(d.cr,(0,r._)((0,i._)({},a),{module:"@/frontend/reader2/chat/DmShareModal",onRequest:()=>n.e("2667").then(n.bind(n,84422)),resolve:e=>e.DmComposerModal,onClose:s}))})}},78446:function(e,t,n){n.d(t,{N4:()=>s,sm:()=>a});var i=n(16584),r=n(30396),o=n(15771),l=n(15562);function s(){let[e,t]=(0,r.eJ)(null);return{confirm:()=>new Promise((n,i)=>{e&&i(Error("Already confirming.")),t({resolve:n,reject:i})}),isConfirming:!!e,handleConfirm:n=>{t(null),null==e||e.resolve(n)},handleCancel:n=>{t(null),null==e||e.resolve(n)}}}function a(e){let{title:t,body:n,cancelLabel:r="Cancel",confirmLabel:s="Confirm",modal:a}=e;return(0,i.tZ)(l.W,{isOpen:a.isConfirming,onClose:()=>a.handleCancel(!1),title:t,description:n,primaryButton:(0,i.tZ)(o.zx,{priority:"destructive",onClick:()=>a.handleConfirm(!0),children:s}),secondaryButton:(0,i.tZ)(o.zx,{priority:"secondary",onClick:()=>a.handleCancel(!1),children:r})})}},84923:function(e,t,n){n.d(t,{d:()=>r});var i=n(30396);function r(){let[e,t]=(0,i.eJ)(!1);return{isOpen:e,onOpen:()=>t(!0),onClose:()=>t(!1)}}},12120:function(e,t,n){function i(e,t){let n=new Set(e);return n.add(t),n}function r(e,t){let n=new Set(e);return n.delete(t),n}function o(e,t){return new Set([...e].filter(e=>!t.has(e)))}n.d(t,{e5:()=>o,oR:()=>i,zu:()=>r})}}]);